var hS=Object.defineProperty;var vp=n=>{throw TypeError(n)};var mS=(n,e,t)=>e in n?hS(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Fe=(n,e,t)=>mS(n,typeof e!="symbol"?e+"":e,t),pS=(n,e,t)=>e.has(n)||vp("Cannot "+t);var Tp=(n,e,t)=>e.has(n)?vp("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t);var Yo=(n,e,t)=>(pS(n,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}})();function od(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function gS(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var r=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:function(){return n[i]}})}),t}var gu={exports:{}},Jo={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sp;function yS(){if(Sp)return Jo;Sp=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,r,a){var c=null;if(a!==void 0&&(c=""+a),r.key!==void 0&&(c=""+r.key),"key"in r){a={};for(var h in r)h!=="key"&&(a[h]=r[h])}else a=r;return r=a.ref,{$$typeof:n,type:i,key:c,ref:r!==void 0?r:null,props:a}}return Jo.Fragment=e,Jo.jsx=t,Jo.jsxs=t,Jo}var xp;function vS(){return xp||(xp=1,gu.exports=yS()),gu.exports}var S=vS(),yu={exports:{}},Ce={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ep;function TS(){if(Ep)return Ce;Ep=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),c=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),T=Symbol.iterator;function x(R){return R===null||typeof R!="object"?null:(R=T&&R[T]||R["@@iterator"],typeof R=="function"?R:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,w={};function N(R,q,te){this.props=R,this.context=q,this.refs=w,this.updater=te||C}N.prototype.isReactComponent={},N.prototype.setState=function(R,q){if(typeof R!="object"&&typeof R!="function"&&R!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,R,q,"setState")},N.prototype.forceUpdate=function(R){this.updater.enqueueForceUpdate(this,R,"forceUpdate")};function H(){}H.prototype=N.prototype;function K(R,q,te){this.props=R,this.context=q,this.refs=w,this.updater=te||C}var I=K.prototype=new H;I.constructor=K,_(I,N.prototype),I.isPureReactComponent=!0;var Q=Array.isArray,Y={H:null,A:null,T:null,S:null,V:null},oe=Object.prototype.hasOwnProperty;function ce(R,q,te,ne,U,G){return te=G.ref,{$$typeof:n,type:R,key:q,ref:te!==void 0?te:null,props:G}}function Ae(R,q){return ce(R.type,q,void 0,void 0,void 0,R.props)}function pe(R){return typeof R=="object"&&R!==null&&R.$$typeof===n}function se(R){var q={"=":"=0",":":"=2"};return"$"+R.replace(/[=:]/g,function(te){return q[te]})}var F=/\/+/g;function ie(R,q){return typeof R=="object"&&R!==null&&R.key!=null?se(""+R.key):q.toString(36)}function de(){}function ue(R){switch(R.status){case"fulfilled":return R.value;case"rejected":throw R.reason;default:switch(typeof R.status=="string"?R.then(de,de):(R.status="pending",R.then(function(q){R.status==="pending"&&(R.status="fulfilled",R.value=q)},function(q){R.status==="pending"&&(R.status="rejected",R.reason=q)})),R.status){case"fulfilled":return R.value;case"rejected":throw R.reason}}throw R}function fe(R,q,te,ne,U){var G=typeof R;(G==="undefined"||G==="boolean")&&(R=null);var z=!1;if(R===null)z=!0;else switch(G){case"bigint":case"string":case"number":z=!0;break;case"object":switch(R.$$typeof){case n:case e:z=!0;break;case y:return z=R._init,fe(z(R._payload),q,te,ne,U)}}if(z)return U=U(R),z=ne===""?"."+ie(R,0):ne,Q(U)?(te="",z!=null&&(te=z.replace(F,"$&/")+"/"),fe(U,q,te,"",function(ee){return ee})):U!=null&&(pe(U)&&(U=Ae(U,te+(U.key==null||R&&R.key===U.key?"":(""+U.key).replace(F,"$&/")+"/")+z)),q.push(U)),1;z=0;var Z=ne===""?".":ne+":";if(Q(R))for(var j=0;j<R.length;j++)ne=R[j],G=Z+ie(ne,j),z+=fe(ne,q,te,G,U);else if(j=x(R),typeof j=="function")for(R=j.call(R),j=0;!(ne=R.next()).done;)ne=ne.value,G=Z+ie(ne,j++),z+=fe(ne,q,te,G,U);else if(G==="object"){if(typeof R.then=="function")return fe(ue(R),q,te,ne,U);throw q=String(R),Error("Objects are not valid as a React child (found: "+(q==="[object Object]"?"object with keys {"+Object.keys(R).join(", ")+"}":q)+"). If you meant to render a collection of children, use an array instead.")}return z}function P(R,q,te){if(R==null)return R;var ne=[],U=0;return fe(R,ne,"","",function(G){return q.call(te,G,U++)}),ne}function X(R){if(R._status===-1){var q=R._result;q=q(),q.then(function(te){(R._status===0||R._status===-1)&&(R._status=1,R._result=te)},function(te){(R._status===0||R._status===-1)&&(R._status=2,R._result=te)}),R._status===-1&&(R._status=0,R._result=q)}if(R._status===1)return R._result.default;throw R._result}var ae=typeof reportError=="function"?reportError:function(R){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var q=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof R=="object"&&R!==null&&typeof R.message=="string"?String(R.message):String(R),error:R});if(!window.dispatchEvent(q))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",R);return}console.error(R)};function ye(){}return Ce.Children={map:P,forEach:function(R,q,te){P(R,function(){q.apply(this,arguments)},te)},count:function(R){var q=0;return P(R,function(){q++}),q},toArray:function(R){return P(R,function(q){return q})||[]},only:function(R){if(!pe(R))throw Error("React.Children.only expected to receive a single React element child.");return R}},Ce.Component=N,Ce.Fragment=t,Ce.Profiler=r,Ce.PureComponent=K,Ce.StrictMode=i,Ce.Suspense=m,Ce.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Y,Ce.__COMPILER_RUNTIME={__proto__:null,c:function(R){return Y.H.useMemoCache(R)}},Ce.cache=function(R){return function(){return R.apply(null,arguments)}},Ce.cloneElement=function(R,q,te){if(R==null)throw Error("The argument must be a React element, but you passed "+R+".");var ne=_({},R.props),U=R.key,G=void 0;if(q!=null)for(z in q.ref!==void 0&&(G=void 0),q.key!==void 0&&(U=""+q.key),q)!oe.call(q,z)||z==="key"||z==="__self"||z==="__source"||z==="ref"&&q.ref===void 0||(ne[z]=q[z]);var z=arguments.length-2;if(z===1)ne.children=te;else if(1<z){for(var Z=Array(z),j=0;j<z;j++)Z[j]=arguments[j+2];ne.children=Z}return ce(R.type,U,void 0,void 0,G,ne)},Ce.createContext=function(R){return R={$$typeof:c,_currentValue:R,_currentValue2:R,_threadCount:0,Provider:null,Consumer:null},R.Provider=R,R.Consumer={$$typeof:a,_context:R},R},Ce.createElement=function(R,q,te){var ne,U={},G=null;if(q!=null)for(ne in q.key!==void 0&&(G=""+q.key),q)oe.call(q,ne)&&ne!=="key"&&ne!=="__self"&&ne!=="__source"&&(U[ne]=q[ne]);var z=arguments.length-2;if(z===1)U.children=te;else if(1<z){for(var Z=Array(z),j=0;j<z;j++)Z[j]=arguments[j+2];U.children=Z}if(R&&R.defaultProps)for(ne in z=R.defaultProps,z)U[ne]===void 0&&(U[ne]=z[ne]);return ce(R,G,void 0,void 0,null,U)},Ce.createRef=function(){return{current:null}},Ce.forwardRef=function(R){return{$$typeof:h,render:R}},Ce.isValidElement=pe,Ce.lazy=function(R){return{$$typeof:y,_payload:{_status:-1,_result:R},_init:X}},Ce.memo=function(R,q){return{$$typeof:p,type:R,compare:q===void 0?null:q}},Ce.startTransition=function(R){var q=Y.T,te={};Y.T=te;try{var ne=R(),U=Y.S;U!==null&&U(te,ne),typeof ne=="object"&&ne!==null&&typeof ne.then=="function"&&ne.then(ye,ae)}catch(G){ae(G)}finally{Y.T=q}},Ce.unstable_useCacheRefresh=function(){return Y.H.useCacheRefresh()},Ce.use=function(R){return Y.H.use(R)},Ce.useActionState=function(R,q,te){return Y.H.useActionState(R,q,te)},Ce.useCallback=function(R,q){return Y.H.useCallback(R,q)},Ce.useContext=function(R){return Y.H.useContext(R)},Ce.useDebugValue=function(){},Ce.useDeferredValue=function(R,q){return Y.H.useDeferredValue(R,q)},Ce.useEffect=function(R,q,te){var ne=Y.H;if(typeof te=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ne.useEffect(R,q)},Ce.useId=function(){return Y.H.useId()},Ce.useImperativeHandle=function(R,q,te){return Y.H.useImperativeHandle(R,q,te)},Ce.useInsertionEffect=function(R,q){return Y.H.useInsertionEffect(R,q)},Ce.useLayoutEffect=function(R,q){return Y.H.useLayoutEffect(R,q)},Ce.useMemo=function(R,q){return Y.H.useMemo(R,q)},Ce.useOptimistic=function(R,q){return Y.H.useOptimistic(R,q)},Ce.useReducer=function(R,q,te){return Y.H.useReducer(R,q,te)},Ce.useRef=function(R){return Y.H.useRef(R)},Ce.useState=function(R){return Y.H.useState(R)},Ce.useSyncExternalStore=function(R,q,te){return Y.H.useSyncExternalStore(R,q,te)},Ce.useTransition=function(){return Y.H.useTransition()},Ce.version="19.1.1",Ce}var Cp;function rd(){return Cp||(Cp=1,yu.exports=TS()),yu.exports}var le=rd();const Ps=od(le);var vu={exports:{}},jo={},Tu={exports:{}},Su={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ap;function SS(){return Ap||(Ap=1,function(n){function e(P,X){var ae=P.length;P.push(X);e:for(;0<ae;){var ye=ae-1>>>1,R=P[ye];if(0<r(R,X))P[ye]=X,P[ae]=R,ae=ye;else break e}}function t(P){return P.length===0?null:P[0]}function i(P){if(P.length===0)return null;var X=P[0],ae=P.pop();if(ae!==X){P[0]=ae;e:for(var ye=0,R=P.length,q=R>>>1;ye<q;){var te=2*(ye+1)-1,ne=P[te],U=te+1,G=P[U];if(0>r(ne,ae))U<R&&0>r(G,ne)?(P[ye]=G,P[U]=ae,ye=U):(P[ye]=ne,P[te]=ae,ye=te);else if(U<R&&0>r(G,ae))P[ye]=G,P[U]=ae,ye=U;else break e}}return X}function r(P,X){var ae=P.sortIndex-X.sortIndex;return ae!==0?ae:P.id-X.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var c=Date,h=c.now();n.unstable_now=function(){return c.now()-h}}var m=[],p=[],y=1,T=null,x=3,C=!1,_=!1,w=!1,N=!1,H=typeof setTimeout=="function"?setTimeout:null,K=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;function Q(P){for(var X=t(p);X!==null;){if(X.callback===null)i(p);else if(X.startTime<=P)i(p),X.sortIndex=X.expirationTime,e(m,X);else break;X=t(p)}}function Y(P){if(w=!1,Q(P),!_)if(t(m)!==null)_=!0,oe||(oe=!0,ie());else{var X=t(p);X!==null&&fe(Y,X.startTime-P)}}var oe=!1,ce=-1,Ae=5,pe=-1;function se(){return N?!0:!(n.unstable_now()-pe<Ae)}function F(){if(N=!1,oe){var P=n.unstable_now();pe=P;var X=!0;try{e:{_=!1,w&&(w=!1,K(ce),ce=-1),C=!0;var ae=x;try{t:{for(Q(P),T=t(m);T!==null&&!(T.expirationTime>P&&se());){var ye=T.callback;if(typeof ye=="function"){T.callback=null,x=T.priorityLevel;var R=ye(T.expirationTime<=P);if(P=n.unstable_now(),typeof R=="function"){T.callback=R,Q(P),X=!0;break t}T===t(m)&&i(m),Q(P)}else i(m);T=t(m)}if(T!==null)X=!0;else{var q=t(p);q!==null&&fe(Y,q.startTime-P),X=!1}}break e}finally{T=null,x=ae,C=!1}X=void 0}}finally{X?ie():oe=!1}}}var ie;if(typeof I=="function")ie=function(){I(F)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,ue=de.port2;de.port1.onmessage=F,ie=function(){ue.postMessage(null)}}else ie=function(){H(F,0)};function fe(P,X){ce=H(function(){P(n.unstable_now())},X)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(P){P.callback=null},n.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ae=0<P?Math.floor(1e3/P):5},n.unstable_getCurrentPriorityLevel=function(){return x},n.unstable_next=function(P){switch(x){case 1:case 2:case 3:var X=3;break;default:X=x}var ae=x;x=X;try{return P()}finally{x=ae}},n.unstable_requestPaint=function(){N=!0},n.unstable_runWithPriority=function(P,X){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var ae=x;x=P;try{return X()}finally{x=ae}},n.unstable_scheduleCallback=function(P,X,ae){var ye=n.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?ye+ae:ye):ae=ye,P){case 1:var R=-1;break;case 2:R=250;break;case 5:R=1073741823;break;case 4:R=1e4;break;default:R=5e3}return R=ae+R,P={id:y++,callback:X,priorityLevel:P,startTime:ae,expirationTime:R,sortIndex:-1},ae>ye?(P.sortIndex=ae,e(p,P),t(m)===null&&P===t(p)&&(w?(K(ce),ce=-1):w=!0,fe(Y,ae-ye))):(P.sortIndex=R,e(m,P),_||C||(_=!0,oe||(oe=!0,ie()))),P},n.unstable_shouldYield=se,n.unstable_wrapCallback=function(P){var X=x;return function(){var ae=x;x=X;try{return P.apply(this,arguments)}finally{x=ae}}}}(Su)),Su}var _p;function xS(){return _p||(_p=1,Tu.exports=SS()),Tu.exports}var xu={exports:{}},vt={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wp;function ES(){if(wp)return vt;wp=1;var n=rd();function e(m){var p="https://react.dev/errors/"+m;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)p+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+m+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function a(m,p,y){var T=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:T==null?null:""+T,children:m,containerInfo:p,implementation:y}}var c=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(m,p){if(m==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return vt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,vt.createPortal=function(m,p){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return a(m,p,null,y)},vt.flushSync=function(m){var p=c.T,y=i.p;try{if(c.T=null,i.p=2,m)return m()}finally{c.T=p,i.p=y,i.d.f()}},vt.preconnect=function(m,p){typeof m=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,i.d.C(m,p))},vt.prefetchDNS=function(m){typeof m=="string"&&i.d.D(m)},vt.preinit=function(m,p){if(typeof m=="string"&&p&&typeof p.as=="string"){var y=p.as,T=h(y,p.crossOrigin),x=typeof p.integrity=="string"?p.integrity:void 0,C=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;y==="style"?i.d.S(m,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:T,integrity:x,fetchPriority:C}):y==="script"&&i.d.X(m,{crossOrigin:T,integrity:x,fetchPriority:C,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},vt.preinitModule=function(m,p){if(typeof m=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var y=h(p.as,p.crossOrigin);i.d.M(m,{crossOrigin:y,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&i.d.M(m)},vt.preload=function(m,p){if(typeof m=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var y=p.as,T=h(y,p.crossOrigin);i.d.L(m,y,{crossOrigin:T,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},vt.preloadModule=function(m,p){if(typeof m=="string")if(p){var y=h(p.as,p.crossOrigin);i.d.m(m,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:y,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else i.d.m(m)},vt.requestFormReset=function(m){i.d.r(m)},vt.unstable_batchedUpdates=function(m,p){return m(p)},vt.useFormState=function(m,p,y){return c.H.useFormState(m,p,y)},vt.useFormStatus=function(){return c.H.useHostTransitionStatus()},vt.version="19.1.1",vt}var bp;function CS(){if(bp)return xu.exports;bp=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),xu.exports=ES(),xu.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rp;function AS(){if(Rp)return jo;Rp=1;var n=xS(),e=rd(),t=CS();function i(s){var o="https://react.dev/errors/"+s;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)o+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function a(s){var o=s,l=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(l=o.return),s=o.return;while(s)}return o.tag===3?l:null}function c(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function h(s){if(a(s)!==s)throw Error(i(188))}function m(s){var o=s.alternate;if(!o){if(o=a(s),o===null)throw Error(i(188));return o!==s?null:s}for(var l=s,f=o;;){var g=l.return;if(g===null)break;var v=g.alternate;if(v===null){if(f=g.return,f!==null){l=f;continue}break}if(g.child===v.child){for(v=g.child;v;){if(v===l)return h(g),s;if(v===f)return h(g),o;v=v.sibling}throw Error(i(188))}if(l.return!==f.return)l=g,f=v;else{for(var E=!1,A=g.child;A;){if(A===l){E=!0,l=g,f=v;break}if(A===f){E=!0,f=g,l=v;break}A=A.sibling}if(!E){for(A=v.child;A;){if(A===l){E=!0,l=v,f=g;break}if(A===f){E=!0,f=v,l=g;break}A=A.sibling}if(!E)throw Error(i(189))}}if(l.alternate!==f)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?s:o}function p(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s;for(s=s.child;s!==null;){if(o=p(s),o!==null)return o;s=s.sibling}return null}var y=Object.assign,T=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),C=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),H=Symbol.for("react.provider"),K=Symbol.for("react.consumer"),I=Symbol.for("react.context"),Q=Symbol.for("react.forward_ref"),Y=Symbol.for("react.suspense"),oe=Symbol.for("react.suspense_list"),ce=Symbol.for("react.memo"),Ae=Symbol.for("react.lazy"),pe=Symbol.for("react.activity"),se=Symbol.for("react.memo_cache_sentinel"),F=Symbol.iterator;function ie(s){return s===null||typeof s!="object"?null:(s=F&&s[F]||s["@@iterator"],typeof s=="function"?s:null)}var de=Symbol.for("react.client.reference");function ue(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===de?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case _:return"Fragment";case N:return"Profiler";case w:return"StrictMode";case Y:return"Suspense";case oe:return"SuspenseList";case pe:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case C:return"Portal";case I:return(s.displayName||"Context")+".Provider";case K:return(s._context.displayName||"Context")+".Consumer";case Q:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case ce:return o=s.displayName||null,o!==null?o:ue(s.type)||"Memo";case Ae:o=s._payload,s=s._init;try{return ue(s(o))}catch{}}return null}var fe=Array.isArray,P=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae={pending:!1,data:null,method:null,action:null},ye=[],R=-1;function q(s){return{current:s}}function te(s){0>R||(s.current=ye[R],ye[R]=null,R--)}function ne(s,o){R++,ye[R]=s.current,s.current=o}var U=q(null),G=q(null),z=q(null),Z=q(null);function j(s,o){switch(ne(z,o),ne(G,s),ne(U,null),o.nodeType){case 9:case 11:s=(s=o.documentElement)&&(s=s.namespaceURI)?Ym(s):0;break;default:if(s=o.tagName,o=o.namespaceURI)o=Ym(o),s=Jm(o,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}te(U),ne(U,s)}function ee(){te(U),te(G),te(z)}function Se(s){s.memoizedState!==null&&ne(Z,s);var o=U.current,l=Jm(o,s.type);o!==l&&(ne(G,s),ne(U,l))}function re(s){G.current===s&&(te(U),te(G)),Z.current===s&&(te(Z),Go._currentValue=ae)}var Ne=Object.prototype.hasOwnProperty,ni=n.unstable_scheduleCallback,sl=n.unstable_cancelCallback,Fv=n.unstable_shouldYield,Yv=n.unstable_requestPaint,Zt=n.unstable_now,Jv=n.unstable_getCurrentPriorityLevel,_d=n.unstable_ImmediatePriority,wd=n.unstable_UserBlockingPriority,pr=n.unstable_NormalPriority,jv=n.unstable_LowPriority,bd=n.unstable_IdlePriority,Kv=n.log,Wv=n.unstable_setDisableYieldValue,js=null,bt=null;function Rn(s){if(typeof Kv=="function"&&Wv(s),bt&&typeof bt.setStrictMode=="function")try{bt.setStrictMode(js,s)}catch{}}var Rt=Math.clz32?Math.clz32:Zv,Xv=Math.log,Qv=Math.LN2;function Zv(s){return s>>>=0,s===0?32:31-(Xv(s)/Qv|0)|0}var gr=256,yr=4194304;function ii(s){var o=s&42;if(o!==0)return o;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function vr(s,o,l){var f=s.pendingLanes;if(f===0)return 0;var g=0,v=s.suspendedLanes,E=s.pingedLanes;s=s.warmLanes;var A=f&134217727;return A!==0?(f=A&~v,f!==0?g=ii(f):(E&=A,E!==0?g=ii(E):l||(l=A&~s,l!==0&&(g=ii(l))))):(A=f&~v,A!==0?g=ii(A):E!==0?g=ii(E):l||(l=f&~s,l!==0&&(g=ii(l)))),g===0?0:o!==0&&o!==g&&(o&v)===0&&(v=g&-g,l=o&-o,v>=l||v===32&&(l&4194048)!==0)?o:g}function Ks(s,o){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&o)===0}function e0(s,o){switch(s){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Rd(){var s=gr;return gr<<=1,(gr&4194048)===0&&(gr=256),s}function Md(){var s=yr;return yr<<=1,(yr&62914560)===0&&(yr=4194304),s}function ol(s){for(var o=[],l=0;31>l;l++)o.push(s);return o}function Ws(s,o){s.pendingLanes|=o,o!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function t0(s,o,l,f,g,v){var E=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var A=s.entanglements,b=s.expirationTimes,L=s.hiddenUpdates;for(l=E&~l;0<l;){var $=31-Rt(l),W=1<<$;A[$]=0,b[$]=-1;var O=L[$];if(O!==null)for(L[$]=null,$=0;$<O.length;$++){var V=O[$];V!==null&&(V.lane&=-536870913)}l&=~W}f!==0&&Nd(s,f,0),v!==0&&g===0&&s.tag!==0&&(s.suspendedLanes|=v&~(E&~o))}function Nd(s,o,l){s.pendingLanes|=o,s.suspendedLanes&=~o;var f=31-Rt(o);s.entangledLanes|=o,s.entanglements[f]=s.entanglements[f]|1073741824|l&4194090}function kd(s,o){var l=s.entangledLanes|=o;for(s=s.entanglements;l;){var f=31-Rt(l),g=1<<f;g&o|s[f]&o&&(s[f]|=o),l&=~g}}function rl(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function al(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Id(){var s=X.p;return s!==0?s:(s=window.event,s===void 0?32:fp(s.type))}function n0(s,o){var l=X.p;try{return X.p=s,o()}finally{X.p=l}}var Mn=Math.random().toString(36).slice(2),gt="__reactFiber$"+Mn,xt="__reactProps$"+Mn,Di="__reactContainer$"+Mn,ll="__reactEvents$"+Mn,i0="__reactListeners$"+Mn,s0="__reactHandles$"+Mn,Dd="__reactResources$"+Mn,Xs="__reactMarker$"+Mn;function cl(s){delete s[gt],delete s[xt],delete s[ll],delete s[i0],delete s[s0]}function Li(s){var o=s[gt];if(o)return o;for(var l=s.parentNode;l;){if(o=l[Di]||l[gt]){if(l=o.alternate,o.child!==null||l!==null&&l.child!==null)for(s=Xm(s);s!==null;){if(l=s[gt])return l;s=Xm(s)}return o}s=l,l=s.parentNode}return null}function Pi(s){if(s=s[gt]||s[Di]){var o=s.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return s}return null}function Qs(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s.stateNode;throw Error(i(33))}function Ui(s){var o=s[Dd];return o||(o=s[Dd]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function rt(s){s[Xs]=!0}var Ld=new Set,Pd={};function si(s,o){Oi(s,o),Oi(s+"Capture",o)}function Oi(s,o){for(Pd[s]=o,s=0;s<o.length;s++)Ld.add(o[s])}var o0=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ud={},Od={};function r0(s){return Ne.call(Od,s)?!0:Ne.call(Ud,s)?!1:o0.test(s)?Od[s]=!0:(Ud[s]=!0,!1)}function Tr(s,o,l){if(r0(o))if(l===null)s.removeAttribute(o);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(o);return;case"boolean":var f=o.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){s.removeAttribute(o);return}}s.setAttribute(o,""+l)}}function Sr(s,o,l){if(l===null)s.removeAttribute(o);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttribute(o,""+l)}}function ln(s,o,l,f){if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(o,l,""+f)}}var ul,Bd;function Bi(s){if(ul===void 0)try{throw Error()}catch(l){var o=l.stack.trim().match(/\n( *(at )?)/);ul=o&&o[1]||"",Bd=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ul+s+Bd}var dl=!1;function fl(s,o){if(!s||dl)return"";dl=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(o){var W=function(){throw Error()};if(Object.defineProperty(W.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(W,[])}catch(V){var O=V}Reflect.construct(s,[],W)}else{try{W.call()}catch(V){O=V}s.call(W.prototype)}}else{try{throw Error()}catch(V){O=V}(W=s())&&typeof W.catch=="function"&&W.catch(function(){})}}catch(V){if(V&&O&&typeof V.stack=="string")return[V.stack,O.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=f.DetermineComponentFrameRoot(),E=v[0],A=v[1];if(E&&A){var b=E.split(`
`),L=A.split(`
`);for(g=f=0;f<b.length&&!b[f].includes("DetermineComponentFrameRoot");)f++;for(;g<L.length&&!L[g].includes("DetermineComponentFrameRoot");)g++;if(f===b.length||g===L.length)for(f=b.length-1,g=L.length-1;1<=f&&0<=g&&b[f]!==L[g];)g--;for(;1<=f&&0<=g;f--,g--)if(b[f]!==L[g]){if(f!==1||g!==1)do if(f--,g--,0>g||b[f]!==L[g]){var $=`
`+b[f].replace(" at new "," at ");return s.displayName&&$.includes("<anonymous>")&&($=$.replace("<anonymous>",s.displayName)),$}while(1<=f&&0<=g);break}}}finally{dl=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?Bi(l):""}function a0(s){switch(s.tag){case 26:case 27:case 5:return Bi(s.type);case 16:return Bi("Lazy");case 13:return Bi("Suspense");case 19:return Bi("SuspenseList");case 0:case 15:return fl(s.type,!1);case 11:return fl(s.type.render,!1);case 1:return fl(s.type,!0);case 31:return Bi("Activity");default:return""}}function Hd(s){try{var o="";do o+=a0(s),s=s.return;while(s);return o}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function Bt(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Vd(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function l0(s){var o=Vd(s)?"checked":"value",l=Object.getOwnPropertyDescriptor(s.constructor.prototype,o),f=""+s[o];if(!s.hasOwnProperty(o)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var g=l.get,v=l.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return g.call(this)},set:function(E){f=""+E,v.call(this,E)}}),Object.defineProperty(s,o,{enumerable:l.enumerable}),{getValue:function(){return f},setValue:function(E){f=""+E},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function xr(s){s._valueTracker||(s._valueTracker=l0(s))}function Gd(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var l=o.getValue(),f="";return s&&(f=Vd(s)?s.checked?"true":"false":s.value),s=f,s!==l?(o.setValue(s),!0):!1}function Er(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var c0=/[\n"\\]/g;function Ht(s){return s.replace(c0,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function hl(s,o,l,f,g,v,E,A){s.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?s.type=E:s.removeAttribute("type"),o!=null?E==="number"?(o===0&&s.value===""||s.value!=o)&&(s.value=""+Bt(o)):s.value!==""+Bt(o)&&(s.value=""+Bt(o)):E!=="submit"&&E!=="reset"||s.removeAttribute("value"),o!=null?ml(s,E,Bt(o)):l!=null?ml(s,E,Bt(l)):f!=null&&s.removeAttribute("value"),g==null&&v!=null&&(s.defaultChecked=!!v),g!=null&&(s.checked=g&&typeof g!="function"&&typeof g!="symbol"),A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?s.name=""+Bt(A):s.removeAttribute("name")}function qd(s,o,l,f,g,v,E,A){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(s.type=v),o!=null||l!=null){if(!(v!=="submit"&&v!=="reset"||o!=null))return;l=l!=null?""+Bt(l):"",o=o!=null?""+Bt(o):l,A||o===s.value||(s.value=o),s.defaultValue=o}f=f??g,f=typeof f!="function"&&typeof f!="symbol"&&!!f,s.checked=A?s.checked:!!f,s.defaultChecked=!!f,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(s.name=E)}function ml(s,o,l){o==="number"&&Er(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function Hi(s,o,l,f){if(s=s.options,o){o={};for(var g=0;g<l.length;g++)o["$"+l[g]]=!0;for(l=0;l<s.length;l++)g=o.hasOwnProperty("$"+s[l].value),s[l].selected!==g&&(s[l].selected=g),g&&f&&(s[l].defaultSelected=!0)}else{for(l=""+Bt(l),o=null,g=0;g<s.length;g++){if(s[g].value===l){s[g].selected=!0,f&&(s[g].defaultSelected=!0);return}o!==null||s[g].disabled||(o=s[g])}o!==null&&(o.selected=!0)}}function zd(s,o,l){if(o!=null&&(o=""+Bt(o),o!==s.value&&(s.value=o),l==null)){s.defaultValue!==o&&(s.defaultValue=o);return}s.defaultValue=l!=null?""+Bt(l):""}function $d(s,o,l,f){if(o==null){if(f!=null){if(l!=null)throw Error(i(92));if(fe(f)){if(1<f.length)throw Error(i(93));f=f[0]}l=f}l==null&&(l=""),o=l}l=Bt(o),s.defaultValue=l,f=s.textContent,f===l&&f!==""&&f!==null&&(s.value=f)}function Vi(s,o){if(o){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=o;return}}s.textContent=o}var u0=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Fd(s,o,l){var f=o.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?f?s.setProperty(o,""):o==="float"?s.cssFloat="":s[o]="":f?s.setProperty(o,l):typeof l!="number"||l===0||u0.has(o)?o==="float"?s.cssFloat=l:s[o]=(""+l).trim():s[o]=l+"px"}function Yd(s,o,l){if(o!=null&&typeof o!="object")throw Error(i(62));if(s=s.style,l!=null){for(var f in l)!l.hasOwnProperty(f)||o!=null&&o.hasOwnProperty(f)||(f.indexOf("--")===0?s.setProperty(f,""):f==="float"?s.cssFloat="":s[f]="");for(var g in o)f=o[g],o.hasOwnProperty(g)&&l[g]!==f&&Fd(s,g,f)}else for(var v in o)o.hasOwnProperty(v)&&Fd(s,v,o[v])}function pl(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var d0=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),f0=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Cr(s){return f0.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var gl=null;function yl(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Gi=null,qi=null;function Jd(s){var o=Pi(s);if(o&&(s=o.stateNode)){var l=s[xt]||null;e:switch(s=o.stateNode,o.type){case"input":if(hl(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),o=l.name,l.type==="radio"&&o!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Ht(""+o)+'"][type="radio"]'),o=0;o<l.length;o++){var f=l[o];if(f!==s&&f.form===s.form){var g=f[xt]||null;if(!g)throw Error(i(90));hl(f,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(o=0;o<l.length;o++)f=l[o],f.form===s.form&&Gd(f)}break e;case"textarea":zd(s,l.value,l.defaultValue);break e;case"select":o=l.value,o!=null&&Hi(s,!!l.multiple,o,!1)}}}var vl=!1;function jd(s,o,l){if(vl)return s(o,l);vl=!0;try{var f=s(o);return f}finally{if(vl=!1,(Gi!==null||qi!==null)&&(la(),Gi&&(o=Gi,s=qi,qi=Gi=null,Jd(o),s)))for(o=0;o<s.length;o++)Jd(s[o])}}function Zs(s,o){var l=s.stateNode;if(l===null)return null;var f=l[xt]||null;if(f===null)return null;l=f[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(s=s.type,f=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!f;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(i(231,o,typeof l));return l}var cn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tl=!1;if(cn)try{var eo={};Object.defineProperty(eo,"passive",{get:function(){Tl=!0}}),window.addEventListener("test",eo,eo),window.removeEventListener("test",eo,eo)}catch{Tl=!1}var Nn=null,Sl=null,Ar=null;function Kd(){if(Ar)return Ar;var s,o=Sl,l=o.length,f,g="value"in Nn?Nn.value:Nn.textContent,v=g.length;for(s=0;s<l&&o[s]===g[s];s++);var E=l-s;for(f=1;f<=E&&o[l-f]===g[v-f];f++);return Ar=g.slice(s,1<f?1-f:void 0)}function _r(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function wr(){return!0}function Wd(){return!1}function Et(s){function o(l,f,g,v,E){this._reactName=l,this._targetInst=g,this.type=f,this.nativeEvent=v,this.target=E,this.currentTarget=null;for(var A in s)s.hasOwnProperty(A)&&(l=s[A],this[A]=l?l(v):v[A]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?wr:Wd,this.isPropagationStopped=Wd,this}return y(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=wr)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=wr)},persist:function(){},isPersistent:wr}),o}var oi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},br=Et(oi),to=y({},oi,{view:0,detail:0}),h0=Et(to),xl,El,no,Rr=y({},to,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Al,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==no&&(no&&s.type==="mousemove"?(xl=s.screenX-no.screenX,El=s.screenY-no.screenY):El=xl=0,no=s),xl)},movementY:function(s){return"movementY"in s?s.movementY:El}}),Xd=Et(Rr),m0=y({},Rr,{dataTransfer:0}),p0=Et(m0),g0=y({},to,{relatedTarget:0}),Cl=Et(g0),y0=y({},oi,{animationName:0,elapsedTime:0,pseudoElement:0}),v0=Et(y0),T0=y({},oi,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),S0=Et(T0),x0=y({},oi,{data:0}),Qd=Et(x0),E0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},C0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},A0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _0(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=A0[s])?!!o[s]:!1}function Al(){return _0}var w0=y({},to,{key:function(s){if(s.key){var o=E0[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=_r(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?C0[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Al,charCode:function(s){return s.type==="keypress"?_r(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?_r(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),b0=Et(w0),R0=y({},Rr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zd=Et(R0),M0=y({},to,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Al}),N0=Et(M0),k0=y({},oi,{propertyName:0,elapsedTime:0,pseudoElement:0}),I0=Et(k0),D0=y({},Rr,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),L0=Et(D0),P0=y({},oi,{newState:0,oldState:0}),U0=Et(P0),O0=[9,13,27,32],_l=cn&&"CompositionEvent"in window,io=null;cn&&"documentMode"in document&&(io=document.documentMode);var B0=cn&&"TextEvent"in window&&!io,ef=cn&&(!_l||io&&8<io&&11>=io),tf=" ",nf=!1;function sf(s,o){switch(s){case"keyup":return O0.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function of(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var zi=!1;function H0(s,o){switch(s){case"compositionend":return of(o);case"keypress":return o.which!==32?null:(nf=!0,tf);case"textInput":return s=o.data,s===tf&&nf?null:s;default:return null}}function V0(s,o){if(zi)return s==="compositionend"||!_l&&sf(s,o)?(s=Kd(),Ar=Sl=Nn=null,zi=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return ef&&o.locale!=="ko"?null:o.data;default:return null}}var G0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function rf(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!G0[s.type]:o==="textarea"}function af(s,o,l,f){Gi?qi?qi.push(f):qi=[f]:Gi=f,o=ma(o,"onChange"),0<o.length&&(l=new br("onChange","change",null,l,f),s.push({event:l,listeners:o}))}var so=null,oo=null;function q0(s){Gm(s,0)}function Mr(s){var o=Qs(s);if(Gd(o))return s}function lf(s,o){if(s==="change")return o}var cf=!1;if(cn){var wl;if(cn){var bl="oninput"in document;if(!bl){var uf=document.createElement("div");uf.setAttribute("oninput","return;"),bl=typeof uf.oninput=="function"}wl=bl}else wl=!1;cf=wl&&(!document.documentMode||9<document.documentMode)}function df(){so&&(so.detachEvent("onpropertychange",ff),oo=so=null)}function ff(s){if(s.propertyName==="value"&&Mr(oo)){var o=[];af(o,oo,s,yl(s)),jd(q0,o)}}function z0(s,o,l){s==="focusin"?(df(),so=o,oo=l,so.attachEvent("onpropertychange",ff)):s==="focusout"&&df()}function $0(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Mr(oo)}function F0(s,o){if(s==="click")return Mr(o)}function Y0(s,o){if(s==="input"||s==="change")return Mr(o)}function J0(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var Mt=typeof Object.is=="function"?Object.is:J0;function ro(s,o){if(Mt(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var l=Object.keys(s),f=Object.keys(o);if(l.length!==f.length)return!1;for(f=0;f<l.length;f++){var g=l[f];if(!Ne.call(o,g)||!Mt(s[g],o[g]))return!1}return!0}function hf(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function mf(s,o){var l=hf(s);s=0;for(var f;l;){if(l.nodeType===3){if(f=s+l.textContent.length,s<=o&&f>=o)return{node:l,offset:o-s};s=f}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=hf(l)}}function pf(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?pf(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function gf(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var o=Er(s.document);o instanceof s.HTMLIFrameElement;){try{var l=typeof o.contentWindow.location.href=="string"}catch{l=!1}if(l)s=o.contentWindow;else break;o=Er(s.document)}return o}function Rl(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}var j0=cn&&"documentMode"in document&&11>=document.documentMode,$i=null,Ml=null,ao=null,Nl=!1;function yf(s,o,l){var f=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Nl||$i==null||$i!==Er(f)||(f=$i,"selectionStart"in f&&Rl(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),ao&&ro(ao,f)||(ao=f,f=ma(Ml,"onSelect"),0<f.length&&(o=new br("onSelect","select",null,o,l),s.push({event:o,listeners:f}),o.target=$i)))}function ri(s,o){var l={};return l[s.toLowerCase()]=o.toLowerCase(),l["Webkit"+s]="webkit"+o,l["Moz"+s]="moz"+o,l}var Fi={animationend:ri("Animation","AnimationEnd"),animationiteration:ri("Animation","AnimationIteration"),animationstart:ri("Animation","AnimationStart"),transitionrun:ri("Transition","TransitionRun"),transitionstart:ri("Transition","TransitionStart"),transitioncancel:ri("Transition","TransitionCancel"),transitionend:ri("Transition","TransitionEnd")},kl={},vf={};cn&&(vf=document.createElement("div").style,"AnimationEvent"in window||(delete Fi.animationend.animation,delete Fi.animationiteration.animation,delete Fi.animationstart.animation),"TransitionEvent"in window||delete Fi.transitionend.transition);function ai(s){if(kl[s])return kl[s];if(!Fi[s])return s;var o=Fi[s],l;for(l in o)if(o.hasOwnProperty(l)&&l in vf)return kl[s]=o[l];return s}var Tf=ai("animationend"),Sf=ai("animationiteration"),xf=ai("animationstart"),K0=ai("transitionrun"),W0=ai("transitionstart"),X0=ai("transitioncancel"),Ef=ai("transitionend"),Cf=new Map,Il="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Il.push("scrollEnd");function jt(s,o){Cf.set(s,o),si(o,[s])}var Af=new WeakMap;function Vt(s,o){if(typeof s=="object"&&s!==null){var l=Af.get(s);return l!==void 0?l:(o={value:s,source:o,stack:Hd(o)},Af.set(s,o),o)}return{value:s,source:o,stack:Hd(o)}}var Gt=[],Yi=0,Dl=0;function Nr(){for(var s=Yi,o=Dl=Yi=0;o<s;){var l=Gt[o];Gt[o++]=null;var f=Gt[o];Gt[o++]=null;var g=Gt[o];Gt[o++]=null;var v=Gt[o];if(Gt[o++]=null,f!==null&&g!==null){var E=f.pending;E===null?g.next=g:(g.next=E.next,E.next=g),f.pending=g}v!==0&&_f(l,g,v)}}function kr(s,o,l,f){Gt[Yi++]=s,Gt[Yi++]=o,Gt[Yi++]=l,Gt[Yi++]=f,Dl|=f,s.lanes|=f,s=s.alternate,s!==null&&(s.lanes|=f)}function Ll(s,o,l,f){return kr(s,o,l,f),Ir(s)}function Ji(s,o){return kr(s,null,null,o),Ir(s)}function _f(s,o,l){s.lanes|=l;var f=s.alternate;f!==null&&(f.lanes|=l);for(var g=!1,v=s.return;v!==null;)v.childLanes|=l,f=v.alternate,f!==null&&(f.childLanes|=l),v.tag===22&&(s=v.stateNode,s===null||s._visibility&1||(g=!0)),s=v,v=v.return;return s.tag===3?(v=s.stateNode,g&&o!==null&&(g=31-Rt(l),s=v.hiddenUpdates,f=s[g],f===null?s[g]=[o]:f.push(o),o.lane=l|536870912),v):null}function Ir(s){if(50<Do)throw Do=0,Vc=null,Error(i(185));for(var o=s.return;o!==null;)s=o,o=s.return;return s.tag===3?s.stateNode:null}var ji={};function Q0(s,o,l,f){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nt(s,o,l,f){return new Q0(s,o,l,f)}function Pl(s){return s=s.prototype,!(!s||!s.isReactComponent)}function un(s,o){var l=s.alternate;return l===null?(l=Nt(s.tag,o,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=o,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,o=s.dependencies,l.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function wf(s,o){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=o,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,o=l.dependencies,s.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),s}function Dr(s,o,l,f,g,v){var E=0;if(f=s,typeof s=="function")Pl(s)&&(E=1);else if(typeof s=="string")E=eS(s,l,U.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case pe:return s=Nt(31,l,o,g),s.elementType=pe,s.lanes=v,s;case _:return li(l.children,g,v,o);case w:E=8,g|=24;break;case N:return s=Nt(12,l,o,g|2),s.elementType=N,s.lanes=v,s;case Y:return s=Nt(13,l,o,g),s.elementType=Y,s.lanes=v,s;case oe:return s=Nt(19,l,o,g),s.elementType=oe,s.lanes=v,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case H:case I:E=10;break e;case K:E=9;break e;case Q:E=11;break e;case ce:E=14;break e;case Ae:E=16,f=null;break e}E=29,l=Error(i(130,s===null?"null":typeof s,"")),f=null}return o=Nt(E,l,o,g),o.elementType=s,o.type=f,o.lanes=v,o}function li(s,o,l,f){return s=Nt(7,s,f,o),s.lanes=l,s}function Ul(s,o,l){return s=Nt(6,s,null,o),s.lanes=l,s}function Ol(s,o,l){return o=Nt(4,s.children!==null?s.children:[],s.key,o),o.lanes=l,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}var Ki=[],Wi=0,Lr=null,Pr=0,qt=[],zt=0,ci=null,dn=1,fn="";function ui(s,o){Ki[Wi++]=Pr,Ki[Wi++]=Lr,Lr=s,Pr=o}function bf(s,o,l){qt[zt++]=dn,qt[zt++]=fn,qt[zt++]=ci,ci=s;var f=dn;s=fn;var g=32-Rt(f)-1;f&=~(1<<g),l+=1;var v=32-Rt(o)+g;if(30<v){var E=g-g%5;v=(f&(1<<E)-1).toString(32),f>>=E,g-=E,dn=1<<32-Rt(o)+g|l<<g|f,fn=v+s}else dn=1<<v|l<<g|f,fn=s}function Bl(s){s.return!==null&&(ui(s,1),bf(s,1,0))}function Hl(s){for(;s===Lr;)Lr=Ki[--Wi],Ki[Wi]=null,Pr=Ki[--Wi],Ki[Wi]=null;for(;s===ci;)ci=qt[--zt],qt[zt]=null,fn=qt[--zt],qt[zt]=null,dn=qt[--zt],qt[zt]=null}var St=null,We=null,Le=!1,di=null,en=!1,Vl=Error(i(519));function fi(s){var o=Error(i(418,""));throw uo(Vt(o,s)),Vl}function Rf(s){var o=s.stateNode,l=s.type,f=s.memoizedProps;switch(o[gt]=s,o[xt]=f,l){case"dialog":Re("cancel",o),Re("close",o);break;case"iframe":case"object":case"embed":Re("load",o);break;case"video":case"audio":for(l=0;l<Po.length;l++)Re(Po[l],o);break;case"source":Re("error",o);break;case"img":case"image":case"link":Re("error",o),Re("load",o);break;case"details":Re("toggle",o);break;case"input":Re("invalid",o),qd(o,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0),xr(o);break;case"select":Re("invalid",o);break;case"textarea":Re("invalid",o),$d(o,f.value,f.defaultValue,f.children),xr(o)}l=f.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||o.textContent===""+l||f.suppressHydrationWarning===!0||Fm(o.textContent,l)?(f.popover!=null&&(Re("beforetoggle",o),Re("toggle",o)),f.onScroll!=null&&Re("scroll",o),f.onScrollEnd!=null&&Re("scrollend",o),f.onClick!=null&&(o.onclick=pa),o=!0):o=!1,o||fi(s)}function Mf(s){for(St=s.return;St;)switch(St.tag){case 5:case 13:en=!1;return;case 27:case 3:en=!0;return;default:St=St.return}}function lo(s){if(s!==St)return!1;if(!Le)return Mf(s),Le=!0,!1;var o=s.tag,l;if((l=o!==3&&o!==27)&&((l=o===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||nu(s.type,s.memoizedProps)),l=!l),l&&We&&fi(s),Mf(s),o===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));e:{for(s=s.nextSibling,o=0;s;){if(s.nodeType===8)if(l=s.data,l==="/$"){if(o===0){We=Wt(s.nextSibling);break e}o--}else l!=="$"&&l!=="$!"&&l!=="$?"||o++;s=s.nextSibling}We=null}}else o===27?(o=We,Yn(s.type)?(s=ru,ru=null,We=s):We=o):We=St?Wt(s.stateNode.nextSibling):null;return!0}function co(){We=St=null,Le=!1}function Nf(){var s=di;return s!==null&&(_t===null?_t=s:_t.push.apply(_t,s),di=null),s}function uo(s){di===null?di=[s]:di.push(s)}var Gl=q(null),hi=null,hn=null;function kn(s,o,l){ne(Gl,o._currentValue),o._currentValue=l}function mn(s){s._currentValue=Gl.current,te(Gl)}function ql(s,o,l){for(;s!==null;){var f=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,f!==null&&(f.childLanes|=o)):f!==null&&(f.childLanes&o)!==o&&(f.childLanes|=o),s===l)break;s=s.return}}function zl(s,o,l,f){var g=s.child;for(g!==null&&(g.return=s);g!==null;){var v=g.dependencies;if(v!==null){var E=g.child;v=v.firstContext;e:for(;v!==null;){var A=v;v=g;for(var b=0;b<o.length;b++)if(A.context===o[b]){v.lanes|=l,A=v.alternate,A!==null&&(A.lanes|=l),ql(v.return,l,s),f||(E=null);break e}v=A.next}}else if(g.tag===18){if(E=g.return,E===null)throw Error(i(341));E.lanes|=l,v=E.alternate,v!==null&&(v.lanes|=l),ql(E,l,s),E=null}else E=g.child;if(E!==null)E.return=g;else for(E=g;E!==null;){if(E===s){E=null;break}if(g=E.sibling,g!==null){g.return=E.return,E=g;break}E=E.return}g=E}}function fo(s,o,l,f){s=null;for(var g=o,v=!1;g!==null;){if(!v){if((g.flags&524288)!==0)v=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var E=g.alternate;if(E===null)throw Error(i(387));if(E=E.memoizedProps,E!==null){var A=g.type;Mt(g.pendingProps.value,E.value)||(s!==null?s.push(A):s=[A])}}else if(g===Z.current){if(E=g.alternate,E===null)throw Error(i(387));E.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(s!==null?s.push(Go):s=[Go])}g=g.return}s!==null&&zl(o,s,l,f),o.flags|=262144}function Ur(s){for(s=s.firstContext;s!==null;){if(!Mt(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function mi(s){hi=s,hn=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function yt(s){return kf(hi,s)}function Or(s,o){return hi===null&&mi(s),kf(s,o)}function kf(s,o){var l=o._currentValue;if(o={context:o,memoizedValue:l,next:null},hn===null){if(s===null)throw Error(i(308));hn=o,s.dependencies={lanes:0,firstContext:o},s.flags|=524288}else hn=hn.next=o;return l}var Z0=typeof AbortController<"u"?AbortController:function(){var s=[],o=this.signal={aborted:!1,addEventListener:function(l,f){s.push(f)}};this.abort=function(){o.aborted=!0,s.forEach(function(l){return l()})}},eT=n.unstable_scheduleCallback,tT=n.unstable_NormalPriority,nt={$$typeof:I,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function $l(){return{controller:new Z0,data:new Map,refCount:0}}function ho(s){s.refCount--,s.refCount===0&&eT(tT,function(){s.controller.abort()})}var mo=null,Fl=0,Xi=0,Qi=null;function nT(s,o){if(mo===null){var l=mo=[];Fl=0,Xi=Jc(),Qi={status:"pending",value:void 0,then:function(f){l.push(f)}}}return Fl++,o.then(If,If),o}function If(){if(--Fl===0&&mo!==null){Qi!==null&&(Qi.status="fulfilled");var s=mo;mo=null,Xi=0,Qi=null;for(var o=0;o<s.length;o++)(0,s[o])()}}function iT(s,o){var l=[],f={status:"pending",value:null,reason:null,then:function(g){l.push(g)}};return s.then(function(){f.status="fulfilled",f.value=o;for(var g=0;g<l.length;g++)(0,l[g])(o)},function(g){for(f.status="rejected",f.reason=g,g=0;g<l.length;g++)(0,l[g])(void 0)}),f}var Df=P.S;P.S=function(s,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&nT(s,o),Df!==null&&Df(s,o)};var pi=q(null);function Yl(){var s=pi.current;return s!==null?s:$e.pooledCache}function Br(s,o){o===null?ne(pi,pi.current):ne(pi,o.pool)}function Lf(){var s=Yl();return s===null?null:{parent:nt._currentValue,pool:s}}var po=Error(i(460)),Pf=Error(i(474)),Hr=Error(i(542)),Jl={then:function(){}};function Uf(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Vr(){}function Of(s,o,l){switch(l=s[l],l===void 0?s.push(o):l!==o&&(o.then(Vr,Vr),o=l),o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,Hf(s),s;default:if(typeof o.status=="string")o.then(Vr,Vr);else{if(s=$e,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=o,s.status="pending",s.then(function(f){if(o.status==="pending"){var g=o;g.status="fulfilled",g.value=f}},function(f){if(o.status==="pending"){var g=o;g.status="rejected",g.reason=f}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,Hf(s),s}throw go=o,po}}var go=null;function Bf(){if(go===null)throw Error(i(459));var s=go;return go=null,s}function Hf(s){if(s===po||s===Hr)throw Error(i(483))}var In=!1;function jl(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Kl(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Dn(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ln(s,o,l){var f=s.updateQueue;if(f===null)return null;if(f=f.shared,(Ue&2)!==0){var g=f.pending;return g===null?o.next=o:(o.next=g.next,g.next=o),f.pending=o,o=Ir(s),_f(s,null,l),o}return kr(s,f,o,l),Ir(s)}function yo(s,o,l){if(o=o.updateQueue,o!==null&&(o=o.shared,(l&4194048)!==0)){var f=o.lanes;f&=s.pendingLanes,l|=f,o.lanes=l,kd(s,l)}}function Wl(s,o){var l=s.updateQueue,f=s.alternate;if(f!==null&&(f=f.updateQueue,l===f)){var g=null,v=null;if(l=l.firstBaseUpdate,l!==null){do{var E={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};v===null?g=v=E:v=v.next=E,l=l.next}while(l!==null);v===null?g=v=o:v=v.next=o}else g=v=o;l={baseState:f.baseState,firstBaseUpdate:g,lastBaseUpdate:v,shared:f.shared,callbacks:f.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=o:s.next=o,l.lastBaseUpdate=o}var Xl=!1;function vo(){if(Xl){var s=Qi;if(s!==null)throw s}}function To(s,o,l,f){Xl=!1;var g=s.updateQueue;In=!1;var v=g.firstBaseUpdate,E=g.lastBaseUpdate,A=g.shared.pending;if(A!==null){g.shared.pending=null;var b=A,L=b.next;b.next=null,E===null?v=L:E.next=L,E=b;var $=s.alternate;$!==null&&($=$.updateQueue,A=$.lastBaseUpdate,A!==E&&(A===null?$.firstBaseUpdate=L:A.next=L,$.lastBaseUpdate=b))}if(v!==null){var W=g.baseState;E=0,$=L=b=null,A=v;do{var O=A.lane&-536870913,V=O!==A.lane;if(V?(ke&O)===O:(f&O)===O){O!==0&&O===Xi&&(Xl=!0),$!==null&&($=$.next={lane:0,tag:A.tag,payload:A.payload,callback:null,next:null});e:{var xe=s,ve=A;O=o;var Ge=l;switch(ve.tag){case 1:if(xe=ve.payload,typeof xe=="function"){W=xe.call(Ge,W,O);break e}W=xe;break e;case 3:xe.flags=xe.flags&-65537|128;case 0:if(xe=ve.payload,O=typeof xe=="function"?xe.call(Ge,W,O):xe,O==null)break e;W=y({},W,O);break e;case 2:In=!0}}O=A.callback,O!==null&&(s.flags|=64,V&&(s.flags|=8192),V=g.callbacks,V===null?g.callbacks=[O]:V.push(O))}else V={lane:O,tag:A.tag,payload:A.payload,callback:A.callback,next:null},$===null?(L=$=V,b=W):$=$.next=V,E|=O;if(A=A.next,A===null){if(A=g.shared.pending,A===null)break;V=A,A=V.next,V.next=null,g.lastBaseUpdate=V,g.shared.pending=null}}while(!0);$===null&&(b=W),g.baseState=b,g.firstBaseUpdate=L,g.lastBaseUpdate=$,v===null&&(g.shared.lanes=0),qn|=E,s.lanes=E,s.memoizedState=W}}function Vf(s,o){if(typeof s!="function")throw Error(i(191,s));s.call(o)}function Gf(s,o){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)Vf(l[s],o)}var Zi=q(null),Gr=q(0);function qf(s,o){s=xn,ne(Gr,s),ne(Zi,o),xn=s|o.baseLanes}function Ql(){ne(Gr,xn),ne(Zi,Zi.current)}function Zl(){xn=Gr.current,te(Zi),te(Gr)}var Pn=0,_e=null,He=null,et=null,qr=!1,es=!1,gi=!1,zr=0,So=0,ts=null,sT=0;function Qe(){throw Error(i(321))}function ec(s,o){if(o===null)return!1;for(var l=0;l<o.length&&l<s.length;l++)if(!Mt(s[l],o[l]))return!1;return!0}function tc(s,o,l,f,g,v){return Pn=v,_e=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,P.H=s===null||s.memoizedState===null?_h:wh,gi=!1,v=l(f,g),gi=!1,es&&(v=$f(o,l,f,g)),zf(s),v}function zf(s){P.H=Kr;var o=He!==null&&He.next!==null;if(Pn=0,et=He=_e=null,qr=!1,So=0,ts=null,o)throw Error(i(300));s===null||at||(s=s.dependencies,s!==null&&Ur(s)&&(at=!0))}function $f(s,o,l,f){_e=s;var g=0;do{if(es&&(ts=null),So=0,es=!1,25<=g)throw Error(i(301));if(g+=1,et=He=null,s.updateQueue!=null){var v=s.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}P.H=dT,v=o(l,f)}while(es);return v}function oT(){var s=P.H,o=s.useState()[0];return o=typeof o.then=="function"?xo(o):o,s=s.useState()[0],(He!==null?He.memoizedState:null)!==s&&(_e.flags|=1024),o}function nc(){var s=zr!==0;return zr=0,s}function ic(s,o,l){o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~l}function sc(s){if(qr){for(s=s.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}qr=!1}Pn=0,et=He=_e=null,es=!1,So=zr=0,ts=null}function Ct(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return et===null?_e.memoizedState=et=s:et=et.next=s,et}function tt(){if(He===null){var s=_e.alternate;s=s!==null?s.memoizedState:null}else s=He.next;var o=et===null?_e.memoizedState:et.next;if(o!==null)et=o,He=s;else{if(s===null)throw _e.alternate===null?Error(i(467)):Error(i(310));He=s,s={memoizedState:He.memoizedState,baseState:He.baseState,baseQueue:He.baseQueue,queue:He.queue,next:null},et===null?_e.memoizedState=et=s:et=et.next=s}return et}function oc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function xo(s){var o=So;return So+=1,ts===null&&(ts=[]),s=Of(ts,s,o),o=_e,(et===null?o.memoizedState:et.next)===null&&(o=o.alternate,P.H=o===null||o.memoizedState===null?_h:wh),s}function $r(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return xo(s);if(s.$$typeof===I)return yt(s)}throw Error(i(438,String(s)))}function rc(s){var o=null,l=_e.updateQueue;if(l!==null&&(o=l.memoCache),o==null){var f=_e.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(o={data:f.data.map(function(g){return g.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),l===null&&(l=oc(),_e.updateQueue=l),l.memoCache=o,l=o.data[o.index],l===void 0)for(l=o.data[o.index]=Array(s),f=0;f<s;f++)l[f]=se;return o.index++,l}function pn(s,o){return typeof o=="function"?o(s):o}function Fr(s){var o=tt();return ac(o,He,s)}function ac(s,o,l){var f=s.queue;if(f===null)throw Error(i(311));f.lastRenderedReducer=l;var g=s.baseQueue,v=f.pending;if(v!==null){if(g!==null){var E=g.next;g.next=v.next,v.next=E}o.baseQueue=g=v,f.pending=null}if(v=s.baseState,g===null)s.memoizedState=v;else{o=g.next;var A=E=null,b=null,L=o,$=!1;do{var W=L.lane&-536870913;if(W!==L.lane?(ke&W)===W:(Pn&W)===W){var O=L.revertLane;if(O===0)b!==null&&(b=b.next={lane:0,revertLane:0,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null}),W===Xi&&($=!0);else if((Pn&O)===O){L=L.next,O===Xi&&($=!0);continue}else W={lane:0,revertLane:L.revertLane,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null},b===null?(A=b=W,E=v):b=b.next=W,_e.lanes|=O,qn|=O;W=L.action,gi&&l(v,W),v=L.hasEagerState?L.eagerState:l(v,W)}else O={lane:W,revertLane:L.revertLane,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null},b===null?(A=b=O,E=v):b=b.next=O,_e.lanes|=W,qn|=W;L=L.next}while(L!==null&&L!==o);if(b===null?E=v:b.next=A,!Mt(v,s.memoizedState)&&(at=!0,$&&(l=Qi,l!==null)))throw l;s.memoizedState=v,s.baseState=E,s.baseQueue=b,f.lastRenderedState=v}return g===null&&(f.lanes=0),[s.memoizedState,f.dispatch]}function lc(s){var o=tt(),l=o.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=s;var f=l.dispatch,g=l.pending,v=o.memoizedState;if(g!==null){l.pending=null;var E=g=g.next;do v=s(v,E.action),E=E.next;while(E!==g);Mt(v,o.memoizedState)||(at=!0),o.memoizedState=v,o.baseQueue===null&&(o.baseState=v),l.lastRenderedState=v}return[v,f]}function Ff(s,o,l){var f=_e,g=tt(),v=Le;if(v){if(l===void 0)throw Error(i(407));l=l()}else l=o();var E=!Mt((He||g).memoizedState,l);E&&(g.memoizedState=l,at=!0),g=g.queue;var A=jf.bind(null,f,g,s);if(Eo(2048,8,A,[s]),g.getSnapshot!==o||E||et!==null&&et.memoizedState.tag&1){if(f.flags|=2048,ns(9,Yr(),Jf.bind(null,f,g,l,o),null),$e===null)throw Error(i(349));v||(Pn&124)!==0||Yf(f,o,l)}return l}function Yf(s,o,l){s.flags|=16384,s={getSnapshot:o,value:l},o=_e.updateQueue,o===null?(o=oc(),_e.updateQueue=o,o.stores=[s]):(l=o.stores,l===null?o.stores=[s]:l.push(s))}function Jf(s,o,l,f){o.value=l,o.getSnapshot=f,Kf(o)&&Wf(s)}function jf(s,o,l){return l(function(){Kf(o)&&Wf(s)})}function Kf(s){var o=s.getSnapshot;s=s.value;try{var l=o();return!Mt(s,l)}catch{return!0}}function Wf(s){var o=Ji(s,2);o!==null&&Pt(o,s,2)}function cc(s){var o=Ct();if(typeof s=="function"){var l=s;if(s=l(),gi){Rn(!0);try{l()}finally{Rn(!1)}}}return o.memoizedState=o.baseState=s,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:pn,lastRenderedState:s},o}function Xf(s,o,l,f){return s.baseState=l,ac(s,He,typeof f=="function"?f:pn)}function rT(s,o,l,f,g){if(jr(s))throw Error(i(485));if(s=o.action,s!==null){var v={payload:g,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){v.listeners.push(E)}};P.T!==null?l(!0):v.isTransition=!1,f(v),l=o.pending,l===null?(v.next=o.pending=v,Qf(o,v)):(v.next=l.next,o.pending=l.next=v)}}function Qf(s,o){var l=o.action,f=o.payload,g=s.state;if(o.isTransition){var v=P.T,E={};P.T=E;try{var A=l(g,f),b=P.S;b!==null&&b(E,A),Zf(s,o,A)}catch(L){uc(s,o,L)}finally{P.T=v}}else try{v=l(g,f),Zf(s,o,v)}catch(L){uc(s,o,L)}}function Zf(s,o,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(f){eh(s,o,f)},function(f){return uc(s,o,f)}):eh(s,o,l)}function eh(s,o,l){o.status="fulfilled",o.value=l,th(o),s.state=l,o=s.pending,o!==null&&(l=o.next,l===o?s.pending=null:(l=l.next,o.next=l,Qf(s,l)))}function uc(s,o,l){var f=s.pending;if(s.pending=null,f!==null){f=f.next;do o.status="rejected",o.reason=l,th(o),o=o.next;while(o!==f)}s.action=null}function th(s){s=s.listeners;for(var o=0;o<s.length;o++)(0,s[o])()}function nh(s,o){return o}function ih(s,o){if(Le){var l=$e.formState;if(l!==null){e:{var f=_e;if(Le){if(We){t:{for(var g=We,v=en;g.nodeType!==8;){if(!v){g=null;break t}if(g=Wt(g.nextSibling),g===null){g=null;break t}}v=g.data,g=v==="F!"||v==="F"?g:null}if(g){We=Wt(g.nextSibling),f=g.data==="F!";break e}}fi(f)}f=!1}f&&(o=l[0])}}return l=Ct(),l.memoizedState=l.baseState=o,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:nh,lastRenderedState:o},l.queue=f,l=Eh.bind(null,_e,f),f.dispatch=l,f=cc(!1),v=pc.bind(null,_e,!1,f.queue),f=Ct(),g={state:o,dispatch:null,action:s,pending:null},f.queue=g,l=rT.bind(null,_e,g,v,l),g.dispatch=l,f.memoizedState=s,[o,l,!1]}function sh(s){var o=tt();return oh(o,He,s)}function oh(s,o,l){if(o=ac(s,o,nh)[0],s=Fr(pn)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var f=xo(o)}catch(E){throw E===po?Hr:E}else f=o;o=tt();var g=o.queue,v=g.dispatch;return l!==o.memoizedState&&(_e.flags|=2048,ns(9,Yr(),aT.bind(null,g,l),null)),[f,v,s]}function aT(s,o){s.action=o}function rh(s){var o=tt(),l=He;if(l!==null)return oh(o,l,s);tt(),o=o.memoizedState,l=tt();var f=l.queue.dispatch;return l.memoizedState=s,[o,f,!1]}function ns(s,o,l,f){return s={tag:s,create:l,deps:f,inst:o,next:null},o=_e.updateQueue,o===null&&(o=oc(),_e.updateQueue=o),l=o.lastEffect,l===null?o.lastEffect=s.next=s:(f=l.next,l.next=s,s.next=f,o.lastEffect=s),s}function Yr(){return{destroy:void 0,resource:void 0}}function ah(){return tt().memoizedState}function Jr(s,o,l,f){var g=Ct();f=f===void 0?null:f,_e.flags|=s,g.memoizedState=ns(1|o,Yr(),l,f)}function Eo(s,o,l,f){var g=tt();f=f===void 0?null:f;var v=g.memoizedState.inst;He!==null&&f!==null&&ec(f,He.memoizedState.deps)?g.memoizedState=ns(o,v,l,f):(_e.flags|=s,g.memoizedState=ns(1|o,v,l,f))}function lh(s,o){Jr(8390656,8,s,o)}function ch(s,o){Eo(2048,8,s,o)}function uh(s,o){return Eo(4,2,s,o)}function dh(s,o){return Eo(4,4,s,o)}function fh(s,o){if(typeof o=="function"){s=s();var l=o(s);return function(){typeof l=="function"?l():o(null)}}if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function hh(s,o,l){l=l!=null?l.concat([s]):null,Eo(4,4,fh.bind(null,o,s),l)}function dc(){}function mh(s,o){var l=tt();o=o===void 0?null:o;var f=l.memoizedState;return o!==null&&ec(o,f[1])?f[0]:(l.memoizedState=[s,o],s)}function ph(s,o){var l=tt();o=o===void 0?null:o;var f=l.memoizedState;if(o!==null&&ec(o,f[1]))return f[0];if(f=s(),gi){Rn(!0);try{s()}finally{Rn(!1)}}return l.memoizedState=[f,o],f}function fc(s,o,l){return l===void 0||(Pn&1073741824)!==0?s.memoizedState=o:(s.memoizedState=l,s=vm(),_e.lanes|=s,qn|=s,l)}function gh(s,o,l,f){return Mt(l,o)?l:Zi.current!==null?(s=fc(s,l,f),Mt(s,o)||(at=!0),s):(Pn&42)===0?(at=!0,s.memoizedState=l):(s=vm(),_e.lanes|=s,qn|=s,o)}function yh(s,o,l,f,g){var v=X.p;X.p=v!==0&&8>v?v:8;var E=P.T,A={};P.T=A,pc(s,!1,o,l);try{var b=g(),L=P.S;if(L!==null&&L(A,b),b!==null&&typeof b=="object"&&typeof b.then=="function"){var $=iT(b,f);Co(s,o,$,Lt(s))}else Co(s,o,f,Lt(s))}catch(W){Co(s,o,{then:function(){},status:"rejected",reason:W},Lt())}finally{X.p=v,P.T=E}}function lT(){}function hc(s,o,l,f){if(s.tag!==5)throw Error(i(476));var g=vh(s).queue;yh(s,g,o,ae,l===null?lT:function(){return Th(s),l(f)})}function vh(s){var o=s.memoizedState;if(o!==null)return o;o={memoizedState:ae,baseState:ae,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:pn,lastRenderedState:ae},next:null};var l={};return o.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:pn,lastRenderedState:l},next:null},s.memoizedState=o,s=s.alternate,s!==null&&(s.memoizedState=o),o}function Th(s){var o=vh(s).next.queue;Co(s,o,{},Lt())}function mc(){return yt(Go)}function Sh(){return tt().memoizedState}function xh(){return tt().memoizedState}function cT(s){for(var o=s.return;o!==null;){switch(o.tag){case 24:case 3:var l=Lt();s=Dn(l);var f=Ln(o,s,l);f!==null&&(Pt(f,o,l),yo(f,o,l)),o={cache:$l()},s.payload=o;return}o=o.return}}function uT(s,o,l){var f=Lt();l={lane:f,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},jr(s)?Ch(o,l):(l=Ll(s,o,l,f),l!==null&&(Pt(l,s,f),Ah(l,o,f)))}function Eh(s,o,l){var f=Lt();Co(s,o,l,f)}function Co(s,o,l,f){var g={lane:f,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(jr(s))Ch(o,g);else{var v=s.alternate;if(s.lanes===0&&(v===null||v.lanes===0)&&(v=o.lastRenderedReducer,v!==null))try{var E=o.lastRenderedState,A=v(E,l);if(g.hasEagerState=!0,g.eagerState=A,Mt(A,E))return kr(s,o,g,0),$e===null&&Nr(),!1}catch{}finally{}if(l=Ll(s,o,g,f),l!==null)return Pt(l,s,f),Ah(l,o,f),!0}return!1}function pc(s,o,l,f){if(f={lane:2,revertLane:Jc(),action:f,hasEagerState:!1,eagerState:null,next:null},jr(s)){if(o)throw Error(i(479))}else o=Ll(s,l,f,2),o!==null&&Pt(o,s,2)}function jr(s){var o=s.alternate;return s===_e||o!==null&&o===_e}function Ch(s,o){es=qr=!0;var l=s.pending;l===null?o.next=o:(o.next=l.next,l.next=o),s.pending=o}function Ah(s,o,l){if((l&4194048)!==0){var f=o.lanes;f&=s.pendingLanes,l|=f,o.lanes=l,kd(s,l)}}var Kr={readContext:yt,use:$r,useCallback:Qe,useContext:Qe,useEffect:Qe,useImperativeHandle:Qe,useLayoutEffect:Qe,useInsertionEffect:Qe,useMemo:Qe,useReducer:Qe,useRef:Qe,useState:Qe,useDebugValue:Qe,useDeferredValue:Qe,useTransition:Qe,useSyncExternalStore:Qe,useId:Qe,useHostTransitionStatus:Qe,useFormState:Qe,useActionState:Qe,useOptimistic:Qe,useMemoCache:Qe,useCacheRefresh:Qe},_h={readContext:yt,use:$r,useCallback:function(s,o){return Ct().memoizedState=[s,o===void 0?null:o],s},useContext:yt,useEffect:lh,useImperativeHandle:function(s,o,l){l=l!=null?l.concat([s]):null,Jr(4194308,4,fh.bind(null,o,s),l)},useLayoutEffect:function(s,o){return Jr(4194308,4,s,o)},useInsertionEffect:function(s,o){Jr(4,2,s,o)},useMemo:function(s,o){var l=Ct();o=o===void 0?null:o;var f=s();if(gi){Rn(!0);try{s()}finally{Rn(!1)}}return l.memoizedState=[f,o],f},useReducer:function(s,o,l){var f=Ct();if(l!==void 0){var g=l(o);if(gi){Rn(!0);try{l(o)}finally{Rn(!1)}}}else g=o;return f.memoizedState=f.baseState=g,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:g},f.queue=s,s=s.dispatch=uT.bind(null,_e,s),[f.memoizedState,s]},useRef:function(s){var o=Ct();return s={current:s},o.memoizedState=s},useState:function(s){s=cc(s);var o=s.queue,l=Eh.bind(null,_e,o);return o.dispatch=l,[s.memoizedState,l]},useDebugValue:dc,useDeferredValue:function(s,o){var l=Ct();return fc(l,s,o)},useTransition:function(){var s=cc(!1);return s=yh.bind(null,_e,s.queue,!0,!1),Ct().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,o,l){var f=_e,g=Ct();if(Le){if(l===void 0)throw Error(i(407));l=l()}else{if(l=o(),$e===null)throw Error(i(349));(ke&124)!==0||Yf(f,o,l)}g.memoizedState=l;var v={value:l,getSnapshot:o};return g.queue=v,lh(jf.bind(null,f,v,s),[s]),f.flags|=2048,ns(9,Yr(),Jf.bind(null,f,v,l,o),null),l},useId:function(){var s=Ct(),o=$e.identifierPrefix;if(Le){var l=fn,f=dn;l=(f&~(1<<32-Rt(f)-1)).toString(32)+l,o=""+o+"R"+l,l=zr++,0<l&&(o+="H"+l.toString(32)),o+=""}else l=sT++,o=""+o+"r"+l.toString(32)+"";return s.memoizedState=o},useHostTransitionStatus:mc,useFormState:ih,useActionState:ih,useOptimistic:function(s){var o=Ct();o.memoizedState=o.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=l,o=pc.bind(null,_e,!0,l),l.dispatch=o,[s,o]},useMemoCache:rc,useCacheRefresh:function(){return Ct().memoizedState=cT.bind(null,_e)}},wh={readContext:yt,use:$r,useCallback:mh,useContext:yt,useEffect:ch,useImperativeHandle:hh,useInsertionEffect:uh,useLayoutEffect:dh,useMemo:ph,useReducer:Fr,useRef:ah,useState:function(){return Fr(pn)},useDebugValue:dc,useDeferredValue:function(s,o){var l=tt();return gh(l,He.memoizedState,s,o)},useTransition:function(){var s=Fr(pn)[0],o=tt().memoizedState;return[typeof s=="boolean"?s:xo(s),o]},useSyncExternalStore:Ff,useId:Sh,useHostTransitionStatus:mc,useFormState:sh,useActionState:sh,useOptimistic:function(s,o){var l=tt();return Xf(l,He,s,o)},useMemoCache:rc,useCacheRefresh:xh},dT={readContext:yt,use:$r,useCallback:mh,useContext:yt,useEffect:ch,useImperativeHandle:hh,useInsertionEffect:uh,useLayoutEffect:dh,useMemo:ph,useReducer:lc,useRef:ah,useState:function(){return lc(pn)},useDebugValue:dc,useDeferredValue:function(s,o){var l=tt();return He===null?fc(l,s,o):gh(l,He.memoizedState,s,o)},useTransition:function(){var s=lc(pn)[0],o=tt().memoizedState;return[typeof s=="boolean"?s:xo(s),o]},useSyncExternalStore:Ff,useId:Sh,useHostTransitionStatus:mc,useFormState:rh,useActionState:rh,useOptimistic:function(s,o){var l=tt();return He!==null?Xf(l,He,s,o):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:rc,useCacheRefresh:xh},is=null,Ao=0;function Wr(s){var o=Ao;return Ao+=1,is===null&&(is=[]),Of(is,s,o)}function _o(s,o){o=o.props.ref,s.ref=o!==void 0?o:null}function Xr(s,o){throw o.$$typeof===T?Error(i(525)):(s=Object.prototype.toString.call(o),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s)))}function bh(s){var o=s._init;return o(s._payload)}function Rh(s){function o(k,M){if(s){var D=k.deletions;D===null?(k.deletions=[M],k.flags|=16):D.push(M)}}function l(k,M){if(!s)return null;for(;M!==null;)o(k,M),M=M.sibling;return null}function f(k){for(var M=new Map;k!==null;)k.key!==null?M.set(k.key,k):M.set(k.index,k),k=k.sibling;return M}function g(k,M){return k=un(k,M),k.index=0,k.sibling=null,k}function v(k,M,D){return k.index=D,s?(D=k.alternate,D!==null?(D=D.index,D<M?(k.flags|=67108866,M):D):(k.flags|=67108866,M)):(k.flags|=1048576,M)}function E(k){return s&&k.alternate===null&&(k.flags|=67108866),k}function A(k,M,D,J){return M===null||M.tag!==6?(M=Ul(D,k.mode,J),M.return=k,M):(M=g(M,D),M.return=k,M)}function b(k,M,D,J){var he=D.type;return he===_?$(k,M,D.props.children,J,D.key):M!==null&&(M.elementType===he||typeof he=="object"&&he!==null&&he.$$typeof===Ae&&bh(he)===M.type)?(M=g(M,D.props),_o(M,D),M.return=k,M):(M=Dr(D.type,D.key,D.props,null,k.mode,J),_o(M,D),M.return=k,M)}function L(k,M,D,J){return M===null||M.tag!==4||M.stateNode.containerInfo!==D.containerInfo||M.stateNode.implementation!==D.implementation?(M=Ol(D,k.mode,J),M.return=k,M):(M=g(M,D.children||[]),M.return=k,M)}function $(k,M,D,J,he){return M===null||M.tag!==7?(M=li(D,k.mode,J,he),M.return=k,M):(M=g(M,D),M.return=k,M)}function W(k,M,D){if(typeof M=="string"&&M!==""||typeof M=="number"||typeof M=="bigint")return M=Ul(""+M,k.mode,D),M.return=k,M;if(typeof M=="object"&&M!==null){switch(M.$$typeof){case x:return D=Dr(M.type,M.key,M.props,null,k.mode,D),_o(D,M),D.return=k,D;case C:return M=Ol(M,k.mode,D),M.return=k,M;case Ae:var J=M._init;return M=J(M._payload),W(k,M,D)}if(fe(M)||ie(M))return M=li(M,k.mode,D,null),M.return=k,M;if(typeof M.then=="function")return W(k,Wr(M),D);if(M.$$typeof===I)return W(k,Or(k,M),D);Xr(k,M)}return null}function O(k,M,D,J){var he=M!==null?M.key:null;if(typeof D=="string"&&D!==""||typeof D=="number"||typeof D=="bigint")return he!==null?null:A(k,M,""+D,J);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case x:return D.key===he?b(k,M,D,J):null;case C:return D.key===he?L(k,M,D,J):null;case Ae:return he=D._init,D=he(D._payload),O(k,M,D,J)}if(fe(D)||ie(D))return he!==null?null:$(k,M,D,J,null);if(typeof D.then=="function")return O(k,M,Wr(D),J);if(D.$$typeof===I)return O(k,M,Or(k,D),J);Xr(k,D)}return null}function V(k,M,D,J,he){if(typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint")return k=k.get(D)||null,A(M,k,""+J,he);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case x:return k=k.get(J.key===null?D:J.key)||null,b(M,k,J,he);case C:return k=k.get(J.key===null?D:J.key)||null,L(M,k,J,he);case Ae:var we=J._init;return J=we(J._payload),V(k,M,D,J,he)}if(fe(J)||ie(J))return k=k.get(D)||null,$(M,k,J,he,null);if(typeof J.then=="function")return V(k,M,D,Wr(J),he);if(J.$$typeof===I)return V(k,M,D,Or(M,J),he);Xr(M,J)}return null}function xe(k,M,D,J){for(var he=null,we=null,ge=M,Te=M=0,ct=null;ge!==null&&Te<D.length;Te++){ge.index>Te?(ct=ge,ge=null):ct=ge.sibling;var De=O(k,ge,D[Te],J);if(De===null){ge===null&&(ge=ct);break}s&&ge&&De.alternate===null&&o(k,ge),M=v(De,M,Te),we===null?he=De:we.sibling=De,we=De,ge=ct}if(Te===D.length)return l(k,ge),Le&&ui(k,Te),he;if(ge===null){for(;Te<D.length;Te++)ge=W(k,D[Te],J),ge!==null&&(M=v(ge,M,Te),we===null?he=ge:we.sibling=ge,we=ge);return Le&&ui(k,Te),he}for(ge=f(ge);Te<D.length;Te++)ct=V(ge,k,Te,D[Te],J),ct!==null&&(s&&ct.alternate!==null&&ge.delete(ct.key===null?Te:ct.key),M=v(ct,M,Te),we===null?he=ct:we.sibling=ct,we=ct);return s&&ge.forEach(function(Xn){return o(k,Xn)}),Le&&ui(k,Te),he}function ve(k,M,D,J){if(D==null)throw Error(i(151));for(var he=null,we=null,ge=M,Te=M=0,ct=null,De=D.next();ge!==null&&!De.done;Te++,De=D.next()){ge.index>Te?(ct=ge,ge=null):ct=ge.sibling;var Xn=O(k,ge,De.value,J);if(Xn===null){ge===null&&(ge=ct);break}s&&ge&&Xn.alternate===null&&o(k,ge),M=v(Xn,M,Te),we===null?he=Xn:we.sibling=Xn,we=Xn,ge=ct}if(De.done)return l(k,ge),Le&&ui(k,Te),he;if(ge===null){for(;!De.done;Te++,De=D.next())De=W(k,De.value,J),De!==null&&(M=v(De,M,Te),we===null?he=De:we.sibling=De,we=De);return Le&&ui(k,Te),he}for(ge=f(ge);!De.done;Te++,De=D.next())De=V(ge,k,Te,De.value,J),De!==null&&(s&&De.alternate!==null&&ge.delete(De.key===null?Te:De.key),M=v(De,M,Te),we===null?he=De:we.sibling=De,we=De);return s&&ge.forEach(function(fS){return o(k,fS)}),Le&&ui(k,Te),he}function Ge(k,M,D,J){if(typeof D=="object"&&D!==null&&D.type===_&&D.key===null&&(D=D.props.children),typeof D=="object"&&D!==null){switch(D.$$typeof){case x:e:{for(var he=D.key;M!==null;){if(M.key===he){if(he=D.type,he===_){if(M.tag===7){l(k,M.sibling),J=g(M,D.props.children),J.return=k,k=J;break e}}else if(M.elementType===he||typeof he=="object"&&he!==null&&he.$$typeof===Ae&&bh(he)===M.type){l(k,M.sibling),J=g(M,D.props),_o(J,D),J.return=k,k=J;break e}l(k,M);break}else o(k,M);M=M.sibling}D.type===_?(J=li(D.props.children,k.mode,J,D.key),J.return=k,k=J):(J=Dr(D.type,D.key,D.props,null,k.mode,J),_o(J,D),J.return=k,k=J)}return E(k);case C:e:{for(he=D.key;M!==null;){if(M.key===he)if(M.tag===4&&M.stateNode.containerInfo===D.containerInfo&&M.stateNode.implementation===D.implementation){l(k,M.sibling),J=g(M,D.children||[]),J.return=k,k=J;break e}else{l(k,M);break}else o(k,M);M=M.sibling}J=Ol(D,k.mode,J),J.return=k,k=J}return E(k);case Ae:return he=D._init,D=he(D._payload),Ge(k,M,D,J)}if(fe(D))return xe(k,M,D,J);if(ie(D)){if(he=ie(D),typeof he!="function")throw Error(i(150));return D=he.call(D),ve(k,M,D,J)}if(typeof D.then=="function")return Ge(k,M,Wr(D),J);if(D.$$typeof===I)return Ge(k,M,Or(k,D),J);Xr(k,D)}return typeof D=="string"&&D!==""||typeof D=="number"||typeof D=="bigint"?(D=""+D,M!==null&&M.tag===6?(l(k,M.sibling),J=g(M,D),J.return=k,k=J):(l(k,M),J=Ul(D,k.mode,J),J.return=k,k=J),E(k)):l(k,M)}return function(k,M,D,J){try{Ao=0;var he=Ge(k,M,D,J);return is=null,he}catch(ge){if(ge===po||ge===Hr)throw ge;var we=Nt(29,ge,null,k.mode);return we.lanes=J,we.return=k,we}finally{}}}var ss=Rh(!0),Mh=Rh(!1),$t=q(null),tn=null;function Un(s){var o=s.alternate;ne(it,it.current&1),ne($t,s),tn===null&&(o===null||Zi.current!==null||o.memoizedState!==null)&&(tn=s)}function Nh(s){if(s.tag===22){if(ne(it,it.current),ne($t,s),tn===null){var o=s.alternate;o!==null&&o.memoizedState!==null&&(tn=s)}}else On()}function On(){ne(it,it.current),ne($t,$t.current)}function gn(s){te($t),tn===s&&(tn=null),te(it)}var it=q(0);function Qr(s){for(var o=s;o!==null;){if(o.tag===13){var l=o.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||ou(l)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function gc(s,o,l,f){o=s.memoizedState,l=l(f,o),l=l==null?o:y({},o,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var yc={enqueueSetState:function(s,o,l){s=s._reactInternals;var f=Lt(),g=Dn(f);g.payload=o,l!=null&&(g.callback=l),o=Ln(s,g,f),o!==null&&(Pt(o,s,f),yo(o,s,f))},enqueueReplaceState:function(s,o,l){s=s._reactInternals;var f=Lt(),g=Dn(f);g.tag=1,g.payload=o,l!=null&&(g.callback=l),o=Ln(s,g,f),o!==null&&(Pt(o,s,f),yo(o,s,f))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var l=Lt(),f=Dn(l);f.tag=2,o!=null&&(f.callback=o),o=Ln(s,f,l),o!==null&&(Pt(o,s,l),yo(o,s,l))}};function kh(s,o,l,f,g,v,E){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(f,v,E):o.prototype&&o.prototype.isPureReactComponent?!ro(l,f)||!ro(g,v):!0}function Ih(s,o,l,f){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(l,f),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(l,f),o.state!==s&&yc.enqueueReplaceState(o,o.state,null)}function yi(s,o){var l=o;if("ref"in o){l={};for(var f in o)f!=="ref"&&(l[f]=o[f])}if(s=s.defaultProps){l===o&&(l=y({},l));for(var g in s)l[g]===void 0&&(l[g]=s[g])}return l}var Zr=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function Dh(s){Zr(s)}function Lh(s){console.error(s)}function Ph(s){Zr(s)}function ea(s,o){try{var l=s.onUncaughtError;l(o.value,{componentStack:o.stack})}catch(f){setTimeout(function(){throw f})}}function Uh(s,o,l){try{var f=s.onCaughtError;f(l.value,{componentStack:l.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function vc(s,o,l){return l=Dn(l),l.tag=3,l.payload={element:null},l.callback=function(){ea(s,o)},l}function Oh(s){return s=Dn(s),s.tag=3,s}function Bh(s,o,l,f){var g=l.type.getDerivedStateFromError;if(typeof g=="function"){var v=f.value;s.payload=function(){return g(v)},s.callback=function(){Uh(o,l,f)}}var E=l.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(s.callback=function(){Uh(o,l,f),typeof g!="function"&&(zn===null?zn=new Set([this]):zn.add(this));var A=f.stack;this.componentDidCatch(f.value,{componentStack:A!==null?A:""})})}function fT(s,o,l,f,g){if(l.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(o=l.alternate,o!==null&&fo(o,l,g,!0),l=$t.current,l!==null){switch(l.tag){case 13:return tn===null?qc():l.alternate===null&&Xe===0&&(Xe=3),l.flags&=-257,l.flags|=65536,l.lanes=g,f===Jl?l.flags|=16384:(o=l.updateQueue,o===null?l.updateQueue=new Set([f]):o.add(f),$c(s,f,g)),!1;case 22:return l.flags|=65536,f===Jl?l.flags|=16384:(o=l.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([f])},l.updateQueue=o):(l=o.retryQueue,l===null?o.retryQueue=new Set([f]):l.add(f)),$c(s,f,g)),!1}throw Error(i(435,l.tag))}return $c(s,f,g),qc(),!1}if(Le)return o=$t.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=g,f!==Vl&&(s=Error(i(422),{cause:f}),uo(Vt(s,l)))):(f!==Vl&&(o=Error(i(423),{cause:f}),uo(Vt(o,l))),s=s.current.alternate,s.flags|=65536,g&=-g,s.lanes|=g,f=Vt(f,l),g=vc(s.stateNode,f,g),Wl(s,g),Xe!==4&&(Xe=2)),!1;var v=Error(i(520),{cause:f});if(v=Vt(v,l),Io===null?Io=[v]:Io.push(v),Xe!==4&&(Xe=2),o===null)return!0;f=Vt(f,l),l=o;do{switch(l.tag){case 3:return l.flags|=65536,s=g&-g,l.lanes|=s,s=vc(l.stateNode,f,s),Wl(l,s),!1;case 1:if(o=l.type,v=l.stateNode,(l.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(zn===null||!zn.has(v))))return l.flags|=65536,g&=-g,l.lanes|=g,g=Oh(g),Bh(g,s,l,f),Wl(l,g),!1}l=l.return}while(l!==null);return!1}var Hh=Error(i(461)),at=!1;function ht(s,o,l,f){o.child=s===null?Mh(o,null,l,f):ss(o,s.child,l,f)}function Vh(s,o,l,f,g){l=l.render;var v=o.ref;if("ref"in f){var E={};for(var A in f)A!=="ref"&&(E[A]=f[A])}else E=f;return mi(o),f=tc(s,o,l,E,v,g),A=nc(),s!==null&&!at?(ic(s,o,g),yn(s,o,g)):(Le&&A&&Bl(o),o.flags|=1,ht(s,o,f,g),o.child)}function Gh(s,o,l,f,g){if(s===null){var v=l.type;return typeof v=="function"&&!Pl(v)&&v.defaultProps===void 0&&l.compare===null?(o.tag=15,o.type=v,qh(s,o,v,f,g)):(s=Dr(l.type,null,f,o,o.mode,g),s.ref=o.ref,s.return=o,o.child=s)}if(v=s.child,!wc(s,g)){var E=v.memoizedProps;if(l=l.compare,l=l!==null?l:ro,l(E,f)&&s.ref===o.ref)return yn(s,o,g)}return o.flags|=1,s=un(v,f),s.ref=o.ref,s.return=o,o.child=s}function qh(s,o,l,f,g){if(s!==null){var v=s.memoizedProps;if(ro(v,f)&&s.ref===o.ref)if(at=!1,o.pendingProps=f=v,wc(s,g))(s.flags&131072)!==0&&(at=!0);else return o.lanes=s.lanes,yn(s,o,g)}return Tc(s,o,l,f,g)}function zh(s,o,l){var f=o.pendingProps,g=f.children,v=s!==null?s.memoizedState:null;if(f.mode==="hidden"){if((o.flags&128)!==0){if(f=v!==null?v.baseLanes|l:l,s!==null){for(g=o.child=s.child,v=0;g!==null;)v=v|g.lanes|g.childLanes,g=g.sibling;o.childLanes=v&~f}else o.childLanes=0,o.child=null;return $h(s,o,f,l)}if((l&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},s!==null&&Br(o,v!==null?v.cachePool:null),v!==null?qf(o,v):Ql(),Nh(o);else return o.lanes=o.childLanes=536870912,$h(s,o,v!==null?v.baseLanes|l:l,l)}else v!==null?(Br(o,v.cachePool),qf(o,v),On(),o.memoizedState=null):(s!==null&&Br(o,null),Ql(),On());return ht(s,o,g,l),o.child}function $h(s,o,l,f){var g=Yl();return g=g===null?null:{parent:nt._currentValue,pool:g},o.memoizedState={baseLanes:l,cachePool:g},s!==null&&Br(o,null),Ql(),Nh(o),s!==null&&fo(s,o,f,!0),null}function ta(s,o){var l=o.ref;if(l===null)s!==null&&s.ref!==null&&(o.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(s===null||s.ref!==l)&&(o.flags|=4194816)}}function Tc(s,o,l,f,g){return mi(o),l=tc(s,o,l,f,void 0,g),f=nc(),s!==null&&!at?(ic(s,o,g),yn(s,o,g)):(Le&&f&&Bl(o),o.flags|=1,ht(s,o,l,g),o.child)}function Fh(s,o,l,f,g,v){return mi(o),o.updateQueue=null,l=$f(o,f,l,g),zf(s),f=nc(),s!==null&&!at?(ic(s,o,v),yn(s,o,v)):(Le&&f&&Bl(o),o.flags|=1,ht(s,o,l,v),o.child)}function Yh(s,o,l,f,g){if(mi(o),o.stateNode===null){var v=ji,E=l.contextType;typeof E=="object"&&E!==null&&(v=yt(E)),v=new l(f,v),o.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=yc,o.stateNode=v,v._reactInternals=o,v=o.stateNode,v.props=f,v.state=o.memoizedState,v.refs={},jl(o),E=l.contextType,v.context=typeof E=="object"&&E!==null?yt(E):ji,v.state=o.memoizedState,E=l.getDerivedStateFromProps,typeof E=="function"&&(gc(o,l,E,f),v.state=o.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(E=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),E!==v.state&&yc.enqueueReplaceState(v,v.state,null),To(o,f,v,g),vo(),v.state=o.memoizedState),typeof v.componentDidMount=="function"&&(o.flags|=4194308),f=!0}else if(s===null){v=o.stateNode;var A=o.memoizedProps,b=yi(l,A);v.props=b;var L=v.context,$=l.contextType;E=ji,typeof $=="object"&&$!==null&&(E=yt($));var W=l.getDerivedStateFromProps;$=typeof W=="function"||typeof v.getSnapshotBeforeUpdate=="function",A=o.pendingProps!==A,$||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(A||L!==E)&&Ih(o,v,f,E),In=!1;var O=o.memoizedState;v.state=O,To(o,f,v,g),vo(),L=o.memoizedState,A||O!==L||In?(typeof W=="function"&&(gc(o,l,W,f),L=o.memoizedState),(b=In||kh(o,l,b,f,O,L,E))?($||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(o.flags|=4194308)):(typeof v.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=f,o.memoizedState=L),v.props=f,v.state=L,v.context=E,f=b):(typeof v.componentDidMount=="function"&&(o.flags|=4194308),f=!1)}else{v=o.stateNode,Kl(s,o),E=o.memoizedProps,$=yi(l,E),v.props=$,W=o.pendingProps,O=v.context,L=l.contextType,b=ji,typeof L=="object"&&L!==null&&(b=yt(L)),A=l.getDerivedStateFromProps,(L=typeof A=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(E!==W||O!==b)&&Ih(o,v,f,b),In=!1,O=o.memoizedState,v.state=O,To(o,f,v,g),vo();var V=o.memoizedState;E!==W||O!==V||In||s!==null&&s.dependencies!==null&&Ur(s.dependencies)?(typeof A=="function"&&(gc(o,l,A,f),V=o.memoizedState),($=In||kh(o,l,$,f,O,V,b)||s!==null&&s.dependencies!==null&&Ur(s.dependencies))?(L||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(f,V,b),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(f,V,b)),typeof v.componentDidUpdate=="function"&&(o.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof v.componentDidUpdate!="function"||E===s.memoizedProps&&O===s.memoizedState||(o.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||E===s.memoizedProps&&O===s.memoizedState||(o.flags|=1024),o.memoizedProps=f,o.memoizedState=V),v.props=f,v.state=V,v.context=b,f=$):(typeof v.componentDidUpdate!="function"||E===s.memoizedProps&&O===s.memoizedState||(o.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||E===s.memoizedProps&&O===s.memoizedState||(o.flags|=1024),f=!1)}return v=f,ta(s,o),f=(o.flags&128)!==0,v||f?(v=o.stateNode,l=f&&typeof l.getDerivedStateFromError!="function"?null:v.render(),o.flags|=1,s!==null&&f?(o.child=ss(o,s.child,null,g),o.child=ss(o,null,l,g)):ht(s,o,l,g),o.memoizedState=v.state,s=o.child):s=yn(s,o,g),s}function Jh(s,o,l,f){return co(),o.flags|=256,ht(s,o,l,f),o.child}var Sc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function xc(s){return{baseLanes:s,cachePool:Lf()}}function Ec(s,o,l){return s=s!==null?s.childLanes&~l:0,o&&(s|=Ft),s}function jh(s,o,l){var f=o.pendingProps,g=!1,v=(o.flags&128)!==0,E;if((E=v)||(E=s!==null&&s.memoizedState===null?!1:(it.current&2)!==0),E&&(g=!0,o.flags&=-129),E=(o.flags&32)!==0,o.flags&=-33,s===null){if(Le){if(g?Un(o):On(),Le){var A=We,b;if(b=A){e:{for(b=A,A=en;b.nodeType!==8;){if(!A){A=null;break e}if(b=Wt(b.nextSibling),b===null){A=null;break e}}A=b}A!==null?(o.memoizedState={dehydrated:A,treeContext:ci!==null?{id:dn,overflow:fn}:null,retryLane:536870912,hydrationErrors:null},b=Nt(18,null,null,0),b.stateNode=A,b.return=o,o.child=b,St=o,We=null,b=!0):b=!1}b||fi(o)}if(A=o.memoizedState,A!==null&&(A=A.dehydrated,A!==null))return ou(A)?o.lanes=32:o.lanes=536870912,null;gn(o)}return A=f.children,f=f.fallback,g?(On(),g=o.mode,A=na({mode:"hidden",children:A},g),f=li(f,g,l,null),A.return=o,f.return=o,A.sibling=f,o.child=A,g=o.child,g.memoizedState=xc(l),g.childLanes=Ec(s,E,l),o.memoizedState=Sc,f):(Un(o),Cc(o,A))}if(b=s.memoizedState,b!==null&&(A=b.dehydrated,A!==null)){if(v)o.flags&256?(Un(o),o.flags&=-257,o=Ac(s,o,l)):o.memoizedState!==null?(On(),o.child=s.child,o.flags|=128,o=null):(On(),g=f.fallback,A=o.mode,f=na({mode:"visible",children:f.children},A),g=li(g,A,l,null),g.flags|=2,f.return=o,g.return=o,f.sibling=g,o.child=f,ss(o,s.child,null,l),f=o.child,f.memoizedState=xc(l),f.childLanes=Ec(s,E,l),o.memoizedState=Sc,o=g);else if(Un(o),ou(A)){if(E=A.nextSibling&&A.nextSibling.dataset,E)var L=E.dgst;E=L,f=Error(i(419)),f.stack="",f.digest=E,uo({value:f,source:null,stack:null}),o=Ac(s,o,l)}else if(at||fo(s,o,l,!1),E=(l&s.childLanes)!==0,at||E){if(E=$e,E!==null&&(f=l&-l,f=(f&42)!==0?1:rl(f),f=(f&(E.suspendedLanes|l))!==0?0:f,f!==0&&f!==b.retryLane))throw b.retryLane=f,Ji(s,f),Pt(E,s,f),Hh;A.data==="$?"||qc(),o=Ac(s,o,l)}else A.data==="$?"?(o.flags|=192,o.child=s.child,o=null):(s=b.treeContext,We=Wt(A.nextSibling),St=o,Le=!0,di=null,en=!1,s!==null&&(qt[zt++]=dn,qt[zt++]=fn,qt[zt++]=ci,dn=s.id,fn=s.overflow,ci=o),o=Cc(o,f.children),o.flags|=4096);return o}return g?(On(),g=f.fallback,A=o.mode,b=s.child,L=b.sibling,f=un(b,{mode:"hidden",children:f.children}),f.subtreeFlags=b.subtreeFlags&65011712,L!==null?g=un(L,g):(g=li(g,A,l,null),g.flags|=2),g.return=o,f.return=o,f.sibling=g,o.child=f,f=g,g=o.child,A=s.child.memoizedState,A===null?A=xc(l):(b=A.cachePool,b!==null?(L=nt._currentValue,b=b.parent!==L?{parent:L,pool:L}:b):b=Lf(),A={baseLanes:A.baseLanes|l,cachePool:b}),g.memoizedState=A,g.childLanes=Ec(s,E,l),o.memoizedState=Sc,f):(Un(o),l=s.child,s=l.sibling,l=un(l,{mode:"visible",children:f.children}),l.return=o,l.sibling=null,s!==null&&(E=o.deletions,E===null?(o.deletions=[s],o.flags|=16):E.push(s)),o.child=l,o.memoizedState=null,l)}function Cc(s,o){return o=na({mode:"visible",children:o},s.mode),o.return=s,s.child=o}function na(s,o){return s=Nt(22,s,null,o),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Ac(s,o,l){return ss(o,s.child,null,l),s=Cc(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function Kh(s,o,l){s.lanes|=o;var f=s.alternate;f!==null&&(f.lanes|=o),ql(s.return,o,l)}function _c(s,o,l,f,g){var v=s.memoizedState;v===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:f,tail:l,tailMode:g}:(v.isBackwards=o,v.rendering=null,v.renderingStartTime=0,v.last=f,v.tail=l,v.tailMode=g)}function Wh(s,o,l){var f=o.pendingProps,g=f.revealOrder,v=f.tail;if(ht(s,o,f.children,l),f=it.current,(f&2)!==0)f=f&1|2,o.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Kh(s,l,o);else if(s.tag===19)Kh(s,l,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}f&=1}switch(ne(it,f),g){case"forwards":for(l=o.child,g=null;l!==null;)s=l.alternate,s!==null&&Qr(s)===null&&(g=l),l=l.sibling;l=g,l===null?(g=o.child,o.child=null):(g=l.sibling,l.sibling=null),_c(o,!1,g,l,v);break;case"backwards":for(l=null,g=o.child,o.child=null;g!==null;){if(s=g.alternate,s!==null&&Qr(s)===null){o.child=g;break}s=g.sibling,g.sibling=l,l=g,g=s}_c(o,!0,l,null,v);break;case"together":_c(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function yn(s,o,l){if(s!==null&&(o.dependencies=s.dependencies),qn|=o.lanes,(l&o.childLanes)===0)if(s!==null){if(fo(s,o,l,!1),(l&o.childLanes)===0)return null}else return null;if(s!==null&&o.child!==s.child)throw Error(i(153));if(o.child!==null){for(s=o.child,l=un(s,s.pendingProps),o.child=l,l.return=o;s.sibling!==null;)s=s.sibling,l=l.sibling=un(s,s.pendingProps),l.return=o;l.sibling=null}return o.child}function wc(s,o){return(s.lanes&o)!==0?!0:(s=s.dependencies,!!(s!==null&&Ur(s)))}function hT(s,o,l){switch(o.tag){case 3:j(o,o.stateNode.containerInfo),kn(o,nt,s.memoizedState.cache),co();break;case 27:case 5:Se(o);break;case 4:j(o,o.stateNode.containerInfo);break;case 10:kn(o,o.type,o.memoizedProps.value);break;case 13:var f=o.memoizedState;if(f!==null)return f.dehydrated!==null?(Un(o),o.flags|=128,null):(l&o.child.childLanes)!==0?jh(s,o,l):(Un(o),s=yn(s,o,l),s!==null?s.sibling:null);Un(o);break;case 19:var g=(s.flags&128)!==0;if(f=(l&o.childLanes)!==0,f||(fo(s,o,l,!1),f=(l&o.childLanes)!==0),g){if(f)return Wh(s,o,l);o.flags|=128}if(g=o.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),ne(it,it.current),f)break;return null;case 22:case 23:return o.lanes=0,zh(s,o,l);case 24:kn(o,nt,s.memoizedState.cache)}return yn(s,o,l)}function Xh(s,o,l){if(s!==null)if(s.memoizedProps!==o.pendingProps)at=!0;else{if(!wc(s,l)&&(o.flags&128)===0)return at=!1,hT(s,o,l);at=(s.flags&131072)!==0}else at=!1,Le&&(o.flags&1048576)!==0&&bf(o,Pr,o.index);switch(o.lanes=0,o.tag){case 16:e:{s=o.pendingProps;var f=o.elementType,g=f._init;if(f=g(f._payload),o.type=f,typeof f=="function")Pl(f)?(s=yi(f,s),o.tag=1,o=Yh(null,o,f,s,l)):(o.tag=0,o=Tc(null,o,f,s,l));else{if(f!=null){if(g=f.$$typeof,g===Q){o.tag=11,o=Vh(null,o,f,s,l);break e}else if(g===ce){o.tag=14,o=Gh(null,o,f,s,l);break e}}throw o=ue(f)||f,Error(i(306,o,""))}}return o;case 0:return Tc(s,o,o.type,o.pendingProps,l);case 1:return f=o.type,g=yi(f,o.pendingProps),Yh(s,o,f,g,l);case 3:e:{if(j(o,o.stateNode.containerInfo),s===null)throw Error(i(387));f=o.pendingProps;var v=o.memoizedState;g=v.element,Kl(s,o),To(o,f,null,l);var E=o.memoizedState;if(f=E.cache,kn(o,nt,f),f!==v.cache&&zl(o,[nt],l,!0),vo(),f=E.element,v.isDehydrated)if(v={element:f,isDehydrated:!1,cache:E.cache},o.updateQueue.baseState=v,o.memoizedState=v,o.flags&256){o=Jh(s,o,f,l);break e}else if(f!==g){g=Vt(Error(i(424)),o),uo(g),o=Jh(s,o,f,l);break e}else{switch(s=o.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(We=Wt(s.firstChild),St=o,Le=!0,di=null,en=!0,l=Mh(o,null,f,l),o.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(co(),f===g){o=yn(s,o,l);break e}ht(s,o,f,l)}o=o.child}return o;case 26:return ta(s,o),s===null?(l=tp(o.type,null,o.pendingProps,null))?o.memoizedState=l:Le||(l=o.type,s=o.pendingProps,f=ga(z.current).createElement(l),f[gt]=o,f[xt]=s,pt(f,l,s),rt(f),o.stateNode=f):o.memoizedState=tp(o.type,s.memoizedProps,o.pendingProps,s.memoizedState),null;case 27:return Se(o),s===null&&Le&&(f=o.stateNode=Qm(o.type,o.pendingProps,z.current),St=o,en=!0,g=We,Yn(o.type)?(ru=g,We=Wt(f.firstChild)):We=g),ht(s,o,o.pendingProps.children,l),ta(s,o),s===null&&(o.flags|=4194304),o.child;case 5:return s===null&&Le&&((g=f=We)&&(f=GT(f,o.type,o.pendingProps,en),f!==null?(o.stateNode=f,St=o,We=Wt(f.firstChild),en=!1,g=!0):g=!1),g||fi(o)),Se(o),g=o.type,v=o.pendingProps,E=s!==null?s.memoizedProps:null,f=v.children,nu(g,v)?f=null:E!==null&&nu(g,E)&&(o.flags|=32),o.memoizedState!==null&&(g=tc(s,o,oT,null,null,l),Go._currentValue=g),ta(s,o),ht(s,o,f,l),o.child;case 6:return s===null&&Le&&((s=l=We)&&(l=qT(l,o.pendingProps,en),l!==null?(o.stateNode=l,St=o,We=null,s=!0):s=!1),s||fi(o)),null;case 13:return jh(s,o,l);case 4:return j(o,o.stateNode.containerInfo),f=o.pendingProps,s===null?o.child=ss(o,null,f,l):ht(s,o,f,l),o.child;case 11:return Vh(s,o,o.type,o.pendingProps,l);case 7:return ht(s,o,o.pendingProps,l),o.child;case 8:return ht(s,o,o.pendingProps.children,l),o.child;case 12:return ht(s,o,o.pendingProps.children,l),o.child;case 10:return f=o.pendingProps,kn(o,o.type,f.value),ht(s,o,f.children,l),o.child;case 9:return g=o.type._context,f=o.pendingProps.children,mi(o),g=yt(g),f=f(g),o.flags|=1,ht(s,o,f,l),o.child;case 14:return Gh(s,o,o.type,o.pendingProps,l);case 15:return qh(s,o,o.type,o.pendingProps,l);case 19:return Wh(s,o,l);case 31:return f=o.pendingProps,l=o.mode,f={mode:f.mode,children:f.children},s===null?(l=na(f,l),l.ref=o.ref,o.child=l,l.return=o,o=l):(l=un(s.child,f),l.ref=o.ref,o.child=l,l.return=o,o=l),o;case 22:return zh(s,o,l);case 24:return mi(o),f=yt(nt),s===null?(g=Yl(),g===null&&(g=$e,v=$l(),g.pooledCache=v,v.refCount++,v!==null&&(g.pooledCacheLanes|=l),g=v),o.memoizedState={parent:f,cache:g},jl(o),kn(o,nt,g)):((s.lanes&l)!==0&&(Kl(s,o),To(o,null,null,l),vo()),g=s.memoizedState,v=o.memoizedState,g.parent!==f?(g={parent:f,cache:f},o.memoizedState=g,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=g),kn(o,nt,f)):(f=v.cache,kn(o,nt,f),f!==g.cache&&zl(o,[nt],l,!0))),ht(s,o,o.pendingProps.children,l),o.child;case 29:throw o.pendingProps}throw Error(i(156,o.tag))}function vn(s){s.flags|=4}function Qh(s,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!rp(o)){if(o=$t.current,o!==null&&((ke&4194048)===ke?tn!==null:(ke&62914560)!==ke&&(ke&536870912)===0||o!==tn))throw go=Jl,Pf;s.flags|=8192}}function ia(s,o){o!==null&&(s.flags|=4),s.flags&16384&&(o=s.tag!==22?Md():536870912,s.lanes|=o,ls|=o)}function wo(s,o){if(!Le)switch(s.tailMode){case"hidden":o=s.tail;for(var l=null;o!==null;)o.alternate!==null&&(l=o),o=o.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:f.sibling=null}}function Ke(s){var o=s.alternate!==null&&s.alternate.child===s.child,l=0,f=0;if(o)for(var g=s.child;g!==null;)l|=g.lanes|g.childLanes,f|=g.subtreeFlags&65011712,f|=g.flags&65011712,g.return=s,g=g.sibling;else for(g=s.child;g!==null;)l|=g.lanes|g.childLanes,f|=g.subtreeFlags,f|=g.flags,g.return=s,g=g.sibling;return s.subtreeFlags|=f,s.childLanes=l,o}function mT(s,o,l){var f=o.pendingProps;switch(Hl(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ke(o),null;case 1:return Ke(o),null;case 3:return l=o.stateNode,f=null,s!==null&&(f=s.memoizedState.cache),o.memoizedState.cache!==f&&(o.flags|=2048),mn(nt),ee(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(lo(o)?vn(o):s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Nf())),Ke(o),null;case 26:return l=o.memoizedState,s===null?(vn(o),l!==null?(Ke(o),Qh(o,l)):(Ke(o),o.flags&=-16777217)):l?l!==s.memoizedState?(vn(o),Ke(o),Qh(o,l)):(Ke(o),o.flags&=-16777217):(s.memoizedProps!==f&&vn(o),Ke(o),o.flags&=-16777217),null;case 27:re(o),l=z.current;var g=o.type;if(s!==null&&o.stateNode!=null)s.memoizedProps!==f&&vn(o);else{if(!f){if(o.stateNode===null)throw Error(i(166));return Ke(o),null}s=U.current,lo(o)?Rf(o):(s=Qm(g,f,l),o.stateNode=s,vn(o))}return Ke(o),null;case 5:if(re(o),l=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==f&&vn(o);else{if(!f){if(o.stateNode===null)throw Error(i(166));return Ke(o),null}if(s=U.current,lo(o))Rf(o);else{switch(g=ga(z.current),s){case 1:s=g.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:s=g.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":s=g.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":s=g.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":s=g.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof f.is=="string"?g.createElement("select",{is:f.is}):g.createElement("select"),f.multiple?s.multiple=!0:f.size&&(s.size=f.size);break;default:s=typeof f.is=="string"?g.createElement(l,{is:f.is}):g.createElement(l)}}s[gt]=o,s[xt]=f;e:for(g=o.child;g!==null;){if(g.tag===5||g.tag===6)s.appendChild(g.stateNode);else if(g.tag!==4&&g.tag!==27&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===o)break e;for(;g.sibling===null;){if(g.return===null||g.return===o)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}o.stateNode=s;e:switch(pt(s,l,f),l){case"button":case"input":case"select":case"textarea":s=!!f.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&vn(o)}}return Ke(o),o.flags&=-16777217,null;case 6:if(s&&o.stateNode!=null)s.memoizedProps!==f&&vn(o);else{if(typeof f!="string"&&o.stateNode===null)throw Error(i(166));if(s=z.current,lo(o)){if(s=o.stateNode,l=o.memoizedProps,f=null,g=St,g!==null)switch(g.tag){case 27:case 5:f=g.memoizedProps}s[gt]=o,s=!!(s.nodeValue===l||f!==null&&f.suppressHydrationWarning===!0||Fm(s.nodeValue,l)),s||fi(o)}else s=ga(s).createTextNode(f),s[gt]=o,o.stateNode=s}return Ke(o),null;case 13:if(f=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(g=lo(o),f!==null&&f.dehydrated!==null){if(s===null){if(!g)throw Error(i(318));if(g=o.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(i(317));g[gt]=o}else co(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Ke(o),g=!1}else g=Nf(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=g),g=!0;if(!g)return o.flags&256?(gn(o),o):(gn(o),null)}if(gn(o),(o.flags&128)!==0)return o.lanes=l,o;if(l=f!==null,s=s!==null&&s.memoizedState!==null,l){f=o.child,g=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(g=f.alternate.memoizedState.cachePool.pool);var v=null;f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(v=f.memoizedState.cachePool.pool),v!==g&&(f.flags|=2048)}return l!==s&&l&&(o.child.flags|=8192),ia(o,o.updateQueue),Ke(o),null;case 4:return ee(),s===null&&Xc(o.stateNode.containerInfo),Ke(o),null;case 10:return mn(o.type),Ke(o),null;case 19:if(te(it),g=o.memoizedState,g===null)return Ke(o),null;if(f=(o.flags&128)!==0,v=g.rendering,v===null)if(f)wo(g,!1);else{if(Xe!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(v=Qr(s),v!==null){for(o.flags|=128,wo(g,!1),s=v.updateQueue,o.updateQueue=s,ia(o,s),o.subtreeFlags=0,s=l,l=o.child;l!==null;)wf(l,s),l=l.sibling;return ne(it,it.current&1|2),o.child}s=s.sibling}g.tail!==null&&Zt()>ra&&(o.flags|=128,f=!0,wo(g,!1),o.lanes=4194304)}else{if(!f)if(s=Qr(v),s!==null){if(o.flags|=128,f=!0,s=s.updateQueue,o.updateQueue=s,ia(o,s),wo(g,!0),g.tail===null&&g.tailMode==="hidden"&&!v.alternate&&!Le)return Ke(o),null}else 2*Zt()-g.renderingStartTime>ra&&l!==536870912&&(o.flags|=128,f=!0,wo(g,!1),o.lanes=4194304);g.isBackwards?(v.sibling=o.child,o.child=v):(s=g.last,s!==null?s.sibling=v:o.child=v,g.last=v)}return g.tail!==null?(o=g.tail,g.rendering=o,g.tail=o.sibling,g.renderingStartTime=Zt(),o.sibling=null,s=it.current,ne(it,f?s&1|2:s&1),o):(Ke(o),null);case 22:case 23:return gn(o),Zl(),f=o.memoizedState!==null,s!==null?s.memoizedState!==null!==f&&(o.flags|=8192):f&&(o.flags|=8192),f?(l&536870912)!==0&&(o.flags&128)===0&&(Ke(o),o.subtreeFlags&6&&(o.flags|=8192)):Ke(o),l=o.updateQueue,l!==null&&ia(o,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),f=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),f!==l&&(o.flags|=2048),s!==null&&te(pi),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),o.memoizedState.cache!==l&&(o.flags|=2048),mn(nt),Ke(o),null;case 25:return null;case 30:return null}throw Error(i(156,o.tag))}function pT(s,o){switch(Hl(o),o.tag){case 1:return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return mn(nt),ee(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 26:case 27:case 5:return re(o),null;case 13:if(gn(o),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(i(340));co()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return te(it),null;case 4:return ee(),null;case 10:return mn(o.type),null;case 22:case 23:return gn(o),Zl(),s!==null&&te(pi),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 24:return mn(nt),null;case 25:return null;default:return null}}function Zh(s,o){switch(Hl(o),o.tag){case 3:mn(nt),ee();break;case 26:case 27:case 5:re(o);break;case 4:ee();break;case 13:gn(o);break;case 19:te(it);break;case 10:mn(o.type);break;case 22:case 23:gn(o),Zl(),s!==null&&te(pi);break;case 24:mn(nt)}}function bo(s,o){try{var l=o.updateQueue,f=l!==null?l.lastEffect:null;if(f!==null){var g=f.next;l=g;do{if((l.tag&s)===s){f=void 0;var v=l.create,E=l.inst;f=v(),E.destroy=f}l=l.next}while(l!==g)}}catch(A){ze(o,o.return,A)}}function Bn(s,o,l){try{var f=o.updateQueue,g=f!==null?f.lastEffect:null;if(g!==null){var v=g.next;f=v;do{if((f.tag&s)===s){var E=f.inst,A=E.destroy;if(A!==void 0){E.destroy=void 0,g=o;var b=l,L=A;try{L()}catch($){ze(g,b,$)}}}f=f.next}while(f!==v)}}catch($){ze(o,o.return,$)}}function em(s){var o=s.updateQueue;if(o!==null){var l=s.stateNode;try{Gf(o,l)}catch(f){ze(s,s.return,f)}}}function tm(s,o,l){l.props=yi(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(f){ze(s,o,f)}}function Ro(s,o){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var f=s.stateNode;break;case 30:f=s.stateNode;break;default:f=s.stateNode}typeof l=="function"?s.refCleanup=l(f):l.current=f}}catch(g){ze(s,o,g)}}function nn(s,o){var l=s.ref,f=s.refCleanup;if(l!==null)if(typeof f=="function")try{f()}catch(g){ze(s,o,g)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(g){ze(s,o,g)}else l.current=null}function nm(s){var o=s.type,l=s.memoizedProps,f=s.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":l.autoFocus&&f.focus();break e;case"img":l.src?f.src=l.src:l.srcSet&&(f.srcset=l.srcSet)}}catch(g){ze(s,s.return,g)}}function bc(s,o,l){try{var f=s.stateNode;UT(f,s.type,l,o),f[xt]=o}catch(g){ze(s,s.return,g)}}function im(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Yn(s.type)||s.tag===4}function Rc(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||im(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Yn(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Mc(s,o,l){var f=s.tag;if(f===5||f===6)s=s.stateNode,o?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,o):(o=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,o.appendChild(s),l=l._reactRootContainer,l!=null||o.onclick!==null||(o.onclick=pa));else if(f!==4&&(f===27&&Yn(s.type)&&(l=s.stateNode,o=null),s=s.child,s!==null))for(Mc(s,o,l),s=s.sibling;s!==null;)Mc(s,o,l),s=s.sibling}function sa(s,o,l){var f=s.tag;if(f===5||f===6)s=s.stateNode,o?l.insertBefore(s,o):l.appendChild(s);else if(f!==4&&(f===27&&Yn(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(sa(s,o,l),s=s.sibling;s!==null;)sa(s,o,l),s=s.sibling}function sm(s){var o=s.stateNode,l=s.memoizedProps;try{for(var f=s.type,g=o.attributes;g.length;)o.removeAttributeNode(g[0]);pt(o,f,l),o[gt]=s,o[xt]=l}catch(v){ze(s,s.return,v)}}var Tn=!1,Ze=!1,Nc=!1,om=typeof WeakSet=="function"?WeakSet:Set,lt=null;function gT(s,o){if(s=s.containerInfo,eu=Ea,s=gf(s),Rl(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var f=l.getSelection&&l.getSelection();if(f&&f.rangeCount!==0){l=f.anchorNode;var g=f.anchorOffset,v=f.focusNode;f=f.focusOffset;try{l.nodeType,v.nodeType}catch{l=null;break e}var E=0,A=-1,b=-1,L=0,$=0,W=s,O=null;t:for(;;){for(var V;W!==l||g!==0&&W.nodeType!==3||(A=E+g),W!==v||f!==0&&W.nodeType!==3||(b=E+f),W.nodeType===3&&(E+=W.nodeValue.length),(V=W.firstChild)!==null;)O=W,W=V;for(;;){if(W===s)break t;if(O===l&&++L===g&&(A=E),O===v&&++$===f&&(b=E),(V=W.nextSibling)!==null)break;W=O,O=W.parentNode}W=V}l=A===-1||b===-1?null:{start:A,end:b}}else l=null}l=l||{start:0,end:0}}else l=null;for(tu={focusedElem:s,selectionRange:l},Ea=!1,lt=o;lt!==null;)if(o=lt,s=o.child,(o.subtreeFlags&1024)!==0&&s!==null)s.return=o,lt=s;else for(;lt!==null;){switch(o=lt,v=o.alternate,s=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&v!==null){s=void 0,l=o,g=v.memoizedProps,v=v.memoizedState,f=l.stateNode;try{var xe=yi(l.type,g,l.elementType===l.type);s=f.getSnapshotBeforeUpdate(xe,v),f.__reactInternalSnapshotBeforeUpdate=s}catch(ve){ze(l,l.return,ve)}}break;case 3:if((s&1024)!==0){if(s=o.stateNode.containerInfo,l=s.nodeType,l===9)su(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":su(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=o.sibling,s!==null){s.return=o.return,lt=s;break}lt=o.return}}function rm(s,o,l){var f=l.flags;switch(l.tag){case 0:case 11:case 15:Hn(s,l),f&4&&bo(5,l);break;case 1:if(Hn(s,l),f&4)if(s=l.stateNode,o===null)try{s.componentDidMount()}catch(E){ze(l,l.return,E)}else{var g=yi(l.type,o.memoizedProps);o=o.memoizedState;try{s.componentDidUpdate(g,o,s.__reactInternalSnapshotBeforeUpdate)}catch(E){ze(l,l.return,E)}}f&64&&em(l),f&512&&Ro(l,l.return);break;case 3:if(Hn(s,l),f&64&&(s=l.updateQueue,s!==null)){if(o=null,l.child!==null)switch(l.child.tag){case 27:case 5:o=l.child.stateNode;break;case 1:o=l.child.stateNode}try{Gf(s,o)}catch(E){ze(l,l.return,E)}}break;case 27:o===null&&f&4&&sm(l);case 26:case 5:Hn(s,l),o===null&&f&4&&nm(l),f&512&&Ro(l,l.return);break;case 12:Hn(s,l);break;case 13:Hn(s,l),f&4&&cm(s,l),f&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=_T.bind(null,l),zT(s,l))));break;case 22:if(f=l.memoizedState!==null||Tn,!f){o=o!==null&&o.memoizedState!==null||Ze,g=Tn;var v=Ze;Tn=f,(Ze=o)&&!v?Vn(s,l,(l.subtreeFlags&8772)!==0):Hn(s,l),Tn=g,Ze=v}break;case 30:break;default:Hn(s,l)}}function am(s){var o=s.alternate;o!==null&&(s.alternate=null,am(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&cl(o)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var je=null,At=!1;function Sn(s,o,l){for(l=l.child;l!==null;)lm(s,o,l),l=l.sibling}function lm(s,o,l){if(bt&&typeof bt.onCommitFiberUnmount=="function")try{bt.onCommitFiberUnmount(js,l)}catch{}switch(l.tag){case 26:Ze||nn(l,o),Sn(s,o,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Ze||nn(l,o);var f=je,g=At;Yn(l.type)&&(je=l.stateNode,At=!1),Sn(s,o,l),Oo(l.stateNode),je=f,At=g;break;case 5:Ze||nn(l,o);case 6:if(f=je,g=At,je=null,Sn(s,o,l),je=f,At=g,je!==null)if(At)try{(je.nodeType===9?je.body:je.nodeName==="HTML"?je.ownerDocument.body:je).removeChild(l.stateNode)}catch(v){ze(l,o,v)}else try{je.removeChild(l.stateNode)}catch(v){ze(l,o,v)}break;case 18:je!==null&&(At?(s=je,Wm(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),Fo(s)):Wm(je,l.stateNode));break;case 4:f=je,g=At,je=l.stateNode.containerInfo,At=!0,Sn(s,o,l),je=f,At=g;break;case 0:case 11:case 14:case 15:Ze||Bn(2,l,o),Ze||Bn(4,l,o),Sn(s,o,l);break;case 1:Ze||(nn(l,o),f=l.stateNode,typeof f.componentWillUnmount=="function"&&tm(l,o,f)),Sn(s,o,l);break;case 21:Sn(s,o,l);break;case 22:Ze=(f=Ze)||l.memoizedState!==null,Sn(s,o,l),Ze=f;break;default:Sn(s,o,l)}}function cm(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Fo(s)}catch(l){ze(o,o.return,l)}}function yT(s){switch(s.tag){case 13:case 19:var o=s.stateNode;return o===null&&(o=s.stateNode=new om),o;case 22:return s=s.stateNode,o=s._retryCache,o===null&&(o=s._retryCache=new om),o;default:throw Error(i(435,s.tag))}}function kc(s,o){var l=yT(s);o.forEach(function(f){var g=wT.bind(null,s,f);l.has(f)||(l.add(f),f.then(g,g))})}function kt(s,o){var l=o.deletions;if(l!==null)for(var f=0;f<l.length;f++){var g=l[f],v=s,E=o,A=E;e:for(;A!==null;){switch(A.tag){case 27:if(Yn(A.type)){je=A.stateNode,At=!1;break e}break;case 5:je=A.stateNode,At=!1;break e;case 3:case 4:je=A.stateNode.containerInfo,At=!0;break e}A=A.return}if(je===null)throw Error(i(160));lm(v,E,g),je=null,At=!1,v=g.alternate,v!==null&&(v.return=null),g.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)um(o,s),o=o.sibling}var Kt=null;function um(s,o){var l=s.alternate,f=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:kt(o,s),It(s),f&4&&(Bn(3,s,s.return),bo(3,s),Bn(5,s,s.return));break;case 1:kt(o,s),It(s),f&512&&(Ze||l===null||nn(l,l.return)),f&64&&Tn&&(s=s.updateQueue,s!==null&&(f=s.callbacks,f!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?f:l.concat(f))));break;case 26:var g=Kt;if(kt(o,s),It(s),f&512&&(Ze||l===null||nn(l,l.return)),f&4){var v=l!==null?l.memoizedState:null;if(f=s.memoizedState,l===null)if(f===null)if(s.stateNode===null){e:{f=s.type,l=s.memoizedProps,g=g.ownerDocument||g;t:switch(f){case"title":v=g.getElementsByTagName("title")[0],(!v||v[Xs]||v[gt]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=g.createElement(f),g.head.insertBefore(v,g.querySelector("head > title"))),pt(v,f,l),v[gt]=s,rt(v),f=v;break e;case"link":var E=sp("link","href",g).get(f+(l.href||""));if(E){for(var A=0;A<E.length;A++)if(v=E[A],v.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&v.getAttribute("rel")===(l.rel==null?null:l.rel)&&v.getAttribute("title")===(l.title==null?null:l.title)&&v.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){E.splice(A,1);break t}}v=g.createElement(f),pt(v,f,l),g.head.appendChild(v);break;case"meta":if(E=sp("meta","content",g).get(f+(l.content||""))){for(A=0;A<E.length;A++)if(v=E[A],v.getAttribute("content")===(l.content==null?null:""+l.content)&&v.getAttribute("name")===(l.name==null?null:l.name)&&v.getAttribute("property")===(l.property==null?null:l.property)&&v.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&v.getAttribute("charset")===(l.charSet==null?null:l.charSet)){E.splice(A,1);break t}}v=g.createElement(f),pt(v,f,l),g.head.appendChild(v);break;default:throw Error(i(468,f))}v[gt]=s,rt(v),f=v}s.stateNode=f}else op(g,s.type,s.stateNode);else s.stateNode=ip(g,f,s.memoizedProps);else v!==f?(v===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):v.count--,f===null?op(g,s.type,s.stateNode):ip(g,f,s.memoizedProps)):f===null&&s.stateNode!==null&&bc(s,s.memoizedProps,l.memoizedProps)}break;case 27:kt(o,s),It(s),f&512&&(Ze||l===null||nn(l,l.return)),l!==null&&f&4&&bc(s,s.memoizedProps,l.memoizedProps);break;case 5:if(kt(o,s),It(s),f&512&&(Ze||l===null||nn(l,l.return)),s.flags&32){g=s.stateNode;try{Vi(g,"")}catch(V){ze(s,s.return,V)}}f&4&&s.stateNode!=null&&(g=s.memoizedProps,bc(s,g,l!==null?l.memoizedProps:g)),f&1024&&(Nc=!0);break;case 6:if(kt(o,s),It(s),f&4){if(s.stateNode===null)throw Error(i(162));f=s.memoizedProps,l=s.stateNode;try{l.nodeValue=f}catch(V){ze(s,s.return,V)}}break;case 3:if(Ta=null,g=Kt,Kt=ya(o.containerInfo),kt(o,s),Kt=g,It(s),f&4&&l!==null&&l.memoizedState.isDehydrated)try{Fo(o.containerInfo)}catch(V){ze(s,s.return,V)}Nc&&(Nc=!1,dm(s));break;case 4:f=Kt,Kt=ya(s.stateNode.containerInfo),kt(o,s),It(s),Kt=f;break;case 12:kt(o,s),It(s);break;case 13:kt(o,s),It(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Oc=Zt()),f&4&&(f=s.updateQueue,f!==null&&(s.updateQueue=null,kc(s,f)));break;case 22:g=s.memoizedState!==null;var b=l!==null&&l.memoizedState!==null,L=Tn,$=Ze;if(Tn=L||g,Ze=$||b,kt(o,s),Ze=$,Tn=L,It(s),f&8192)e:for(o=s.stateNode,o._visibility=g?o._visibility&-2:o._visibility|1,g&&(l===null||b||Tn||Ze||vi(s)),l=null,o=s;;){if(o.tag===5||o.tag===26){if(l===null){b=l=o;try{if(v=b.stateNode,g)E=v.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{A=b.stateNode;var W=b.memoizedProps.style,O=W!=null&&W.hasOwnProperty("display")?W.display:null;A.style.display=O==null||typeof O=="boolean"?"":(""+O).trim()}}catch(V){ze(b,b.return,V)}}}else if(o.tag===6){if(l===null){b=o;try{b.stateNode.nodeValue=g?"":b.memoizedProps}catch(V){ze(b,b.return,V)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===s)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break e;for(;o.sibling===null;){if(o.return===null||o.return===s)break e;l===o&&(l=null),o=o.return}l===o&&(l=null),o.sibling.return=o.return,o=o.sibling}f&4&&(f=s.updateQueue,f!==null&&(l=f.retryQueue,l!==null&&(f.retryQueue=null,kc(s,l))));break;case 19:kt(o,s),It(s),f&4&&(f=s.updateQueue,f!==null&&(s.updateQueue=null,kc(s,f)));break;case 30:break;case 21:break;default:kt(o,s),It(s)}}function It(s){var o=s.flags;if(o&2){try{for(var l,f=s.return;f!==null;){if(im(f)){l=f;break}f=f.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var g=l.stateNode,v=Rc(s);sa(s,v,g);break;case 5:var E=l.stateNode;l.flags&32&&(Vi(E,""),l.flags&=-33);var A=Rc(s);sa(s,A,E);break;case 3:case 4:var b=l.stateNode.containerInfo,L=Rc(s);Mc(s,L,b);break;default:throw Error(i(161))}}catch($){ze(s,s.return,$)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function dm(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var o=s;dm(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),s=s.sibling}}function Hn(s,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)rm(s,o.alternate,o),o=o.sibling}function vi(s){for(s=s.child;s!==null;){var o=s;switch(o.tag){case 0:case 11:case 14:case 15:Bn(4,o,o.return),vi(o);break;case 1:nn(o,o.return);var l=o.stateNode;typeof l.componentWillUnmount=="function"&&tm(o,o.return,l),vi(o);break;case 27:Oo(o.stateNode);case 26:case 5:nn(o,o.return),vi(o);break;case 22:o.memoizedState===null&&vi(o);break;case 30:vi(o);break;default:vi(o)}s=s.sibling}}function Vn(s,o,l){for(l=l&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var f=o.alternate,g=s,v=o,E=v.flags;switch(v.tag){case 0:case 11:case 15:Vn(g,v,l),bo(4,v);break;case 1:if(Vn(g,v,l),f=v,g=f.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(L){ze(f,f.return,L)}if(f=v,g=f.updateQueue,g!==null){var A=f.stateNode;try{var b=g.shared.hiddenCallbacks;if(b!==null)for(g.shared.hiddenCallbacks=null,g=0;g<b.length;g++)Vf(b[g],A)}catch(L){ze(f,f.return,L)}}l&&E&64&&em(v),Ro(v,v.return);break;case 27:sm(v);case 26:case 5:Vn(g,v,l),l&&f===null&&E&4&&nm(v),Ro(v,v.return);break;case 12:Vn(g,v,l);break;case 13:Vn(g,v,l),l&&E&4&&cm(g,v);break;case 22:v.memoizedState===null&&Vn(g,v,l),Ro(v,v.return);break;case 30:break;default:Vn(g,v,l)}o=o.sibling}}function Ic(s,o){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(s=o.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&ho(l))}function Dc(s,o){s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&ho(s))}function sn(s,o,l,f){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)fm(s,o,l,f),o=o.sibling}function fm(s,o,l,f){var g=o.flags;switch(o.tag){case 0:case 11:case 15:sn(s,o,l,f),g&2048&&bo(9,o);break;case 1:sn(s,o,l,f);break;case 3:sn(s,o,l,f),g&2048&&(s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&ho(s)));break;case 12:if(g&2048){sn(s,o,l,f),s=o.stateNode;try{var v=o.memoizedProps,E=v.id,A=v.onPostCommit;typeof A=="function"&&A(E,o.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(b){ze(o,o.return,b)}}else sn(s,o,l,f);break;case 13:sn(s,o,l,f);break;case 23:break;case 22:v=o.stateNode,E=o.alternate,o.memoizedState!==null?v._visibility&2?sn(s,o,l,f):Mo(s,o):v._visibility&2?sn(s,o,l,f):(v._visibility|=2,os(s,o,l,f,(o.subtreeFlags&10256)!==0)),g&2048&&Ic(E,o);break;case 24:sn(s,o,l,f),g&2048&&Dc(o.alternate,o);break;default:sn(s,o,l,f)}}function os(s,o,l,f,g){for(g=g&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var v=s,E=o,A=l,b=f,L=E.flags;switch(E.tag){case 0:case 11:case 15:os(v,E,A,b,g),bo(8,E);break;case 23:break;case 22:var $=E.stateNode;E.memoizedState!==null?$._visibility&2?os(v,E,A,b,g):Mo(v,E):($._visibility|=2,os(v,E,A,b,g)),g&&L&2048&&Ic(E.alternate,E);break;case 24:os(v,E,A,b,g),g&&L&2048&&Dc(E.alternate,E);break;default:os(v,E,A,b,g)}o=o.sibling}}function Mo(s,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var l=s,f=o,g=f.flags;switch(f.tag){case 22:Mo(l,f),g&2048&&Ic(f.alternate,f);break;case 24:Mo(l,f),g&2048&&Dc(f.alternate,f);break;default:Mo(l,f)}o=o.sibling}}var No=8192;function rs(s){if(s.subtreeFlags&No)for(s=s.child;s!==null;)hm(s),s=s.sibling}function hm(s){switch(s.tag){case 26:rs(s),s.flags&No&&s.memoizedState!==null&&nS(Kt,s.memoizedState,s.memoizedProps);break;case 5:rs(s);break;case 3:case 4:var o=Kt;Kt=ya(s.stateNode.containerInfo),rs(s),Kt=o;break;case 22:s.memoizedState===null&&(o=s.alternate,o!==null&&o.memoizedState!==null?(o=No,No=16777216,rs(s),No=o):rs(s));break;default:rs(s)}}function mm(s){var o=s.alternate;if(o!==null&&(s=o.child,s!==null)){o.child=null;do o=s.sibling,s.sibling=null,s=o;while(s!==null)}}function ko(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var l=0;l<o.length;l++){var f=o[l];lt=f,gm(f,s)}mm(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)pm(s),s=s.sibling}function pm(s){switch(s.tag){case 0:case 11:case 15:ko(s),s.flags&2048&&Bn(9,s,s.return);break;case 3:ko(s);break;case 12:ko(s);break;case 22:var o=s.stateNode;s.memoizedState!==null&&o._visibility&2&&(s.return===null||s.return.tag!==13)?(o._visibility&=-3,oa(s)):ko(s);break;default:ko(s)}}function oa(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var l=0;l<o.length;l++){var f=o[l];lt=f,gm(f,s)}mm(s)}for(s=s.child;s!==null;){switch(o=s,o.tag){case 0:case 11:case 15:Bn(8,o,o.return),oa(o);break;case 22:l=o.stateNode,l._visibility&2&&(l._visibility&=-3,oa(o));break;default:oa(o)}s=s.sibling}}function gm(s,o){for(;lt!==null;){var l=lt;switch(l.tag){case 0:case 11:case 15:Bn(8,l,o);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var f=l.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:ho(l.memoizedState.cache)}if(f=l.child,f!==null)f.return=l,lt=f;else e:for(l=s;lt!==null;){f=lt;var g=f.sibling,v=f.return;if(am(f),f===l){lt=null;break e}if(g!==null){g.return=v,lt=g;break e}lt=v}}}var vT={getCacheForType:function(s){var o=yt(nt),l=o.data.get(s);return l===void 0&&(l=s(),o.data.set(s,l)),l}},TT=typeof WeakMap=="function"?WeakMap:Map,Ue=0,$e=null,be=null,ke=0,Oe=0,Dt=null,Gn=!1,as=!1,Lc=!1,xn=0,Xe=0,qn=0,Ti=0,Pc=0,Ft=0,ls=0,Io=null,_t=null,Uc=!1,Oc=0,ra=1/0,aa=null,zn=null,mt=0,$n=null,cs=null,us=0,Bc=0,Hc=null,ym=null,Do=0,Vc=null;function Lt(){if((Ue&2)!==0&&ke!==0)return ke&-ke;if(P.T!==null){var s=Xi;return s!==0?s:Jc()}return Id()}function vm(){Ft===0&&(Ft=(ke&536870912)===0||Le?Rd():536870912);var s=$t.current;return s!==null&&(s.flags|=32),Ft}function Pt(s,o,l){(s===$e&&(Oe===2||Oe===9)||s.cancelPendingCommit!==null)&&(ds(s,0),Fn(s,ke,Ft,!1)),Ws(s,l),((Ue&2)===0||s!==$e)&&(s===$e&&((Ue&2)===0&&(Ti|=l),Xe===4&&Fn(s,ke,Ft,!1)),on(s))}function Tm(s,o,l){if((Ue&6)!==0)throw Error(i(327));var f=!l&&(o&124)===0&&(o&s.expiredLanes)===0||Ks(s,o),g=f?ET(s,o):zc(s,o,!0),v=f;do{if(g===0){as&&!f&&Fn(s,o,0,!1);break}else{if(l=s.current.alternate,v&&!ST(l)){g=zc(s,o,!1),v=!1;continue}if(g===2){if(v=o,s.errorRecoveryDisabledLanes&v)var E=0;else E=s.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){o=E;e:{var A=s;g=Io;var b=A.current.memoizedState.isDehydrated;if(b&&(ds(A,E).flags|=256),E=zc(A,E,!1),E!==2){if(Lc&&!b){A.errorRecoveryDisabledLanes|=v,Ti|=v,g=4;break e}v=_t,_t=g,v!==null&&(_t===null?_t=v:_t.push.apply(_t,v))}g=E}if(v=!1,g!==2)continue}}if(g===1){ds(s,0),Fn(s,o,0,!0);break}e:{switch(f=s,v=g,v){case 0:case 1:throw Error(i(345));case 4:if((o&4194048)!==o)break;case 6:Fn(f,o,Ft,!Gn);break e;case 2:_t=null;break;case 3:case 5:break;default:throw Error(i(329))}if((o&62914560)===o&&(g=Oc+300-Zt(),10<g)){if(Fn(f,o,Ft,!Gn),vr(f,0,!0)!==0)break e;f.timeoutHandle=jm(Sm.bind(null,f,l,_t,aa,Uc,o,Ft,Ti,ls,Gn,v,2,-0,0),g);break e}Sm(f,l,_t,aa,Uc,o,Ft,Ti,ls,Gn,v,0,-0,0)}}break}while(!0);on(s)}function Sm(s,o,l,f,g,v,E,A,b,L,$,W,O,V){if(s.timeoutHandle=-1,W=o.subtreeFlags,(W&8192||(W&16785408)===16785408)&&(Vo={stylesheets:null,count:0,unsuspend:tS},hm(o),W=iS(),W!==null)){s.cancelPendingCommit=W(bm.bind(null,s,o,v,l,f,g,E,A,b,$,1,O,V)),Fn(s,v,E,!L);return}bm(s,o,v,l,f,g,E,A,b)}function ST(s){for(var o=s;;){var l=o.tag;if((l===0||l===11||l===15)&&o.flags&16384&&(l=o.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var f=0;f<l.length;f++){var g=l[f],v=g.getSnapshot;g=g.value;try{if(!Mt(v(),g))return!1}catch{return!1}}if(l=o.child,o.subtreeFlags&16384&&l!==null)l.return=o,o=l;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Fn(s,o,l,f){o&=~Pc,o&=~Ti,s.suspendedLanes|=o,s.pingedLanes&=~o,f&&(s.warmLanes|=o),f=s.expirationTimes;for(var g=o;0<g;){var v=31-Rt(g),E=1<<v;f[v]=-1,g&=~E}l!==0&&Nd(s,l,o)}function la(){return(Ue&6)===0?(Lo(0),!1):!0}function Gc(){if(be!==null){if(Oe===0)var s=be.return;else s=be,hn=hi=null,sc(s),is=null,Ao=0,s=be;for(;s!==null;)Zh(s.alternate,s),s=s.return;be=null}}function ds(s,o){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,BT(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),Gc(),$e=s,be=l=un(s.current,null),ke=o,Oe=0,Dt=null,Gn=!1,as=Ks(s,o),Lc=!1,ls=Ft=Pc=Ti=qn=Xe=0,_t=Io=null,Uc=!1,(o&8)!==0&&(o|=o&32);var f=s.entangledLanes;if(f!==0)for(s=s.entanglements,f&=o;0<f;){var g=31-Rt(f),v=1<<g;o|=s[g],f&=~v}return xn=o,Nr(),l}function xm(s,o){_e=null,P.H=Kr,o===po||o===Hr?(o=Bf(),Oe=3):o===Pf?(o=Bf(),Oe=4):Oe=o===Hh?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Dt=o,be===null&&(Xe=1,ea(s,Vt(o,s.current)))}function Em(){var s=P.H;return P.H=Kr,s===null?Kr:s}function Cm(){var s=P.A;return P.A=vT,s}function qc(){Xe=4,Gn||(ke&4194048)!==ke&&$t.current!==null||(as=!0),(qn&134217727)===0&&(Ti&134217727)===0||$e===null||Fn($e,ke,Ft,!1)}function zc(s,o,l){var f=Ue;Ue|=2;var g=Em(),v=Cm();($e!==s||ke!==o)&&(aa=null,ds(s,o)),o=!1;var E=Xe;e:do try{if(Oe!==0&&be!==null){var A=be,b=Dt;switch(Oe){case 8:Gc(),E=6;break e;case 3:case 2:case 9:case 6:$t.current===null&&(o=!0);var L=Oe;if(Oe=0,Dt=null,fs(s,A,b,L),l&&as){E=0;break e}break;default:L=Oe,Oe=0,Dt=null,fs(s,A,b,L)}}xT(),E=Xe;break}catch($){xm(s,$)}while(!0);return o&&s.shellSuspendCounter++,hn=hi=null,Ue=f,P.H=g,P.A=v,be===null&&($e=null,ke=0,Nr()),E}function xT(){for(;be!==null;)Am(be)}function ET(s,o){var l=Ue;Ue|=2;var f=Em(),g=Cm();$e!==s||ke!==o?(aa=null,ra=Zt()+500,ds(s,o)):as=Ks(s,o);e:do try{if(Oe!==0&&be!==null){o=be;var v=Dt;t:switch(Oe){case 1:Oe=0,Dt=null,fs(s,o,v,1);break;case 2:case 9:if(Uf(v)){Oe=0,Dt=null,_m(o);break}o=function(){Oe!==2&&Oe!==9||$e!==s||(Oe=7),on(s)},v.then(o,o);break e;case 3:Oe=7;break e;case 4:Oe=5;break e;case 7:Uf(v)?(Oe=0,Dt=null,_m(o)):(Oe=0,Dt=null,fs(s,o,v,7));break;case 5:var E=null;switch(be.tag){case 26:E=be.memoizedState;case 5:case 27:var A=be;if(!E||rp(E)){Oe=0,Dt=null;var b=A.sibling;if(b!==null)be=b;else{var L=A.return;L!==null?(be=L,ca(L)):be=null}break t}}Oe=0,Dt=null,fs(s,o,v,5);break;case 6:Oe=0,Dt=null,fs(s,o,v,6);break;case 8:Gc(),Xe=6;break e;default:throw Error(i(462))}}CT();break}catch($){xm(s,$)}while(!0);return hn=hi=null,P.H=f,P.A=g,Ue=l,be!==null?0:($e=null,ke=0,Nr(),Xe)}function CT(){for(;be!==null&&!Fv();)Am(be)}function Am(s){var o=Xh(s.alternate,s,xn);s.memoizedProps=s.pendingProps,o===null?ca(s):be=o}function _m(s){var o=s,l=o.alternate;switch(o.tag){case 15:case 0:o=Fh(l,o,o.pendingProps,o.type,void 0,ke);break;case 11:o=Fh(l,o,o.pendingProps,o.type.render,o.ref,ke);break;case 5:sc(o);default:Zh(l,o),o=be=wf(o,xn),o=Xh(l,o,xn)}s.memoizedProps=s.pendingProps,o===null?ca(s):be=o}function fs(s,o,l,f){hn=hi=null,sc(o),is=null,Ao=0;var g=o.return;try{if(fT(s,g,o,l,ke)){Xe=1,ea(s,Vt(l,s.current)),be=null;return}}catch(v){if(g!==null)throw be=g,v;Xe=1,ea(s,Vt(l,s.current)),be=null;return}o.flags&32768?(Le||f===1?s=!0:as||(ke&536870912)!==0?s=!1:(Gn=s=!0,(f===2||f===9||f===3||f===6)&&(f=$t.current,f!==null&&f.tag===13&&(f.flags|=16384))),wm(o,s)):ca(o)}function ca(s){var o=s;do{if((o.flags&32768)!==0){wm(o,Gn);return}s=o.return;var l=mT(o.alternate,o,xn);if(l!==null){be=l;return}if(o=o.sibling,o!==null){be=o;return}be=o=s}while(o!==null);Xe===0&&(Xe=5)}function wm(s,o){do{var l=pT(s.alternate,s);if(l!==null){l.flags&=32767,be=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!o&&(s=s.sibling,s!==null)){be=s;return}be=s=l}while(s!==null);Xe=6,be=null}function bm(s,o,l,f,g,v,E,A,b){s.cancelPendingCommit=null;do ua();while(mt!==0);if((Ue&6)!==0)throw Error(i(327));if(o!==null){if(o===s.current)throw Error(i(177));if(v=o.lanes|o.childLanes,v|=Dl,t0(s,l,v,E,A,b),s===$e&&(be=$e=null,ke=0),cs=o,$n=s,us=l,Bc=v,Hc=g,ym=f,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,bT(pr,function(){return Im(),null})):(s.callbackNode=null,s.callbackPriority=0),f=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||f){f=P.T,P.T=null,g=X.p,X.p=2,E=Ue,Ue|=4;try{gT(s,o,l)}finally{Ue=E,X.p=g,P.T=f}}mt=1,Rm(),Mm(),Nm()}}function Rm(){if(mt===1){mt=0;var s=$n,o=cs,l=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||l){l=P.T,P.T=null;var f=X.p;X.p=2;var g=Ue;Ue|=4;try{um(o,s);var v=tu,E=gf(s.containerInfo),A=v.focusedElem,b=v.selectionRange;if(E!==A&&A&&A.ownerDocument&&pf(A.ownerDocument.documentElement,A)){if(b!==null&&Rl(A)){var L=b.start,$=b.end;if($===void 0&&($=L),"selectionStart"in A)A.selectionStart=L,A.selectionEnd=Math.min($,A.value.length);else{var W=A.ownerDocument||document,O=W&&W.defaultView||window;if(O.getSelection){var V=O.getSelection(),xe=A.textContent.length,ve=Math.min(b.start,xe),Ge=b.end===void 0?ve:Math.min(b.end,xe);!V.extend&&ve>Ge&&(E=Ge,Ge=ve,ve=E);var k=mf(A,ve),M=mf(A,Ge);if(k&&M&&(V.rangeCount!==1||V.anchorNode!==k.node||V.anchorOffset!==k.offset||V.focusNode!==M.node||V.focusOffset!==M.offset)){var D=W.createRange();D.setStart(k.node,k.offset),V.removeAllRanges(),ve>Ge?(V.addRange(D),V.extend(M.node,M.offset)):(D.setEnd(M.node,M.offset),V.addRange(D))}}}}for(W=[],V=A;V=V.parentNode;)V.nodeType===1&&W.push({element:V,left:V.scrollLeft,top:V.scrollTop});for(typeof A.focus=="function"&&A.focus(),A=0;A<W.length;A++){var J=W[A];J.element.scrollLeft=J.left,J.element.scrollTop=J.top}}Ea=!!eu,tu=eu=null}finally{Ue=g,X.p=f,P.T=l}}s.current=o,mt=2}}function Mm(){if(mt===2){mt=0;var s=$n,o=cs,l=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||l){l=P.T,P.T=null;var f=X.p;X.p=2;var g=Ue;Ue|=4;try{rm(s,o.alternate,o)}finally{Ue=g,X.p=f,P.T=l}}mt=3}}function Nm(){if(mt===4||mt===3){mt=0,Yv();var s=$n,o=cs,l=us,f=ym;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?mt=5:(mt=0,cs=$n=null,km(s,s.pendingLanes));var g=s.pendingLanes;if(g===0&&(zn=null),al(l),o=o.stateNode,bt&&typeof bt.onCommitFiberRoot=="function")try{bt.onCommitFiberRoot(js,o,void 0,(o.current.flags&128)===128)}catch{}if(f!==null){o=P.T,g=X.p,X.p=2,P.T=null;try{for(var v=s.onRecoverableError,E=0;E<f.length;E++){var A=f[E];v(A.value,{componentStack:A.stack})}}finally{P.T=o,X.p=g}}(us&3)!==0&&ua(),on(s),g=s.pendingLanes,(l&4194090)!==0&&(g&42)!==0?s===Vc?Do++:(Do=0,Vc=s):Do=0,Lo(0)}}function km(s,o){(s.pooledCacheLanes&=o)===0&&(o=s.pooledCache,o!=null&&(s.pooledCache=null,ho(o)))}function ua(s){return Rm(),Mm(),Nm(),Im()}function Im(){if(mt!==5)return!1;var s=$n,o=Bc;Bc=0;var l=al(us),f=P.T,g=X.p;try{X.p=32>l?32:l,P.T=null,l=Hc,Hc=null;var v=$n,E=us;if(mt=0,cs=$n=null,us=0,(Ue&6)!==0)throw Error(i(331));var A=Ue;if(Ue|=4,pm(v.current),fm(v,v.current,E,l),Ue=A,Lo(0,!1),bt&&typeof bt.onPostCommitFiberRoot=="function")try{bt.onPostCommitFiberRoot(js,v)}catch{}return!0}finally{X.p=g,P.T=f,km(s,o)}}function Dm(s,o,l){o=Vt(l,o),o=vc(s.stateNode,o,2),s=Ln(s,o,2),s!==null&&(Ws(s,2),on(s))}function ze(s,o,l){if(s.tag===3)Dm(s,s,l);else for(;o!==null;){if(o.tag===3){Dm(o,s,l);break}else if(o.tag===1){var f=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(zn===null||!zn.has(f))){s=Vt(l,s),l=Oh(2),f=Ln(o,l,2),f!==null&&(Bh(l,f,o,s),Ws(f,2),on(f));break}}o=o.return}}function $c(s,o,l){var f=s.pingCache;if(f===null){f=s.pingCache=new TT;var g=new Set;f.set(o,g)}else g=f.get(o),g===void 0&&(g=new Set,f.set(o,g));g.has(l)||(Lc=!0,g.add(l),s=AT.bind(null,s,o,l),o.then(s,s))}function AT(s,o,l){var f=s.pingCache;f!==null&&f.delete(o),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,$e===s&&(ke&l)===l&&(Xe===4||Xe===3&&(ke&62914560)===ke&&300>Zt()-Oc?(Ue&2)===0&&ds(s,0):Pc|=l,ls===ke&&(ls=0)),on(s)}function Lm(s,o){o===0&&(o=Md()),s=Ji(s,o),s!==null&&(Ws(s,o),on(s))}function _T(s){var o=s.memoizedState,l=0;o!==null&&(l=o.retryLane),Lm(s,l)}function wT(s,o){var l=0;switch(s.tag){case 13:var f=s.stateNode,g=s.memoizedState;g!==null&&(l=g.retryLane);break;case 19:f=s.stateNode;break;case 22:f=s.stateNode._retryCache;break;default:throw Error(i(314))}f!==null&&f.delete(o),Lm(s,l)}function bT(s,o){return ni(s,o)}var da=null,hs=null,Fc=!1,fa=!1,Yc=!1,Si=0;function on(s){s!==hs&&s.next===null&&(hs===null?da=hs=s:hs=hs.next=s),fa=!0,Fc||(Fc=!0,MT())}function Lo(s,o){if(!Yc&&fa){Yc=!0;do for(var l=!1,f=da;f!==null;){if(s!==0){var g=f.pendingLanes;if(g===0)var v=0;else{var E=f.suspendedLanes,A=f.pingedLanes;v=(1<<31-Rt(42|s)+1)-1,v&=g&~(E&~A),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(l=!0,Bm(f,v))}else v=ke,v=vr(f,f===$e?v:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(v&3)===0||Ks(f,v)||(l=!0,Bm(f,v));f=f.next}while(l);Yc=!1}}function RT(){Pm()}function Pm(){fa=Fc=!1;var s=0;Si!==0&&(OT()&&(s=Si),Si=0);for(var o=Zt(),l=null,f=da;f!==null;){var g=f.next,v=Um(f,o);v===0?(f.next=null,l===null?da=g:l.next=g,g===null&&(hs=l)):(l=f,(s!==0||(v&3)!==0)&&(fa=!0)),f=g}Lo(s)}function Um(s,o){for(var l=s.suspendedLanes,f=s.pingedLanes,g=s.expirationTimes,v=s.pendingLanes&-62914561;0<v;){var E=31-Rt(v),A=1<<E,b=g[E];b===-1?((A&l)===0||(A&f)!==0)&&(g[E]=e0(A,o)):b<=o&&(s.expiredLanes|=A),v&=~A}if(o=$e,l=ke,l=vr(s,s===o?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),f=s.callbackNode,l===0||s===o&&(Oe===2||Oe===9)||s.cancelPendingCommit!==null)return f!==null&&f!==null&&sl(f),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||Ks(s,l)){if(o=l&-l,o===s.callbackPriority)return o;switch(f!==null&&sl(f),al(l)){case 2:case 8:l=wd;break;case 32:l=pr;break;case 268435456:l=bd;break;default:l=pr}return f=Om.bind(null,s),l=ni(l,f),s.callbackPriority=o,s.callbackNode=l,o}return f!==null&&f!==null&&sl(f),s.callbackPriority=2,s.callbackNode=null,2}function Om(s,o){if(mt!==0&&mt!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(ua()&&s.callbackNode!==l)return null;var f=ke;return f=vr(s,s===$e?f:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),f===0?null:(Tm(s,f,o),Um(s,Zt()),s.callbackNode!=null&&s.callbackNode===l?Om.bind(null,s):null)}function Bm(s,o){if(ua())return null;Tm(s,o,!0)}function MT(){HT(function(){(Ue&6)!==0?ni(_d,RT):Pm()})}function Jc(){return Si===0&&(Si=Rd()),Si}function Hm(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Cr(""+s)}function Vm(s,o){var l=o.ownerDocument.createElement("input");return l.name=o.name,l.value=o.value,s.id&&l.setAttribute("form",s.id),o.parentNode.insertBefore(l,o),s=new FormData(s),l.parentNode.removeChild(l),s}function NT(s,o,l,f,g){if(o==="submit"&&l&&l.stateNode===g){var v=Hm((g[xt]||null).action),E=f.submitter;E&&(o=(o=E[xt]||null)?Hm(o.formAction):E.getAttribute("formAction"),o!==null&&(v=o,E=null));var A=new br("action","action",null,f,g);s.push({event:A,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Si!==0){var b=E?Vm(g,E):new FormData(g);hc(l,{pending:!0,data:b,method:g.method,action:v},null,b)}}else typeof v=="function"&&(A.preventDefault(),b=E?Vm(g,E):new FormData(g),hc(l,{pending:!0,data:b,method:g.method,action:v},v,b))},currentTarget:g}]})}}for(var jc=0;jc<Il.length;jc++){var Kc=Il[jc],kT=Kc.toLowerCase(),IT=Kc[0].toUpperCase()+Kc.slice(1);jt(kT,"on"+IT)}jt(Tf,"onAnimationEnd"),jt(Sf,"onAnimationIteration"),jt(xf,"onAnimationStart"),jt("dblclick","onDoubleClick"),jt("focusin","onFocus"),jt("focusout","onBlur"),jt(K0,"onTransitionRun"),jt(W0,"onTransitionStart"),jt(X0,"onTransitionCancel"),jt(Ef,"onTransitionEnd"),Oi("onMouseEnter",["mouseout","mouseover"]),Oi("onMouseLeave",["mouseout","mouseover"]),Oi("onPointerEnter",["pointerout","pointerover"]),Oi("onPointerLeave",["pointerout","pointerover"]),si("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),si("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),si("onBeforeInput",["compositionend","keypress","textInput","paste"]),si("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),si("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),si("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Po="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),DT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Po));function Gm(s,o){o=(o&4)!==0;for(var l=0;l<s.length;l++){var f=s[l],g=f.event;f=f.listeners;e:{var v=void 0;if(o)for(var E=f.length-1;0<=E;E--){var A=f[E],b=A.instance,L=A.currentTarget;if(A=A.listener,b!==v&&g.isPropagationStopped())break e;v=A,g.currentTarget=L;try{v(g)}catch($){Zr($)}g.currentTarget=null,v=b}else for(E=0;E<f.length;E++){if(A=f[E],b=A.instance,L=A.currentTarget,A=A.listener,b!==v&&g.isPropagationStopped())break e;v=A,g.currentTarget=L;try{v(g)}catch($){Zr($)}g.currentTarget=null,v=b}}}}function Re(s,o){var l=o[ll];l===void 0&&(l=o[ll]=new Set);var f=s+"__bubble";l.has(f)||(qm(o,s,2,!1),l.add(f))}function Wc(s,o,l){var f=0;o&&(f|=4),qm(l,s,f,o)}var ha="_reactListening"+Math.random().toString(36).slice(2);function Xc(s){if(!s[ha]){s[ha]=!0,Ld.forEach(function(l){l!=="selectionchange"&&(DT.has(l)||Wc(l,!1,s),Wc(l,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[ha]||(o[ha]=!0,Wc("selectionchange",!1,o))}}function qm(s,o,l,f){switch(fp(o)){case 2:var g=rS;break;case 8:g=aS;break;default:g=du}l=g.bind(null,o,l,s),g=void 0,!Tl||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(g=!0),f?g!==void 0?s.addEventListener(o,l,{capture:!0,passive:g}):s.addEventListener(o,l,!0):g!==void 0?s.addEventListener(o,l,{passive:g}):s.addEventListener(o,l,!1)}function Qc(s,o,l,f,g){var v=f;if((o&1)===0&&(o&2)===0&&f!==null)e:for(;;){if(f===null)return;var E=f.tag;if(E===3||E===4){var A=f.stateNode.containerInfo;if(A===g)break;if(E===4)for(E=f.return;E!==null;){var b=E.tag;if((b===3||b===4)&&E.stateNode.containerInfo===g)return;E=E.return}for(;A!==null;){if(E=Li(A),E===null)return;if(b=E.tag,b===5||b===6||b===26||b===27){f=v=E;continue e}A=A.parentNode}}f=f.return}jd(function(){var L=v,$=yl(l),W=[];e:{var O=Cf.get(s);if(O!==void 0){var V=br,xe=s;switch(s){case"keypress":if(_r(l)===0)break e;case"keydown":case"keyup":V=b0;break;case"focusin":xe="focus",V=Cl;break;case"focusout":xe="blur",V=Cl;break;case"beforeblur":case"afterblur":V=Cl;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":V=Xd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":V=p0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":V=N0;break;case Tf:case Sf:case xf:V=v0;break;case Ef:V=I0;break;case"scroll":case"scrollend":V=h0;break;case"wheel":V=L0;break;case"copy":case"cut":case"paste":V=S0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":V=Zd;break;case"toggle":case"beforetoggle":V=U0}var ve=(o&4)!==0,Ge=!ve&&(s==="scroll"||s==="scrollend"),k=ve?O!==null?O+"Capture":null:O;ve=[];for(var M=L,D;M!==null;){var J=M;if(D=J.stateNode,J=J.tag,J!==5&&J!==26&&J!==27||D===null||k===null||(J=Zs(M,k),J!=null&&ve.push(Uo(M,J,D))),Ge)break;M=M.return}0<ve.length&&(O=new V(O,xe,null,l,$),W.push({event:O,listeners:ve}))}}if((o&7)===0){e:{if(O=s==="mouseover"||s==="pointerover",V=s==="mouseout"||s==="pointerout",O&&l!==gl&&(xe=l.relatedTarget||l.fromElement)&&(Li(xe)||xe[Di]))break e;if((V||O)&&(O=$.window===$?$:(O=$.ownerDocument)?O.defaultView||O.parentWindow:window,V?(xe=l.relatedTarget||l.toElement,V=L,xe=xe?Li(xe):null,xe!==null&&(Ge=a(xe),ve=xe.tag,xe!==Ge||ve!==5&&ve!==27&&ve!==6)&&(xe=null)):(V=null,xe=L),V!==xe)){if(ve=Xd,J="onMouseLeave",k="onMouseEnter",M="mouse",(s==="pointerout"||s==="pointerover")&&(ve=Zd,J="onPointerLeave",k="onPointerEnter",M="pointer"),Ge=V==null?O:Qs(V),D=xe==null?O:Qs(xe),O=new ve(J,M+"leave",V,l,$),O.target=Ge,O.relatedTarget=D,J=null,Li($)===L&&(ve=new ve(k,M+"enter",xe,l,$),ve.target=D,ve.relatedTarget=Ge,J=ve),Ge=J,V&&xe)t:{for(ve=V,k=xe,M=0,D=ve;D;D=ms(D))M++;for(D=0,J=k;J;J=ms(J))D++;for(;0<M-D;)ve=ms(ve),M--;for(;0<D-M;)k=ms(k),D--;for(;M--;){if(ve===k||k!==null&&ve===k.alternate)break t;ve=ms(ve),k=ms(k)}ve=null}else ve=null;V!==null&&zm(W,O,V,ve,!1),xe!==null&&Ge!==null&&zm(W,Ge,xe,ve,!0)}}e:{if(O=L?Qs(L):window,V=O.nodeName&&O.nodeName.toLowerCase(),V==="select"||V==="input"&&O.type==="file")var he=lf;else if(rf(O))if(cf)he=Y0;else{he=$0;var we=z0}else V=O.nodeName,!V||V.toLowerCase()!=="input"||O.type!=="checkbox"&&O.type!=="radio"?L&&pl(L.elementType)&&(he=lf):he=F0;if(he&&(he=he(s,L))){af(W,he,l,$);break e}we&&we(s,O,L),s==="focusout"&&L&&O.type==="number"&&L.memoizedProps.value!=null&&ml(O,"number",O.value)}switch(we=L?Qs(L):window,s){case"focusin":(rf(we)||we.contentEditable==="true")&&($i=we,Ml=L,ao=null);break;case"focusout":ao=Ml=$i=null;break;case"mousedown":Nl=!0;break;case"contextmenu":case"mouseup":case"dragend":Nl=!1,yf(W,l,$);break;case"selectionchange":if(j0)break;case"keydown":case"keyup":yf(W,l,$)}var ge;if(_l)e:{switch(s){case"compositionstart":var Te="onCompositionStart";break e;case"compositionend":Te="onCompositionEnd";break e;case"compositionupdate":Te="onCompositionUpdate";break e}Te=void 0}else zi?sf(s,l)&&(Te="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(Te="onCompositionStart");Te&&(ef&&l.locale!=="ko"&&(zi||Te!=="onCompositionStart"?Te==="onCompositionEnd"&&zi&&(ge=Kd()):(Nn=$,Sl="value"in Nn?Nn.value:Nn.textContent,zi=!0)),we=ma(L,Te),0<we.length&&(Te=new Qd(Te,s,null,l,$),W.push({event:Te,listeners:we}),ge?Te.data=ge:(ge=of(l),ge!==null&&(Te.data=ge)))),(ge=B0?H0(s,l):V0(s,l))&&(Te=ma(L,"onBeforeInput"),0<Te.length&&(we=new Qd("onBeforeInput","beforeinput",null,l,$),W.push({event:we,listeners:Te}),we.data=ge)),NT(W,s,L,l,$)}Gm(W,o)})}function Uo(s,o,l){return{instance:s,listener:o,currentTarget:l}}function ma(s,o){for(var l=o+"Capture",f=[];s!==null;){var g=s,v=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||v===null||(g=Zs(s,l),g!=null&&f.unshift(Uo(s,g,v)),g=Zs(s,o),g!=null&&f.push(Uo(s,g,v))),s.tag===3)return f;s=s.return}return[]}function ms(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function zm(s,o,l,f,g){for(var v=o._reactName,E=[];l!==null&&l!==f;){var A=l,b=A.alternate,L=A.stateNode;if(A=A.tag,b!==null&&b===f)break;A!==5&&A!==26&&A!==27||L===null||(b=L,g?(L=Zs(l,v),L!=null&&E.unshift(Uo(l,L,b))):g||(L=Zs(l,v),L!=null&&E.push(Uo(l,L,b)))),l=l.return}E.length!==0&&s.push({event:o,listeners:E})}var LT=/\r\n?/g,PT=/\u0000|\uFFFD/g;function $m(s){return(typeof s=="string"?s:""+s).replace(LT,`
`).replace(PT,"")}function Fm(s,o){return o=$m(o),$m(s)===o}function pa(){}function Ve(s,o,l,f,g,v){switch(l){case"children":typeof f=="string"?o==="body"||o==="textarea"&&f===""||Vi(s,f):(typeof f=="number"||typeof f=="bigint")&&o!=="body"&&Vi(s,""+f);break;case"className":Sr(s,"class",f);break;case"tabIndex":Sr(s,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":Sr(s,l,f);break;case"style":Yd(s,f,v);break;case"data":if(o!=="object"){Sr(s,"data",f);break}case"src":case"href":if(f===""&&(o!=="a"||l!=="href")){s.removeAttribute(l);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){s.removeAttribute(l);break}f=Cr(""+f),s.setAttribute(l,f);break;case"action":case"formAction":if(typeof f=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(l==="formAction"?(o!=="input"&&Ve(s,o,"name",g.name,g,null),Ve(s,o,"formEncType",g.formEncType,g,null),Ve(s,o,"formMethod",g.formMethod,g,null),Ve(s,o,"formTarget",g.formTarget,g,null)):(Ve(s,o,"encType",g.encType,g,null),Ve(s,o,"method",g.method,g,null),Ve(s,o,"target",g.target,g,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){s.removeAttribute(l);break}f=Cr(""+f),s.setAttribute(l,f);break;case"onClick":f!=null&&(s.onclick=pa);break;case"onScroll":f!=null&&Re("scroll",s);break;case"onScrollEnd":f!=null&&Re("scrollend",s);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(i(61));if(l=f.__html,l!=null){if(g.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"multiple":s.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":s.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){s.removeAttribute("xlink:href");break}l=Cr(""+f),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(l,""+f):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":f===!0?s.setAttribute(l,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(l,f):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?s.setAttribute(l,f):s.removeAttribute(l);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?s.removeAttribute(l):s.setAttribute(l,f);break;case"popover":Re("beforetoggle",s),Re("toggle",s),Tr(s,"popover",f);break;case"xlinkActuate":ln(s,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":ln(s,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":ln(s,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":ln(s,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":ln(s,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":ln(s,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":ln(s,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":ln(s,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":ln(s,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":Tr(s,"is",f);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=d0.get(l)||l,Tr(s,l,f))}}function Zc(s,o,l,f,g,v){switch(l){case"style":Yd(s,f,v);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(i(61));if(l=f.__html,l!=null){if(g.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"children":typeof f=="string"?Vi(s,f):(typeof f=="number"||typeof f=="bigint")&&Vi(s,""+f);break;case"onScroll":f!=null&&Re("scroll",s);break;case"onScrollEnd":f!=null&&Re("scrollend",s);break;case"onClick":f!=null&&(s.onclick=pa);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Pd.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(g=l.endsWith("Capture"),o=l.slice(2,g?l.length-7:void 0),v=s[xt]||null,v=v!=null?v[l]:null,typeof v=="function"&&s.removeEventListener(o,v,g),typeof f=="function")){typeof v!="function"&&v!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(o,f,g);break e}l in s?s[l]=f:f===!0?s.setAttribute(l,""):Tr(s,l,f)}}}function pt(s,o,l){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Re("error",s),Re("load",s);var f=!1,g=!1,v;for(v in l)if(l.hasOwnProperty(v)){var E=l[v];if(E!=null)switch(v){case"src":f=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:Ve(s,o,v,E,l,null)}}g&&Ve(s,o,"srcSet",l.srcSet,l,null),f&&Ve(s,o,"src",l.src,l,null);return;case"input":Re("invalid",s);var A=v=E=g=null,b=null,L=null;for(f in l)if(l.hasOwnProperty(f)){var $=l[f];if($!=null)switch(f){case"name":g=$;break;case"type":E=$;break;case"checked":b=$;break;case"defaultChecked":L=$;break;case"value":v=$;break;case"defaultValue":A=$;break;case"children":case"dangerouslySetInnerHTML":if($!=null)throw Error(i(137,o));break;default:Ve(s,o,f,$,l,null)}}qd(s,v,A,b,L,E,g,!1),xr(s);return;case"select":Re("invalid",s),f=E=v=null;for(g in l)if(l.hasOwnProperty(g)&&(A=l[g],A!=null))switch(g){case"value":v=A;break;case"defaultValue":E=A;break;case"multiple":f=A;default:Ve(s,o,g,A,l,null)}o=v,l=E,s.multiple=!!f,o!=null?Hi(s,!!f,o,!1):l!=null&&Hi(s,!!f,l,!0);return;case"textarea":Re("invalid",s),v=g=f=null;for(E in l)if(l.hasOwnProperty(E)&&(A=l[E],A!=null))switch(E){case"value":f=A;break;case"defaultValue":g=A;break;case"children":v=A;break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(i(91));break;default:Ve(s,o,E,A,l,null)}$d(s,f,g,v),xr(s);return;case"option":for(b in l)if(l.hasOwnProperty(b)&&(f=l[b],f!=null))switch(b){case"selected":s.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:Ve(s,o,b,f,l,null)}return;case"dialog":Re("beforetoggle",s),Re("toggle",s),Re("cancel",s),Re("close",s);break;case"iframe":case"object":Re("load",s);break;case"video":case"audio":for(f=0;f<Po.length;f++)Re(Po[f],s);break;case"image":Re("error",s),Re("load",s);break;case"details":Re("toggle",s);break;case"embed":case"source":case"link":Re("error",s),Re("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(L in l)if(l.hasOwnProperty(L)&&(f=l[L],f!=null))switch(L){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:Ve(s,o,L,f,l,null)}return;default:if(pl(o)){for($ in l)l.hasOwnProperty($)&&(f=l[$],f!==void 0&&Zc(s,o,$,f,l,void 0));return}}for(A in l)l.hasOwnProperty(A)&&(f=l[A],f!=null&&Ve(s,o,A,f,l,null))}function UT(s,o,l,f){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,v=null,E=null,A=null,b=null,L=null,$=null;for(V in l){var W=l[V];if(l.hasOwnProperty(V)&&W!=null)switch(V){case"checked":break;case"value":break;case"defaultValue":b=W;default:f.hasOwnProperty(V)||Ve(s,o,V,null,f,W)}}for(var O in f){var V=f[O];if(W=l[O],f.hasOwnProperty(O)&&(V!=null||W!=null))switch(O){case"type":v=V;break;case"name":g=V;break;case"checked":L=V;break;case"defaultChecked":$=V;break;case"value":E=V;break;case"defaultValue":A=V;break;case"children":case"dangerouslySetInnerHTML":if(V!=null)throw Error(i(137,o));break;default:V!==W&&Ve(s,o,O,V,f,W)}}hl(s,E,A,b,L,$,v,g);return;case"select":V=E=A=O=null;for(v in l)if(b=l[v],l.hasOwnProperty(v)&&b!=null)switch(v){case"value":break;case"multiple":V=b;default:f.hasOwnProperty(v)||Ve(s,o,v,null,f,b)}for(g in f)if(v=f[g],b=l[g],f.hasOwnProperty(g)&&(v!=null||b!=null))switch(g){case"value":O=v;break;case"defaultValue":A=v;break;case"multiple":E=v;default:v!==b&&Ve(s,o,g,v,f,b)}o=A,l=E,f=V,O!=null?Hi(s,!!l,O,!1):!!f!=!!l&&(o!=null?Hi(s,!!l,o,!0):Hi(s,!!l,l?[]:"",!1));return;case"textarea":V=O=null;for(A in l)if(g=l[A],l.hasOwnProperty(A)&&g!=null&&!f.hasOwnProperty(A))switch(A){case"value":break;case"children":break;default:Ve(s,o,A,null,f,g)}for(E in f)if(g=f[E],v=l[E],f.hasOwnProperty(E)&&(g!=null||v!=null))switch(E){case"value":O=g;break;case"defaultValue":V=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(i(91));break;default:g!==v&&Ve(s,o,E,g,f,v)}zd(s,O,V);return;case"option":for(var xe in l)if(O=l[xe],l.hasOwnProperty(xe)&&O!=null&&!f.hasOwnProperty(xe))switch(xe){case"selected":s.selected=!1;break;default:Ve(s,o,xe,null,f,O)}for(b in f)if(O=f[b],V=l[b],f.hasOwnProperty(b)&&O!==V&&(O!=null||V!=null))switch(b){case"selected":s.selected=O&&typeof O!="function"&&typeof O!="symbol";break;default:Ve(s,o,b,O,f,V)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ve in l)O=l[ve],l.hasOwnProperty(ve)&&O!=null&&!f.hasOwnProperty(ve)&&Ve(s,o,ve,null,f,O);for(L in f)if(O=f[L],V=l[L],f.hasOwnProperty(L)&&O!==V&&(O!=null||V!=null))switch(L){case"children":case"dangerouslySetInnerHTML":if(O!=null)throw Error(i(137,o));break;default:Ve(s,o,L,O,f,V)}return;default:if(pl(o)){for(var Ge in l)O=l[Ge],l.hasOwnProperty(Ge)&&O!==void 0&&!f.hasOwnProperty(Ge)&&Zc(s,o,Ge,void 0,f,O);for($ in f)O=f[$],V=l[$],!f.hasOwnProperty($)||O===V||O===void 0&&V===void 0||Zc(s,o,$,O,f,V);return}}for(var k in l)O=l[k],l.hasOwnProperty(k)&&O!=null&&!f.hasOwnProperty(k)&&Ve(s,o,k,null,f,O);for(W in f)O=f[W],V=l[W],!f.hasOwnProperty(W)||O===V||O==null&&V==null||Ve(s,o,W,O,f,V)}var eu=null,tu=null;function ga(s){return s.nodeType===9?s:s.ownerDocument}function Ym(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Jm(s,o){if(s===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&o==="foreignObject"?0:s}function nu(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var iu=null;function OT(){var s=window.event;return s&&s.type==="popstate"?s===iu?!1:(iu=s,!0):(iu=null,!1)}var jm=typeof setTimeout=="function"?setTimeout:void 0,BT=typeof clearTimeout=="function"?clearTimeout:void 0,Km=typeof Promise=="function"?Promise:void 0,HT=typeof queueMicrotask=="function"?queueMicrotask:typeof Km<"u"?function(s){return Km.resolve(null).then(s).catch(VT)}:jm;function VT(s){setTimeout(function(){throw s})}function Yn(s){return s==="head"}function Wm(s,o){var l=o,f=0,g=0;do{var v=l.nextSibling;if(s.removeChild(l),v&&v.nodeType===8)if(l=v.data,l==="/$"){if(0<f&&8>f){l=f;var E=s.ownerDocument;if(l&1&&Oo(E.documentElement),l&2&&Oo(E.body),l&4)for(l=E.head,Oo(l),E=l.firstChild;E;){var A=E.nextSibling,b=E.nodeName;E[Xs]||b==="SCRIPT"||b==="STYLE"||b==="LINK"&&E.rel.toLowerCase()==="stylesheet"||l.removeChild(E),E=A}}if(g===0){s.removeChild(v),Fo(o);return}g--}else l==="$"||l==="$?"||l==="$!"?g++:f=l.charCodeAt(0)-48;else f=0;l=v}while(l);Fo(o)}function su(s){var o=s.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var l=o;switch(o=o.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":su(l),cl(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function GT(s,o,l,f){for(;s.nodeType===1;){var g=l;if(s.nodeName.toLowerCase()!==o.toLowerCase()){if(!f&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(f){if(!s[Xs])switch(o){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(v=s.getAttribute("rel"),v==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(v!==g.rel||s.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||s.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||s.getAttribute("title")!==(g.title==null?null:g.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(v=s.getAttribute("src"),(v!==(g.src==null?null:g.src)||s.getAttribute("type")!==(g.type==null?null:g.type)||s.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&v&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(o==="input"&&s.type==="hidden"){var v=g.name==null?null:""+g.name;if(g.type==="hidden"&&s.getAttribute("name")===v)return s}else return s;if(s=Wt(s.nextSibling),s===null)break}return null}function qT(s,o,l){if(o==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=Wt(s.nextSibling),s===null))return null;return s}function ou(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function zT(s,o){var l=s.ownerDocument;if(s.data!=="$?"||l.readyState==="complete")o();else{var f=function(){o(),l.removeEventListener("DOMContentLoaded",f)};l.addEventListener("DOMContentLoaded",f),s._reactRetry=f}}function Wt(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return s}var ru=null;function Xm(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"){if(o===0)return s;o--}else l==="/$"&&o++}s=s.previousSibling}return null}function Qm(s,o,l){switch(o=ga(l),s){case"html":if(s=o.documentElement,!s)throw Error(i(452));return s;case"head":if(s=o.head,!s)throw Error(i(453));return s;case"body":if(s=o.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function Oo(s){for(var o=s.attributes;o.length;)s.removeAttributeNode(o[0]);cl(s)}var Yt=new Map,Zm=new Set;function ya(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var En=X.d;X.d={f:$T,r:FT,D:YT,C:JT,L:jT,m:KT,X:XT,S:WT,M:QT};function $T(){var s=En.f(),o=la();return s||o}function FT(s){var o=Pi(s);o!==null&&o.tag===5&&o.type==="form"?Th(o):En.r(s)}var ps=typeof document>"u"?null:document;function ep(s,o,l){var f=ps;if(f&&typeof o=="string"&&o){var g=Ht(o);g='link[rel="'+s+'"][href="'+g+'"]',typeof l=="string"&&(g+='[crossorigin="'+l+'"]'),Zm.has(g)||(Zm.add(g),s={rel:s,crossOrigin:l,href:o},f.querySelector(g)===null&&(o=f.createElement("link"),pt(o,"link",s),rt(o),f.head.appendChild(o)))}}function YT(s){En.D(s),ep("dns-prefetch",s,null)}function JT(s,o){En.C(s,o),ep("preconnect",s,o)}function jT(s,o,l){En.L(s,o,l);var f=ps;if(f&&s&&o){var g='link[rel="preload"][as="'+Ht(o)+'"]';o==="image"&&l&&l.imageSrcSet?(g+='[imagesrcset="'+Ht(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(g+='[imagesizes="'+Ht(l.imageSizes)+'"]')):g+='[href="'+Ht(s)+'"]';var v=g;switch(o){case"style":v=gs(s);break;case"script":v=ys(s)}Yt.has(v)||(s=y({rel:"preload",href:o==="image"&&l&&l.imageSrcSet?void 0:s,as:o},l),Yt.set(v,s),f.querySelector(g)!==null||o==="style"&&f.querySelector(Bo(v))||o==="script"&&f.querySelector(Ho(v))||(o=f.createElement("link"),pt(o,"link",s),rt(o),f.head.appendChild(o)))}}function KT(s,o){En.m(s,o);var l=ps;if(l&&s){var f=o&&typeof o.as=="string"?o.as:"script",g='link[rel="modulepreload"][as="'+Ht(f)+'"][href="'+Ht(s)+'"]',v=g;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=ys(s)}if(!Yt.has(v)&&(s=y({rel:"modulepreload",href:s},o),Yt.set(v,s),l.querySelector(g)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(Ho(v)))return}f=l.createElement("link"),pt(f,"link",s),rt(f),l.head.appendChild(f)}}}function WT(s,o,l){En.S(s,o,l);var f=ps;if(f&&s){var g=Ui(f).hoistableStyles,v=gs(s);o=o||"default";var E=g.get(v);if(!E){var A={loading:0,preload:null};if(E=f.querySelector(Bo(v)))A.loading=5;else{s=y({rel:"stylesheet",href:s,"data-precedence":o},l),(l=Yt.get(v))&&au(s,l);var b=E=f.createElement("link");rt(b),pt(b,"link",s),b._p=new Promise(function(L,$){b.onload=L,b.onerror=$}),b.addEventListener("load",function(){A.loading|=1}),b.addEventListener("error",function(){A.loading|=2}),A.loading|=4,va(E,o,f)}E={type:"stylesheet",instance:E,count:1,state:A},g.set(v,E)}}}function XT(s,o){En.X(s,o);var l=ps;if(l&&s){var f=Ui(l).hoistableScripts,g=ys(s),v=f.get(g);v||(v=l.querySelector(Ho(g)),v||(s=y({src:s,async:!0},o),(o=Yt.get(g))&&lu(s,o),v=l.createElement("script"),rt(v),pt(v,"link",s),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},f.set(g,v))}}function QT(s,o){En.M(s,o);var l=ps;if(l&&s){var f=Ui(l).hoistableScripts,g=ys(s),v=f.get(g);v||(v=l.querySelector(Ho(g)),v||(s=y({src:s,async:!0,type:"module"},o),(o=Yt.get(g))&&lu(s,o),v=l.createElement("script"),rt(v),pt(v,"link",s),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},f.set(g,v))}}function tp(s,o,l,f){var g=(g=z.current)?ya(g):null;if(!g)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(o=gs(l.href),l=Ui(g).hoistableStyles,f=l.get(o),f||(f={type:"style",instance:null,count:0,state:null},l.set(o,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=gs(l.href);var v=Ui(g).hoistableStyles,E=v.get(s);if(E||(g=g.ownerDocument||g,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(s,E),(v=g.querySelector(Bo(s)))&&!v._p&&(E.instance=v,E.state.loading=5),Yt.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Yt.set(s,l),v||ZT(g,s,l,E.state))),o&&f===null)throw Error(i(528,""));return E}if(o&&f!==null)throw Error(i(529,""));return null;case"script":return o=l.async,l=l.src,typeof l=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=ys(l),l=Ui(g).hoistableScripts,f=l.get(o),f||(f={type:"script",instance:null,count:0,state:null},l.set(o,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function gs(s){return'href="'+Ht(s)+'"'}function Bo(s){return'link[rel="stylesheet"]['+s+"]"}function np(s){return y({},s,{"data-precedence":s.precedence,precedence:null})}function ZT(s,o,l,f){s.querySelector('link[rel="preload"][as="style"]['+o+"]")?f.loading=1:(o=s.createElement("link"),f.preload=o,o.addEventListener("load",function(){return f.loading|=1}),o.addEventListener("error",function(){return f.loading|=2}),pt(o,"link",l),rt(o),s.head.appendChild(o))}function ys(s){return'[src="'+Ht(s)+'"]'}function Ho(s){return"script[async]"+s}function ip(s,o,l){if(o.count++,o.instance===null)switch(o.type){case"style":var f=s.querySelector('style[data-href~="'+Ht(l.href)+'"]');if(f)return o.instance=f,rt(f),f;var g=y({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return f=(s.ownerDocument||s).createElement("style"),rt(f),pt(f,"style",g),va(f,l.precedence,s),o.instance=f;case"stylesheet":g=gs(l.href);var v=s.querySelector(Bo(g));if(v)return o.state.loading|=4,o.instance=v,rt(v),v;f=np(l),(g=Yt.get(g))&&au(f,g),v=(s.ownerDocument||s).createElement("link"),rt(v);var E=v;return E._p=new Promise(function(A,b){E.onload=A,E.onerror=b}),pt(v,"link",f),o.state.loading|=4,va(v,l.precedence,s),o.instance=v;case"script":return v=ys(l.src),(g=s.querySelector(Ho(v)))?(o.instance=g,rt(g),g):(f=l,(g=Yt.get(v))&&(f=y({},l),lu(f,g)),s=s.ownerDocument||s,g=s.createElement("script"),rt(g),pt(g,"link",f),s.head.appendChild(g),o.instance=g);case"void":return null;default:throw Error(i(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(f=o.instance,o.state.loading|=4,va(f,l.precedence,s));return o.instance}function va(s,o,l){for(var f=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=f.length?f[f.length-1]:null,v=g,E=0;E<f.length;E++){var A=f[E];if(A.dataset.precedence===o)v=A;else if(v!==g)break}v?v.parentNode.insertBefore(s,v.nextSibling):(o=l.nodeType===9?l.head:l,o.insertBefore(s,o.firstChild))}function au(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.title==null&&(s.title=o.title)}function lu(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.integrity==null&&(s.integrity=o.integrity)}var Ta=null;function sp(s,o,l){if(Ta===null){var f=new Map,g=Ta=new Map;g.set(l,f)}else g=Ta,f=g.get(l),f||(f=new Map,g.set(l,f));if(f.has(s))return f;for(f.set(s,null),l=l.getElementsByTagName(s),g=0;g<l.length;g++){var v=l[g];if(!(v[Xs]||v[gt]||s==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var E=v.getAttribute(o)||"";E=s+E;var A=f.get(E);A?A.push(v):f.set(E,[v])}}return f}function op(s,o,l){s=s.ownerDocument||s,s.head.insertBefore(l,o==="title"?s.querySelector("head > title"):null)}function eS(s,o,l){if(l===1||o.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return s=o.disabled,typeof o.precedence=="string"&&s==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function rp(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var Vo=null;function tS(){}function nS(s,o,l){if(Vo===null)throw Error(i(475));var f=Vo;if(o.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var g=gs(l.href),v=s.querySelector(Bo(g));if(v){s=v._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(f.count++,f=Sa.bind(f),s.then(f,f)),o.state.loading|=4,o.instance=v,rt(v);return}v=s.ownerDocument||s,l=np(l),(g=Yt.get(g))&&au(l,g),v=v.createElement("link"),rt(v);var E=v;E._p=new Promise(function(A,b){E.onload=A,E.onerror=b}),pt(v,"link",l),o.instance=v}f.stylesheets===null&&(f.stylesheets=new Map),f.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(f.count++,o=Sa.bind(f),s.addEventListener("load",o),s.addEventListener("error",o))}}function iS(){if(Vo===null)throw Error(i(475));var s=Vo;return s.stylesheets&&s.count===0&&cu(s,s.stylesheets),0<s.count?function(o){var l=setTimeout(function(){if(s.stylesheets&&cu(s,s.stylesheets),s.unsuspend){var f=s.unsuspend;s.unsuspend=null,f()}},6e4);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(l)}}:null}function Sa(){if(this.count--,this.count===0){if(this.stylesheets)cu(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var xa=null;function cu(s,o){s.stylesheets=null,s.unsuspend!==null&&(s.count++,xa=new Map,o.forEach(sS,s),xa=null,Sa.call(s))}function sS(s,o){if(!(o.state.loading&4)){var l=xa.get(s);if(l)var f=l.get(null);else{l=new Map,xa.set(s,l);for(var g=s.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<g.length;v++){var E=g[v];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(l.set(E.dataset.precedence,E),f=E)}f&&l.set(null,f)}g=o.instance,E=g.getAttribute("data-precedence"),v=l.get(E)||f,v===f&&l.set(null,g),l.set(E,g),this.count++,f=Sa.bind(this),g.addEventListener("load",f),g.addEventListener("error",f),v?v.parentNode.insertBefore(g,v.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(g,s.firstChild)),o.state.loading|=4}}var Go={$$typeof:I,Provider:null,Consumer:null,_currentValue:ae,_currentValue2:ae,_threadCount:0};function oS(s,o,l,f,g,v,E,A){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ol(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ol(0),this.hiddenUpdates=ol(null),this.identifierPrefix=f,this.onUncaughtError=g,this.onCaughtError=v,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=A,this.incompleteTransitions=new Map}function ap(s,o,l,f,g,v,E,A,b,L,$,W){return s=new oS(s,o,l,E,A,b,L,W),o=1,v===!0&&(o|=24),v=Nt(3,null,null,o),s.current=v,v.stateNode=s,o=$l(),o.refCount++,s.pooledCache=o,o.refCount++,v.memoizedState={element:f,isDehydrated:l,cache:o},jl(v),s}function lp(s){return s?(s=ji,s):ji}function cp(s,o,l,f,g,v){g=lp(g),f.context===null?f.context=g:f.pendingContext=g,f=Dn(o),f.payload={element:l},v=v===void 0?null:v,v!==null&&(f.callback=v),l=Ln(s,f,o),l!==null&&(Pt(l,s,o),yo(l,s,o))}function up(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<o?l:o}}function uu(s,o){up(s,o),(s=s.alternate)&&up(s,o)}function dp(s){if(s.tag===13){var o=Ji(s,67108864);o!==null&&Pt(o,s,67108864),uu(s,67108864)}}var Ea=!0;function rS(s,o,l,f){var g=P.T;P.T=null;var v=X.p;try{X.p=2,du(s,o,l,f)}finally{X.p=v,P.T=g}}function aS(s,o,l,f){var g=P.T;P.T=null;var v=X.p;try{X.p=8,du(s,o,l,f)}finally{X.p=v,P.T=g}}function du(s,o,l,f){if(Ea){var g=fu(f);if(g===null)Qc(s,o,f,Ca,l),hp(s,f);else if(cS(g,s,o,l,f))f.stopPropagation();else if(hp(s,f),o&4&&-1<lS.indexOf(s)){for(;g!==null;){var v=Pi(g);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var E=ii(v.pendingLanes);if(E!==0){var A=v;for(A.pendingLanes|=2,A.entangledLanes|=2;E;){var b=1<<31-Rt(E);A.entanglements[1]|=b,E&=~b}on(v),(Ue&6)===0&&(ra=Zt()+500,Lo(0))}}break;case 13:A=Ji(v,2),A!==null&&Pt(A,v,2),la(),uu(v,2)}if(v=fu(f),v===null&&Qc(s,o,f,Ca,l),v===g)break;g=v}g!==null&&f.stopPropagation()}else Qc(s,o,f,null,l)}}function fu(s){return s=yl(s),hu(s)}var Ca=null;function hu(s){if(Ca=null,s=Li(s),s!==null){var o=a(s);if(o===null)s=null;else{var l=o.tag;if(l===13){if(s=c(o),s!==null)return s;s=null}else if(l===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null)}}return Ca=s,null}function fp(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Jv()){case _d:return 2;case wd:return 8;case pr:case jv:return 32;case bd:return 268435456;default:return 32}default:return 32}}var mu=!1,Jn=null,jn=null,Kn=null,qo=new Map,zo=new Map,Wn=[],lS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function hp(s,o){switch(s){case"focusin":case"focusout":Jn=null;break;case"dragenter":case"dragleave":jn=null;break;case"mouseover":case"mouseout":Kn=null;break;case"pointerover":case"pointerout":qo.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":zo.delete(o.pointerId)}}function $o(s,o,l,f,g,v){return s===null||s.nativeEvent!==v?(s={blockedOn:o,domEventName:l,eventSystemFlags:f,nativeEvent:v,targetContainers:[g]},o!==null&&(o=Pi(o),o!==null&&dp(o)),s):(s.eventSystemFlags|=f,o=s.targetContainers,g!==null&&o.indexOf(g)===-1&&o.push(g),s)}function cS(s,o,l,f,g){switch(o){case"focusin":return Jn=$o(Jn,s,o,l,f,g),!0;case"dragenter":return jn=$o(jn,s,o,l,f,g),!0;case"mouseover":return Kn=$o(Kn,s,o,l,f,g),!0;case"pointerover":var v=g.pointerId;return qo.set(v,$o(qo.get(v)||null,s,o,l,f,g)),!0;case"gotpointercapture":return v=g.pointerId,zo.set(v,$o(zo.get(v)||null,s,o,l,f,g)),!0}return!1}function mp(s){var o=Li(s.target);if(o!==null){var l=a(o);if(l!==null){if(o=l.tag,o===13){if(o=c(l),o!==null){s.blockedOn=o,n0(s.priority,function(){if(l.tag===13){var f=Lt();f=rl(f);var g=Ji(l,f);g!==null&&Pt(g,l,f),uu(l,f)}});return}}else if(o===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Aa(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var l=fu(s.nativeEvent);if(l===null){l=s.nativeEvent;var f=new l.constructor(l.type,l);gl=f,l.target.dispatchEvent(f),gl=null}else return o=Pi(l),o!==null&&dp(o),s.blockedOn=l,!1;o.shift()}return!0}function pp(s,o,l){Aa(s)&&l.delete(o)}function uS(){mu=!1,Jn!==null&&Aa(Jn)&&(Jn=null),jn!==null&&Aa(jn)&&(jn=null),Kn!==null&&Aa(Kn)&&(Kn=null),qo.forEach(pp),zo.forEach(pp)}function _a(s,o){s.blockedOn===o&&(s.blockedOn=null,mu||(mu=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,uS)))}var wa=null;function gp(s){wa!==s&&(wa=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){wa===s&&(wa=null);for(var o=0;o<s.length;o+=3){var l=s[o],f=s[o+1],g=s[o+2];if(typeof f!="function"){if(hu(f||l)===null)continue;break}var v=Pi(l);v!==null&&(s.splice(o,3),o-=3,hc(v,{pending:!0,data:g,method:l.method,action:f},f,g))}}))}function Fo(s){function o(b){return _a(b,s)}Jn!==null&&_a(Jn,s),jn!==null&&_a(jn,s),Kn!==null&&_a(Kn,s),qo.forEach(o),zo.forEach(o);for(var l=0;l<Wn.length;l++){var f=Wn[l];f.blockedOn===s&&(f.blockedOn=null)}for(;0<Wn.length&&(l=Wn[0],l.blockedOn===null);)mp(l),l.blockedOn===null&&Wn.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(f=0;f<l.length;f+=3){var g=l[f],v=l[f+1],E=g[xt]||null;if(typeof v=="function")E||gp(l);else if(E){var A=null;if(v&&v.hasAttribute("formAction")){if(g=v,E=v[xt]||null)A=E.formAction;else if(hu(g)!==null)continue}else A=E.action;typeof A=="function"?l[f+1]=A:(l.splice(f,3),f-=3),gp(l)}}}function pu(s){this._internalRoot=s}ba.prototype.render=pu.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(i(409));var l=o.current,f=Lt();cp(l,f,s,o,null,null)},ba.prototype.unmount=pu.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;cp(s.current,2,null,s,null,null),la(),o[Di]=null}};function ba(s){this._internalRoot=s}ba.prototype.unstable_scheduleHydration=function(s){if(s){var o=Id();s={blockedOn:null,target:s,priority:o};for(var l=0;l<Wn.length&&o!==0&&o<Wn[l].priority;l++);Wn.splice(l,0,s),l===0&&mp(s)}};var yp=e.version;if(yp!=="19.1.1")throw Error(i(527,yp,"19.1.1"));X.findDOMNode=function(s){var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=m(o),s=s!==null?p(s):null,s=s===null?null:s.stateNode,s};var dS={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:P,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ra=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ra.isDisabled&&Ra.supportsFiber)try{js=Ra.inject(dS),bt=Ra}catch{}}return jo.createRoot=function(s,o){if(!r(s))throw Error(i(299));var l=!1,f="",g=Dh,v=Lh,E=Ph,A=null;return o!=null&&(o.unstable_strictMode===!0&&(l=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(g=o.onUncaughtError),o.onCaughtError!==void 0&&(v=o.onCaughtError),o.onRecoverableError!==void 0&&(E=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(A=o.unstable_transitionCallbacks)),o=ap(s,1,!1,null,null,l,f,g,v,E,A,null),s[Di]=o.current,Xc(s),new pu(o)},jo.hydrateRoot=function(s,o,l){if(!r(s))throw Error(i(299));var f=!1,g="",v=Dh,E=Lh,A=Ph,b=null,L=null;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(v=l.onUncaughtError),l.onCaughtError!==void 0&&(E=l.onCaughtError),l.onRecoverableError!==void 0&&(A=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(b=l.unstable_transitionCallbacks),l.formState!==void 0&&(L=l.formState)),o=ap(s,1,!0,o,l??null,f,g,v,E,A,b,L),o.context=lp(null),l=o.current,f=Lt(),f=rl(f),g=Dn(f),g.callback=null,Ln(l,g,f),l=f,o.current.lanes=l,Ws(o,l),on(o),s[Di]=o.current,Xc(s),new ba(o)},jo.version="19.1.1",jo}var Mp;function _S(){if(Mp)return vu.exports;Mp=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),vu.exports=AS(),vu.exports}var wS=_S();const bS=od(wS),RS=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),MS=n=>S.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:[S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.24-.438.613-.438.995s.145.755.438.995l1.003.827c.48.398.668 1.03.26 1.431l-1.296 2.247a1.125 1.125 0 0 1-1.37.49l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.063-.374-.313-.686-.645-.87a6.52 6.52 0 0 1-.22-.127c-.324-.196-.72-.257-1.075-.124l-1.217.456a1.125 1.125 0 0 1-1.37-.49l-1.296-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.437-.995s-.145-.755-.437-.995l-1.004-.827a1.125 1.125 0 0 1-.26-1.431l1.296-2.247a1.125 1.125 0 0 1 1.37-.49l1.217.456c.355.133.75.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"}),S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"})]}),NS=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"})}),kS=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"})}),IS=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z"})}),DS=({user:n,theme:e,onToggleTheme:t,onOpenSettings:i,onLogout:r})=>{var y,T,x;const[a,c]=le.useState(!1),h=le.useRef(null),m=((y=n.user_metadata)==null?void 0:y.name)||((T=n.user_metadata)==null?void 0:T.full_name)||n.email,p=(x=n.user_metadata)==null?void 0:x.avatar_url;return le.useEffect(()=>{const C=_=>{h.current&&!h.current.contains(_.target)&&c(!1)};return document.addEventListener("mousedown",C),()=>document.removeEventListener("mousedown",C)},[]),S.jsxs("div",{className:"relative",ref:h,children:[S.jsxs("button",{onClick:()=>c(C=>!C),className:"flex items-center w-full gap-3 text-left p-2 rounded-md text-text-secondary hover:bg-input-bg hover:text-text-primary transition-colors","aria-haspopup":"true","aria-expanded":a,children:[p?S.jsx("img",{src:p,alt:m,className:"h-8 w-8 rounded-full bg-border-color"}):S.jsx("span",{className:"h-8 w-8 rounded-full bg-border-color flex items-center justify-center text-text-primary font-bold text-sm",children:(m==null?void 0:m.charAt(0).toUpperCase())||"?"}),S.jsxs("div",{className:"flex-1 overflow-hidden",children:[S.jsx("span",{className:"text-sm font-medium text-text-primary truncate block",children:m}),S.jsx("span",{className:"text-xs text-text-secondary truncate block",children:n.email})]})]}),a&&S.jsx("div",{className:"absolute bottom-full left-0 w-full mb-2 bg-sidebar-bg border border-border-color rounded-lg shadow-xl z-10",children:S.jsxs("div",{className:"p-1",children:[S.jsxs("button",{onClick:()=>{t(),c(!1)},className:"flex items-center gap-3 w-full text-left p-2 text-sm rounded-md text-text-secondary hover:bg-input-bg hover:text-text-primary transition-colors",children:[e==="dark"?S.jsx(kS,{className:"w-4 h-4"}):S.jsx(IS,{className:"w-4 h-4"}),S.jsxs("span",{children:["Switch to ",e==="dark"?"Light":"Dark"," Mode"]})]}),S.jsxs("button",{onClick:()=>{i(),c(!1)},className:"flex items-center gap-3 w-full text-left p-2 text-sm rounded-md text-text-secondary hover:bg-input-bg hover:text-text-primary transition-colors",children:[S.jsx(MS,{className:"w-4 h-4"}),S.jsx("span",{children:"Settings"})]}),S.jsx("div",{className:"my-1 h-px bg-border-color"}),S.jsxs("button",{onClick:()=>{r(),c(!1)},className:"flex items-center gap-3 w-full text-left p-2 text-sm rounded-md text-accent-red hover:bg-red-500/10 transition-colors",children:[S.jsx(NS,{className:"w-4 h-4"}),S.jsx("span",{children:"Logout"})]})]})})]})},LS=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})}),PS=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"})}),US=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.134-2.036-2.134H8.718c-1.126 0-2.037.955-2.037 2.134v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})}),OS=({session:n,isActive:e,onSelect:t,onDelete:i,onRename:r})=>{const[a,c]=le.useState(!1),[h,m]=le.useState(n.title),p=le.useRef(null);le.useEffect(()=>{var x,C;a&&((x=p.current)==null||x.focus(),(C=p.current)==null||C.select())},[a]);const y=()=>{c(!1),h.trim()&&h.trim()!==n.title?r(n.id,h.trim()):m(n.title)},T=x=>{x.stopPropagation(),window.confirm(`Are you sure you want to delete "${n.title}"?`)&&i(n.id)};return S.jsxs("div",{onClick:()=>t(n.id),className:`group relative flex items-center w-full text-left rounded-md cursor-pointer transition-colors ${e?"bg-accent-blue text-white":"text-text-secondary hover:bg-input-bg hover:text-text-primary"}`,children:[a?S.jsx("input",{ref:p,type:"text",value:h,onClick:x=>x.stopPropagation(),onChange:x=>m(x.target.value),onBlur:y,onKeyDown:x=>{x.key==="Enter"&&y(),x.key==="Escape"&&(c(!1),m(n.title))},className:"flex-1 bg-transparent px-4 py-2 text-sm focus:outline-none"}):S.jsx("span",{className:"flex-1 px-4 py-2 text-sm truncate",children:n.title}),!a&&S.jsxs("div",{className:"absolute right-1 top-1/2 -translate-y-1/2 flex items-center opacity-0 group-hover:opacity-100 transition-opacity duration-200 bg-inherit rounded-md",children:[S.jsx("button",{onClick:x=>{x.stopPropagation(),c(!0)},className:`p-1 ${e?"hover:bg-blue-400":"hover:bg-border-color"} rounded`,"aria-label":"Rename session",children:S.jsx(PS,{className:"h-4 w-4"})}),S.jsx("button",{onClick:T,className:`p-1 ${e?"hover:bg-blue-400":"hover:bg-border-color"} rounded`,"aria-label":"Delete session",children:S.jsx(US,{className:"h-4 w-4"})})]})]})},BS=({isOpen:n,sessions:e,activeSessionId:t,user:i,theme:r,onNewSession:a,onSelectSession:c,onDeleteSession:h,onRenameSession:m,onToggleTheme:p,onOpenSettings:y,onLogout:T})=>{const[x,C]=le.useState(""),[_,w]=le.useState("");le.useEffect(()=>{const H=setTimeout(()=>w(x.trim().toLowerCase()),200);return()=>clearTimeout(H)},[x]);const N=le.useMemo(()=>_?e.filter(H=>{if(H.title.toLowerCase().includes(_))return!0;for(const K of H.messages)if(typeof K.content=="string"){if(K.content.toLowerCase().includes(_))return!0}else if(K.content&&typeof K.content=="object"){const I=K.content;if([I.summary,I.thinkingProcess,I.verificationSummary,I.signal,I.confidence,I.riskRewardRatio,I.timeframe].some(Y=>typeof Y=="string"&&Y.toLowerCase().includes(_)))return!0}return!1}):e,[_,e]);return S.jsxs("aside",{className:`bg-sidebar-bg flex flex-col transition-all duration-300 ease-in-out border-r border-border-color ${n?"w-64":"w-0"} overflow-hidden`,children:[S.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border-color h-14",children:[S.jsx("h2",{className:"text-xl font-bold whitespace-nowrap text-text-primary",children:"History"}),S.jsx("button",{onClick:a,className:"p-2 rounded-md hover:bg-input-bg focus:outline-none focus:ring-2 focus:ring-accent-blue","aria-label":"Create new analysis",children:S.jsx(RS,{className:"h-6 w-6 text-text-secondary"})})]}),S.jsx("div",{className:"p-2 border-b border-border-color",children:S.jsxs("div",{className:"relative",children:[S.jsx("input",{type:"text",placeholder:"Search...",value:x,onChange:H=>C(H.target.value),className:"w-full bg-input-bg border border-transparent rounded-md pl-9 pr-3 py-1.5 text-sm text-text-primary placeholder-text-secondary focus:outline-none focus:ring-2 focus:ring-accent-blue focus:border-transparent"}),S.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:S.jsx(LS,{className:"h-4 w-4 text-text-secondary"})})]})}),S.jsx("nav",{className:"flex-1 overflow-y-auto p-2 space-y-1",children:N.map(H=>S.jsx(OS,{session:H,isActive:H.id===t,onSelect:c,onDelete:h,onRename:m},H.id))}),S.jsx("div",{className:"p-2 border-t border-border-color",children:S.jsx(DS,{user:i,theme:r,onToggleTheme:p,onOpenSettings:y,onLogout:T})})]})},Nu=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3.375 3.375 0 1112.81 7.341L5.17 15.011a1.125 1.125 0 001.591 1.59L15.182 8.25"})}),HS=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"})}),VS=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:S.jsx("path",{d:"M6 6h12v12H6z"})}),GS=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 1 1-3 0m3 0a1.5 1.5 0 1 0-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-9.75 0h9.75"})});async function Ny(n,e=1024,t=768){const i=await zS(n),r=document.createElement("canvas");r.width=e,r.height=t;const a=r.getContext("2d");if(!a)throw new Error("Canvas not supported");a.fillStyle="#ffffff",a.fillRect(0,0,e,t);const c=Math.min(e/i.naturalWidth,t/i.naturalHeight),h=Math.round(i.naturalWidth*c),m=Math.round(i.naturalHeight*c),p=Math.floor((e-h)/2),y=Math.floor((t-m)/2);a.imageSmoothingEnabled=!0,a.imageSmoothingQuality="high",a.drawImage(i,p,y,h,m);const x=await(await new Promise(C=>r.toBlob(_=>C(_),"image/png"))).arrayBuffer();return new Uint8Array(x)}async function ky(n){const e=await crypto.subtle.digest("SHA-256",n);return qS(new Uint8Array(e))}function qS(n){return Array.from(n).map(e=>e.toString(16).padStart(2,"0")).join("")}async function zS(n){return new Promise((e,t)=>{const i=new Image;i.onload=()=>e(i),i.onerror=r=>t(r),typeof n=="string"?i.src=n.startsWith("data:")?n:URL.createObjectURL(new Blob([n])):i.src=URL.createObjectURL(n)})}function vs(n){return["v1",n.modelVersion,n.promptVersion,n.ultra?"ultra":"normal",...n.imageHashes.sort()].join("|")}const $S=({className:n="h-6 w-6"})=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})}),FS=[{value:"1M",label:"1 Minute"},{value:"5M",label:"5 Minutes"},{value:"15M",label:"15 Minutes"},{value:"30M",label:"30 Minutes"},{value:"1H",label:"1 Hour"},{value:"4H",label:"4 Hours"},{value:"12H",label:"12 Hours"},{value:"1D",label:"1 Day"},{value:"3D",label:"3 Days"},{value:"1W",label:"1 Week"},{value:"1M_MONTHLY",label:"1 Month"}],YS=async n=>{const e=await Ny(n),t=await ky(e),i=new Blob([e],{type:"image/png"});return{mimeType:"image/png",data:await new Promise((a,c)=>{const h=new FileReader;h.onloadend=()=>{const m=h.result,p=m.indexOf(",");a(p>=0?m.slice(p+1):m)},h.onerror=m=>c(m),h.readAsDataURL(i)}),hash:t}},JS=({onTimeframeImagesChange:n,disabled:e=!1})=>{const[t,i]=le.useState([]),[r,a]=le.useState(!1),c=le.useRef(null),h=async x=>{if(!(!x||x.length===0)){a(!0);try{const C=[];for(let w=0;w<x.length;w++){const N=x[w];if(N.type.startsWith("image/")){const H=await YS(N),K=w===0?"1H":w===1?"4H":"1D";C.push({imageData:H,timeframe:K,label:N.name.replace(/\.[^/.]+$/,"")})}}const _=[...t,...C];i(_),n(_)}catch(C){console.error("Error processing images:",C)}finally{a(!1)}}},m=(x,C)=>{const _=[...t];_[x]={..._[x],timeframe:C},i(_),n(_)},p=(x,C)=>{const _=[...t];_[x]={..._[x],label:C},i(_),n(_)},y=x=>{const C=t.filter((_,w)=>w!==x);i(C),n(C)},T=x=>`data:${x.mimeType};base64,${x.data}`;return S.jsxs("div",{className:"space-y-4",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsx("h3",{className:"font-medium text-text-primary",children:"Multi-Timeframe Analysis"}),S.jsxs("button",{type:"button",onClick:()=>{var x;return(x=c.current)==null?void 0:x.click()},disabled:e||r,className:"inline-flex items-center px-3 py-1.5 text-sm font-medium text-accent-blue hover:text-blue-700 disabled:opacity-50",children:[S.jsx(Nu,{className:"h-4 w-4 mr-1"}),"Add Charts"]})]}),S.jsx("input",{ref:c,type:"file",multiple:!0,accept:"image/png, image/jpeg, image/webp",onChange:x=>h(x.target.files),className:"hidden"}),r&&S.jsxs("div",{className:"flex items-center justify-center py-4",children:[S.jsx("div",{className:"h-5 w-5 border-2 border-t-transparent border-accent-blue rounded-full animate-spin"}),S.jsx("span",{className:"ml-2 text-sm text-text-secondary",children:"Processing images..."})]}),t.length>0&&S.jsx("div",{className:"space-y-3",children:t.map((x,C)=>S.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-input-bg-50 rounded-lg border border-border-color",children:[S.jsx("div",{className:"flex-shrink-0",children:S.jsx("img",{src:T(x.imageData),alt:`Chart ${C+1}`,className:"h-16 w-16 object-cover rounded border border-border-color"})}),S.jsxs("div",{className:"flex-1 space-y-2",children:[S.jsxs("div",{children:[S.jsx("label",{className:"block text-xs font-medium text-text-secondary mb-1",children:"Chart Label"}),S.jsx("input",{type:"text",value:x.label||"",onChange:_=>p(C,_.target.value),placeholder:"e.g., Bitcoin 4H Chart",className:"w-full px-2 py-1 text-sm bg-input-bg border border-border-color rounded focus:outline-none focus:ring-1 focus:ring-accent-blue",disabled:e})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-xs font-medium text-text-secondary mb-1",children:"Timeframe"}),S.jsx("select",{value:x.timeframe,onChange:_=>m(C,_.target.value),className:"w-full px-2 py-1 text-sm bg-input-bg border border-border-color rounded focus:outline-none focus:ring-1 focus:ring-accent-blue",disabled:e,children:FS.map(_=>S.jsx("option",{value:_.value,children:_.label},_.value))})]})]}),S.jsx("button",{type:"button",onClick:()=>y(C),disabled:e,className:"flex-shrink-0 p-1 text-text-secondary hover:text-accent-red transition-colors disabled:opacity-50","aria-label":"Remove chart",children:S.jsx($S,{className:"h-4 w-4"})})]},C))}),t.length===0&&!r&&S.jsxs("div",{className:"text-center py-8 bg-input-bg-50 rounded-lg border-2 border-dashed border-border-color",children:[S.jsx(Nu,{className:"h-8 w-8 mx-auto text-text-secondary mb-2"}),S.jsx("p",{className:"text-sm text-text-secondary",children:"Upload multiple chart images for multi-timeframe analysis"}),S.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Add charts from different timeframes (1H, 4H, 1D, etc.) for better confluence"})]}),t.length>0&&S.jsx("div",{className:"text-xs text-text-secondary",children:S.jsxs("p",{children:[S.jsx("strong",{children:"Tip:"})," Include different timeframes (e.g., 1H, 4H, 1D) for better analysis confluence. Higher timeframes provide trend context while lower timeframes refine entry timing."]})})]})},lr=class lr{static detectMultiTimeframeAnalysis(e,t=""){const i={isMultiTimeframe:!1,isCorrelationAnalysis:!1,isDifferentAssets:!1,detectedTimeframes:[],confidence:0,reasoning:""};if(e.length<=1)return i.reasoning="Single image detected - not multi-timeframe analysis",i;const r=t.toLowerCase();let a=0;const c=[];this.CORRELATION_KEYWORDS.some(y=>r.includes(y))&&(i.isCorrelationAnalysis=!0,a+=30,c.push("Correlation analysis keywords detected in prompt"));const m=this.ASSET_KEYWORDS.filter(y=>r.includes(y));m.length>1&&(i.isDifferentAssets=!0,a+=25,c.push(`Multiple assets detected: ${m.join(", ")}`));const p=[];for(const[y,T]of Object.entries(this.TIMEFRAME_KEYWORDS))T.some(x=>r.includes(x))&&p.push(y);return p.length>1&&(a+=35,c.push(`Multiple timeframes mentioned: ${p.join(", ")}`)),e.length>=2&&(a+=20,c.push(`${e.length} images uploaded - likely different timeframes`)),e.length>=3&&(a+=10,c.push("Three or more images suggest comprehensive multi-timeframe analysis")),i.isMultiTimeframe=a>=50,i.confidence=Math.min(a,100),i.detectedTimeframes=p,i.reasoning=c.join("; "),i}static generateDefaultTimeframes(e){const t=["1H","4H","1D"];return e.map((i,r)=>({imageData:i,timeframe:t[r]||"1D",label:`Chart ${r+1}`}))}static shouldUseMultiTimeframeAnalysis(e,t=""){const i=this.detectMultiTimeframeAnalysis(e,t);return e.length>1&&!i.isCorrelationAnalysis&&!i.isDifferentAssets&&i.confidence>=50}};lr.TIMEFRAME_KEYWORDS={"1M":["1m","1 minute","1min","minute"],"5M":["5m","5 minute","5min","5 minutes"],"15M":["15m","15 minute","15min","15 minutes"],"30M":["30m","30 minute","30min","30 minutes"],"1H":["1h","1 hour","1hr","hour","1 hour"],"4H":["4h","4 hour","4hr","4 hours"],"12H":["12h","12 hour","12hr","12 hours"],"1D":["1d","1 day","daily","day"],"3D":["3d","3 day","3 days"],"1W":["1w","1 week","weekly","week"],"1M_MONTHLY":["1m","1 month","monthly","month"]},lr.CORRELATION_KEYWORDS=["correlation","correlate","relationship","compare","versus","vs","against","correlation analysis","correlation study","correlation between","correlation of","how do","how does","relationship between","compare","comparison"],lr.ASSET_KEYWORDS=["bitcoin","btc","ethereum","eth","binance","bnb","cardano","ada","solana","sol","polkadot","dot","chainlink","link","litecoin","ltc","ripple","xrp","dogecoin","doge","shiba","shib","avalanche","avax","polygon","matic","cosmos","atom","uniswap","uni","aave","aave","compound","comp","sushi","sushi","yearn","yfi","curve","crv"];let Va=lr;const Ts=async n=>{const e=await Ny(n),t=await ky(e),i=new Blob([e],{type:"image/png"});return{mimeType:"image/png",data:await new Promise((a,c)=>{const h=new FileReader;h.onloadend=()=>{const m=h.result,p=m.indexOf(",");a(p>=0?m.slice(p+1):m)},h.onerror=m=>c(m),h.readAsDataURL(i)}),hash:t}},jS=({onSendMessage:n,onSendMultiTimeframeMessage:e,onSendSMCMessage:t,onSendAdvancedPatternMessage:i,onSendProgressiveMessage:r,isLoading:a,onStopGeneration:c,initialPrompt:h,isUltraMode:m,onToggleUltraMode:p})=>{const[y,T]=le.useState(""),[x,C]=le.useState([]),[_,w]=le.useState([]),[N,H]=le.useState(!1),[K,I]=le.useState(!1),[Q,Y]=le.useState(!1),[oe,ce]=le.useState(!1),[Ae,pe]=le.useState(!1),[se,F]=le.useState([]),[ie,de]=le.useState(!1),ue=le.useRef(null),fe=le.useRef(null),P=le.useRef(null);le.useEffect(()=>{var U;h&&(T(h),(U=fe.current)==null||U.focus())},[h]),le.useEffect(()=>{const U=G=>{P.current&&!P.current.contains(G.target)&&H(!1)};return document.addEventListener("mousedown",U),()=>document.removeEventListener("mousedown",U)},[]);const X=async U=>{const G=[],z=new Set(x.map(ee=>ee.name+ee.size)),Z=Array.from(U);for(const ee of Z){if(!ee.type.startsWith("image/"))continue;const Se=ee.name+ee.size;z.has(Se)||G.push(ee)}if(G.length===0)return;G.forEach(ee=>{const Se=new FileReader;Se.onloadend=()=>{w(re=>[...re,Se.result])},Se.readAsDataURL(ee)});const j=[...x,...G];if(C(j),j.length>1&&!K){const ee=[];for(const re of j){const Ne=await Ts(re);ee.push(Ne)}if(Va.shouldUseMultiTimeframeAnalysis(ee,y)){de(!0);const re=Va.generateDefaultTimeframes(ee);F(re)}}},ae=U=>{U.target.files&&X(U.target.files)},ye=U=>{U.preventDefault(),U.dataTransfer.files&&U.dataTransfer.files.length>0&&(X(U.dataTransfer.files),U.dataTransfer.clearData())},R=U=>{const G=U.clipboardData.items,z=[];for(let Z=0;Z<G.length;Z++){const j=G[Z];if(j.kind==="file"){const ee=j.getAsFile();ee&&ee.type.startsWith("image/")&&z.push(ee)}}z.length>0&&X(z)},q=async()=>{if(Ae){if(!y.trim()&&x.length===0&&se.length===0||a)return;if(r){let U="STANDARD",G=[];K||ie?(U="MULTI_TIMEFRAME",se.length>0&&(G=se.map(z=>z.imageData))):(Q||m?U="SMC":oe&&(U="ADVANCED_PATTERN"),x.length>0&&(G=await Promise.all(x.map(Ts)))),r(y,G,U),T(""),C([]),w([]),F([]),ue.current&&(ue.current.value="")}}else if(K||ie){if(!y.trim()&&se.length===0||a)return;e&&(e(y.trim(),se),T(""),F([]),de(!1))}else if(Q){if(!y.trim()&&x.length===0||a)return;let U=[];x.length>0&&(U=await Promise.all(x.map(Ts))),t&&(t(y,U),T(""),C([]),w([]),ue.current&&(ue.current.value=""))}else if(oe){if(!y.trim()&&x.length===0||a)return;let U=[];x.length>0&&(U=await Promise.all(x.map(Ts))),i&&(i(y,U),T(""),C([]),w([]),ue.current&&(ue.current.value=""))}else if(m&&x.length>0){if(!y.trim()&&x.length===0||a)return;let U=[];x.length>0&&(U=await Promise.all(x.map(Ts))),t&&(t(y,U),T(""),C([]),w([]),ue.current&&(ue.current.value=""))}else{if(!y.trim()&&x.length===0||a)return;let U=[];x.length>0&&(U=await Promise.all(x.map(Ts))),n(y,U),T(""),C([]),w([]),ue.current&&(ue.current.value="")}},te=U=>{U.key==="Enter"&&!U.shiftKey&&(U.preventDefault(),q())},ne=U=>{C(G=>G.filter((z,Z)=>Z!==U)),w(G=>G.filter((z,Z)=>Z!==U)),ue.current&&x.length===1&&(ue.current.value="")};return S.jsxs("div",{className:"bg-input-bg border border-border-color rounded-lg p-2 flex flex-col",onDrop:ye,onDragOver:U=>U.preventDefault(),onPaste:R,children:[!(K||ie)&&_.length>0&&S.jsx("div",{className:"p-2 grid grid-cols-3 gap-2",children:_.map((U,G)=>S.jsxs("div",{className:"relative",children:[S.jsx("img",{src:U,alt:`Image preview ${G+1}`,className:"max-h-24 w-full object-cover rounded-md"}),S.jsx("button",{onClick:()=>ne(G),className:"absolute top-0 right-0 m-1 bg-red-500 text-white rounded-full h-5 w-5 flex items-center justify-center text-xs",children:""})]},G))}),(K||ie)&&S.jsxs("div",{className:"p-3 border-b border-border-color",children:[ie&&S.jsx("div",{className:"mb-2 p-2 bg-blue-100 dark:bg-blue-900/30 rounded-md",children:S.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:" Auto-detected multi-timeframe analysis"})}),S.jsx(JS,{onTimeframeImagesChange:F,disabled:a})]}),S.jsxs("div",{className:"flex items-start",children:[!(K||ie)&&S.jsx("button",{onClick:()=>{var U;return(U=ue.current)==null?void 0:U.click()},className:"p-2 text-text-secondary hover:text-text-primary self-center",disabled:a,"aria-label":"Attach images",children:S.jsx(Nu,{className:"h-5 w-5"})}),S.jsx("input",{type:"file",ref:ue,onChange:ae,className:"hidden",multiple:!0,accept:"image/png, image/jpeg, image/webp"}),S.jsxs("div",{className:"relative self-center",ref:P,children:[S.jsx("button",{onClick:()=>H(U=>!U),className:`p-2 text-text-secondary hover:text-text-primary transition-colors ${m?"text-accent-blue":""}`,disabled:a,"aria-label":"Wizz Ultra Settings",children:S.jsx(GS,{className:"h-5 w-5"})}),N&&S.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-72 bg-sidebar-bg border border-border-color rounded-lg shadow-xl z-10 p-3",children:[S.jsxs("div",{className:"space-y-3",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{children:[S.jsx("h4",{className:"font-semibold text-text-primary",children:"Wizz Ultra"}),S.jsx("p",{className:"text-xs text-text-secondary",children:"Advanced analysis mode with SMC & Patterns"})]}),S.jsxs("label",{htmlFor:"ultra-toggle",className:"relative inline-flex items-center cursor-pointer",children:[S.jsx("input",{type:"checkbox",id:"ultra-toggle",className:"sr-only peer",checked:m,onChange:p}),S.jsx("div",{className:"w-11 h-6 bg-border-color peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-offset-2 peer-focus:ring-accent-blue peer-focus:ring-offset-sidebar-bg rounded-full peer peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent-blue"})]})]}),S.jsxs("div",{className:"flex items-center justify-between border-t border-border-color pt-3",children:[S.jsxs("div",{children:[S.jsx("h4",{className:"font-semibold text-text-primary",children:"Smart Money Concepts"}),S.jsx("p",{className:"text-xs text-text-secondary",children:"Advanced SMC analysis"})]}),S.jsxs("label",{htmlFor:"smc-toggle",className:"relative inline-flex items-center cursor-pointer",children:[S.jsx("input",{type:"checkbox",id:"smc-toggle",className:"sr-only peer",checked:Q,onChange:U=>{Y(U.target.checked),U.target.checked&&(I(!1),ce(!1))}}),S.jsx("div",{className:"w-11 h-6 bg-border-color peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-offset-2 peer-focus:ring-accent-blue peer-focus:ring-offset-sidebar-bg rounded-full peer peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent-blue"})]})]}),S.jsxs("div",{className:"flex items-center justify-between border-t border-border-color pt-3",children:[S.jsxs("div",{children:[S.jsx("h4",{className:"font-semibold text-text-primary",children:"Advanced Patterns"}),S.jsx("p",{className:"text-xs text-text-secondary",children:"Wyckoff, Elliott Wave, Harmonics"})]}),S.jsxs("label",{htmlFor:"pattern-toggle",className:"relative inline-flex items-center cursor-pointer",children:[S.jsx("input",{type:"checkbox",id:"pattern-toggle",className:"sr-only peer",checked:oe,onChange:U=>{ce(U.target.checked),U.target.checked&&(I(!1),Y(!1))}}),S.jsx("div",{className:"w-11 h-6 bg-border-color peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-offset-2 peer-focus:ring-accent-blue peer-focus:ring-offset-sidebar-bg rounded-full peer peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent-blue"})]})]}),S.jsxs("div",{className:"flex items-center justify-between border-t border-border-color pt-3",children:[S.jsxs("div",{children:[S.jsx("h4",{className:"font-semibold text-text-primary",children:"Progressive Analysis"}),S.jsx("p",{className:"text-xs text-text-secondary",children:"Stream results in phases (30%70%100%)"})]}),S.jsxs("label",{htmlFor:"progressive-toggle",className:"relative inline-flex items-center cursor-pointer",children:[S.jsx("input",{type:"checkbox",id:"progressive-toggle",className:"sr-only peer",checked:Ae,onChange:U=>{pe(U.target.checked)}}),S.jsx("div",{className:"w-11 h-6 bg-border-color peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-offset-2 peer-focus:ring-accent-blue peer-focus:ring-offset-sidebar-bg rounded-full peer peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent-blue"})]})]})]}),S.jsx("p",{className:"text-xs text-text-secondary mt-2 border-t border-border-color pt-2",children:Ae?"Progressive analysis streams results in real-time: Quick overview (30% confidence)  Detailed analysis (70% confidence)  Final verification (100% confidence).":Q?"Advanced Smart Money Concepts analysis with order blocks, FVGs, and liquidity detection.":oe?"Institutional-grade pattern recognition: Wyckoff Method, Elliott Wave, Harmonic Patterns, and Volume Profile.":m?"Ultra mode combines advanced analysis techniques including Smart Money Concepts, pattern recognition, and enhanced confidence calibration for maximum accuracy.":"Multi-timeframe analysis is automatically detected when multiple charts are uploaded. Upload charts from different timeframes (1H, 4H, 1D) for better confluence analysis."})]})]}),S.jsx("textarea",{ref:fe,value:y,onChange:U=>T(U.target.value),onKeyDown:te,placeholder:"Describe the chart or ask a question... (you can also paste or drag-and-drop images)",className:"flex-1 bg-transparent resize-none focus:outline-none text-text-primary placeholder-text-secondary px-2 pt-1.5 max-h-28",rows:1,disabled:a}),S.jsx("div",{className:"self-center",children:a?S.jsx("button",{onClick:c,className:"p-2 rounded-md bg-accent-red text-white","aria-label":"Stop generation",children:S.jsx(VS,{className:"h-5 w-5"})}):S.jsx("button",{onClick:q,disabled:!y.trim()&&x.length===0,className:"p-2 rounded-md bg-accent-blue text-white disabled:bg-gray-500 disabled:cursor-not-allowed","aria-label":"Send message",children:S.jsx(HS,{className:"h-5 w-5"})})})]})]})};function ad(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let Mi=ad();function Iy(n){Mi=n}const Dy=/[&<>"']/,KS=new RegExp(Dy.source,"g"),Ly=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,WS=new RegExp(Ly.source,"g"),XS={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Np=n=>XS[n];function Ot(n,e){if(e){if(Dy.test(n))return n.replace(KS,Np)}else if(Ly.test(n))return n.replace(WS,Np);return n}const QS=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function ZS(n){return n.replace(QS,(e,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const ex=/(^|[^\[])\^/g;function qe(n,e){let t=typeof n=="string"?n:n.source;e=e||"";const i={replace:(r,a)=>{let c=typeof a=="string"?a:a.source;return c=c.replace(ex,"$1"),t=t.replace(r,c),i},getRegex:()=>new RegExp(t,e)};return i}function kp(n){try{n=encodeURI(n).replace(/%25/g,"%")}catch{return null}return n}const nr={exec:()=>null};function Ip(n,e){const t=n.replace(/\|/g,(a,c,h)=>{let m=!1,p=c;for(;--p>=0&&h[p]==="\\";)m=!m;return m?"|":" |"}),i=t.split(/ \|/);let r=0;if(i[0].trim()||i.shift(),i.length>0&&!i[i.length-1].trim()&&i.pop(),e)if(i.length>e)i.splice(e);else for(;i.length<e;)i.push("");for(;r<i.length;r++)i[r]=i[r].trim().replace(/\\\|/g,"|");return i}function Ko(n,e,t){const i=n.length;if(i===0)return"";let r=0;for(;r<i&&n.charAt(i-r-1)===e;)r++;return n.slice(0,i-r)}function tx(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let i=0;i<n.length;i++)if(n[i]==="\\")i++;else if(n[i]===e[0])t++;else if(n[i]===e[1]&&(t--,t<0))return i;return-1}function Dp(n,e,t,i){const r=e.href,a=e.title?Ot(e.title):null,c=n[1].replace(/\\([\[\]])/g,"$1");if(n[0].charAt(0)!=="!"){i.state.inLink=!0;const h={type:"link",raw:t,href:r,title:a,text:c,tokens:i.inlineTokens(c)};return i.state.inLink=!1,h}return{type:"image",raw:t,href:r,title:a,text:Ot(c)}}function nx(n,e){const t=n.match(/^(\s+)(?:```)/);if(t===null)return e;const i=t[1];return e.split(`
`).map(r=>{const a=r.match(/^\s+/);if(a===null)return r;const[c]=a;return c.length>=i.length?r.slice(i.length):r}).join(`
`)}class Ga{constructor(e){Fe(this,"options");Fe(this,"rules");Fe(this,"lexer");this.options=e||Mi}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const i=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?i:Ko(i,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const i=t[0],r=nx(i,t[3]||"");return{type:"code",raw:i,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let i=t[2].trim();if(/#$/.test(i)){const r=Ko(i,"#");(this.options.pedantic||!r||/ $/.test(r))&&(i=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:i,tokens:this.lexer.inline(i)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:Ko(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let i=Ko(t[0],`
`).split(`
`),r="",a="";const c=[];for(;i.length>0;){let h=!1;const m=[];let p;for(p=0;p<i.length;p++)if(/^ {0,3}>/.test(i[p]))m.push(i[p]),h=!0;else if(!h)m.push(i[p]);else break;i=i.slice(p);const y=m.join(`
`),T=y.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");r=r?`${r}
${y}`:y,a=a?`${a}
${T}`:T;const x=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(T,c,!0),this.lexer.state.top=x,i.length===0)break;const C=c[c.length-1];if((C==null?void 0:C.type)==="code")break;if((C==null?void 0:C.type)==="blockquote"){const _=C,w=_.raw+`
`+i.join(`
`),N=this.blockquote(w);c[c.length-1]=N,r=r.substring(0,r.length-_.raw.length)+N.raw,a=a.substring(0,a.length-_.text.length)+N.text;break}else if((C==null?void 0:C.type)==="list"){const _=C,w=_.raw+`
`+i.join(`
`),N=this.list(w);c[c.length-1]=N,r=r.substring(0,r.length-C.raw.length)+N.raw,a=a.substring(0,a.length-_.raw.length)+N.raw,i=w.substring(c[c.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:c,text:a}}}list(e){let t=this.rules.block.list.exec(e);if(t){let i=t[1].trim();const r=i.length>1,a={type:"list",raw:"",ordered:r,start:r?+i.slice(0,-1):"",loose:!1,items:[]};i=r?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=r?i:"[*+-]");const c=new RegExp(`^( {0,3}${i})((?:[	 ][^\\n]*)?(?:\\n|$))`);let h=!1;for(;e;){let m=!1,p="",y="";if(!(t=c.exec(e))||this.rules.block.hr.test(e))break;p=t[0],e=e.substring(p.length);let T=t[2].split(`
`,1)[0].replace(/^\t+/,H=>" ".repeat(3*H.length)),x=e.split(`
`,1)[0],C=!T.trim(),_=0;if(this.options.pedantic?(_=2,y=T.trimStart()):C?_=t[1].length+1:(_=t[2].search(/[^ ]/),_=_>4?1:_,y=T.slice(_),_+=t[1].length),C&&/^ *$/.test(x)&&(p+=x+`
`,e=e.substring(x.length+1),m=!0),!m){const H=new RegExp(`^ {0,${Math.min(3,_-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),K=new RegExp(`^ {0,${Math.min(3,_-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),I=new RegExp(`^ {0,${Math.min(3,_-1)}}(?:\`\`\`|~~~)`),Q=new RegExp(`^ {0,${Math.min(3,_-1)}}#`);for(;e;){const Y=e.split(`
`,1)[0];if(x=Y,this.options.pedantic&&(x=x.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),I.test(x)||Q.test(x)||H.test(x)||K.test(e))break;if(x.search(/[^ ]/)>=_||!x.trim())y+=`
`+x.slice(_);else{if(C||T.search(/[^ ]/)>=4||I.test(T)||Q.test(T)||K.test(T))break;y+=`
`+x}!C&&!x.trim()&&(C=!0),p+=Y+`
`,e=e.substring(Y.length+1),T=x.slice(_)}}a.loose||(h?a.loose=!0:/\n *\n *$/.test(p)&&(h=!0));let w=null,N;this.options.gfm&&(w=/^\[[ xX]\] /.exec(y),w&&(N=w[0]!=="[ ] ",y=y.replace(/^\[[ xX]\] +/,""))),a.items.push({type:"list_item",raw:p,task:!!w,checked:N,loose:!1,text:y,tokens:[]}),a.raw+=p}a.items[a.items.length-1].raw=a.items[a.items.length-1].raw.trimEnd(),a.items[a.items.length-1].text=a.items[a.items.length-1].text.trimEnd(),a.raw=a.raw.trimEnd();for(let m=0;m<a.items.length;m++)if(this.lexer.state.top=!1,a.items[m].tokens=this.lexer.blockTokens(a.items[m].text,[]),!a.loose){const p=a.items[m].tokens.filter(T=>T.type==="space"),y=p.length>0&&p.some(T=>/\n.*\n/.test(T.raw));a.loose=y}if(a.loose)for(let m=0;m<a.items.length;m++)a.items[m].loose=!0;return a}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const i=t[1].toLowerCase().replace(/\s+/g," "),r=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",a=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:i,raw:t[0],href:r,title:a}}}table(e){const t=this.rules.block.table.exec(e);if(!t||!/[:|]/.test(t[2]))return;const i=Ip(t[1]),r=t[2].replace(/^\||\| *$/g,"").split("|"),a=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[],c={type:"table",raw:t[0],header:[],align:[],rows:[]};if(i.length===r.length){for(const h of r)/^ *-+: *$/.test(h)?c.align.push("right"):/^ *:-+: *$/.test(h)?c.align.push("center"):/^ *:-+ *$/.test(h)?c.align.push("left"):c.align.push(null);for(let h=0;h<i.length;h++)c.header.push({text:i[h],tokens:this.lexer.inline(i[h]),header:!0,align:c.align[h]});for(const h of a)c.rows.push(Ip(h,c.header.length).map((m,p)=>({text:m,tokens:this.lexer.inline(m),header:!1,align:c.align[p]})));return c}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const i=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:i,tokens:this.lexer.inline(i)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:Ot(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const i=t[2].trim();if(!this.options.pedantic&&/^</.test(i)){if(!/>$/.test(i))return;const c=Ko(i.slice(0,-1),"\\");if((i.length-c.length)%2===0)return}else{const c=tx(t[2],"()");if(c>-1){const m=(t[0].indexOf("!")===0?5:4)+t[1].length+c;t[2]=t[2].substring(0,c),t[0]=t[0].substring(0,m).trim(),t[3]=""}}let r=t[2],a="";if(this.options.pedantic){const c=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(r);c&&(r=c[1],a=c[3])}else a=t[3]?t[3].slice(1,-1):"";return r=r.trim(),/^</.test(r)&&(this.options.pedantic&&!/>$/.test(i)?r=r.slice(1):r=r.slice(1,-1)),Dp(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:a&&a.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer)}}reflink(e,t){let i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){const r=(i[2]||i[1]).replace(/\s+/g," "),a=t[r.toLowerCase()];if(!a){const c=i[0].charAt(0);return{type:"text",raw:c,text:c}}return Dp(i,a,i[0],this.lexer)}}emStrong(e,t,i=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!r||r[3]&&i.match(/[\p{L}\p{N}]/u))return;if(!(r[1]||r[2]||"")||!i||this.rules.inline.punctuation.exec(i)){const c=[...r[0]].length-1;let h,m,p=c,y=0;const T=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(T.lastIndex=0,t=t.slice(-1*e.length+c);(r=T.exec(t))!=null;){if(h=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!h)continue;if(m=[...h].length,r[3]||r[4]){p+=m;continue}else if((r[5]||r[6])&&c%3&&!((c+m)%3)){y+=m;continue}if(p-=m,p>0)continue;m=Math.min(m,m+p+y);const x=[...r[0]][0].length,C=e.slice(0,c+r.index+x+m);if(Math.min(c,m)%2){const w=C.slice(1,-1);return{type:"em",raw:C,text:w,tokens:this.lexer.inlineTokens(w)}}const _=C.slice(2,-2);return{type:"strong",raw:C,text:_,tokens:this.lexer.inlineTokens(_)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let i=t[2].replace(/\n/g," ");const r=/[^ ]/.test(i),a=/^ /.test(i)&&/ $/.test(i);return r&&a&&(i=i.substring(1,i.length-1)),i=Ot(i,!0),{type:"codespan",raw:t[0],text:i}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let i,r;return t[2]==="@"?(i=Ot(t[1]),r="mailto:"+i):(i=Ot(t[1]),r=i),{type:"link",raw:t[0],text:i,href:r,tokens:[{type:"text",raw:i,text:i}]}}}url(e){var i;let t;if(t=this.rules.inline.url.exec(e)){let r,a;if(t[2]==="@")r=Ot(t[0]),a="mailto:"+r;else{let c;do c=t[0],t[0]=((i=this.rules.inline._backpedal.exec(t[0]))==null?void 0:i[0])??"";while(c!==t[0]);r=Ot(t[0]),t[1]==="www."?a="http://"+t[0]:a=t[0]}return{type:"link",raw:t[0],text:r,href:a,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let i;return this.lexer.state.inRawBlock?i=t[0]:i=Ot(t[0]),{type:"text",raw:t[0],text:i}}}}const ix=/^(?: *(?:\n|$))+/,sx=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,ox=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,ur=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,rx=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Py=/(?:[*+-]|\d{1,9}[.)])/,Uy=qe(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,Py).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),ld=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,ax=/^[^\n]+/,cd=/(?!\s*\])(?:\\.|[^\[\]\\])+/,lx=qe(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",cd).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),cx=qe(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Py).getRegex(),Qa="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",ud=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,ux=qe("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",ud).replace("tag",Qa).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Oy=qe(ld).replace("hr",ur).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Qa).getRegex(),dx=qe(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Oy).getRegex(),dd={blockquote:dx,code:sx,def:lx,fences:ox,heading:rx,hr:ur,html:ux,lheading:Uy,list:cx,newline:ix,paragraph:Oy,table:nr,text:ax},Lp=qe("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",ur).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Qa).getRegex(),fx={...dd,table:Lp,paragraph:qe(ld).replace("hr",ur).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Lp).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Qa).getRegex()},hx={...dd,html:qe(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",ud).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:nr,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:qe(ld).replace("hr",ur).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Uy).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},By=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,mx=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Hy=/^( {2,}|\\)\n(?!\s*$)/,px=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,dr="\\p{P}\\p{S}",gx=qe(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,dr).getRegex(),yx=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,vx=qe(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,dr).getRegex(),Tx=qe("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,dr).getRegex(),Sx=qe("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,dr).getRegex(),xx=qe(/\\([punct])/,"gu").replace(/punct/g,dr).getRegex(),Ex=qe(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Cx=qe(ud).replace("(?:-->|$)","-->").getRegex(),Ax=qe("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Cx).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),qa=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,_x=qe(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",qa).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Vy=qe(/^!?\[(label)\]\[(ref)\]/).replace("label",qa).replace("ref",cd).getRegex(),Gy=qe(/^!?\[(ref)\](?:\[\])?/).replace("ref",cd).getRegex(),wx=qe("reflink|nolink(?!\\()","g").replace("reflink",Vy).replace("nolink",Gy).getRegex(),fd={_backpedal:nr,anyPunctuation:xx,autolink:Ex,blockSkip:yx,br:Hy,code:mx,del:nr,emStrongLDelim:vx,emStrongRDelimAst:Tx,emStrongRDelimUnd:Sx,escape:By,link:_x,nolink:Gy,punctuation:gx,reflink:Vy,reflinkSearch:wx,tag:Ax,text:px,url:nr},bx={...fd,link:qe(/^!?\[(label)\]\((.*?)\)/).replace("label",qa).getRegex(),reflink:qe(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",qa).getRegex()},ku={...fd,escape:qe(By).replace("])","~|])").getRegex(),url:qe(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Rx={...ku,br:qe(Hy).replace("{2,}","*").getRegex(),text:qe(ku.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Ma={normal:dd,gfm:fx,pedantic:hx},Wo={normal:fd,gfm:ku,breaks:Rx,pedantic:bx};class rn{constructor(e){Fe(this,"tokens");Fe(this,"options");Fe(this,"state");Fe(this,"tokenizer");Fe(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Mi,this.options.tokenizer=this.options.tokenizer||new Ga,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:Ma.normal,inline:Wo.normal};this.options.pedantic?(t.block=Ma.pedantic,t.inline=Wo.pedantic):this.options.gfm&&(t.block=Ma.gfm,this.options.breaks?t.inline=Wo.breaks:t.inline=Wo.gfm),this.tokenizer.rules=t}static get rules(){return{block:Ma,inline:Wo}}static lex(e,t){return new rn(t).lex(e)}static lexInline(e,t){return new rn(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const i=this.inlineQueue[t];this.inlineTokens(i.src,i.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],i=!1){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(h,m,p)=>m+"    ".repeat(p.length));let r,a,c;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(h=>(r=h.call({lexer:this},e,t))?(e=e.substring(r.raw.length),t.push(r),!0):!1))){if(r=this.tokenizer.space(e)){e=e.substring(r.raw.length),r.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(r);continue}if(r=this.tokenizer.code(e)){e=e.substring(r.raw.length),a=t[t.length-1],a&&(a.type==="paragraph"||a.type==="text")?(a.raw+=`
`+r.raw,a.text+=`
`+r.text,this.inlineQueue[this.inlineQueue.length-1].src=a.text):t.push(r);continue}if(r=this.tokenizer.fences(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.heading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.hr(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.blockquote(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.list(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.html(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.def(e)){e=e.substring(r.raw.length),a=t[t.length-1],a&&(a.type==="paragraph"||a.type==="text")?(a.raw+=`
`+r.raw,a.text+=`
`+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=a.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.lheading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(c=e,this.options.extensions&&this.options.extensions.startBlock){let h=1/0;const m=e.slice(1);let p;this.options.extensions.startBlock.forEach(y=>{p=y.call({lexer:this},m),typeof p=="number"&&p>=0&&(h=Math.min(h,p))}),h<1/0&&h>=0&&(c=e.substring(0,h+1))}if(this.state.top&&(r=this.tokenizer.paragraph(c))){a=t[t.length-1],i&&(a==null?void 0:a.type)==="paragraph"?(a.raw+=`
`+r.raw,a.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=a.text):t.push(r),i=c.length!==e.length,e=e.substring(r.raw.length);continue}if(r=this.tokenizer.text(e)){e=e.substring(r.raw.length),a=t[t.length-1],a&&a.type==="text"?(a.raw+=`
`+r.raw,a.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=a.text):t.push(r);continue}if(e){const h="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let i,r,a,c=e,h,m,p;if(this.tokens.links){const y=Object.keys(this.tokens.links);if(y.length>0)for(;(h=this.tokenizer.rules.inline.reflinkSearch.exec(c))!=null;)y.includes(h[0].slice(h[0].lastIndexOf("[")+1,-1))&&(c=c.slice(0,h.index)+"["+"a".repeat(h[0].length-2)+"]"+c.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(h=this.tokenizer.rules.inline.blockSkip.exec(c))!=null;)c=c.slice(0,h.index)+"["+"a".repeat(h[0].length-2)+"]"+c.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(h=this.tokenizer.rules.inline.anyPunctuation.exec(c))!=null;)c=c.slice(0,h.index)+"++"+c.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(m||(p=""),m=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(y=>(i=y.call({lexer:this},e,t))?(e=e.substring(i.raw.length),t.push(i),!0):!1))){if(i=this.tokenizer.escape(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.tag(e)){e=e.substring(i.raw.length),r=t[t.length-1],r&&i.type==="text"&&r.type==="text"?(r.raw+=i.raw,r.text+=i.text):t.push(i);continue}if(i=this.tokenizer.link(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(i.raw.length),r=t[t.length-1],r&&i.type==="text"&&r.type==="text"?(r.raw+=i.raw,r.text+=i.text):t.push(i);continue}if(i=this.tokenizer.emStrong(e,c,p)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.codespan(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.br(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.del(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.autolink(e)){e=e.substring(i.raw.length),t.push(i);continue}if(!this.state.inLink&&(i=this.tokenizer.url(e))){e=e.substring(i.raw.length),t.push(i);continue}if(a=e,this.options.extensions&&this.options.extensions.startInline){let y=1/0;const T=e.slice(1);let x;this.options.extensions.startInline.forEach(C=>{x=C.call({lexer:this},T),typeof x=="number"&&x>=0&&(y=Math.min(y,x))}),y<1/0&&y>=0&&(a=e.substring(0,y+1))}if(i=this.tokenizer.inlineText(a)){e=e.substring(i.raw.length),i.raw.slice(-1)!=="_"&&(p=i.raw.slice(-1)),m=!0,r=t[t.length-1],r&&r.type==="text"?(r.raw+=i.raw,r.text+=i.text):t.push(i);continue}if(e){const y="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(y);break}else throw new Error(y)}}return t}}class za{constructor(e){Fe(this,"options");Fe(this,"parser");this.options=e||Mi}space(e){return""}code({text:e,lang:t,escaped:i}){var c;const r=(c=(t||"").match(/^\S*/))==null?void 0:c[0],a=e.replace(/\n$/,"")+`
`;return r?'<pre><code class="language-'+Ot(r)+'">'+(i?a:Ot(a,!0))+`</code></pre>
`:"<pre><code>"+(i?a:Ot(a,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,i=e.start;let r="";for(let h=0;h<e.items.length;h++){const m=e.items[h];r+=this.listitem(m)}const a=t?"ol":"ul",c=t&&i!==1?' start="'+i+'"':"";return"<"+a+c+`>
`+r+"</"+a+`>
`}listitem(e){let t="";if(e.task){const i=this.checkbox({checked:!!e.checked});e.loose?e.tokens.length>0&&e.tokens[0].type==="paragraph"?(e.tokens[0].text=i+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=i+" "+e.tokens[0].tokens[0].text)):e.tokens.unshift({type:"text",raw:i+" ",text:i+" "}):t+=i+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",i="";for(let a=0;a<e.header.length;a++)i+=this.tablecell(e.header[a]);t+=this.tablerow({text:i});let r="";for(let a=0;a<e.rows.length;a++){const c=e.rows[a];i="";for(let h=0;h<c.length;h++)i+=this.tablecell(c[h]);r+=this.tablerow({text:i})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),i=e.header?"th":"td";return(e.align?`<${i} align="${e.align}">`:`<${i}>`)+t+`</${i}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${e}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:i}){const r=this.parser.parseInline(i),a=kp(e);if(a===null)return r;e=a;let c='<a href="'+e+'"';return t&&(c+=' title="'+t+'"'),c+=">"+r+"</a>",c}image({href:e,title:t,text:i}){const r=kp(e);if(r===null)return i;e=r;let a=`<img src="${e}" alt="${i}"`;return t&&(a+=` title="${t}"`),a+=">",a}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):e.text}}class hd{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class an{constructor(e){Fe(this,"options");Fe(this,"renderer");Fe(this,"textRenderer");this.options=e||Mi,this.options.renderer=this.options.renderer||new za,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new hd}static parse(e,t){return new an(t).parse(e)}static parseInline(e,t){return new an(t).parseInline(e)}parse(e,t=!0){let i="";for(let r=0;r<e.length;r++){const a=e[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[a.type]){const h=a,m=this.options.extensions.renderers[h.type].call({parser:this},h);if(m!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(h.type)){i+=m||"";continue}}const c=a;switch(c.type){case"space":{i+=this.renderer.space(c);continue}case"hr":{i+=this.renderer.hr(c);continue}case"heading":{i+=this.renderer.heading(c);continue}case"code":{i+=this.renderer.code(c);continue}case"table":{i+=this.renderer.table(c);continue}case"blockquote":{i+=this.renderer.blockquote(c);continue}case"list":{i+=this.renderer.list(c);continue}case"html":{i+=this.renderer.html(c);continue}case"paragraph":{i+=this.renderer.paragraph(c);continue}case"text":{let h=c,m=this.renderer.text(h);for(;r+1<e.length&&e[r+1].type==="text";)h=e[++r],m+=`
`+this.renderer.text(h);t?i+=this.renderer.paragraph({type:"paragraph",raw:m,text:m,tokens:[{type:"text",raw:m,text:m}]}):i+=m;continue}default:{const h='Token with "'+c.type+'" type was not found.';if(this.options.silent)return console.error(h),"";throw new Error(h)}}}return i}parseInline(e,t){t=t||this.renderer;let i="";for(let r=0;r<e.length;r++){const a=e[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[a.type]){const h=this.options.extensions.renderers[a.type].call({parser:this},a);if(h!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){i+=h||"";continue}}const c=a;switch(c.type){case"escape":{i+=t.text(c);break}case"html":{i+=t.html(c);break}case"link":{i+=t.link(c);break}case"image":{i+=t.image(c);break}case"strong":{i+=t.strong(c);break}case"em":{i+=t.em(c);break}case"codespan":{i+=t.codespan(c);break}case"br":{i+=t.br(c);break}case"del":{i+=t.del(c);break}case"text":{i+=t.text(c);break}default:{const h='Token with "'+c.type+'" type was not found.';if(this.options.silent)return console.error(h),"";throw new Error(h)}}}return i}}class ir{constructor(e){Fe(this,"options");this.options=e||Mi}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}}Fe(ir,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));var wn,qy,Iu,zy;class Mx{constructor(...e){Tp(this,wn);Fe(this,"defaults",ad());Fe(this,"options",this.setOptions);Fe(this,"parse",Yo(this,wn,Iu).call(this,rn.lex,an.parse));Fe(this,"parseInline",Yo(this,wn,Iu).call(this,rn.lexInline,an.parseInline));Fe(this,"Parser",an);Fe(this,"Renderer",za);Fe(this,"TextRenderer",hd);Fe(this,"Lexer",rn);Fe(this,"Tokenizer",Ga);Fe(this,"Hooks",ir);this.use(...e)}walkTokens(e,t){var r,a;let i=[];for(const c of e)switch(i=i.concat(t.call(this,c)),c.type){case"table":{const h=c;for(const m of h.header)i=i.concat(this.walkTokens(m.tokens,t));for(const m of h.rows)for(const p of m)i=i.concat(this.walkTokens(p.tokens,t));break}case"list":{const h=c;i=i.concat(this.walkTokens(h.items,t));break}default:{const h=c;(a=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&a[h.type]?this.defaults.extensions.childTokens[h.type].forEach(m=>{const p=h[m].flat(1/0);i=i.concat(this.walkTokens(p,t))}):h.tokens&&(i=i.concat(this.walkTokens(h.tokens,t)))}}return i}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(i=>{const r={...i};if(r.async=this.defaults.async||r.async||!1,i.extensions&&(i.extensions.forEach(a=>{if(!a.name)throw new Error("extension name required");if("renderer"in a){const c=t.renderers[a.name];c?t.renderers[a.name]=function(...h){let m=a.renderer.apply(this,h);return m===!1&&(m=c.apply(this,h)),m}:t.renderers[a.name]=a.renderer}if("tokenizer"in a){if(!a.level||a.level!=="block"&&a.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const c=t[a.level];c?c.unshift(a.tokenizer):t[a.level]=[a.tokenizer],a.start&&(a.level==="block"?t.startBlock?t.startBlock.push(a.start):t.startBlock=[a.start]:a.level==="inline"&&(t.startInline?t.startInline.push(a.start):t.startInline=[a.start]))}"childTokens"in a&&a.childTokens&&(t.childTokens[a.name]=a.childTokens)}),r.extensions=t),i.renderer){const a=this.defaults.renderer||new za(this.defaults);for(const c in i.renderer){if(!(c in a))throw new Error(`renderer '${c}' does not exist`);if(["options","parser"].includes(c))continue;const h=c;let m=i.renderer[h];i.useNewRenderer||(m=Yo(this,wn,qy).call(this,m,h,a));const p=a[h];a[h]=(...y)=>{let T=m.apply(a,y);return T===!1&&(T=p.apply(a,y)),T||""}}r.renderer=a}if(i.tokenizer){const a=this.defaults.tokenizer||new Ga(this.defaults);for(const c in i.tokenizer){if(!(c in a))throw new Error(`tokenizer '${c}' does not exist`);if(["options","rules","lexer"].includes(c))continue;const h=c,m=i.tokenizer[h],p=a[h];a[h]=(...y)=>{let T=m.apply(a,y);return T===!1&&(T=p.apply(a,y)),T}}r.tokenizer=a}if(i.hooks){const a=this.defaults.hooks||new ir;for(const c in i.hooks){if(!(c in a))throw new Error(`hook '${c}' does not exist`);if(c==="options")continue;const h=c,m=i.hooks[h],p=a[h];ir.passThroughHooks.has(c)?a[h]=y=>{if(this.defaults.async)return Promise.resolve(m.call(a,y)).then(x=>p.call(a,x));const T=m.call(a,y);return p.call(a,T)}:a[h]=(...y)=>{let T=m.apply(a,y);return T===!1&&(T=p.apply(a,y)),T}}r.hooks=a}if(i.walkTokens){const a=this.defaults.walkTokens,c=i.walkTokens;r.walkTokens=function(h){let m=[];return m.push(c.call(this,h)),a&&(m=m.concat(a.call(this,h))),m}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return rn.lex(e,t??this.defaults)}parser(e,t){return an.parse(e,t??this.defaults)}}wn=new WeakSet,qy=function(e,t,i){switch(t){case"heading":return function(r){return!r.type||r.type!==t?e.apply(this,arguments):e.call(this,i.parser.parseInline(r.tokens),r.depth,ZS(i.parser.parseInline(r.tokens,i.parser.textRenderer)))};case"code":return function(r){return!r.type||r.type!==t?e.apply(this,arguments):e.call(this,r.text,r.lang,!!r.escaped)};case"table":return function(r){if(!r.type||r.type!==t)return e.apply(this,arguments);let a="",c="";for(let m=0;m<r.header.length;m++)c+=this.tablecell({text:r.header[m].text,tokens:r.header[m].tokens,header:!0,align:r.align[m]});a+=this.tablerow({text:c});let h="";for(let m=0;m<r.rows.length;m++){const p=r.rows[m];c="";for(let y=0;y<p.length;y++)c+=this.tablecell({text:p[y].text,tokens:p[y].tokens,header:!1,align:r.align[y]});h+=this.tablerow({text:c})}return e.call(this,a,h)};case"blockquote":return function(r){if(!r.type||r.type!==t)return e.apply(this,arguments);const a=this.parser.parse(r.tokens);return e.call(this,a)};case"list":return function(r){if(!r.type||r.type!==t)return e.apply(this,arguments);const a=r.ordered,c=r.start,h=r.loose;let m="";for(let p=0;p<r.items.length;p++){const y=r.items[p],T=y.checked,x=y.task;let C="";if(y.task){const _=this.checkbox({checked:!!T});h?y.tokens.length>0&&y.tokens[0].type==="paragraph"?(y.tokens[0].text=_+" "+y.tokens[0].text,y.tokens[0].tokens&&y.tokens[0].tokens.length>0&&y.tokens[0].tokens[0].type==="text"&&(y.tokens[0].tokens[0].text=_+" "+y.tokens[0].tokens[0].text)):y.tokens.unshift({type:"text",text:_+" "}):C+=_+" "}C+=this.parser.parse(y.tokens,h),m+=this.listitem({type:"list_item",raw:C,text:C,task:x,checked:!!T,loose:h,tokens:y.tokens})}return e.call(this,m,a,c)};case"html":return function(r){return!r.type||r.type!==t?e.apply(this,arguments):e.call(this,r.text,r.block)};case"paragraph":return function(r){return!r.type||r.type!==t?e.apply(this,arguments):e.call(this,this.parser.parseInline(r.tokens))};case"escape":return function(r){return!r.type||r.type!==t?e.apply(this,arguments):e.call(this,r.text)};case"link":return function(r){return!r.type||r.type!==t?e.apply(this,arguments):e.call(this,r.href,r.title,this.parser.parseInline(r.tokens))};case"image":return function(r){return!r.type||r.type!==t?e.apply(this,arguments):e.call(this,r.href,r.title,r.text)};case"strong":return function(r){return!r.type||r.type!==t?e.apply(this,arguments):e.call(this,this.parser.parseInline(r.tokens))};case"em":return function(r){return!r.type||r.type!==t?e.apply(this,arguments):e.call(this,this.parser.parseInline(r.tokens))};case"codespan":return function(r){return!r.type||r.type!==t?e.apply(this,arguments):e.call(this,r.text)};case"del":return function(r){return!r.type||r.type!==t?e.apply(this,arguments):e.call(this,this.parser.parseInline(r.tokens))};case"text":return function(r){return!r.type||r.type!==t?e.apply(this,arguments):e.call(this,r.text)}}return e},Iu=function(e,t){return(i,r)=>{const a={...r},c={...this.defaults,...a};this.defaults.async===!0&&a.async===!1&&(c.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),c.async=!0);const h=Yo(this,wn,zy).call(this,!!c.silent,!!c.async);if(typeof i>"u"||i===null)return h(new Error("marked(): input parameter is undefined or null"));if(typeof i!="string")return h(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(i)+", string expected"));if(c.hooks&&(c.hooks.options=c),c.async)return Promise.resolve(c.hooks?c.hooks.preprocess(i):i).then(m=>e(m,c)).then(m=>c.hooks?c.hooks.processAllTokens(m):m).then(m=>c.walkTokens?Promise.all(this.walkTokens(m,c.walkTokens)).then(()=>m):m).then(m=>t(m,c)).then(m=>c.hooks?c.hooks.postprocess(m):m).catch(h);try{c.hooks&&(i=c.hooks.preprocess(i));let m=e(i,c);c.hooks&&(m=c.hooks.processAllTokens(m)),c.walkTokens&&this.walkTokens(m,c.walkTokens);let p=t(m,c);return c.hooks&&(p=c.hooks.postprocess(p)),p}catch(m){return h(m)}}},zy=function(e,t){return i=>{if(i.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const r="<p>An error occurred:</p><pre>"+Ot(i.message+"",!0)+"</pre>";return t?Promise.resolve(r):r}if(t)return Promise.reject(i);throw i}};const bi=new Mx;function Be(n,e){return bi.parse(n,e)}Be.options=Be.setOptions=function(n){return bi.setOptions(n),Be.defaults=bi.defaults,Iy(Be.defaults),Be};Be.getDefaults=ad;Be.defaults=Mi;Be.use=function(...n){return bi.use(...n),Be.defaults=bi.defaults,Iy(Be.defaults),Be};Be.walkTokens=function(n,e){return bi.walkTokens(n,e)};Be.parseInline=bi.parseInline;Be.Parser=an;Be.parser=an.parse;Be.Renderer=za;Be.TextRenderer=hd;Be.Lexer=rn;Be.lexer=rn.lex;Be.Tokenizer=Ga;Be.Hooks=ir;Be.parse=Be;Be.options;Be.setOptions;Be.use;Be.walkTokens;Be.parseInline;an.parse;rn.lex;const Nx=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 11.667 0l3.181-3.183m-4.991-2.691v4.992m0 0h-4.992m4.992 0-3.181-3.183a8.25 8.25 0 0 0-11.667 0L2.985 16.652"})}),kx=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"})}),Ix=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"})}),Dx=({calibratedConfidence:n,className:e=""})=>{const[t,i]=le.useState(!1),{overallScore:r,factors:a,interval:c,breakdown:h,historicalContext:m,riskAdjustments:p}=n,y=C=>C>=80?"text-green-600 dark:text-green-400":C>=60?"text-yellow-600 dark:text-yellow-400":C>=40?"text-orange-600 dark:text-orange-400":"text-red-600 dark:text-red-400",T=C=>{switch(C){case"VERY_HIGH":return"text-green-600 dark:text-green-400";case"HIGH":return"text-blue-600 dark:text-blue-400";case"MEDIUM":return"text-yellow-600 dark:text-yellow-400";case"LOW":return"text-red-600 dark:text-red-400";default:return"text-gray-600 dark:text-gray-400"}},x=C=>`${Math.round(C)}%`;return S.jsxs("div",{className:`bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 ${e}`,children:[S.jsxs("div",{className:"flex items-center justify-between mb-3",children:[S.jsxs("div",{className:"flex items-center space-x-3",children:[S.jsxs("div",{className:"flex items-center space-x-2",children:[S.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Confidence:"}),S.jsxs("span",{className:`text-lg font-bold ${y(r)}`,children:[r,"%"]})]}),S.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600 dark:text-gray-400",children:[S.jsxs("span",{children:["",c.uncertainty,"%"]}),S.jsxs("span",{className:`font-medium ${T(c.reliability)}`,children:["(",c.reliability.toLowerCase()," reliability)"]})]})]}),S.jsx("button",{onClick:()=>i(!t),className:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium",children:t?"Hide Details":"Show Details"})]}),S.jsxs("div",{className:"mb-3",children:[S.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400 mb-1",children:[S.jsxs("span",{children:[c.lowerBound,"%"]}),S.jsxs("span",{children:["Range: ",c.lowerBound,"% - ",c.upperBound,"%"]}),S.jsxs("span",{children:[c.upperBound,"%"]})]}),S.jsxs("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 relative",children:[S.jsx("div",{className:"absolute h-2 bg-blue-200 dark:bg-blue-800 rounded-full",style:{left:`${c.lowerBound}%`,width:`${c.upperBound-c.lowerBound}%`}}),S.jsx("div",{className:`absolute h-2 w-1 ${y(r).replace("text-","bg-")} rounded-full`,style:{left:`${r}%`}})]})]}),t&&S.jsxs("div",{className:"space-y-4 border-t border-gray-200 dark:border-gray-700 pt-4",children:[S.jsxs("div",{children:[S.jsx("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Confidence Factors"}),S.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[S.jsxs("div",{className:"space-y-2",children:[S.jsxs("div",{className:"flex justify-between",children:[S.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Technical Confluence:"}),S.jsx("span",{className:y(a.technicalConfluence),children:x(a.technicalConfluence)})]}),S.jsxs("div",{className:"flex justify-between",children:[S.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Historical Patterns:"}),S.jsx("span",{className:y(a.historicalPatternSuccess),children:x(a.historicalPatternSuccess)})]}),S.jsxs("div",{className:"flex justify-between",children:[S.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Market Conditions:"}),S.jsx("span",{className:y(a.marketConditions),children:x(a.marketConditions)})]})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsxs("div",{className:"flex justify-between",children:[S.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Volatility Adjustment:"}),S.jsx("span",{className:y(a.volatilityAdjustment),children:x(a.volatilityAdjustment)})]}),S.jsxs("div",{className:"flex justify-between",children:[S.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Volume Confirmation:"}),S.jsx("span",{className:y(a.volumeConfirmation),children:x(a.volumeConfirmation)})]}),S.jsxs("div",{className:"flex justify-between",children:[S.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Structural Integrity:"}),S.jsx("span",{className:y(a.structuralIntegrity),children:x(a.structuralIntegrity)})]})]})]})]}),S.jsxs("div",{children:[S.jsx("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Quality Metrics"}),S.jsxs("div",{className:"grid grid-cols-3 gap-3 text-sm",children:[S.jsxs("div",{className:"text-center",children:[S.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Data Quality"}),S.jsx("div",{className:y(h.qualityMetrics.dataQuality),children:x(h.qualityMetrics.dataQuality)})]}),S.jsxs("div",{className:"text-center",children:[S.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Signal Clarity"}),S.jsx("div",{className:y(h.qualityMetrics.signalClarity),children:x(h.qualityMetrics.signalClarity)})]}),S.jsxs("div",{className:"text-center",children:[S.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Market Noise"}),S.jsx("div",{className:y(100-h.qualityMetrics.marketNoise),children:x(h.qualityMetrics.marketNoise)})]})]})]}),S.jsxs("div",{children:[S.jsx("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Historical Context"}),S.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded p-3 text-sm",children:S.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[S.jsxs("div",{children:[S.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Similar Patterns"}),S.jsx("div",{className:"font-medium",children:m.similarPatternCount})]}),S.jsxs("div",{children:[S.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Success Rate"}),S.jsx("div",{className:`font-medium ${y(m.successRate)}`,children:x(m.successRate)})]}),S.jsxs("div",{children:[S.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Avg Win"}),S.jsxs("div",{className:"font-medium text-green-600 dark:text-green-400",children:["+",m.avgReturnOnSuccess,"%"]})]}),S.jsxs("div",{children:[S.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Avg Loss"}),S.jsxs("div",{className:"font-medium text-red-600 dark:text-red-400",children:[m.avgLossOnFailure,"%"]})]})]})})]}),(p.volatilityPenalty>0||p.liquidityDiscount>0||p.newsRisk>0)&&S.jsxs("div",{children:[S.jsx("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Risk Adjustments"}),S.jsxs("div",{className:"space-y-1 text-sm",children:[p.volatilityPenalty>0&&S.jsxs("div",{className:"flex justify-between text-red-600 dark:text-red-400",children:[S.jsx("span",{children:"Volatility Penalty:"}),S.jsxs("span",{children:["-",p.volatilityPenalty,"%"]})]}),p.liquidityDiscount>0&&S.jsxs("div",{className:"flex justify-between text-orange-600 dark:text-orange-400",children:[S.jsx("span",{children:"Liquidity Discount:"}),S.jsxs("span",{children:["-",p.liquidityDiscount,"%"]})]}),p.newsRisk>0&&S.jsxs("div",{className:"flex justify-between text-yellow-600 dark:text-yellow-400",children:[S.jsx("span",{children:"News Risk:"}),S.jsxs("span",{children:["-",p.newsRisk,"%"]})]})]})]}),S.jsxs("div",{children:[S.jsx("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Factor Contributions to Final Score"}),S.jsx("div",{className:"space-y-1 text-xs",children:Object.entries(h.factorContributions).map(([C,_])=>S.jsxs("div",{className:"flex justify-between",children:[S.jsxs("span",{className:"text-gray-600 dark:text-gray-400 capitalize",children:[C.replace(/([A-Z])/g," $1").toLowerCase(),":"]}),S.jsxs("span",{className:y(_),children:["+",_]})]},C))})]})]})]})},Lx=()=>S.jsx("div",{className:"w-8 h-8 rounded-full bg-accent-blue flex items-center justify-center font-bold text-white flex-shrink-0",children:"U"}),Px=()=>S.jsx("div",{className:"w-8 h-8 rounded-full bg-sidebar-bg border border-border-color flex items-center justify-center flex-shrink-0",children:S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5 text-accent-blue",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456Z"})})}),Pp=({content:n})=>{const e=Be.parse(n,{gfm:!0,breaks:!0});return S.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:e}})},Ux=({result:n})=>{const[e,t]=le.useState(!1),i=n.signal==="BUY"?"text-accent-green":n.signal==="SELL"?"text-accent-red":"text-accent-yellow",r=n.signal==="BUY"?"bg-accent-green-10":n.signal==="SELL"?"bg-accent-red-10":"bg-accent-yellow-10",a=()=>{let c=`Wizz AI Analysis
---
`;if(c+=`Summary: ${n.summary}
`,c+=`Signal: ${n.signal} (${n.confidence} Confidence)
`,n.trade&&n.confidence==="HIGH"&&(c+=`Entry Price: ${n.trade.entryPrice}
`,c+=`Take Profit: ${n.trade.takeProfit}
`,c+=`Stop Loss: ${n.trade.stopLoss}
`),n.riskRewardRatio&&(c+=`Risk/Reward Ratio: ${n.riskRewardRatio}
`),n.calibratedConfidence){const h=n.calibratedConfidence;c+=`Enhanced Confidence: ${h.overallScore}% ${h.interval.uncertainty}% (${h.interval.reliability.toLowerCase()} reliability)
`,c+=`Factors - Technical: ${h.factors.technicalConfluence}%, Historical: ${h.factors.historicalPatternSuccess}%, Market: ${h.factors.marketConditions}%`}else c+=`AI Confidence Score: ${n.overallConfidenceScore}/100`;navigator.clipboard.writeText(c).then(()=>{t(!0),setTimeout(()=>t(!1),2e3)})};return S.jsxs("div",{className:"border border-border-color rounded-lg space-y-4 bg-sidebar-bg relative",children:[S.jsx("div",{className:"absolute top-2 right-2",children:S.jsx("button",{onClick:a,className:"p-1.5 rounded-md text-text-secondary hover:bg-input-bg hover:text-text-primary transition-colors","aria-label":"Copy analysis to clipboard",children:e?S.jsx(Ix,{className:"h-4 w-4 text-accent-green"}):S.jsx(kx,{className:"h-4 w-4"})})}),S.jsxs("div",{className:"p-4 space-y-4",children:[S.jsxs("div",{children:[S.jsx("h3",{className:"font-semibold text-text-primary mb-1",children:"Summary"}),S.jsx("p",{className:"text-sm text-text-secondary",children:n.summary})]}),S.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[S.jsxs("div",{className:`p-3 rounded-lg ${r}`,children:[S.jsx("h4",{className:"text-xs font-semibold text-text-secondary mb-1",children:"Signal"}),S.jsx("p",{className:`text-lg font-bold ${i}`,children:n.signal})]}),S.jsxs("div",{className:"p-3 rounded-lg bg-input-bg-50",children:[S.jsx("h4",{className:"text-xs font-semibold text-text-secondary mb-1",children:"Confidence"}),S.jsx("p",{className:`text-lg font-bold ${n.confidence==="HIGH"?"text-text-primary":"text-text-secondary"}`,children:n.confidence})]})]}),n.timeframe&&S.jsxs("div",{children:[S.jsx("h3",{className:"font-semibold text-text-primary mb-2",children:"Analysis Context"}),S.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[S.jsxs("div",{className:"bg-input-bg-50 p-2 rounded-md",children:[S.jsx("span",{className:"text-text-secondary block text-xs",children:"Chart Timeframe"}),S.jsx("span",{className:"font-mono text-text-primary",children:n.timeframe})]}),n.riskRewardRatio&&S.jsxs("div",{className:"bg-input-bg-50 p-2 rounded-md",children:[S.jsx("span",{className:"text-text-secondary block text-xs",children:"Risk/Reward Ratio"}),S.jsx("span",{className:"font-mono text-text-primary",children:n.riskRewardRatio})]})]})]}),n.trade&&n.confidence==="HIGH"&&S.jsxs("div",{children:[S.jsx("h3",{className:"font-semibold text-text-primary mb-2",children:"Trade Details"}),S.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm",children:[S.jsxs("div",{className:"bg-input-bg-50 p-2 rounded-md",children:[S.jsx("span",{className:"text-text-secondary block text-xs",children:"Entry Price"}),S.jsx("span",{className:"font-mono text-text-primary",children:n.trade.entryPrice})]}),S.jsxs("div",{className:"bg-input-bg-50 p-2 rounded-md",children:[S.jsx("span",{className:"text-text-secondary block text-xs",children:"Take Profit"}),S.jsx("span",{className:"font-mono text-accent-green",children:n.trade.takeProfit})]}),S.jsxs("div",{className:"bg-input-bg-50 p-2 rounded-md",children:[S.jsx("span",{className:"text-text-secondary block text-xs",children:"Stop Loss"}),S.jsx("span",{className:"font-mono text-accent-red",children:n.trade.stopLoss})]})]})]}),n.confidence==="LOW"&&S.jsx("p",{className:"text-xs text-center text-text-secondary italic",children:"No trade signal provided due to low confidence."}),n.isMultiTimeframeAnalysis&&n.multiTimeframeContext&&S.jsxs("div",{children:[S.jsx("h3",{className:"font-semibold text-text-primary mb-2",children:"Multi-Timeframe Confluence"}),S.jsxs("div",{className:"bg-input-bg-50 p-3 rounded-lg space-y-3",children:[S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsx("span",{className:"text-sm font-medium text-text-secondary",children:"Confluence Score"}),S.jsxs("span",{className:"text-lg font-bold text-text-primary",children:[n.multiTimeframeContext.confluenceScore,"/100"]})]}),S.jsx("div",{className:"w-full bg-border-color rounded-full h-2.5",children:S.jsx("div",{className:"bg-accent-green h-2.5 rounded-full",style:{width:`${n.multiTimeframeContext.confluenceScore}%`}})}),S.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[S.jsxs("div",{children:[S.jsx("span",{className:"text-text-secondary",children:"Overall Trend:"}),S.jsx("span",{className:`ml-1 font-medium ${n.multiTimeframeContext.overallTrend==="BULLISH"?"text-accent-green":n.multiTimeframeContext.overallTrend==="BEARISH"?"text-accent-red":n.multiTimeframeContext.overallTrend==="MIXED"?"text-accent-yellow":"text-text-secondary"}`,children:n.multiTimeframeContext.overallTrend})]}),S.jsxs("div",{children:[S.jsx("span",{className:"text-text-secondary",children:"Primary TF:"}),S.jsx("span",{className:"ml-1 font-medium text-text-primary",children:n.multiTimeframeContext.primaryTimeframe})]})]}),S.jsxs("div",{className:"border-t border-border-color pt-2",children:[S.jsx("div",{className:"text-xs font-medium text-text-secondary mb-2",children:"Timeframe Analysis:"}),S.jsx("div",{className:"space-y-1",children:n.multiTimeframeContext.timeframeAnalyses.map((c,h)=>S.jsxs("div",{className:"flex justify-between items-center text-xs",children:[S.jsx("span",{className:"font-medium",children:c.timeframe}),S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs ${c.trend==="BULLISH"?"bg-accent-green-10 text-accent-green":c.trend==="BEARISH"?"bg-accent-red-10 text-accent-red":c.trend==="CONSOLIDATING"?"bg-accent-yellow-10 text-accent-yellow":"bg-input-bg text-text-secondary"}`,children:c.trend}),S.jsxs("span",{className:"text-text-secondary",children:[c.confidence,"%"]})]})]},h))})]}),n.multiTimeframeContext.conflictingSignals&&n.multiTimeframeContext.conflictingSignals.length>0&&S.jsxs("div",{className:"border-t border-border-color pt-2",children:[S.jsx("div",{className:"text-xs font-medium text-accent-red mb-1",children:"Conflicting Signals:"}),S.jsx("ul",{className:"text-xs text-text-secondary space-y-0.5",children:n.multiTimeframeContext.conflictingSignals.map((c,h)=>S.jsxs("li",{className:"flex items-start",children:[S.jsx("span",{className:"text-accent-red mr-1",children:""}),c]},h))})]})]})]}),n.hasSMCAnalysis&&n.smcAnalysis&&S.jsxs("div",{children:[S.jsx("h3",{className:"font-semibold text-text-primary mb-2",children:"Smart Money Concepts Analysis"}),S.jsxs("div",{className:"bg-input-bg-50 p-3 rounded-lg space-y-3",children:[S.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[S.jsxs("div",{children:[S.jsx("span",{className:"text-sm font-medium text-text-secondary",children:"Market Structure:"}),S.jsx("span",{className:`ml-2 px-2 py-1 rounded text-xs font-medium ${n.smcAnalysis.overallStructure==="BULLISH_STRUCTURE"?"bg-accent-green-10 text-accent-green":n.smcAnalysis.overallStructure==="BEARISH_STRUCTURE"?"bg-accent-red-10 text-accent-red":n.smcAnalysis.overallStructure==="RANGING"?"bg-accent-yellow-10 text-accent-yellow":"bg-input-bg text-text-secondary"}`,children:n.smcAnalysis.overallStructure.replace("_"," ")})]}),S.jsxs("div",{children:[S.jsx("span",{className:"text-sm font-medium text-text-secondary",children:"Market Phase:"}),S.jsx("span",{className:"ml-2 text-sm font-medium text-text-primary",children:n.smcAnalysis.marketPhase})]})]}),S.jsxs("div",{className:"border-t border-border-color pt-3",children:[S.jsxs("div",{className:"flex justify-between items-center mb-2",children:[S.jsx("span",{className:"text-sm font-medium text-text-secondary",children:"Trading Bias"}),S.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${n.smcAnalysis.tradingBias.direction==="BULLISH"?"bg-accent-green-10 text-accent-green":n.smcAnalysis.tradingBias.direction==="BEARISH"?"bg-accent-red-10 text-accent-red":"bg-input-bg text-text-secondary"}`,children:n.smcAnalysis.tradingBias.direction})]}),S.jsxs("div",{className:"flex justify-between items-center mb-1",children:[S.jsx("span",{className:"text-xs text-text-secondary",children:"SMC Confidence:"}),S.jsxs("span",{className:"text-sm font-medium",children:[n.smcAnalysis.tradingBias.confidence,"%"]})]}),S.jsx("div",{className:"w-full bg-border-color rounded-full h-2",children:S.jsx("div",{className:"bg-accent-purple h-2 rounded-full",style:{width:`${n.smcAnalysis.tradingBias.confidence}%`}})}),S.jsx("p",{className:"text-xs text-text-secondary mt-2",children:n.smcAnalysis.tradingBias.reasoning})]}),n.smcAnalysis.criticalLevels.orderBlocks&&n.smcAnalysis.criticalLevels.orderBlocks.length>0&&S.jsxs("div",{className:"border-t border-border-color pt-3",children:[S.jsx("div",{className:"text-sm font-medium text-text-secondary mb-2",children:"Order Blocks"}),S.jsx("div",{className:"space-y-2",children:n.smcAnalysis.criticalLevels.orderBlocks.map((c,h)=>S.jsxs("div",{className:"flex justify-between items-center text-xs bg-input-bg p-2 rounded",children:[S.jsxs("div",{className:"flex items-center space-x-2",children:[S.jsx("span",{className:`px-1.5 py-0.5 rounded ${c.type==="BULLISH_OB"?"bg-accent-green-10 text-accent-green":"bg-accent-red-10 text-accent-red"}`,children:c.type==="BULLISH_OB"?"Bull OB":"Bear OB"}),S.jsx("span",{className:"font-mono text-text-primary",children:c.price})]}),S.jsxs("div",{className:"flex items-center space-x-2",children:[S.jsx("span",{className:`text-xs ${c.mitigated?"text-accent-red":"text-accent-green"}`,children:c.mitigated?"Mitigated":"Active"}),S.jsx("span",{className:"text-text-secondary",children:c.strength})]})]},h))})]}),n.smcAnalysis.criticalLevels.fairValueGaps&&n.smcAnalysis.criticalLevels.fairValueGaps.length>0&&S.jsxs("div",{className:"border-t border-border-color pt-3",children:[S.jsx("div",{className:"text-sm font-medium text-text-secondary mb-2",children:"Fair Value Gaps"}),S.jsx("div",{className:"space-y-2",children:n.smcAnalysis.criticalLevels.fairValueGaps.map((c,h)=>S.jsxs("div",{className:"flex justify-between items-center text-xs bg-input-bg p-2 rounded",children:[S.jsxs("div",{className:"flex items-center space-x-2",children:[S.jsx("span",{className:`px-1.5 py-0.5 rounded ${c.type==="BULLISH_FVG"?"bg-accent-green-10 text-accent-green":"bg-accent-red-10 text-accent-red"}`,children:c.type==="BULLISH_FVG"?"Bull FVG":"Bear FVG"}),S.jsx("span",{className:"font-mono text-text-primary",children:c.priceRange})]}),S.jsxs("div",{className:"flex items-center space-x-2",children:[S.jsx("span",{className:`text-xs ${c.filled?"text-accent-red":"text-accent-green"}`,children:c.filled?"Filled":"Open"}),S.jsx("span",{className:"text-text-secondary",children:c.significance})]})]},h))})]}),n.smcAnalysis.criticalLevels.liquidityLevels&&n.smcAnalysis.criticalLevels.liquidityLevels.length>0&&S.jsxs("div",{className:"border-t border-border-color pt-3",children:[S.jsx("div",{className:"text-sm font-medium text-text-secondary mb-2",children:"Liquidity Levels"}),S.jsx("div",{className:"space-y-2",children:n.smcAnalysis.criticalLevels.liquidityLevels.map((c,h)=>S.jsxs("div",{className:"flex justify-between items-center text-xs bg-input-bg p-2 rounded",children:[S.jsxs("div",{className:"flex items-center space-x-2",children:[S.jsx("span",{className:`px-1.5 py-0.5 rounded ${c.type==="BUY_SIDE_LIQUIDITY"?"bg-accent-green-10 text-accent-green":c.type==="SELL_SIDE_LIQUIDITY"?"bg-accent-red-10 text-accent-red":"bg-accent-yellow-10 text-accent-yellow"}`,children:c.type==="BUY_SIDE_LIQUIDITY"?"BSL":c.type==="SELL_SIDE_LIQUIDITY"?"SSL":"Both"}),S.jsx("span",{className:"font-mono text-text-primary",children:c.price})]}),S.jsxs("div",{className:"flex items-center space-x-2",children:[S.jsx("span",{className:`text-xs ${c.swept?"text-accent-red":"text-accent-green"}`,children:c.swept?"Swept":"Active"}),S.jsx("span",{className:"text-text-secondary",children:c.significance})]})]},h))})]}),n.smcAnalysis.displacement.detected&&S.jsxs("div",{className:"border-t border-border-color pt-3",children:[S.jsx("div",{className:"text-sm font-medium text-text-secondary mb-2",children:"Displacement Detected"}),S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsxs("span",{className:`px-2 py-1 rounded text-xs font-medium ${n.smcAnalysis.displacement.direction==="BULLISH"?"bg-accent-green-10 text-accent-green":"bg-accent-red-10 text-accent-red"}`,children:[n.smcAnalysis.displacement.direction," Displacement"]}),S.jsxs("span",{className:"text-sm font-medium text-text-primary",children:[n.smcAnalysis.displacement.strength," Strength"]})]})]})]})]}),S.jsxs("div",{children:[S.jsx("h3",{className:"font-semibold text-text-primary mb-2",children:n.isMultiTimeframeAnalysis?"Final Verification":"Verification"}),n.calibratedConfidence?S.jsx(Dx,{calibratedConfidence:n.calibratedConfidence,className:"mb-3"}):S.jsxs("div",{className:"bg-input-bg-50 p-3 rounded-lg space-y-2 mb-3",children:[S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsx("span",{className:"text-sm font-medium text-text-secondary",children:"AI Confidence Score"}),S.jsxs("span",{className:"text-lg font-bold text-text-primary",children:[n.overallConfidenceScore,"/100"]})]}),S.jsx("div",{className:"w-full bg-border-color rounded-full h-2.5",children:S.jsx("div",{className:"bg-accent-blue h-2.5 rounded-full",style:{width:`${n.overallConfidenceScore}%`}})})]}),S.jsx("div",{className:"bg-input-bg-50 p-3 rounded-lg",children:S.jsx("p",{className:"text-xs text-text-secondary",children:n.verificationSummary})})]})]})]})},Ox=Ps.memo(({message:n,isLastMessage:e,isLoading:t,onRegenerate:i})=>{const r=n.role==="user",{content:a,thinkingText:c}=n;if(r){const m=[];Array.isArray(n.images)&&n.images.length>0?m.push(...n.images):n.image&&m.push(n.image);const p=n.timeframeImages,y=p&&p.length>0;return S.jsxs("div",{className:"flex items-start gap-4 justify-end",children:[S.jsxs("div",{className:"flex-1 max-w-2xl bg-accent-blue rounded-lg p-3 text-white",children:[typeof a=="string"&&a&&S.jsx("p",{className:"whitespace-pre-wrap",children:a}),m.length>0&&!y&&S.jsx("div",{className:"mt-2 grid grid-cols-2 md:grid-cols-3 gap-2",children:m.map((T,x)=>S.jsx("img",{src:T,alt:`User upload ${x+1}`,className:"max-w-xs max-h-64 rounded-md border border-blue-400"},x))}),y&&S.jsxs("div",{className:"mt-2 space-y-2",children:[S.jsx("div",{className:"text-xs font-medium opacity-90",children:"Multi-Timeframe Analysis:"}),S.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:p.map((T,x)=>S.jsxs("div",{className:"bg-white bg-opacity-10 rounded-lg p-2",children:[S.jsxs("div",{className:"text-xs font-medium mb-1",children:[T.timeframe," ",T.label&&`- ${T.label}`]}),S.jsx("img",{src:`data:${T.imageData.mimeType};base64,${T.imageData.data}`,alt:`${T.timeframe} chart`,className:"w-full max-h-48 object-cover rounded border border-blue-400"})]},x))})]})]}),S.jsx(Lx,{})]})}const h=typeof a=="string"&&(a.startsWith("Error:")||a.startsWith("Sorry, I encountered an error")||a==="Response stopped by user."||a==="An unexpected error occurred. Please try again.");return S.jsxs("div",{className:"flex items-start gap-4",children:[S.jsx(Px,{}),S.jsxs("div",{className:"flex-1 max-w-2xl space-y-4",children:[t&&S.jsxs("div",{className:"flex items-center gap-2 text-text-secondary",children:[S.jsx("div",{className:"h-5 w-5 border-2 border-t-transparent border-accent-blue rounded-full animate-spin"}),S.jsx("span",{children:"Wizz is analyzing..."})]}),c&&S.jsx(Pp,{content:c}),typeof a=="object"&&S.jsx(Ux,{result:a}),typeof a=="string"&&a&&(h?S.jsx("p",{className:"text-text-secondary italic",children:a}):S.jsx(Pp,{content:a})),e&&n.role==="assistant"&&!t&&n.content&&S.jsx("div",{className:"!mt-2 flex justify-start",children:S.jsxs("button",{onClick:i,className:"flex items-center gap-1.5 text-xs text-text-secondary hover:text-text-primary px-2 py-1 rounded-md hover:bg-input-bg transition-colors","aria-label":"Regenerate response",children:[S.jsx(Nx,{className:"h-4 w-4"}),S.jsx("span",{children:"Regenerate"})]})})]})]})}),Bx=({regimeContext:n,className:e=""})=>{if(!n)return S.jsx("div",{className:`bg-gray-800/50 border border-gray-700 rounded-lg p-4 ${e}`,children:S.jsxs("div",{className:"flex items-center space-x-2",children:[S.jsx("div",{className:"w-3 h-3 bg-gray-500 rounded-full animate-pulse"}),S.jsx("span",{className:"text-gray-400 text-sm",children:"Market regime analysis unavailable"})]})});const t=h=>h.includes("BULL")?"text-green-400":h.includes("BEAR")?"text-red-400":h.includes("NEUTRAL")?"text-yellow-400":h.includes("TRANSITIONAL")?"text-purple-400":"text-gray-400",i=h=>h.includes("BULL_TRENDING")?"":h.includes("BEAR_TRENDING")?"":h.includes("BULL_RANGING")?"":h.includes("BEAR_RANGING")?"":h.includes("NEUTRAL_TRENDING")?"":h.includes("NEUTRAL_RANGING")?"":h.includes("TRANSITIONAL")?"":"",r=h=>{switch(h){case"LOW":return"text-blue-400";case"NORMAL":return"text-green-400";case"HIGH":return"text-orange-400";case"EXTREME":return"text-red-400";default:return"text-gray-400"}},a=h=>h>=80?"text-green-400":h>=60?"text-yellow-400":h>=40?"text-orange-400":"text-red-400",c=h=>h>=80?"text-green-400":h>=60?"text-yellow-400":h>=40?"text-orange-400":"text-red-400";return S.jsxs("div",{className:`bg-gray-800/50 border border-gray-700 rounded-lg p-4 space-y-4 ${e}`,children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{className:"flex items-center space-x-2",children:[S.jsx("span",{className:"text-lg",children:i(n.overallRegime)}),S.jsx("h3",{className:"text-lg font-semibold text-white",children:"Market Regime"})]}),S.jsx("div",{className:"flex items-center space-x-4",children:S.jsxs("div",{className:"text-right",children:[S.jsxs("div",{className:`text-sm font-medium ${a(n.confidence)}`,children:[n.confidence,"% Confidence"]}),S.jsxs("div",{className:`text-xs ${c(n.stability)}`,children:[n.stability,"% Stable"]})]})})]}),S.jsx("div",{className:"bg-gray-900/50 rounded-lg p-3",children:S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsx("span",{className:"text-gray-400 text-sm",children:"Overall Regime"}),S.jsx("span",{className:`font-semibold ${t(n.overallRegime)}`,children:n.overallRegime.replace(/_/g," ")})]})}),S.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[S.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-3",children:[S.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Trend"}),S.jsx("div",{className:`text-sm font-medium ${t(n.trendRegime)}`,children:n.trendRegime.replace(/_/g," ")}),S.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["ADX: ",n.trendMetrics.adx.toFixed(1)]})]}),S.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-3",children:[S.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Direction"}),S.jsx("div",{className:`text-sm font-medium ${n.directionRegime==="TRENDING"?"text-blue-400":n.directionRegime==="RANGING"?"text-orange-400":"text-purple-400"}`,children:n.directionRegime}),S.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Efficiency: ",n.rangingMetrics.efficiency.toFixed(0),"%"]})]}),S.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-3",children:[S.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Volatility"}),S.jsx("div",{className:`text-sm font-medium ${r(n.volatilityRegime)}`,children:n.volatilityRegime}),S.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["ATR: ",n.volatilityMetrics.atrNormalized.toFixed(2),"%"]})]}),S.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-3",children:[S.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Momentum"}),S.jsx("div",{className:`text-sm font-medium ${n.momentumRegime==="ACCELERATING"?"text-green-400":n.momentumRegime==="DECELERATING"?"text-red-400":n.momentumRegime==="STABLE"?"text-blue-400":"text-yellow-400"}`,children:n.momentumRegime}),S.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["RSI: ",n.momentumMetrics.rsi.toFixed(0)]})]})]}),S.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-3",children:[S.jsx("div",{className:"text-sm font-medium text-white mb-2",children:"Analysis Adjustments"}),S.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[S.jsxs("div",{className:"flex justify-between",children:[S.jsx("span",{className:"text-gray-400",children:"Risk Multiplier:"}),S.jsxs("span",{className:`font-medium ${n.analysisAdjustments.riskMultiplier>1?"text-green-400":n.analysisAdjustments.riskMultiplier<1?"text-red-400":"text-gray-300"}`,children:[n.analysisAdjustments.riskMultiplier.toFixed(2),"x"]})]}),S.jsxs("div",{className:"flex justify-between",children:[S.jsx("span",{className:"text-gray-400",children:"Stop Adjustment:"}),S.jsxs("span",{className:`font-medium ${n.analysisAdjustments.stopLossAdjustment>1?"text-red-400":"text-green-400"}`,children:[n.analysisAdjustments.stopLossAdjustment.toFixed(2),"x"]})]}),S.jsxs("div",{className:"flex justify-between",children:[S.jsx("span",{className:"text-gray-400",children:"Target Adjustment:"}),S.jsxs("span",{className:`font-medium ${n.analysisAdjustments.takeProfitAdjustment>1?"text-green-400":"text-red-400"}`,children:[n.analysisAdjustments.takeProfitAdjustment.toFixed(2),"x"]})]}),S.jsxs("div",{className:"flex justify-between",children:[S.jsx("span",{className:"text-gray-400",children:"Entry Approach:"}),S.jsx("span",{className:`font-medium ${n.analysisAdjustments.entryApproach==="AGGRESSIVE"?"text-red-400":n.analysisAdjustments.entryApproach==="CONSERVATIVE"?"text-blue-400":n.analysisAdjustments.entryApproach==="PATIENT"?"text-green-400":"text-purple-400"}`,children:n.analysisAdjustments.entryApproach})]})]})]}),(n.warnings.length>0||n.opportunities.length>0)&&S.jsxs("div",{className:"space-y-2",children:[n.warnings.length>0&&S.jsxs("div",{className:"bg-red-900/20 border border-red-700/50 rounded-lg p-3",children:[S.jsx("div",{className:"text-sm font-medium text-red-400 mb-1",children:" Warnings"}),S.jsx("ul",{className:"text-xs text-red-300 space-y-1",children:n.warnings.map((h,m)=>S.jsxs("li",{className:"flex items-start space-x-2",children:[S.jsx("span",{className:"text-red-500 mt-0.5",children:""}),S.jsx("span",{children:h})]},m))})]}),n.opportunities.length>0&&S.jsxs("div",{className:"bg-green-900/20 border border-green-700/50 rounded-lg p-3",children:[S.jsx("div",{className:"text-sm font-medium text-green-400 mb-1",children:" Opportunities"}),S.jsx("ul",{className:"text-xs text-green-300 space-y-1",children:n.opportunities.map((h,m)=>S.jsxs("li",{className:"flex items-start space-x-2",children:[S.jsx("span",{className:"text-green-500 mt-0.5",children:""}),S.jsx("span",{children:h})]},m))})]})]}),S.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-3",children:[S.jsx("div",{className:"text-sm font-medium text-white mb-2",children:"Historical Context"}),S.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[S.jsxs("div",{className:"flex justify-between",children:[S.jsx("span",{className:"text-gray-400",children:"Time in Regime:"}),S.jsxs("span",{className:"text-gray-300",children:[n.regimeHistory.timeInCurrentRegime.toFixed(1),"h"]})]}),S.jsxs("div",{className:"flex justify-between",children:[S.jsx("span",{className:"text-gray-400",children:"Recent Changes:"}),S.jsx("span",{className:`font-medium ${n.regimeHistory.recentRegimeChanges>3?"text-red-400":n.regimeHistory.recentRegimeChanges>1?"text-yellow-400":"text-green-400"}`,children:n.regimeHistory.recentRegimeChanges})]})]})]}),S.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[S.jsxs("span",{children:["Last Updated: ",new Date(n.timestamp).toLocaleTimeString()]}),S.jsxs("span",{children:["Next Review: ",new Date(n.nextReviewTime).toLocaleTimeString()]})]})]})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Hx,Vx;function Gx(){return{geminiUrl:Hx,vertexUrl:Vx}}function qx(n,e,t,i){var r,a;if(!(n!=null&&n.baseUrl)){const c=Gx();return e?(r=c.vertexUrl)!==null&&r!==void 0?r:t:(a=c.geminiUrl)!==null&&a!==void 0?a:i}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ni{}function me(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(i,r)=>{if(Object.prototype.hasOwnProperty.call(e,r)){const a=e[r];return a!=null?String(a):""}else throw new Error(`Key '${r}' not found in valueMap.`)})}function d(n,e,t){for(let a=0;a<e.length-1;a++){const c=e[a];if(c.endsWith("[]")){const h=c.slice(0,-2);if(!(h in n))if(Array.isArray(t))n[h]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${c}`);if(Array.isArray(n[h])){const m=n[h];if(Array.isArray(t))for(let p=0;p<m.length;p++){const y=m[p];d(y,e.slice(a+1),t[p])}else for(const p of m)d(p,e.slice(a+1),t)}return}else if(c.endsWith("[0]")){const h=c.slice(0,-3);h in n||(n[h]=[{}]);const m=n[h];d(m[0],e.slice(a+1),t);return}(!n[c]||typeof n[c]!="object")&&(n[c]={}),n=n[c]}const i=e[e.length-1],r=n[i];if(r!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===r)return;if(typeof r=="object"&&typeof t=="object"&&r!==null&&t!==null)Object.assign(r,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else n[i]=t}function u(n,e){try{if(e.length===1&&e[0]==="_self")return n;for(let t=0;t<e.length;t++){if(typeof n!="object"||n===null)return;const i=e[t];if(i.endsWith("[]")){const r=i.slice(0,-2);if(r in n){const a=n[r];return Array.isArray(a)?a.map(c=>u(c,e.slice(t+1))):void 0}else return}else n=n[i]}return n}catch(t){if(t instanceof TypeError)return;throw t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Du(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Up;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Up||(Up={}));var Op;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(Op||(Op={}));var B;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(B||(B={}));var Bp;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(Bp||(Bp={}));var Hp;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(Hp||(Hp={}));var Vp;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(Vp||(Vp={}));var Gp;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(Gp||(Gp={}));var qp;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(qp||(qp={}));var zp;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(zp||(zp={}));var $p;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})($p||($p={}));var Fp;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Fp||(Fp={}));var Yp;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(Yp||(Yp={}));var Jp;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(Jp||(Jp={}));var jp;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(jp||(jp={}));var Kp;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY"})(Kp||(Kp={}));var Wp;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Wp||(Wp={}));var $a;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})($a||($a={}));var Xp;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Xp||(Xp={}));var Lu;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Lu||(Lu={}));var Qp;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Qp||(Qp={}));var Zp;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(Zp||(Zp={}));var eg;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(eg||(eg={}));var tg;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(tg||(tg={}));var ng;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE"})(ng||(ng={}));var ig;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(ig||(ig={}));var sg;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(sg||(sg={}));var og;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(og||(og={}));var rg;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(rg||(rg={}));var ag;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(ag||(ag={}));var lg;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(lg||(lg={}));var cg;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(cg||(cg={}));var ug;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(ug||(ug={}));var dg;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(dg||(dg={}));var fg;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(fg||(fg={}));var hg;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(hg||(hg={}));var mg;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(mg||(mg={}));var pg;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(pg||(pg={}));var gg;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(gg||(gg={}));var yg;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(yg||(yg={}));var vg;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(vg||(vg={}));var Tg;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Tg||(Tg={}));var Sg;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(Sg||(Sg={}));var Us;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(Us||(Us={}));class Pu{constructor(e){const t={};for(const i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class Xo{get text(){var e,t,i,r,a,c,h,m;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let p="",y=!1;const T=[];for(const x of(m=(h=(c=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||c===void 0?void 0:c.content)===null||h===void 0?void 0:h.parts)!==null&&m!==void 0?m:[]){for(const[C,_]of Object.entries(x))C!=="text"&&C!=="thought"&&(_!==null||_!==void 0)&&T.push(C);if(typeof x.text=="string"){if(typeof x.thought=="boolean"&&x.thought)continue;y=!0,p+=x.text}}return T.length>0&&console.warn(`there are non-text parts ${T} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),y?p:void 0}get data(){var e,t,i,r,a,c,h,m;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let p="";const y=[];for(const T of(m=(h=(c=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||c===void 0?void 0:c.content)===null||h===void 0?void 0:h.parts)!==null&&m!==void 0?m:[]){for(const[x,C]of Object.entries(T))x!=="inlineData"&&(C!==null||C!==void 0)&&y.push(x);T.inlineData&&typeof T.inlineData.data=="string"&&(p+=atob(T.inlineData.data))}return y.length>0&&console.warn(`there are non-data parts ${y} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),p.length>0?btoa(p):void 0}get functionCalls(){var e,t,i,r,a,c,h,m;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const p=(m=(h=(c=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||c===void 0?void 0:c.content)===null||h===void 0?void 0:h.parts)===null||m===void 0?void 0:m.filter(y=>y.functionCall).map(y=>y.functionCall).filter(y=>y!==void 0);if((p==null?void 0:p.length)!==0)return p}get executableCode(){var e,t,i,r,a,c,h,m,p;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const y=(m=(h=(c=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||c===void 0?void 0:c.content)===null||h===void 0?void 0:h.parts)===null||m===void 0?void 0:m.filter(T=>T.executableCode).map(T=>T.executableCode).filter(T=>T!==void 0);if((y==null?void 0:y.length)!==0)return(p=y==null?void 0:y[0])===null||p===void 0?void 0:p.code}get codeExecutionResult(){var e,t,i,r,a,c,h,m,p;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const y=(m=(h=(c=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||c===void 0?void 0:c.content)===null||h===void 0?void 0:h.parts)===null||m===void 0?void 0:m.filter(T=>T.codeExecutionResult).map(T=>T.codeExecutionResult).filter(T=>T!==void 0);if((y==null?void 0:y.length)!==0)return(p=y==null?void 0:y[0])===null||p===void 0?void 0:p.output}}class xg{}class Eg{}class zx{}class $x{}class Fx{}class Cg{}class Ag{}class _g{}class Yx{}class wg{}class bg{}class Rg{}class Mg{}class Jx{}class jx{}class Kx{}class Ng{}class Wx{get text(){var e,t,i;let r="",a=!1;const c=[];for(const h of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[m,p]of Object.entries(h))m!=="text"&&m!=="thought"&&p!==null&&c.push(m);if(typeof h.text=="string"){if(typeof h.thought=="boolean"&&h.thought)continue;a=!0,r+=h.text}}return c.length>0&&console.warn(`there are non-text parts ${c} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),a?r:void 0}get data(){var e,t,i;let r="";const a=[];for(const c of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[h,m]of Object.entries(c))h!=="inlineData"&&m!==null&&a.push(h);c.inlineData&&typeof c.inlineData.data=="string"&&(r+=atob(c.inlineData.data))}return a.length>0&&console.warn(`there are non-data parts ${a} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),r.length>0?btoa(r):void 0}}class Fa{_fromAPIResponse({apiResponse:e,isVertexAI:t}){const i=new Fa;if(i.name=e.name,i.metadata=e.metadata,i.done=e.done,i.error=e.error,t){const r=e.response;if(r){const a=new wg,c=r.videos;a.generatedVideos=c==null?void 0:c.map(h=>({video:{uri:h.gcsUri,videoBytes:h.bytesBase64Encoded?Du(h.bytesBase64Encoded):void 0,mimeType:h.mimeType}})),a.raiMediaFilteredCount=r.raiMediaFilteredCount,a.raiMediaFilteredReasons=r.raiMediaFilteredReasons,i.response=a}}else{const r=e.response;if(r){const a=new wg,c=r.generateVideoResponse,h=c==null?void 0:c.generatedSamples;a.generatedVideos=h==null?void 0:h.map(m=>{const p=m.video;return{video:{uri:p==null?void 0:p.uri,videoBytes:p!=null&&p.encodedVideo?Du(p==null?void 0:p.encodedVideo):void 0,mimeType:m.encoding}}}),a.raiMediaFilteredCount=c==null?void 0:c.raiMediaFilteredCount,a.raiMediaFilteredReasons=c==null?void 0:c.raiMediaFilteredReasons,i.response=a}}return i}}class Xx{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Pe(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function $y(n,e){const t=Pe(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function Fy(n){return Array.isArray(n)?n.map(e=>Ya(e)):[Ya(n)]}function Ya(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function Yy(n){const e=Ya(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Jy(n){const e=Ya(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function kg(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function jy(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>kg(e)):[kg(n)]}function Uu(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function Ig(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function Dg(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function Tt(n){if(n==null)throw new Error("ContentUnion is required");return Uu(n)?n:{role:"user",parts:jy(n)}}function Ky(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const i=Tt(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){const t=Tt(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>Tt(t)):[Tt(e)]}function Jt(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(Ig(n)||Dg(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Tt(n)]}const e=[],t=[],i=Uu(n[0]);for(const r of n){const a=Uu(r);if(a!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)e.push(r);else{if(Ig(r)||Dg(r))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(r)}}return i||e.push({role:"user",parts:jy(t)}),e}function Qx(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(B).includes(t[0].toUpperCase())?t[0].toUpperCase():B.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of t)e.anyOf.push({type:Object.values(B).includes(i.toUpperCase())?i.toUpperCase():B.TYPE_UNSPECIFIED})}}function Bs(n){const e={},t=["items"],i=["anyOf"],r=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const a=n.anyOf;a!=null&&a.length==2&&(a[0].type==="null"?(e.nullable=!0,n=a[1]):a[1].type==="null"&&(e.nullable=!0,n=a[0])),n.type instanceof Array&&Qx(n.type,e);for(const[c,h]of Object.entries(n))if(h!=null)if(c=="type"){if(h==="null")throw new Error("type: null can not be the only possible type for the field.");if(h instanceof Array)continue;e.type=Object.values(B).includes(h.toUpperCase())?h.toUpperCase():B.TYPE_UNSPECIFIED}else if(t.includes(c))e[c]=Bs(h);else if(i.includes(c)){const m=[];for(const p of h){if(p.type=="null"){e.nullable=!0;continue}m.push(Bs(p))}e[c]=m}else if(r.includes(c)){const m={};for(const[p,y]of Object.entries(h))m[p]=Bs(y);e[c]=m}else{if(c==="additionalProperties")continue;e[c]=h}return e}function md(n){return Bs(n)}function pd(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function gd(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function qs(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Bs(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Bs(e.response));return n}function zs(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function Zx(n,e,t,i=1){const r=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:r?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:r?`${t}/${e}`:e}function bn(n,e){if(typeof e!="string")throw new Error("name must be a string");return Zx(n,e,"cachedContents")}function Wy(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function ki(n){return Du(n)}function eE(n){return n!=null&&typeof n=="object"&&"name"in n}function tE(n){return n!=null&&typeof n=="object"&&"video"in n}function nE(n){return n!=null&&typeof n=="object"&&"uri"in n}function Xy(n){var e;let t;if(eE(n)&&(t=n.name),!(nE(n)&&(t=n.uri,t===void 0))&&!(tE(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const r=t.split("files/")[1].match(/[a-z0-9]+/);if(r===null)throw new Error(`Could not extract file name from URI ${t}`);t=r[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function Qy(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function Zy(n){for(const e of["models","tunedModels","publisherModels"])if(iE(n,e))return n[e];return[]}function iE(n,e){return n!==null&&typeof n=="object"&&e in n}function sE(n,e={}){const t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function oE(n,e={}){const t=[],i=new Set;for(const r of n){const a=r.name;if(i.has(a))throw new Error(`Duplicate function name ${a} found in MCP tools. Please ensure function names are unique.`);i.add(a);const c=sE(r,e);c.functionDeclarations&&t.push(...c.functionDeclarations)}return{functionDeclarations:t}}function ev(n,e){if(typeof e!="string"&&!Array.isArray(e)){if(n&&n.isVertexAI()){if(e.gcsUri&&e.bigqueryUri)throw new Error("Only one of `gcsUri` or `bigqueryUri` can be set.");if(!e.gcsUri&&!e.bigqueryUri)throw new Error("One of `gcsUri` or `bigqueryUri` must be set.")}else{if(e.inlinedRequests&&e.fileName)throw new Error("Only one of `inlinedRequests` or `fileName` can be set.");if(!e.inlinedRequests&&!e.fileName)throw new Error("One of `inlinedRequests` or `fileName` must be set.")}return e}else{if(Array.isArray(e))return{inlinedRequests:e};if(typeof e=="string"){if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:[e]};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};if(e.startsWith("files/"))return{fileName:e}}}throw new Error(`Unsupported source: ${e}`)}function rE(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function $s(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function tv(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function aE(n){const e={},t=u(n,["fps"]);t!=null&&d(e,["fps"],t);const i=u(n,["endOffset"]);i!=null&&d(e,["endOffset"],i);const r=u(n,["startOffset"]);return r!=null&&d(e,["startOffset"],r),e}function lE(n){const e={};if(u(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=u(n,["data"]);t!=null&&d(e,["data"],t);const i=u(n,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function cE(n){const e={};if(u(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=u(n,["fileUri"]);t!=null&&d(e,["fileUri"],t);const i=u(n,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function uE(n){const e={},t=u(n,["videoMetadata"]);t!=null&&d(e,["videoMetadata"],aE(t));const i=u(n,["thought"]);i!=null&&d(e,["thought"],i);const r=u(n,["inlineData"]);r!=null&&d(e,["inlineData"],lE(r));const a=u(n,["fileData"]);a!=null&&d(e,["fileData"],cE(a));const c=u(n,["thoughtSignature"]);c!=null&&d(e,["thoughtSignature"],c);const h=u(n,["codeExecutionResult"]);h!=null&&d(e,["codeExecutionResult"],h);const m=u(n,["executableCode"]);m!=null&&d(e,["executableCode"],m);const p=u(n,["functionCall"]);p!=null&&d(e,["functionCall"],p);const y=u(n,["functionResponse"]);y!=null&&d(e,["functionResponse"],y);const T=u(n,["text"]);return T!=null&&d(e,["text"],T),e}function nv(n){const e={},t=u(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>uE(a))),d(e,["parts"],r)}const i=u(n,["role"]);return i!=null&&d(e,["role"],i),e}function dE(n){const e={},t=u(n,["anyOf"]);t!=null&&d(e,["anyOf"],t);const i=u(n,["default"]);i!=null&&d(e,["default"],i);const r=u(n,["description"]);r!=null&&d(e,["description"],r);const a=u(n,["enum"]);a!=null&&d(e,["enum"],a);const c=u(n,["example"]);c!=null&&d(e,["example"],c);const h=u(n,["format"]);h!=null&&d(e,["format"],h);const m=u(n,["items"]);m!=null&&d(e,["items"],m);const p=u(n,["maxItems"]);p!=null&&d(e,["maxItems"],p);const y=u(n,["maxLength"]);y!=null&&d(e,["maxLength"],y);const T=u(n,["maxProperties"]);T!=null&&d(e,["maxProperties"],T);const x=u(n,["maximum"]);x!=null&&d(e,["maximum"],x);const C=u(n,["minItems"]);C!=null&&d(e,["minItems"],C);const _=u(n,["minLength"]);_!=null&&d(e,["minLength"],_);const w=u(n,["minProperties"]);w!=null&&d(e,["minProperties"],w);const N=u(n,["minimum"]);N!=null&&d(e,["minimum"],N);const H=u(n,["nullable"]);H!=null&&d(e,["nullable"],H);const K=u(n,["pattern"]);K!=null&&d(e,["pattern"],K);const I=u(n,["properties"]);I!=null&&d(e,["properties"],I);const Q=u(n,["propertyOrdering"]);Q!=null&&d(e,["propertyOrdering"],Q);const Y=u(n,["required"]);Y!=null&&d(e,["required"],Y);const oe=u(n,["title"]);oe!=null&&d(e,["title"],oe);const ce=u(n,["type"]);return ce!=null&&d(e,["type"],ce),e}function fE(n){const e={};if(u(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=u(n,["category"]);t!=null&&d(e,["category"],t);const i=u(n,["threshold"]);return i!=null&&d(e,["threshold"],i),e}function hE(n){const e={},t=u(n,["behavior"]);t!=null&&d(e,["behavior"],t);const i=u(n,["description"]);i!=null&&d(e,["description"],i);const r=u(n,["name"]);r!=null&&d(e,["name"],r);const a=u(n,["parameters"]);a!=null&&d(e,["parameters"],a);const c=u(n,["parametersJsonSchema"]);c!=null&&d(e,["parametersJsonSchema"],c);const h=u(n,["response"]);h!=null&&d(e,["response"],h);const m=u(n,["responseJsonSchema"]);return m!=null&&d(e,["responseJsonSchema"],m),e}function mE(n){const e={},t=u(n,["startTime"]);t!=null&&d(e,["startTime"],t);const i=u(n,["endTime"]);return i!=null&&d(e,["endTime"],i),e}function pE(n){const e={},t=u(n,["timeRangeFilter"]);return t!=null&&d(e,["timeRangeFilter"],mE(t)),e}function gE(n){const e={},t=u(n,["mode"]);t!=null&&d(e,["mode"],t);const i=u(n,["dynamicThreshold"]);return i!=null&&d(e,["dynamicThreshold"],i),e}function yE(n){const e={},t=u(n,["dynamicRetrievalConfig"]);return t!=null&&d(e,["dynamicRetrievalConfig"],gE(t)),e}function vE(){return{}}function TE(n){const e={},t=u(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(p=>hE(p))),d(e,["functionDeclarations"],m)}if(u(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=u(n,["googleSearch"]);i!=null&&d(e,["googleSearch"],pE(i));const r=u(n,["googleSearchRetrieval"]);if(r!=null&&d(e,["googleSearchRetrieval"],yE(r)),u(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(u(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");u(n,["urlContext"])!=null&&d(e,["urlContext"],vE());const c=u(n,["codeExecution"]);c!=null&&d(e,["codeExecution"],c);const h=u(n,["computerUse"]);return h!=null&&d(e,["computerUse"],h),e}function SE(n){const e={},t=u(n,["mode"]);t!=null&&d(e,["mode"],t);const i=u(n,["allowedFunctionNames"]);return i!=null&&d(e,["allowedFunctionNames"],i),e}function xE(n){const e={},t=u(n,["latitude"]);t!=null&&d(e,["latitude"],t);const i=u(n,["longitude"]);return i!=null&&d(e,["longitude"],i),e}function EE(n){const e={},t=u(n,["latLng"]);t!=null&&d(e,["latLng"],xE(t));const i=u(n,["languageCode"]);return i!=null&&d(e,["languageCode"],i),e}function CE(n){const e={},t=u(n,["functionCallingConfig"]);t!=null&&d(e,["functionCallingConfig"],SE(t));const i=u(n,["retrievalConfig"]);return i!=null&&d(e,["retrievalConfig"],EE(i)),e}function AE(n){const e={},t=u(n,["voiceName"]);return t!=null&&d(e,["voiceName"],t),e}function iv(n){const e={},t=u(n,["prebuiltVoiceConfig"]);return t!=null&&d(e,["prebuiltVoiceConfig"],AE(t)),e}function _E(n){const e={},t=u(n,["speaker"]);t!=null&&d(e,["speaker"],t);const i=u(n,["voiceConfig"]);return i!=null&&d(e,["voiceConfig"],iv(i)),e}function wE(n){const e={},t=u(n,["speakerVoiceConfigs"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>_E(r))),d(e,["speakerVoiceConfigs"],i)}return e}function bE(n){const e={},t=u(n,["voiceConfig"]);t!=null&&d(e,["voiceConfig"],iv(t));const i=u(n,["multiSpeakerVoiceConfig"]);i!=null&&d(e,["multiSpeakerVoiceConfig"],wE(i));const r=u(n,["languageCode"]);return r!=null&&d(e,["languageCode"],r),e}function RE(n){const e={},t=u(n,["includeThoughts"]);t!=null&&d(e,["includeThoughts"],t);const i=u(n,["thinkingBudget"]);return i!=null&&d(e,["thinkingBudget"],i),e}function ME(n,e,t){const i={},r=u(e,["systemInstruction"]);t!==void 0&&r!=null&&d(t,["systemInstruction"],nv(Tt(r)));const a=u(e,["temperature"]);a!=null&&d(i,["temperature"],a);const c=u(e,["topP"]);c!=null&&d(i,["topP"],c);const h=u(e,["topK"]);h!=null&&d(i,["topK"],h);const m=u(e,["candidateCount"]);m!=null&&d(i,["candidateCount"],m);const p=u(e,["maxOutputTokens"]);p!=null&&d(i,["maxOutputTokens"],p);const y=u(e,["stopSequences"]);y!=null&&d(i,["stopSequences"],y);const T=u(e,["responseLogprobs"]);T!=null&&d(i,["responseLogprobs"],T);const x=u(e,["logprobs"]);x!=null&&d(i,["logprobs"],x);const C=u(e,["presencePenalty"]);C!=null&&d(i,["presencePenalty"],C);const _=u(e,["frequencyPenalty"]);_!=null&&d(i,["frequencyPenalty"],_);const w=u(e,["seed"]);w!=null&&d(i,["seed"],w);const N=u(e,["responseMimeType"]);N!=null&&d(i,["responseMimeType"],N);const H=u(e,["responseSchema"]);H!=null&&d(i,["responseSchema"],dE(md(H)));const K=u(e,["responseJsonSchema"]);if(K!=null&&d(i,["responseJsonSchema"],K),u(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(u(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const I=u(e,["safetySettings"]);if(t!==void 0&&I!=null){let F=I;Array.isArray(F)&&(F=F.map(ie=>fE(ie))),d(t,["safetySettings"],F)}const Q=u(e,["tools"]);if(t!==void 0&&Q!=null){let F=zs(Q);Array.isArray(F)&&(F=F.map(ie=>TE(qs(ie)))),d(t,["tools"],F)}const Y=u(e,["toolConfig"]);if(t!==void 0&&Y!=null&&d(t,["toolConfig"],CE(Y)),u(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const oe=u(e,["cachedContent"]);t!==void 0&&oe!=null&&d(t,["cachedContent"],bn(n,oe));const ce=u(e,["responseModalities"]);ce!=null&&d(i,["responseModalities"],ce);const Ae=u(e,["mediaResolution"]);Ae!=null&&d(i,["mediaResolution"],Ae);const pe=u(e,["speechConfig"]);if(pe!=null&&d(i,["speechConfig"],bE(pd(pe))),u(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const se=u(e,["thinkingConfig"]);return se!=null&&d(i,["thinkingConfig"],RE(se)),i}function NE(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["request","model"],Pe(n,i));const r=u(e,["contents"]);if(r!=null){let c=Jt(r);Array.isArray(c)&&(c=c.map(h=>nv(h))),d(t,["request","contents"],c)}const a=u(e,["config"]);return a!=null&&d(t,["request","generationConfig"],ME(n,a,t)),t}function kE(n,e){const t={};if(u(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(u(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(u(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=u(e,["fileName"]);i!=null&&d(t,["fileName"],i);const r=u(e,["inlinedRequests"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(c=>NE(n,c))),d(t,["requests","requests"],a)}return t}function IE(n,e){const t={},i=u(n,["displayName"]);if(e!==void 0&&i!=null&&d(e,["batch","displayName"],i),u(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function DE(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["_url","model"],Pe(n,i));const r=u(e,["src"]);r!=null&&d(t,["batch","inputConfig"],kE(n,ev(n,r)));const a=u(e,["config"]);return a!=null&&d(t,["config"],IE(a,t)),t}function LE(n,e){const t={},i=u(e,["name"]);i!=null&&d(t,["_url","name"],$s(n,i));const r=u(e,["config"]);return r!=null&&d(t,["config"],r),t}function PE(n,e){const t={},i=u(e,["name"]);i!=null&&d(t,["_url","name"],$s(n,i));const r=u(e,["config"]);return r!=null&&d(t,["config"],r),t}function UE(n,e){const t={},i=u(n,["pageSize"]);e!==void 0&&i!=null&&d(e,["_query","pageSize"],i);const r=u(n,["pageToken"]);if(e!==void 0&&r!=null&&d(e,["_query","pageToken"],r),u(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function OE(n){const e={},t=u(n,["config"]);return t!=null&&d(e,["config"],UE(t,e)),e}function BE(n,e){const t={},i=u(e,["name"]);i!=null&&d(t,["_url","name"],$s(n,i));const r=u(e,["config"]);return r!=null&&d(t,["config"],r),t}function HE(n){const e={},t=u(n,["format"]);t!=null&&d(e,["instancesFormat"],t);const i=u(n,["gcsUri"]);i!=null&&d(e,["gcsSource","uris"],i);const r=u(n,["bigqueryUri"]);if(r!=null&&d(e,["bigquerySource","inputUri"],r),u(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(u(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function VE(n){const e={},t=u(n,["format"]);t!=null&&d(e,["predictionsFormat"],t);const i=u(n,["gcsUri"]);i!=null&&d(e,["gcsDestination","outputUriPrefix"],i);const r=u(n,["bigqueryUri"]);if(r!=null&&d(e,["bigqueryDestination","outputUri"],r),u(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(u(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");return e}function GE(n,e){const t={},i=u(n,["displayName"]);e!==void 0&&i!=null&&d(e,["displayName"],i);const r=u(n,["dest"]);return e!==void 0&&r!=null&&d(e,["outputConfig"],VE(rE(r))),t}function qE(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["model"],Pe(n,i));const r=u(e,["src"]);r!=null&&d(t,["inputConfig"],HE(ev(n,r)));const a=u(e,["config"]);return a!=null&&d(t,["config"],GE(a,t)),t}function zE(n,e){const t={},i=u(e,["name"]);i!=null&&d(t,["_url","name"],$s(n,i));const r=u(e,["config"]);return r!=null&&d(t,["config"],r),t}function $E(n,e){const t={},i=u(e,["name"]);i!=null&&d(t,["_url","name"],$s(n,i));const r=u(e,["config"]);return r!=null&&d(t,["config"],r),t}function FE(n,e){const t={},i=u(n,["pageSize"]);e!==void 0&&i!=null&&d(e,["_query","pageSize"],i);const r=u(n,["pageToken"]);e!==void 0&&r!=null&&d(e,["_query","pageToken"],r);const a=u(n,["filter"]);return e!==void 0&&a!=null&&d(e,["_query","filter"],a),t}function YE(n){const e={},t=u(n,["config"]);return t!=null&&d(e,["config"],FE(t,e)),e}function JE(n,e){const t={},i=u(e,["name"]);i!=null&&d(t,["_url","name"],$s(n,i));const r=u(e,["config"]);return r!=null&&d(t,["config"],r),t}function jE(n){const e={},t=u(n,["fps"]);t!=null&&d(e,["fps"],t);const i=u(n,["endOffset"]);i!=null&&d(e,["endOffset"],i);const r=u(n,["startOffset"]);return r!=null&&d(e,["startOffset"],r),e}function KE(n){const e={},t=u(n,["data"]);t!=null&&d(e,["data"],t);const i=u(n,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function WE(n){const e={},t=u(n,["fileUri"]);t!=null&&d(e,["fileUri"],t);const i=u(n,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function XE(n){const e={},t=u(n,["videoMetadata"]);t!=null&&d(e,["videoMetadata"],jE(t));const i=u(n,["thought"]);i!=null&&d(e,["thought"],i);const r=u(n,["inlineData"]);r!=null&&d(e,["inlineData"],KE(r));const a=u(n,["fileData"]);a!=null&&d(e,["fileData"],WE(a));const c=u(n,["thoughtSignature"]);c!=null&&d(e,["thoughtSignature"],c);const h=u(n,["codeExecutionResult"]);h!=null&&d(e,["codeExecutionResult"],h);const m=u(n,["executableCode"]);m!=null&&d(e,["executableCode"],m);const p=u(n,["functionCall"]);p!=null&&d(e,["functionCall"],p);const y=u(n,["functionResponse"]);y!=null&&d(e,["functionResponse"],y);const T=u(n,["text"]);return T!=null&&d(e,["text"],T),e}function QE(n){const e={},t=u(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>XE(a))),d(e,["parts"],r)}const i=u(n,["role"]);return i!=null&&d(e,["role"],i),e}function ZE(n){const e={},t=u(n,["citationSources"]);return t!=null&&d(e,["citations"],t),e}function eC(n){const e={},t=u(n,["retrievedUrl"]);t!=null&&d(e,["retrievedUrl"],t);const i=u(n,["urlRetrievalStatus"]);return i!=null&&d(e,["urlRetrievalStatus"],i),e}function tC(n){const e={},t=u(n,["urlMetadata"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>eC(r))),d(e,["urlMetadata"],i)}return e}function nC(n){const e={},t=u(n,["content"]);t!=null&&d(e,["content"],QE(t));const i=u(n,["citationMetadata"]);i!=null&&d(e,["citationMetadata"],ZE(i));const r=u(n,["tokenCount"]);r!=null&&d(e,["tokenCount"],r);const a=u(n,["finishReason"]);a!=null&&d(e,["finishReason"],a);const c=u(n,["urlContextMetadata"]);c!=null&&d(e,["urlContextMetadata"],tC(c));const h=u(n,["avgLogprobs"]);h!=null&&d(e,["avgLogprobs"],h);const m=u(n,["groundingMetadata"]);m!=null&&d(e,["groundingMetadata"],m);const p=u(n,["index"]);p!=null&&d(e,["index"],p);const y=u(n,["logprobsResult"]);y!=null&&d(e,["logprobsResult"],y);const T=u(n,["safetyRatings"]);return T!=null&&d(e,["safetyRatings"],T),e}function iC(n){const e={},t=u(n,["sdkHttpResponse"]);t!=null&&d(e,["sdkHttpResponse"],t);const i=u(n,["candidates"]);if(i!=null){let m=i;Array.isArray(m)&&(m=m.map(p=>nC(p))),d(e,["candidates"],m)}const r=u(n,["modelVersion"]);r!=null&&d(e,["modelVersion"],r);const a=u(n,["promptFeedback"]);a!=null&&d(e,["promptFeedback"],a);const c=u(n,["responseId"]);c!=null&&d(e,["responseId"],c);const h=u(n,["usageMetadata"]);return h!=null&&d(e,["usageMetadata"],h),e}function sv(n){const e={},t=u(n,["details"]);t!=null&&d(e,["details"],t);const i=u(n,["code"]);i!=null&&d(e,["code"],i);const r=u(n,["message"]);return r!=null&&d(e,["message"],r),e}function sC(n){const e={},t=u(n,["response"]);t!=null&&d(e,["response"],iC(t));const i=u(n,["error"]);return i!=null&&d(e,["error"],sv(i)),e}function oC(n){const e={},t=u(n,["responsesFile"]);t!=null&&d(e,["fileName"],t);const i=u(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>sC(a))),d(e,["inlinedResponses"],r)}return e}function Ou(n){const e={},t=u(n,["name"]);t!=null&&d(e,["name"],t);const i=u(n,["metadata","displayName"]);i!=null&&d(e,["displayName"],i);const r=u(n,["metadata","state"]);r!=null&&d(e,["state"],tv(r));const a=u(n,["metadata","createTime"]);a!=null&&d(e,["createTime"],a);const c=u(n,["metadata","endTime"]);c!=null&&d(e,["endTime"],c);const h=u(n,["metadata","updateTime"]);h!=null&&d(e,["updateTime"],h);const m=u(n,["metadata","model"]);m!=null&&d(e,["model"],m);const p=u(n,["metadata","output"]);return p!=null&&d(e,["dest"],oC(p)),e}function rC(n){const e={},t=u(n,["sdkHttpResponse"]);t!=null&&d(e,["sdkHttpResponse"],t);const i=u(n,["nextPageToken"]);i!=null&&d(e,["nextPageToken"],i);const r=u(n,["operations"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(c=>Ou(c))),d(e,["batchJobs"],a)}return e}function aC(n){const e={},t=u(n,["sdkHttpResponse"]);t!=null&&d(e,["sdkHttpResponse"],t);const i=u(n,["name"]);i!=null&&d(e,["name"],i);const r=u(n,["done"]);r!=null&&d(e,["done"],r);const a=u(n,["error"]);return a!=null&&d(e,["error"],sv(a)),e}function ov(n){const e={},t=u(n,["details"]);t!=null&&d(e,["details"],t);const i=u(n,["code"]);i!=null&&d(e,["code"],i);const r=u(n,["message"]);return r!=null&&d(e,["message"],r),e}function lC(n){const e={},t=u(n,["instancesFormat"]);t!=null&&d(e,["format"],t);const i=u(n,["gcsSource","uris"]);i!=null&&d(e,["gcsUri"],i);const r=u(n,["bigquerySource","inputUri"]);return r!=null&&d(e,["bigqueryUri"],r),e}function cC(n){const e={},t=u(n,["predictionsFormat"]);t!=null&&d(e,["format"],t);const i=u(n,["gcsDestination","outputUriPrefix"]);i!=null&&d(e,["gcsUri"],i);const r=u(n,["bigqueryDestination","outputUri"]);return r!=null&&d(e,["bigqueryUri"],r),e}function Bu(n){const e={},t=u(n,["name"]);t!=null&&d(e,["name"],t);const i=u(n,["displayName"]);i!=null&&d(e,["displayName"],i);const r=u(n,["state"]);r!=null&&d(e,["state"],tv(r));const a=u(n,["error"]);a!=null&&d(e,["error"],ov(a));const c=u(n,["createTime"]);c!=null&&d(e,["createTime"],c);const h=u(n,["startTime"]);h!=null&&d(e,["startTime"],h);const m=u(n,["endTime"]);m!=null&&d(e,["endTime"],m);const p=u(n,["updateTime"]);p!=null&&d(e,["updateTime"],p);const y=u(n,["model"]);y!=null&&d(e,["model"],y);const T=u(n,["inputConfig"]);T!=null&&d(e,["src"],lC(T));const x=u(n,["outputConfig"]);return x!=null&&d(e,["dest"],cC(x)),e}function uC(n){const e={},t=u(n,["sdkHttpResponse"]);t!=null&&d(e,["sdkHttpResponse"],t);const i=u(n,["nextPageToken"]);i!=null&&d(e,["nextPageToken"],i);const r=u(n,["batchPredictionJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(c=>Bu(c))),d(e,["batchJobs"],a)}return e}function dC(n){const e={},t=u(n,["sdkHttpResponse"]);t!=null&&d(e,["sdkHttpResponse"],t);const i=u(n,["name"]);i!=null&&d(e,["name"],i);const r=u(n,["done"]);r!=null&&d(e,["done"],r);const a=u(n,["error"]);return a!=null&&d(e,["error"],ov(a)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ri;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Ri||(Ri={}));class fr{constructor(e,t,i,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,r)}init(e,t,i){var r,a;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let c={config:{}};!i||Object.keys(i).length===0?c={config:{}}:typeof i=="object"?c=Object.assign({},i):c=i,c.config&&(c.config.pageToken=t.nextPageToken),this.paramsInternal=c,this.pageInternalSize=(a=(r=c.config)===null||r===void 0?void 0:r.pageSize)!==null&&a!==void 0?a:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class fC extends Ni{constructor(e){super(),this.apiClient=e,this.create=async t=>{if(this.apiClient.isVertexAI()){const r=Date.now().toString();if(Array.isArray(t.src))throw new Error("InlinedRequest[] is not supported in Vertex AI. Please use Google Cloud Storage URI or BigQuery URI instead.");if(t.config=t.config||{},t.config.displayName===void 0&&(t.config.displayName="genaiBatchJob_${timestampStr}"),t.config.dest===void 0&&typeof t.src=="string")if(t.src.startsWith("gs://")&&t.src.endsWith(".jsonl"))t.config.dest=`${t.src.slice(0,-6)}/dest`;else if(t.src.startsWith("bq://"))t.config.dest=`${t.src}_dest_${r}`;else throw new Error("Unsupported source:"+t.src)}return await this.createInternal(t)},this.list=async(t={})=>new fr(Ri.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t)}async createInternal(e){var t,i,r,a;let c,h="",m={};if(this.apiClient.isVertexAI()){const p=qE(this.apiClient,e);return h=me("batchPredictionJobs",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json()),c.then(y=>Bu(y))}else{const p=DE(this.apiClient,e);return h=me("{model}:batchGenerateContent",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),c.then(y=>Ou(y))}}async get(e){var t,i,r,a;let c,h="",m={};if(this.apiClient.isVertexAI()){const p=zE(this.apiClient,e);return h=me("batchPredictionJobs/{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json()),c.then(y=>Bu(y))}else{const p=LE(this.apiClient,e);return h=me("batches/{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),c.then(y=>Ou(y))}}async cancel(e){var t,i,r,a;let c="",h={};if(this.apiClient.isVertexAI()){const m=$E(this.apiClient,e);c=me("batchPredictionJobs/{name}:cancel",m._url),h=m._query,delete m.config,delete m._url,delete m._query,await this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const m=PE(this.apiClient,e);c=me("batches/{name}:cancel",m._url),h=m._query,delete m.config,delete m._url,delete m._query,await this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal})}}async listInternal(e){var t,i,r,a;let c,h="",m={};if(this.apiClient.isVertexAI()){const p=YE(e);return h=me("batchPredictionJobs",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),c.then(y=>{const T=uC(y),x=new Ng;return Object.assign(x,T),x})}else{const p=OE(e);return h=me("batches",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),c.then(y=>{const T=rC(y),x=new Ng;return Object.assign(x,T),x})}}async delete(e){var t,i,r,a;let c,h="",m={};if(this.apiClient.isVertexAI()){const p=JE(this.apiClient,e);return h=me("batchPredictionJobs/{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),c.then(y=>dC(y))}else{const p=BE(this.apiClient,e);return h=me("batches/{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),c.then(y=>aC(y))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function hC(n){const e={},t=u(n,["fps"]);t!=null&&d(e,["fps"],t);const i=u(n,["endOffset"]);i!=null&&d(e,["endOffset"],i);const r=u(n,["startOffset"]);return r!=null&&d(e,["startOffset"],r),e}function mC(n){const e={};if(u(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=u(n,["data"]);t!=null&&d(e,["data"],t);const i=u(n,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function pC(n){const e={};if(u(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=u(n,["fileUri"]);t!=null&&d(e,["fileUri"],t);const i=u(n,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function gC(n){const e={},t=u(n,["videoMetadata"]);t!=null&&d(e,["videoMetadata"],hC(t));const i=u(n,["thought"]);i!=null&&d(e,["thought"],i);const r=u(n,["inlineData"]);r!=null&&d(e,["inlineData"],mC(r));const a=u(n,["fileData"]);a!=null&&d(e,["fileData"],pC(a));const c=u(n,["thoughtSignature"]);c!=null&&d(e,["thoughtSignature"],c);const h=u(n,["codeExecutionResult"]);h!=null&&d(e,["codeExecutionResult"],h);const m=u(n,["executableCode"]);m!=null&&d(e,["executableCode"],m);const p=u(n,["functionCall"]);p!=null&&d(e,["functionCall"],p);const y=u(n,["functionResponse"]);y!=null&&d(e,["functionResponse"],y);const T=u(n,["text"]);return T!=null&&d(e,["text"],T),e}function Lg(n){const e={},t=u(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>gC(a))),d(e,["parts"],r)}const i=u(n,["role"]);return i!=null&&d(e,["role"],i),e}function yC(n){const e={},t=u(n,["behavior"]);t!=null&&d(e,["behavior"],t);const i=u(n,["description"]);i!=null&&d(e,["description"],i);const r=u(n,["name"]);r!=null&&d(e,["name"],r);const a=u(n,["parameters"]);a!=null&&d(e,["parameters"],a);const c=u(n,["parametersJsonSchema"]);c!=null&&d(e,["parametersJsonSchema"],c);const h=u(n,["response"]);h!=null&&d(e,["response"],h);const m=u(n,["responseJsonSchema"]);return m!=null&&d(e,["responseJsonSchema"],m),e}function vC(n){const e={},t=u(n,["startTime"]);t!=null&&d(e,["startTime"],t);const i=u(n,["endTime"]);return i!=null&&d(e,["endTime"],i),e}function TC(n){const e={},t=u(n,["timeRangeFilter"]);return t!=null&&d(e,["timeRangeFilter"],vC(t)),e}function SC(n){const e={},t=u(n,["mode"]);t!=null&&d(e,["mode"],t);const i=u(n,["dynamicThreshold"]);return i!=null&&d(e,["dynamicThreshold"],i),e}function xC(n){const e={},t=u(n,["dynamicRetrievalConfig"]);return t!=null&&d(e,["dynamicRetrievalConfig"],SC(t)),e}function EC(){return{}}function CC(n){const e={},t=u(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(p=>yC(p))),d(e,["functionDeclarations"],m)}if(u(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=u(n,["googleSearch"]);i!=null&&d(e,["googleSearch"],TC(i));const r=u(n,["googleSearchRetrieval"]);if(r!=null&&d(e,["googleSearchRetrieval"],xC(r)),u(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(u(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");u(n,["urlContext"])!=null&&d(e,["urlContext"],EC());const c=u(n,["codeExecution"]);c!=null&&d(e,["codeExecution"],c);const h=u(n,["computerUse"]);return h!=null&&d(e,["computerUse"],h),e}function AC(n){const e={},t=u(n,["mode"]);t!=null&&d(e,["mode"],t);const i=u(n,["allowedFunctionNames"]);return i!=null&&d(e,["allowedFunctionNames"],i),e}function _C(n){const e={},t=u(n,["latitude"]);t!=null&&d(e,["latitude"],t);const i=u(n,["longitude"]);return i!=null&&d(e,["longitude"],i),e}function wC(n){const e={},t=u(n,["latLng"]);t!=null&&d(e,["latLng"],_C(t));const i=u(n,["languageCode"]);return i!=null&&d(e,["languageCode"],i),e}function bC(n){const e={},t=u(n,["functionCallingConfig"]);t!=null&&d(e,["functionCallingConfig"],AC(t));const i=u(n,["retrievalConfig"]);return i!=null&&d(e,["retrievalConfig"],wC(i)),e}function RC(n,e){const t={},i=u(n,["ttl"]);e!==void 0&&i!=null&&d(e,["ttl"],i);const r=u(n,["expireTime"]);e!==void 0&&r!=null&&d(e,["expireTime"],r);const a=u(n,["displayName"]);e!==void 0&&a!=null&&d(e,["displayName"],a);const c=u(n,["contents"]);if(e!==void 0&&c!=null){let y=Jt(c);Array.isArray(y)&&(y=y.map(T=>Lg(T))),d(e,["contents"],y)}const h=u(n,["systemInstruction"]);e!==void 0&&h!=null&&d(e,["systemInstruction"],Lg(Tt(h)));const m=u(n,["tools"]);if(e!==void 0&&m!=null){let y=m;Array.isArray(y)&&(y=y.map(T=>CC(T))),d(e,["tools"],y)}const p=u(n,["toolConfig"]);if(e!==void 0&&p!=null&&d(e,["toolConfig"],bC(p)),u(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function MC(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["model"],$y(n,i));const r=u(e,["config"]);return r!=null&&d(t,["config"],RC(r,t)),t}function NC(n,e){const t={},i=u(e,["name"]);i!=null&&d(t,["_url","name"],bn(n,i));const r=u(e,["config"]);return r!=null&&d(t,["config"],r),t}function kC(n,e){const t={},i=u(e,["name"]);i!=null&&d(t,["_url","name"],bn(n,i));const r=u(e,["config"]);return r!=null&&d(t,["config"],r),t}function IC(n,e){const t={},i=u(n,["ttl"]);e!==void 0&&i!=null&&d(e,["ttl"],i);const r=u(n,["expireTime"]);return e!==void 0&&r!=null&&d(e,["expireTime"],r),t}function DC(n,e){const t={},i=u(e,["name"]);i!=null&&d(t,["_url","name"],bn(n,i));const r=u(e,["config"]);return r!=null&&d(t,["config"],IC(r,t)),t}function LC(n,e){const t={},i=u(n,["pageSize"]);e!==void 0&&i!=null&&d(e,["_query","pageSize"],i);const r=u(n,["pageToken"]);return e!==void 0&&r!=null&&d(e,["_query","pageToken"],r),t}function PC(n){const e={},t=u(n,["config"]);return t!=null&&d(e,["config"],LC(t,e)),e}function UC(n){const e={},t=u(n,["fps"]);t!=null&&d(e,["fps"],t);const i=u(n,["endOffset"]);i!=null&&d(e,["endOffset"],i);const r=u(n,["startOffset"]);return r!=null&&d(e,["startOffset"],r),e}function OC(n){const e={},t=u(n,["displayName"]);t!=null&&d(e,["displayName"],t);const i=u(n,["data"]);i!=null&&d(e,["data"],i);const r=u(n,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function BC(n){const e={},t=u(n,["displayName"]);t!=null&&d(e,["displayName"],t);const i=u(n,["fileUri"]);i!=null&&d(e,["fileUri"],i);const r=u(n,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function HC(n){const e={},t=u(n,["videoMetadata"]);t!=null&&d(e,["videoMetadata"],UC(t));const i=u(n,["thought"]);i!=null&&d(e,["thought"],i);const r=u(n,["inlineData"]);r!=null&&d(e,["inlineData"],OC(r));const a=u(n,["fileData"]);a!=null&&d(e,["fileData"],BC(a));const c=u(n,["thoughtSignature"]);c!=null&&d(e,["thoughtSignature"],c);const h=u(n,["codeExecutionResult"]);h!=null&&d(e,["codeExecutionResult"],h);const m=u(n,["executableCode"]);m!=null&&d(e,["executableCode"],m);const p=u(n,["functionCall"]);p!=null&&d(e,["functionCall"],p);const y=u(n,["functionResponse"]);y!=null&&d(e,["functionResponse"],y);const T=u(n,["text"]);return T!=null&&d(e,["text"],T),e}function Pg(n){const e={},t=u(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>HC(a))),d(e,["parts"],r)}const i=u(n,["role"]);return i!=null&&d(e,["role"],i),e}function VC(n){const e={};if(u(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=u(n,["description"]);t!=null&&d(e,["description"],t);const i=u(n,["name"]);i!=null&&d(e,["name"],i);const r=u(n,["parameters"]);r!=null&&d(e,["parameters"],r);const a=u(n,["parametersJsonSchema"]);a!=null&&d(e,["parametersJsonSchema"],a);const c=u(n,["response"]);c!=null&&d(e,["response"],c);const h=u(n,["responseJsonSchema"]);return h!=null&&d(e,["responseJsonSchema"],h),e}function GC(n){const e={},t=u(n,["startTime"]);t!=null&&d(e,["startTime"],t);const i=u(n,["endTime"]);return i!=null&&d(e,["endTime"],i),e}function qC(n){const e={},t=u(n,["timeRangeFilter"]);return t!=null&&d(e,["timeRangeFilter"],GC(t)),e}function zC(n){const e={},t=u(n,["mode"]);t!=null&&d(e,["mode"],t);const i=u(n,["dynamicThreshold"]);return i!=null&&d(e,["dynamicThreshold"],i),e}function $C(n){const e={},t=u(n,["dynamicRetrievalConfig"]);return t!=null&&d(e,["dynamicRetrievalConfig"],zC(t)),e}function FC(){return{}}function YC(n){const e={},t=u(n,["apiKeyString"]);return t!=null&&d(e,["apiKeyString"],t),e}function JC(n){const e={},t=u(n,["apiKeyConfig"]);t!=null&&d(e,["apiKeyConfig"],YC(t));const i=u(n,["authType"]);i!=null&&d(e,["authType"],i);const r=u(n,["googleServiceAccountConfig"]);r!=null&&d(e,["googleServiceAccountConfig"],r);const a=u(n,["httpBasicAuthConfig"]);a!=null&&d(e,["httpBasicAuthConfig"],a);const c=u(n,["oauthConfig"]);c!=null&&d(e,["oauthConfig"],c);const h=u(n,["oidcConfig"]);return h!=null&&d(e,["oidcConfig"],h),e}function jC(n){const e={},t=u(n,["authConfig"]);return t!=null&&d(e,["authConfig"],JC(t)),e}function KC(){return{}}function WC(n){const e={},t=u(n,["functionDeclarations"]);if(t!=null){let T=t;Array.isArray(T)&&(T=T.map(x=>VC(x))),d(e,["functionDeclarations"],T)}const i=u(n,["retrieval"]);i!=null&&d(e,["retrieval"],i);const r=u(n,["googleSearch"]);r!=null&&d(e,["googleSearch"],qC(r));const a=u(n,["googleSearchRetrieval"]);a!=null&&d(e,["googleSearchRetrieval"],$C(a)),u(n,["enterpriseWebSearch"])!=null&&d(e,["enterpriseWebSearch"],FC());const h=u(n,["googleMaps"]);h!=null&&d(e,["googleMaps"],jC(h)),u(n,["urlContext"])!=null&&d(e,["urlContext"],KC());const p=u(n,["codeExecution"]);p!=null&&d(e,["codeExecution"],p);const y=u(n,["computerUse"]);return y!=null&&d(e,["computerUse"],y),e}function XC(n){const e={},t=u(n,["mode"]);t!=null&&d(e,["mode"],t);const i=u(n,["allowedFunctionNames"]);return i!=null&&d(e,["allowedFunctionNames"],i),e}function QC(n){const e={},t=u(n,["latitude"]);t!=null&&d(e,["latitude"],t);const i=u(n,["longitude"]);return i!=null&&d(e,["longitude"],i),e}function ZC(n){const e={},t=u(n,["latLng"]);t!=null&&d(e,["latLng"],QC(t));const i=u(n,["languageCode"]);return i!=null&&d(e,["languageCode"],i),e}function eA(n){const e={},t=u(n,["functionCallingConfig"]);t!=null&&d(e,["functionCallingConfig"],XC(t));const i=u(n,["retrievalConfig"]);return i!=null&&d(e,["retrievalConfig"],ZC(i)),e}function tA(n,e){const t={},i=u(n,["ttl"]);e!==void 0&&i!=null&&d(e,["ttl"],i);const r=u(n,["expireTime"]);e!==void 0&&r!=null&&d(e,["expireTime"],r);const a=u(n,["displayName"]);e!==void 0&&a!=null&&d(e,["displayName"],a);const c=u(n,["contents"]);if(e!==void 0&&c!=null){let T=Jt(c);Array.isArray(T)&&(T=T.map(x=>Pg(x))),d(e,["contents"],T)}const h=u(n,["systemInstruction"]);e!==void 0&&h!=null&&d(e,["systemInstruction"],Pg(Tt(h)));const m=u(n,["tools"]);if(e!==void 0&&m!=null){let T=m;Array.isArray(T)&&(T=T.map(x=>WC(x))),d(e,["tools"],T)}const p=u(n,["toolConfig"]);e!==void 0&&p!=null&&d(e,["toolConfig"],eA(p));const y=u(n,["kmsKeyName"]);return e!==void 0&&y!=null&&d(e,["encryption_spec","kmsKeyName"],y),t}function nA(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["model"],$y(n,i));const r=u(e,["config"]);return r!=null&&d(t,["config"],tA(r,t)),t}function iA(n,e){const t={},i=u(e,["name"]);i!=null&&d(t,["_url","name"],bn(n,i));const r=u(e,["config"]);return r!=null&&d(t,["config"],r),t}function sA(n,e){const t={},i=u(e,["name"]);i!=null&&d(t,["_url","name"],bn(n,i));const r=u(e,["config"]);return r!=null&&d(t,["config"],r),t}function oA(n,e){const t={},i=u(n,["ttl"]);e!==void 0&&i!=null&&d(e,["ttl"],i);const r=u(n,["expireTime"]);return e!==void 0&&r!=null&&d(e,["expireTime"],r),t}function rA(n,e){const t={},i=u(e,["name"]);i!=null&&d(t,["_url","name"],bn(n,i));const r=u(e,["config"]);return r!=null&&d(t,["config"],oA(r,t)),t}function aA(n,e){const t={},i=u(n,["pageSize"]);e!==void 0&&i!=null&&d(e,["_query","pageSize"],i);const r=u(n,["pageToken"]);return e!==void 0&&r!=null&&d(e,["_query","pageToken"],r),t}function lA(n){const e={},t=u(n,["config"]);return t!=null&&d(e,["config"],aA(t,e)),e}function Oa(n){const e={},t=u(n,["name"]);t!=null&&d(e,["name"],t);const i=u(n,["displayName"]);i!=null&&d(e,["displayName"],i);const r=u(n,["model"]);r!=null&&d(e,["model"],r);const a=u(n,["createTime"]);a!=null&&d(e,["createTime"],a);const c=u(n,["updateTime"]);c!=null&&d(e,["updateTime"],c);const h=u(n,["expireTime"]);h!=null&&d(e,["expireTime"],h);const m=u(n,["usageMetadata"]);return m!=null&&d(e,["usageMetadata"],m),e}function cA(){return{}}function uA(n){const e={},t=u(n,["sdkHttpResponse"]);t!=null&&d(e,["sdkHttpResponse"],t);const i=u(n,["nextPageToken"]);i!=null&&d(e,["nextPageToken"],i);const r=u(n,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(c=>Oa(c))),d(e,["cachedContents"],a)}return e}function Ba(n){const e={},t=u(n,["name"]);t!=null&&d(e,["name"],t);const i=u(n,["displayName"]);i!=null&&d(e,["displayName"],i);const r=u(n,["model"]);r!=null&&d(e,["model"],r);const a=u(n,["createTime"]);a!=null&&d(e,["createTime"],a);const c=u(n,["updateTime"]);c!=null&&d(e,["updateTime"],c);const h=u(n,["expireTime"]);h!=null&&d(e,["expireTime"],h);const m=u(n,["usageMetadata"]);return m!=null&&d(e,["usageMetadata"],m),e}function dA(){return{}}function fA(n){const e={},t=u(n,["sdkHttpResponse"]);t!=null&&d(e,["sdkHttpResponse"],t);const i=u(n,["nextPageToken"]);i!=null&&d(e,["nextPageToken"],i);const r=u(n,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(c=>Ba(c))),d(e,["cachedContents"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hA extends Ni{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new fr(Ri.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,r,a;let c,h="",m={};if(this.apiClient.isVertexAI()){const p=nA(this.apiClient,e);return h=me("cachedContents",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json()),c.then(y=>Ba(y))}else{const p=MC(this.apiClient,e);return h=me("cachedContents",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),c.then(y=>Oa(y))}}async get(e){var t,i,r,a;let c,h="",m={};if(this.apiClient.isVertexAI()){const p=iA(this.apiClient,e);return h=me("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json()),c.then(y=>Ba(y))}else{const p=NC(this.apiClient,e);return h=me("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),c.then(y=>Oa(y))}}async delete(e){var t,i,r,a;let c,h="",m={};if(this.apiClient.isVertexAI()){const p=sA(this.apiClient,e);return h=me("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json()),c.then(()=>{const y=dA(),T=new Rg;return Object.assign(T,y),T})}else{const p=kC(this.apiClient,e);return h=me("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),c.then(()=>{const y=cA(),T=new Rg;return Object.assign(T,y),T})}}async update(e){var t,i,r,a;let c,h="",m={};if(this.apiClient.isVertexAI()){const p=rA(this.apiClient,e);return h=me("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json()),c.then(y=>Ba(y))}else{const p=DC(this.apiClient,e);return h=me("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),c.then(y=>Oa(y))}}async listInternal(e){var t,i,r,a;let c,h="",m={};if(this.apiClient.isVertexAI()){const p=lA(e);return h=me("cachedContents",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),c.then(y=>{const T=fA(y),x=new Mg;return Object.assign(x,T),x})}else{const p=PC(e);return h=me("cachedContents",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),c.then(y=>{const T=uA(y),x=new Mg;return Object.assign(x,T),x})}}}function Ug(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Je(n){return this instanceof Je?(this.v=n,this):new Je(n)}function Hs(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,a=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),h("next"),h("throw"),h("return",c),r[Symbol.asyncIterator]=function(){return this},r;function c(C){return function(_){return Promise.resolve(_).then(C,T)}}function h(C,_){i[C]&&(r[C]=function(w){return new Promise(function(N,H){a.push([C,w,N,H])>1||m(C,w)})},_&&(r[C]=_(r[C])))}function m(C,_){try{p(i[C](_))}catch(w){x(a[0][3],w)}}function p(C){C.value instanceof Je?Promise.resolve(C.value.v).then(y,T):x(a[0][2],C)}function y(C){m("next",C)}function T(C){m("throw",C)}function x(C,_){C(_),a.shift(),a.length&&m(a[0][0],a[0][1])}}function sr(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Ug=="function"?Ug(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(a){t[a]=n[a]&&function(c){return new Promise(function(h,m){c=n[a](c),r(h,m,c.done,c.value)})}}function r(a,c,h,m){Promise.resolve(m).then(function(p){a({value:p,done:h})},c)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function mA(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:rv(t)}function rv(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0||!e.thought&&e.text!==void 0&&e.text==="")return!1;return!0}function pA(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function Og(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{const r=[];let a=!0;for(;i<t&&n[i].role==="model";)r.push(n[i]),a&&!rv(n[i])&&(a=!1),i++;a?e.push(...r):e.pop()}return e}class gA{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new yA(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class yA{constructor(e,t,i,r={},a=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=r,this.history=a,this.sendPromise=Promise.resolve(),pA(a)}async sendMessage(e){var t;await this.sendPromise;const i=Tt(e.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var a,c,h;const m=await r,p=(c=(a=m.candidates)===null||a===void 0?void 0:a[0])===null||c===void 0?void 0:c.content,y=m.automaticFunctionCallingHistory,T=this.getHistory(!0).length;let x=[];y!=null&&(x=(h=y.slice(T))!==null&&h!==void 0?h:[]);const C=p?[p]:[];this.recordHistory(i,C,x)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),r}async sendMessageStream(e){var t;await this.sendPromise;const i=Tt(e.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=r.then(()=>{}).catch(()=>{});const a=await r;return this.processStreamResponse(a,i)}getHistory(e=!1){const t=e?Og(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var i,r;return Hs(this,arguments,function*(){var c,h,m,p;const y=[];try{for(var T=!0,x=sr(e),C;C=yield Je(x.next()),c=C.done,!c;T=!0){p=C.value,T=!1;const _=p;if(mA(_)){const w=(r=(i=_.candidates)===null||i===void 0?void 0:i[0])===null||r===void 0?void 0:r.content;w!==void 0&&y.push(w)}yield yield Je(_)}}catch(_){h={error:_}}finally{try{!T&&!c&&(m=x.return)&&(yield Je(m.call(x)))}finally{if(h)throw h.error}}this.recordHistory(t,y)})}recordHistory(e,t,i){let r=[];t.length>0&&t.every(a=>a.role!==void 0)?r=t:r.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...Og(i)):this.history.push(e),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Za extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Za.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vA(n,e){const t={},i=u(n,["pageSize"]);e!==void 0&&i!=null&&d(e,["_query","pageSize"],i);const r=u(n,["pageToken"]);return e!==void 0&&r!=null&&d(e,["_query","pageToken"],r),t}function TA(n){const e={},t=u(n,["config"]);return t!=null&&d(e,["config"],vA(t,e)),e}function SA(n){const e={},t=u(n,["details"]);t!=null&&d(e,["details"],t);const i=u(n,["message"]);i!=null&&d(e,["message"],i);const r=u(n,["code"]);return r!=null&&d(e,["code"],r),e}function xA(n){const e={},t=u(n,["name"]);t!=null&&d(e,["name"],t);const i=u(n,["displayName"]);i!=null&&d(e,["displayName"],i);const r=u(n,["mimeType"]);r!=null&&d(e,["mimeType"],r);const a=u(n,["sizeBytes"]);a!=null&&d(e,["sizeBytes"],a);const c=u(n,["createTime"]);c!=null&&d(e,["createTime"],c);const h=u(n,["expirationTime"]);h!=null&&d(e,["expirationTime"],h);const m=u(n,["updateTime"]);m!=null&&d(e,["updateTime"],m);const p=u(n,["sha256Hash"]);p!=null&&d(e,["sha256Hash"],p);const y=u(n,["uri"]);y!=null&&d(e,["uri"],y);const T=u(n,["downloadUri"]);T!=null&&d(e,["downloadUri"],T);const x=u(n,["state"]);x!=null&&d(e,["state"],x);const C=u(n,["source"]);C!=null&&d(e,["source"],C);const _=u(n,["videoMetadata"]);_!=null&&d(e,["videoMetadata"],_);const w=u(n,["error"]);return w!=null&&d(e,["error"],SA(w)),e}function EA(n){const e={},t=u(n,["file"]);t!=null&&d(e,["file"],xA(t));const i=u(n,["config"]);return i!=null&&d(e,["config"],i),e}function CA(n){const e={},t=u(n,["name"]);t!=null&&d(e,["_url","file"],Xy(t));const i=u(n,["config"]);return i!=null&&d(e,["config"],i),e}function AA(n){const e={},t=u(n,["name"]);t!=null&&d(e,["_url","file"],Xy(t));const i=u(n,["config"]);return i!=null&&d(e,["config"],i),e}function _A(n){const e={},t=u(n,["details"]);t!=null&&d(e,["details"],t);const i=u(n,["message"]);i!=null&&d(e,["message"],i);const r=u(n,["code"]);return r!=null&&d(e,["code"],r),e}function Hu(n){const e={},t=u(n,["name"]);t!=null&&d(e,["name"],t);const i=u(n,["displayName"]);i!=null&&d(e,["displayName"],i);const r=u(n,["mimeType"]);r!=null&&d(e,["mimeType"],r);const a=u(n,["sizeBytes"]);a!=null&&d(e,["sizeBytes"],a);const c=u(n,["createTime"]);c!=null&&d(e,["createTime"],c);const h=u(n,["expirationTime"]);h!=null&&d(e,["expirationTime"],h);const m=u(n,["updateTime"]);m!=null&&d(e,["updateTime"],m);const p=u(n,["sha256Hash"]);p!=null&&d(e,["sha256Hash"],p);const y=u(n,["uri"]);y!=null&&d(e,["uri"],y);const T=u(n,["downloadUri"]);T!=null&&d(e,["downloadUri"],T);const x=u(n,["state"]);x!=null&&d(e,["state"],x);const C=u(n,["source"]);C!=null&&d(e,["source"],C);const _=u(n,["videoMetadata"]);_!=null&&d(e,["videoMetadata"],_);const w=u(n,["error"]);return w!=null&&d(e,["error"],_A(w)),e}function wA(n){const e={},t=u(n,["sdkHttpResponse"]);t!=null&&d(e,["sdkHttpResponse"],t);const i=u(n,["nextPageToken"]);i!=null&&d(e,["nextPageToken"],i);const r=u(n,["files"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(c=>Hu(c))),d(e,["files"],a)}return e}function bA(n){const e={},t=u(n,["sdkHttpResponse"]);return t!=null&&d(e,["sdkHttpResponse"],t),e}function RA(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class MA extends Ni{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new fr(Ri.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>Hu(t))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,i;let r,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=TA(e);return a=me("files",h._url),c=h._query,delete h.config,delete h._url,delete h._query,r=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(p=>{const y=p;return y.sdkHttpResponse={headers:m.headers},y})),r.then(m=>{const p=wA(m),y=new Jx;return Object.assign(y,p),y})}}async createInternal(e){var t,i;let r,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=EA(e);return a=me("upload/v1beta/files",h._url),c=h._query,delete h.config,delete h._url,delete h._query,r=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),r.then(m=>{const p=bA(m),y=new jx;return Object.assign(y,p),y})}}async get(e){var t,i;let r,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=CA(e);return a=me("files/{file}",h._url),c=h._query,delete h.config,delete h._url,delete h._query,r=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),r.then(m=>Hu(m))}}async delete(e){var t,i;let r,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=AA(e);return a=me("files/{file}",h._url),c=h._query,delete h.config,delete h._url,delete h._query,r=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),r.then(()=>{const m=RA(),p=new Kx;return Object.assign(p,m),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function NA(n){const e={},t=u(n,["voiceName"]);return t!=null&&d(e,["voiceName"],t),e}function av(n){const e={},t=u(n,["prebuiltVoiceConfig"]);return t!=null&&d(e,["prebuiltVoiceConfig"],NA(t)),e}function kA(n){const e={},t=u(n,["speaker"]);t!=null&&d(e,["speaker"],t);const i=u(n,["voiceConfig"]);return i!=null&&d(e,["voiceConfig"],av(i)),e}function IA(n){const e={},t=u(n,["speakerVoiceConfigs"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>kA(r))),d(e,["speakerVoiceConfigs"],i)}return e}function DA(n){const e={},t=u(n,["voiceConfig"]);t!=null&&d(e,["voiceConfig"],av(t));const i=u(n,["multiSpeakerVoiceConfig"]);i!=null&&d(e,["multiSpeakerVoiceConfig"],IA(i));const r=u(n,["languageCode"]);return r!=null&&d(e,["languageCode"],r),e}function LA(n){const e={},t=u(n,["fps"]);t!=null&&d(e,["fps"],t);const i=u(n,["endOffset"]);i!=null&&d(e,["endOffset"],i);const r=u(n,["startOffset"]);return r!=null&&d(e,["startOffset"],r),e}function PA(n){const e={};if(u(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=u(n,["data"]);t!=null&&d(e,["data"],t);const i=u(n,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function UA(n){const e={};if(u(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=u(n,["fileUri"]);t!=null&&d(e,["fileUri"],t);const i=u(n,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function OA(n){const e={},t=u(n,["videoMetadata"]);t!=null&&d(e,["videoMetadata"],LA(t));const i=u(n,["thought"]);i!=null&&d(e,["thought"],i);const r=u(n,["inlineData"]);r!=null&&d(e,["inlineData"],PA(r));const a=u(n,["fileData"]);a!=null&&d(e,["fileData"],UA(a));const c=u(n,["thoughtSignature"]);c!=null&&d(e,["thoughtSignature"],c);const h=u(n,["codeExecutionResult"]);h!=null&&d(e,["codeExecutionResult"],h);const m=u(n,["executableCode"]);m!=null&&d(e,["executableCode"],m);const p=u(n,["functionCall"]);p!=null&&d(e,["functionCall"],p);const y=u(n,["functionResponse"]);y!=null&&d(e,["functionResponse"],y);const T=u(n,["text"]);return T!=null&&d(e,["text"],T),e}function BA(n){const e={},t=u(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>OA(a))),d(e,["parts"],r)}const i=u(n,["role"]);return i!=null&&d(e,["role"],i),e}function HA(n){const e={},t=u(n,["behavior"]);t!=null&&d(e,["behavior"],t);const i=u(n,["description"]);i!=null&&d(e,["description"],i);const r=u(n,["name"]);r!=null&&d(e,["name"],r);const a=u(n,["parameters"]);a!=null&&d(e,["parameters"],a);const c=u(n,["parametersJsonSchema"]);c!=null&&d(e,["parametersJsonSchema"],c);const h=u(n,["response"]);h!=null&&d(e,["response"],h);const m=u(n,["responseJsonSchema"]);return m!=null&&d(e,["responseJsonSchema"],m),e}function VA(n){const e={},t=u(n,["startTime"]);t!=null&&d(e,["startTime"],t);const i=u(n,["endTime"]);return i!=null&&d(e,["endTime"],i),e}function GA(n){const e={},t=u(n,["timeRangeFilter"]);return t!=null&&d(e,["timeRangeFilter"],VA(t)),e}function qA(n){const e={},t=u(n,["mode"]);t!=null&&d(e,["mode"],t);const i=u(n,["dynamicThreshold"]);return i!=null&&d(e,["dynamicThreshold"],i),e}function zA(n){const e={},t=u(n,["dynamicRetrievalConfig"]);return t!=null&&d(e,["dynamicRetrievalConfig"],qA(t)),e}function $A(){return{}}function FA(n){const e={},t=u(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(p=>HA(p))),d(e,["functionDeclarations"],m)}if(u(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=u(n,["googleSearch"]);i!=null&&d(e,["googleSearch"],GA(i));const r=u(n,["googleSearchRetrieval"]);if(r!=null&&d(e,["googleSearchRetrieval"],zA(r)),u(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(u(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");u(n,["urlContext"])!=null&&d(e,["urlContext"],$A());const c=u(n,["codeExecution"]);c!=null&&d(e,["codeExecution"],c);const h=u(n,["computerUse"]);return h!=null&&d(e,["computerUse"],h),e}function YA(n){const e={},t=u(n,["handle"]);if(t!=null&&d(e,["handle"],t),u(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Bg(){return{}}function JA(n){const e={},t=u(n,["disabled"]);t!=null&&d(e,["disabled"],t);const i=u(n,["startOfSpeechSensitivity"]);i!=null&&d(e,["startOfSpeechSensitivity"],i);const r=u(n,["endOfSpeechSensitivity"]);r!=null&&d(e,["endOfSpeechSensitivity"],r);const a=u(n,["prefixPaddingMs"]);a!=null&&d(e,["prefixPaddingMs"],a);const c=u(n,["silenceDurationMs"]);return c!=null&&d(e,["silenceDurationMs"],c),e}function jA(n){const e={},t=u(n,["automaticActivityDetection"]);t!=null&&d(e,["automaticActivityDetection"],JA(t));const i=u(n,["activityHandling"]);i!=null&&d(e,["activityHandling"],i);const r=u(n,["turnCoverage"]);return r!=null&&d(e,["turnCoverage"],r),e}function KA(n){const e={},t=u(n,["targetTokens"]);return t!=null&&d(e,["targetTokens"],t),e}function WA(n){const e={},t=u(n,["triggerTokens"]);t!=null&&d(e,["triggerTokens"],t);const i=u(n,["slidingWindow"]);return i!=null&&d(e,["slidingWindow"],KA(i)),e}function XA(n){const e={},t=u(n,["proactiveAudio"]);return t!=null&&d(e,["proactiveAudio"],t),e}function QA(n,e){const t={},i=u(n,["generationConfig"]);e!==void 0&&i!=null&&d(e,["setup","generationConfig"],i);const r=u(n,["responseModalities"]);e!==void 0&&r!=null&&d(e,["setup","generationConfig","responseModalities"],r);const a=u(n,["temperature"]);e!==void 0&&a!=null&&d(e,["setup","generationConfig","temperature"],a);const c=u(n,["topP"]);e!==void 0&&c!=null&&d(e,["setup","generationConfig","topP"],c);const h=u(n,["topK"]);e!==void 0&&h!=null&&d(e,["setup","generationConfig","topK"],h);const m=u(n,["maxOutputTokens"]);e!==void 0&&m!=null&&d(e,["setup","generationConfig","maxOutputTokens"],m);const p=u(n,["mediaResolution"]);e!==void 0&&p!=null&&d(e,["setup","generationConfig","mediaResolution"],p);const y=u(n,["seed"]);e!==void 0&&y!=null&&d(e,["setup","generationConfig","seed"],y);const T=u(n,["speechConfig"]);e!==void 0&&T!=null&&d(e,["setup","generationConfig","speechConfig"],DA(gd(T)));const x=u(n,["enableAffectiveDialog"]);e!==void 0&&x!=null&&d(e,["setup","generationConfig","enableAffectiveDialog"],x);const C=u(n,["systemInstruction"]);e!==void 0&&C!=null&&d(e,["setup","systemInstruction"],BA(Tt(C)));const _=u(n,["tools"]);if(e!==void 0&&_!=null){let Y=zs(_);Array.isArray(Y)&&(Y=Y.map(oe=>FA(qs(oe)))),d(e,["setup","tools"],Y)}const w=u(n,["sessionResumption"]);e!==void 0&&w!=null&&d(e,["setup","sessionResumption"],YA(w));const N=u(n,["inputAudioTranscription"]);e!==void 0&&N!=null&&d(e,["setup","inputAudioTranscription"],Bg());const H=u(n,["outputAudioTranscription"]);e!==void 0&&H!=null&&d(e,["setup","outputAudioTranscription"],Bg());const K=u(n,["realtimeInputConfig"]);e!==void 0&&K!=null&&d(e,["setup","realtimeInputConfig"],jA(K));const I=u(n,["contextWindowCompression"]);e!==void 0&&I!=null&&d(e,["setup","contextWindowCompression"],WA(I));const Q=u(n,["proactivity"]);return e!==void 0&&Q!=null&&d(e,["setup","proactivity"],XA(Q)),t}function ZA(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["setup","model"],Pe(n,i));const r=u(e,["config"]);return r!=null&&d(t,["config"],QA(r,t)),t}function e_(){return{}}function t_(){return{}}function n_(n){const e={},t=u(n,["media"]);t!=null&&d(e,["mediaChunks"],Fy(t));const i=u(n,["audio"]);i!=null&&d(e,["audio"],Jy(i));const r=u(n,["audioStreamEnd"]);r!=null&&d(e,["audioStreamEnd"],r);const a=u(n,["video"]);a!=null&&d(e,["video"],Yy(a));const c=u(n,["text"]);return c!=null&&d(e,["text"],c),u(n,["activityStart"])!=null&&d(e,["activityStart"],e_()),u(n,["activityEnd"])!=null&&d(e,["activityEnd"],t_()),e}function lv(n){const e={},t=u(n,["text"]);t!=null&&d(e,["text"],t);const i=u(n,["weight"]);return i!=null&&d(e,["weight"],i),e}function i_(n){const e={},t=u(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>lv(r))),d(e,["weightedPrompts"],i)}return e}function cv(n){const e={},t=u(n,["temperature"]);t!=null&&d(e,["temperature"],t);const i=u(n,["topK"]);i!=null&&d(e,["topK"],i);const r=u(n,["seed"]);r!=null&&d(e,["seed"],r);const a=u(n,["guidance"]);a!=null&&d(e,["guidance"],a);const c=u(n,["bpm"]);c!=null&&d(e,["bpm"],c);const h=u(n,["density"]);h!=null&&d(e,["density"],h);const m=u(n,["brightness"]);m!=null&&d(e,["brightness"],m);const p=u(n,["scale"]);p!=null&&d(e,["scale"],p);const y=u(n,["muteBass"]);y!=null&&d(e,["muteBass"],y);const T=u(n,["muteDrums"]);T!=null&&d(e,["muteDrums"],T);const x=u(n,["onlyBassAndDrums"]);x!=null&&d(e,["onlyBassAndDrums"],x);const C=u(n,["musicGenerationMode"]);return C!=null&&d(e,["musicGenerationMode"],C),e}function s_(n){const e={},t=u(n,["musicGenerationConfig"]);return t!=null&&d(e,["musicGenerationConfig"],cv(t)),e}function uv(n){const e={},t=u(n,["model"]);return t!=null&&d(e,["model"],t),e}function dv(n){const e={},t=u(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>lv(r))),d(e,["weightedPrompts"],i)}return e}function Vu(n){const e={},t=u(n,["setup"]);t!=null&&d(e,["setup"],uv(t));const i=u(n,["clientContent"]);i!=null&&d(e,["clientContent"],dv(i));const r=u(n,["musicGenerationConfig"]);r!=null&&d(e,["musicGenerationConfig"],cv(r));const a=u(n,["playbackControl"]);return a!=null&&d(e,["playbackControl"],a),e}function o_(n){const e={},t=u(n,["voiceName"]);return t!=null&&d(e,["voiceName"],t),e}function r_(n){const e={},t=u(n,["prebuiltVoiceConfig"]);return t!=null&&d(e,["prebuiltVoiceConfig"],o_(t)),e}function a_(n){const e={},t=u(n,["voiceConfig"]);if(t!=null&&d(e,["voiceConfig"],r_(t)),u(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=u(n,["languageCode"]);return i!=null&&d(e,["languageCode"],i),e}function l_(n){const e={},t=u(n,["fps"]);t!=null&&d(e,["fps"],t);const i=u(n,["endOffset"]);i!=null&&d(e,["endOffset"],i);const r=u(n,["startOffset"]);return r!=null&&d(e,["startOffset"],r),e}function c_(n){const e={},t=u(n,["displayName"]);t!=null&&d(e,["displayName"],t);const i=u(n,["data"]);i!=null&&d(e,["data"],i);const r=u(n,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function u_(n){const e={},t=u(n,["displayName"]);t!=null&&d(e,["displayName"],t);const i=u(n,["fileUri"]);i!=null&&d(e,["fileUri"],i);const r=u(n,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function d_(n){const e={},t=u(n,["videoMetadata"]);t!=null&&d(e,["videoMetadata"],l_(t));const i=u(n,["thought"]);i!=null&&d(e,["thought"],i);const r=u(n,["inlineData"]);r!=null&&d(e,["inlineData"],c_(r));const a=u(n,["fileData"]);a!=null&&d(e,["fileData"],u_(a));const c=u(n,["thoughtSignature"]);c!=null&&d(e,["thoughtSignature"],c);const h=u(n,["codeExecutionResult"]);h!=null&&d(e,["codeExecutionResult"],h);const m=u(n,["executableCode"]);m!=null&&d(e,["executableCode"],m);const p=u(n,["functionCall"]);p!=null&&d(e,["functionCall"],p);const y=u(n,["functionResponse"]);y!=null&&d(e,["functionResponse"],y);const T=u(n,["text"]);return T!=null&&d(e,["text"],T),e}function f_(n){const e={},t=u(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>d_(a))),d(e,["parts"],r)}const i=u(n,["role"]);return i!=null&&d(e,["role"],i),e}function h_(n){const e={};if(u(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=u(n,["description"]);t!=null&&d(e,["description"],t);const i=u(n,["name"]);i!=null&&d(e,["name"],i);const r=u(n,["parameters"]);r!=null&&d(e,["parameters"],r);const a=u(n,["parametersJsonSchema"]);a!=null&&d(e,["parametersJsonSchema"],a);const c=u(n,["response"]);c!=null&&d(e,["response"],c);const h=u(n,["responseJsonSchema"]);return h!=null&&d(e,["responseJsonSchema"],h),e}function m_(n){const e={},t=u(n,["startTime"]);t!=null&&d(e,["startTime"],t);const i=u(n,["endTime"]);return i!=null&&d(e,["endTime"],i),e}function p_(n){const e={},t=u(n,["timeRangeFilter"]);return t!=null&&d(e,["timeRangeFilter"],m_(t)),e}function g_(n){const e={},t=u(n,["mode"]);t!=null&&d(e,["mode"],t);const i=u(n,["dynamicThreshold"]);return i!=null&&d(e,["dynamicThreshold"],i),e}function y_(n){const e={},t=u(n,["dynamicRetrievalConfig"]);return t!=null&&d(e,["dynamicRetrievalConfig"],g_(t)),e}function v_(){return{}}function T_(n){const e={},t=u(n,["apiKeyString"]);return t!=null&&d(e,["apiKeyString"],t),e}function S_(n){const e={},t=u(n,["apiKeyConfig"]);t!=null&&d(e,["apiKeyConfig"],T_(t));const i=u(n,["authType"]);i!=null&&d(e,["authType"],i);const r=u(n,["googleServiceAccountConfig"]);r!=null&&d(e,["googleServiceAccountConfig"],r);const a=u(n,["httpBasicAuthConfig"]);a!=null&&d(e,["httpBasicAuthConfig"],a);const c=u(n,["oauthConfig"]);c!=null&&d(e,["oauthConfig"],c);const h=u(n,["oidcConfig"]);return h!=null&&d(e,["oidcConfig"],h),e}function x_(n){const e={},t=u(n,["authConfig"]);return t!=null&&d(e,["authConfig"],S_(t)),e}function E_(){return{}}function C_(n){const e={},t=u(n,["functionDeclarations"]);if(t!=null){let T=t;Array.isArray(T)&&(T=T.map(x=>h_(x))),d(e,["functionDeclarations"],T)}const i=u(n,["retrieval"]);i!=null&&d(e,["retrieval"],i);const r=u(n,["googleSearch"]);r!=null&&d(e,["googleSearch"],p_(r));const a=u(n,["googleSearchRetrieval"]);a!=null&&d(e,["googleSearchRetrieval"],y_(a)),u(n,["enterpriseWebSearch"])!=null&&d(e,["enterpriseWebSearch"],v_());const h=u(n,["googleMaps"]);h!=null&&d(e,["googleMaps"],x_(h)),u(n,["urlContext"])!=null&&d(e,["urlContext"],E_());const p=u(n,["codeExecution"]);p!=null&&d(e,["codeExecution"],p);const y=u(n,["computerUse"]);return y!=null&&d(e,["computerUse"],y),e}function A_(n){const e={},t=u(n,["handle"]);t!=null&&d(e,["handle"],t);const i=u(n,["transparent"]);return i!=null&&d(e,["transparent"],i),e}function Hg(){return{}}function __(n){const e={},t=u(n,["disabled"]);t!=null&&d(e,["disabled"],t);const i=u(n,["startOfSpeechSensitivity"]);i!=null&&d(e,["startOfSpeechSensitivity"],i);const r=u(n,["endOfSpeechSensitivity"]);r!=null&&d(e,["endOfSpeechSensitivity"],r);const a=u(n,["prefixPaddingMs"]);a!=null&&d(e,["prefixPaddingMs"],a);const c=u(n,["silenceDurationMs"]);return c!=null&&d(e,["silenceDurationMs"],c),e}function w_(n){const e={},t=u(n,["automaticActivityDetection"]);t!=null&&d(e,["automaticActivityDetection"],__(t));const i=u(n,["activityHandling"]);i!=null&&d(e,["activityHandling"],i);const r=u(n,["turnCoverage"]);return r!=null&&d(e,["turnCoverage"],r),e}function b_(n){const e={},t=u(n,["targetTokens"]);return t!=null&&d(e,["targetTokens"],t),e}function R_(n){const e={},t=u(n,["triggerTokens"]);t!=null&&d(e,["triggerTokens"],t);const i=u(n,["slidingWindow"]);return i!=null&&d(e,["slidingWindow"],b_(i)),e}function M_(n){const e={},t=u(n,["proactiveAudio"]);return t!=null&&d(e,["proactiveAudio"],t),e}function N_(n,e){const t={},i=u(n,["generationConfig"]);e!==void 0&&i!=null&&d(e,["setup","generationConfig"],i);const r=u(n,["responseModalities"]);e!==void 0&&r!=null&&d(e,["setup","generationConfig","responseModalities"],r);const a=u(n,["temperature"]);e!==void 0&&a!=null&&d(e,["setup","generationConfig","temperature"],a);const c=u(n,["topP"]);e!==void 0&&c!=null&&d(e,["setup","generationConfig","topP"],c);const h=u(n,["topK"]);e!==void 0&&h!=null&&d(e,["setup","generationConfig","topK"],h);const m=u(n,["maxOutputTokens"]);e!==void 0&&m!=null&&d(e,["setup","generationConfig","maxOutputTokens"],m);const p=u(n,["mediaResolution"]);e!==void 0&&p!=null&&d(e,["setup","generationConfig","mediaResolution"],p);const y=u(n,["seed"]);e!==void 0&&y!=null&&d(e,["setup","generationConfig","seed"],y);const T=u(n,["speechConfig"]);e!==void 0&&T!=null&&d(e,["setup","generationConfig","speechConfig"],a_(gd(T)));const x=u(n,["enableAffectiveDialog"]);e!==void 0&&x!=null&&d(e,["setup","generationConfig","enableAffectiveDialog"],x);const C=u(n,["systemInstruction"]);e!==void 0&&C!=null&&d(e,["setup","systemInstruction"],f_(Tt(C)));const _=u(n,["tools"]);if(e!==void 0&&_!=null){let Y=zs(_);Array.isArray(Y)&&(Y=Y.map(oe=>C_(qs(oe)))),d(e,["setup","tools"],Y)}const w=u(n,["sessionResumption"]);e!==void 0&&w!=null&&d(e,["setup","sessionResumption"],A_(w));const N=u(n,["inputAudioTranscription"]);e!==void 0&&N!=null&&d(e,["setup","inputAudioTranscription"],Hg());const H=u(n,["outputAudioTranscription"]);e!==void 0&&H!=null&&d(e,["setup","outputAudioTranscription"],Hg());const K=u(n,["realtimeInputConfig"]);e!==void 0&&K!=null&&d(e,["setup","realtimeInputConfig"],w_(K));const I=u(n,["contextWindowCompression"]);e!==void 0&&I!=null&&d(e,["setup","contextWindowCompression"],R_(I));const Q=u(n,["proactivity"]);return e!==void 0&&Q!=null&&d(e,["setup","proactivity"],M_(Q)),t}function k_(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["setup","model"],Pe(n,i));const r=u(e,["config"]);return r!=null&&d(t,["config"],N_(r,t)),t}function I_(){return{}}function D_(){return{}}function L_(n){const e={},t=u(n,["media"]);t!=null&&d(e,["mediaChunks"],Fy(t));const i=u(n,["audio"]);i!=null&&d(e,["audio"],Jy(i));const r=u(n,["audioStreamEnd"]);r!=null&&d(e,["audioStreamEnd"],r);const a=u(n,["video"]);a!=null&&d(e,["video"],Yy(a));const c=u(n,["text"]);return c!=null&&d(e,["text"],c),u(n,["activityStart"])!=null&&d(e,["activityStart"],I_()),u(n,["activityEnd"])!=null&&d(e,["activityEnd"],D_()),e}function P_(){return{}}function U_(n){const e={},t=u(n,["fps"]);t!=null&&d(e,["fps"],t);const i=u(n,["endOffset"]);i!=null&&d(e,["endOffset"],i);const r=u(n,["startOffset"]);return r!=null&&d(e,["startOffset"],r),e}function O_(n){const e={},t=u(n,["data"]);t!=null&&d(e,["data"],t);const i=u(n,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function B_(n){const e={},t=u(n,["fileUri"]);t!=null&&d(e,["fileUri"],t);const i=u(n,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function H_(n){const e={},t=u(n,["videoMetadata"]);t!=null&&d(e,["videoMetadata"],U_(t));const i=u(n,["thought"]);i!=null&&d(e,["thought"],i);const r=u(n,["inlineData"]);r!=null&&d(e,["inlineData"],O_(r));const a=u(n,["fileData"]);a!=null&&d(e,["fileData"],B_(a));const c=u(n,["thoughtSignature"]);c!=null&&d(e,["thoughtSignature"],c);const h=u(n,["codeExecutionResult"]);h!=null&&d(e,["codeExecutionResult"],h);const m=u(n,["executableCode"]);m!=null&&d(e,["executableCode"],m);const p=u(n,["functionCall"]);p!=null&&d(e,["functionCall"],p);const y=u(n,["functionResponse"]);y!=null&&d(e,["functionResponse"],y);const T=u(n,["text"]);return T!=null&&d(e,["text"],T),e}function V_(n){const e={},t=u(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>H_(a))),d(e,["parts"],r)}const i=u(n,["role"]);return i!=null&&d(e,["role"],i),e}function Vg(n){const e={},t=u(n,["text"]);t!=null&&d(e,["text"],t);const i=u(n,["finished"]);return i!=null&&d(e,["finished"],i),e}function G_(n){const e={},t=u(n,["retrievedUrl"]);t!=null&&d(e,["retrievedUrl"],t);const i=u(n,["urlRetrievalStatus"]);return i!=null&&d(e,["urlRetrievalStatus"],i),e}function q_(n){const e={},t=u(n,["urlMetadata"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>G_(r))),d(e,["urlMetadata"],i)}return e}function z_(n){const e={},t=u(n,["modelTurn"]);t!=null&&d(e,["modelTurn"],V_(t));const i=u(n,["turnComplete"]);i!=null&&d(e,["turnComplete"],i);const r=u(n,["interrupted"]);r!=null&&d(e,["interrupted"],r);const a=u(n,["groundingMetadata"]);a!=null&&d(e,["groundingMetadata"],a);const c=u(n,["generationComplete"]);c!=null&&d(e,["generationComplete"],c);const h=u(n,["inputTranscription"]);h!=null&&d(e,["inputTranscription"],Vg(h));const m=u(n,["outputTranscription"]);m!=null&&d(e,["outputTranscription"],Vg(m));const p=u(n,["urlContextMetadata"]);return p!=null&&d(e,["urlContextMetadata"],q_(p)),e}function $_(n){const e={},t=u(n,["id"]);t!=null&&d(e,["id"],t);const i=u(n,["args"]);i!=null&&d(e,["args"],i);const r=u(n,["name"]);return r!=null&&d(e,["name"],r),e}function F_(n){const e={},t=u(n,["functionCalls"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>$_(r))),d(e,["functionCalls"],i)}return e}function Y_(n){const e={},t=u(n,["ids"]);return t!=null&&d(e,["ids"],t),e}function Na(n){const e={},t=u(n,["modality"]);t!=null&&d(e,["modality"],t);const i=u(n,["tokenCount"]);return i!=null&&d(e,["tokenCount"],i),e}function J_(n){const e={},t=u(n,["promptTokenCount"]);t!=null&&d(e,["promptTokenCount"],t);const i=u(n,["cachedContentTokenCount"]);i!=null&&d(e,["cachedContentTokenCount"],i);const r=u(n,["responseTokenCount"]);r!=null&&d(e,["responseTokenCount"],r);const a=u(n,["toolUsePromptTokenCount"]);a!=null&&d(e,["toolUsePromptTokenCount"],a);const c=u(n,["thoughtsTokenCount"]);c!=null&&d(e,["thoughtsTokenCount"],c);const h=u(n,["totalTokenCount"]);h!=null&&d(e,["totalTokenCount"],h);const m=u(n,["promptTokensDetails"]);if(m!=null){let x=m;Array.isArray(x)&&(x=x.map(C=>Na(C))),d(e,["promptTokensDetails"],x)}const p=u(n,["cacheTokensDetails"]);if(p!=null){let x=p;Array.isArray(x)&&(x=x.map(C=>Na(C))),d(e,["cacheTokensDetails"],x)}const y=u(n,["responseTokensDetails"]);if(y!=null){let x=y;Array.isArray(x)&&(x=x.map(C=>Na(C))),d(e,["responseTokensDetails"],x)}const T=u(n,["toolUsePromptTokensDetails"]);if(T!=null){let x=T;Array.isArray(x)&&(x=x.map(C=>Na(C))),d(e,["toolUsePromptTokensDetails"],x)}return e}function j_(n){const e={},t=u(n,["timeLeft"]);return t!=null&&d(e,["timeLeft"],t),e}function K_(n){const e={},t=u(n,["newHandle"]);t!=null&&d(e,["newHandle"],t);const i=u(n,["resumable"]);i!=null&&d(e,["resumable"],i);const r=u(n,["lastConsumedClientMessageIndex"]);return r!=null&&d(e,["lastConsumedClientMessageIndex"],r),e}function W_(n){const e={};u(n,["setupComplete"])!=null&&d(e,["setupComplete"],P_());const i=u(n,["serverContent"]);i!=null&&d(e,["serverContent"],z_(i));const r=u(n,["toolCall"]);r!=null&&d(e,["toolCall"],F_(r));const a=u(n,["toolCallCancellation"]);a!=null&&d(e,["toolCallCancellation"],Y_(a));const c=u(n,["usageMetadata"]);c!=null&&d(e,["usageMetadata"],J_(c));const h=u(n,["goAway"]);h!=null&&d(e,["goAway"],j_(h));const m=u(n,["sessionResumptionUpdate"]);return m!=null&&d(e,["sessionResumptionUpdate"],K_(m)),e}function X_(){return{}}function Q_(n){const e={},t=u(n,["text"]);t!=null&&d(e,["text"],t);const i=u(n,["weight"]);return i!=null&&d(e,["weight"],i),e}function Z_(n){const e={},t=u(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>Q_(r))),d(e,["weightedPrompts"],i)}return e}function ew(n){const e={},t=u(n,["temperature"]);t!=null&&d(e,["temperature"],t);const i=u(n,["topK"]);i!=null&&d(e,["topK"],i);const r=u(n,["seed"]);r!=null&&d(e,["seed"],r);const a=u(n,["guidance"]);a!=null&&d(e,["guidance"],a);const c=u(n,["bpm"]);c!=null&&d(e,["bpm"],c);const h=u(n,["density"]);h!=null&&d(e,["density"],h);const m=u(n,["brightness"]);m!=null&&d(e,["brightness"],m);const p=u(n,["scale"]);p!=null&&d(e,["scale"],p);const y=u(n,["muteBass"]);y!=null&&d(e,["muteBass"],y);const T=u(n,["muteDrums"]);T!=null&&d(e,["muteDrums"],T);const x=u(n,["onlyBassAndDrums"]);x!=null&&d(e,["onlyBassAndDrums"],x);const C=u(n,["musicGenerationMode"]);return C!=null&&d(e,["musicGenerationMode"],C),e}function tw(n){const e={},t=u(n,["clientContent"]);t!=null&&d(e,["clientContent"],Z_(t));const i=u(n,["musicGenerationConfig"]);return i!=null&&d(e,["musicGenerationConfig"],ew(i)),e}function nw(n){const e={},t=u(n,["data"]);t!=null&&d(e,["data"],t);const i=u(n,["mimeType"]);i!=null&&d(e,["mimeType"],i);const r=u(n,["sourceMetadata"]);return r!=null&&d(e,["sourceMetadata"],tw(r)),e}function iw(n){const e={},t=u(n,["audioChunks"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>nw(r))),d(e,["audioChunks"],i)}return e}function sw(n){const e={},t=u(n,["text"]);t!=null&&d(e,["text"],t);const i=u(n,["filteredReason"]);return i!=null&&d(e,["filteredReason"],i),e}function ow(n){const e={};u(n,["setupComplete"])!=null&&d(e,["setupComplete"],X_());const i=u(n,["serverContent"]);i!=null&&d(e,["serverContent"],iw(i));const r=u(n,["filteredPrompt"]);return r!=null&&d(e,["filteredPrompt"],sw(r)),e}function rw(n){const e={},t=u(n,["sessionId"]);return t!=null&&d(e,["sessionId"],t),e}function aw(n){const e={},t=u(n,["fps"]);t!=null&&d(e,["fps"],t);const i=u(n,["endOffset"]);i!=null&&d(e,["endOffset"],i);const r=u(n,["startOffset"]);return r!=null&&d(e,["startOffset"],r),e}function lw(n){const e={},t=u(n,["displayName"]);t!=null&&d(e,["displayName"],t);const i=u(n,["data"]);i!=null&&d(e,["data"],i);const r=u(n,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function cw(n){const e={},t=u(n,["displayName"]);t!=null&&d(e,["displayName"],t);const i=u(n,["fileUri"]);i!=null&&d(e,["fileUri"],i);const r=u(n,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function uw(n){const e={},t=u(n,["videoMetadata"]);t!=null&&d(e,["videoMetadata"],aw(t));const i=u(n,["thought"]);i!=null&&d(e,["thought"],i);const r=u(n,["inlineData"]);r!=null&&d(e,["inlineData"],lw(r));const a=u(n,["fileData"]);a!=null&&d(e,["fileData"],cw(a));const c=u(n,["thoughtSignature"]);c!=null&&d(e,["thoughtSignature"],c);const h=u(n,["codeExecutionResult"]);h!=null&&d(e,["codeExecutionResult"],h);const m=u(n,["executableCode"]);m!=null&&d(e,["executableCode"],m);const p=u(n,["functionCall"]);p!=null&&d(e,["functionCall"],p);const y=u(n,["functionResponse"]);y!=null&&d(e,["functionResponse"],y);const T=u(n,["text"]);return T!=null&&d(e,["text"],T),e}function dw(n){const e={},t=u(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>uw(a))),d(e,["parts"],r)}const i=u(n,["role"]);return i!=null&&d(e,["role"],i),e}function Gg(n){const e={},t=u(n,["text"]);t!=null&&d(e,["text"],t);const i=u(n,["finished"]);return i!=null&&d(e,["finished"],i),e}function fw(n){const e={},t=u(n,["modelTurn"]);t!=null&&d(e,["modelTurn"],dw(t));const i=u(n,["turnComplete"]);i!=null&&d(e,["turnComplete"],i);const r=u(n,["interrupted"]);r!=null&&d(e,["interrupted"],r);const a=u(n,["groundingMetadata"]);a!=null&&d(e,["groundingMetadata"],a);const c=u(n,["generationComplete"]);c!=null&&d(e,["generationComplete"],c);const h=u(n,["inputTranscription"]);h!=null&&d(e,["inputTranscription"],Gg(h));const m=u(n,["outputTranscription"]);return m!=null&&d(e,["outputTranscription"],Gg(m)),e}function hw(n){const e={},t=u(n,["args"]);t!=null&&d(e,["args"],t);const i=u(n,["name"]);return i!=null&&d(e,["name"],i),e}function mw(n){const e={},t=u(n,["functionCalls"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>hw(r))),d(e,["functionCalls"],i)}return e}function pw(n){const e={},t=u(n,["ids"]);return t!=null&&d(e,["ids"],t),e}function ka(n){const e={},t=u(n,["modality"]);t!=null&&d(e,["modality"],t);const i=u(n,["tokenCount"]);return i!=null&&d(e,["tokenCount"],i),e}function gw(n){const e={},t=u(n,["promptTokenCount"]);t!=null&&d(e,["promptTokenCount"],t);const i=u(n,["cachedContentTokenCount"]);i!=null&&d(e,["cachedContentTokenCount"],i);const r=u(n,["candidatesTokenCount"]);r!=null&&d(e,["responseTokenCount"],r);const a=u(n,["toolUsePromptTokenCount"]);a!=null&&d(e,["toolUsePromptTokenCount"],a);const c=u(n,["thoughtsTokenCount"]);c!=null&&d(e,["thoughtsTokenCount"],c);const h=u(n,["totalTokenCount"]);h!=null&&d(e,["totalTokenCount"],h);const m=u(n,["promptTokensDetails"]);if(m!=null){let C=m;Array.isArray(C)&&(C=C.map(_=>ka(_))),d(e,["promptTokensDetails"],C)}const p=u(n,["cacheTokensDetails"]);if(p!=null){let C=p;Array.isArray(C)&&(C=C.map(_=>ka(_))),d(e,["cacheTokensDetails"],C)}const y=u(n,["candidatesTokensDetails"]);if(y!=null){let C=y;Array.isArray(C)&&(C=C.map(_=>ka(_))),d(e,["responseTokensDetails"],C)}const T=u(n,["toolUsePromptTokensDetails"]);if(T!=null){let C=T;Array.isArray(C)&&(C=C.map(_=>ka(_))),d(e,["toolUsePromptTokensDetails"],C)}const x=u(n,["trafficType"]);return x!=null&&d(e,["trafficType"],x),e}function yw(n){const e={},t=u(n,["timeLeft"]);return t!=null&&d(e,["timeLeft"],t),e}function vw(n){const e={},t=u(n,["newHandle"]);t!=null&&d(e,["newHandle"],t);const i=u(n,["resumable"]);i!=null&&d(e,["resumable"],i);const r=u(n,["lastConsumedClientMessageIndex"]);return r!=null&&d(e,["lastConsumedClientMessageIndex"],r),e}function Tw(n){const e={},t=u(n,["setupComplete"]);t!=null&&d(e,["setupComplete"],rw(t));const i=u(n,["serverContent"]);i!=null&&d(e,["serverContent"],fw(i));const r=u(n,["toolCall"]);r!=null&&d(e,["toolCall"],mw(r));const a=u(n,["toolCallCancellation"]);a!=null&&d(e,["toolCallCancellation"],pw(a));const c=u(n,["usageMetadata"]);c!=null&&d(e,["usageMetadata"],gw(c));const h=u(n,["goAway"]);h!=null&&d(e,["goAway"],yw(h));const m=u(n,["sessionResumptionUpdate"]);return m!=null&&d(e,["sessionResumptionUpdate"],vw(m)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Sw(n){const e={},t=u(n,["fps"]);t!=null&&d(e,["fps"],t);const i=u(n,["endOffset"]);i!=null&&d(e,["endOffset"],i);const r=u(n,["startOffset"]);return r!=null&&d(e,["startOffset"],r),e}function xw(n){const e={};if(u(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=u(n,["data"]);t!=null&&d(e,["data"],t);const i=u(n,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function Ew(n){const e={};if(u(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=u(n,["fileUri"]);t!=null&&d(e,["fileUri"],t);const i=u(n,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function Cw(n){const e={},t=u(n,["videoMetadata"]);t!=null&&d(e,["videoMetadata"],Sw(t));const i=u(n,["thought"]);i!=null&&d(e,["thought"],i);const r=u(n,["inlineData"]);r!=null&&d(e,["inlineData"],xw(r));const a=u(n,["fileData"]);a!=null&&d(e,["fileData"],Ew(a));const c=u(n,["thoughtSignature"]);c!=null&&d(e,["thoughtSignature"],c);const h=u(n,["codeExecutionResult"]);h!=null&&d(e,["codeExecutionResult"],h);const m=u(n,["executableCode"]);m!=null&&d(e,["executableCode"],m);const p=u(n,["functionCall"]);p!=null&&d(e,["functionCall"],p);const y=u(n,["functionResponse"]);y!=null&&d(e,["functionResponse"],y);const T=u(n,["text"]);return T!=null&&d(e,["text"],T),e}function el(n){const e={},t=u(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>Cw(a))),d(e,["parts"],r)}const i=u(n,["role"]);return i!=null&&d(e,["role"],i),e}function Aw(n){const e={},t=u(n,["anyOf"]);t!=null&&d(e,["anyOf"],t);const i=u(n,["default"]);i!=null&&d(e,["default"],i);const r=u(n,["description"]);r!=null&&d(e,["description"],r);const a=u(n,["enum"]);a!=null&&d(e,["enum"],a);const c=u(n,["example"]);c!=null&&d(e,["example"],c);const h=u(n,["format"]);h!=null&&d(e,["format"],h);const m=u(n,["items"]);m!=null&&d(e,["items"],m);const p=u(n,["maxItems"]);p!=null&&d(e,["maxItems"],p);const y=u(n,["maxLength"]);y!=null&&d(e,["maxLength"],y);const T=u(n,["maxProperties"]);T!=null&&d(e,["maxProperties"],T);const x=u(n,["maximum"]);x!=null&&d(e,["maximum"],x);const C=u(n,["minItems"]);C!=null&&d(e,["minItems"],C);const _=u(n,["minLength"]);_!=null&&d(e,["minLength"],_);const w=u(n,["minProperties"]);w!=null&&d(e,["minProperties"],w);const N=u(n,["minimum"]);N!=null&&d(e,["minimum"],N);const H=u(n,["nullable"]);H!=null&&d(e,["nullable"],H);const K=u(n,["pattern"]);K!=null&&d(e,["pattern"],K);const I=u(n,["properties"]);I!=null&&d(e,["properties"],I);const Q=u(n,["propertyOrdering"]);Q!=null&&d(e,["propertyOrdering"],Q);const Y=u(n,["required"]);Y!=null&&d(e,["required"],Y);const oe=u(n,["title"]);oe!=null&&d(e,["title"],oe);const ce=u(n,["type"]);return ce!=null&&d(e,["type"],ce),e}function _w(n){const e={};if(u(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=u(n,["category"]);t!=null&&d(e,["category"],t);const i=u(n,["threshold"]);return i!=null&&d(e,["threshold"],i),e}function ww(n){const e={},t=u(n,["behavior"]);t!=null&&d(e,["behavior"],t);const i=u(n,["description"]);i!=null&&d(e,["description"],i);const r=u(n,["name"]);r!=null&&d(e,["name"],r);const a=u(n,["parameters"]);a!=null&&d(e,["parameters"],a);const c=u(n,["parametersJsonSchema"]);c!=null&&d(e,["parametersJsonSchema"],c);const h=u(n,["response"]);h!=null&&d(e,["response"],h);const m=u(n,["responseJsonSchema"]);return m!=null&&d(e,["responseJsonSchema"],m),e}function bw(n){const e={},t=u(n,["startTime"]);t!=null&&d(e,["startTime"],t);const i=u(n,["endTime"]);return i!=null&&d(e,["endTime"],i),e}function Rw(n){const e={},t=u(n,["timeRangeFilter"]);return t!=null&&d(e,["timeRangeFilter"],bw(t)),e}function Mw(n){const e={},t=u(n,["mode"]);t!=null&&d(e,["mode"],t);const i=u(n,["dynamicThreshold"]);return i!=null&&d(e,["dynamicThreshold"],i),e}function Nw(n){const e={},t=u(n,["dynamicRetrievalConfig"]);return t!=null&&d(e,["dynamicRetrievalConfig"],Mw(t)),e}function kw(){return{}}function Iw(n){const e={},t=u(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(p=>ww(p))),d(e,["functionDeclarations"],m)}if(u(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=u(n,["googleSearch"]);i!=null&&d(e,["googleSearch"],Rw(i));const r=u(n,["googleSearchRetrieval"]);if(r!=null&&d(e,["googleSearchRetrieval"],Nw(r)),u(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(u(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");u(n,["urlContext"])!=null&&d(e,["urlContext"],kw());const c=u(n,["codeExecution"]);c!=null&&d(e,["codeExecution"],c);const h=u(n,["computerUse"]);return h!=null&&d(e,["computerUse"],h),e}function Dw(n){const e={},t=u(n,["mode"]);t!=null&&d(e,["mode"],t);const i=u(n,["allowedFunctionNames"]);return i!=null&&d(e,["allowedFunctionNames"],i),e}function Lw(n){const e={},t=u(n,["latitude"]);t!=null&&d(e,["latitude"],t);const i=u(n,["longitude"]);return i!=null&&d(e,["longitude"],i),e}function Pw(n){const e={},t=u(n,["latLng"]);t!=null&&d(e,["latLng"],Lw(t));const i=u(n,["languageCode"]);return i!=null&&d(e,["languageCode"],i),e}function Uw(n){const e={},t=u(n,["functionCallingConfig"]);t!=null&&d(e,["functionCallingConfig"],Dw(t));const i=u(n,["retrievalConfig"]);return i!=null&&d(e,["retrievalConfig"],Pw(i)),e}function Ow(n){const e={},t=u(n,["voiceName"]);return t!=null&&d(e,["voiceName"],t),e}function fv(n){const e={},t=u(n,["prebuiltVoiceConfig"]);return t!=null&&d(e,["prebuiltVoiceConfig"],Ow(t)),e}function Bw(n){const e={},t=u(n,["speaker"]);t!=null&&d(e,["speaker"],t);const i=u(n,["voiceConfig"]);return i!=null&&d(e,["voiceConfig"],fv(i)),e}function Hw(n){const e={},t=u(n,["speakerVoiceConfigs"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>Bw(r))),d(e,["speakerVoiceConfigs"],i)}return e}function Vw(n){const e={},t=u(n,["voiceConfig"]);t!=null&&d(e,["voiceConfig"],fv(t));const i=u(n,["multiSpeakerVoiceConfig"]);i!=null&&d(e,["multiSpeakerVoiceConfig"],Hw(i));const r=u(n,["languageCode"]);return r!=null&&d(e,["languageCode"],r),e}function Gw(n){const e={},t=u(n,["includeThoughts"]);t!=null&&d(e,["includeThoughts"],t);const i=u(n,["thinkingBudget"]);return i!=null&&d(e,["thinkingBudget"],i),e}function qw(n,e,t){const i={},r=u(e,["systemInstruction"]);t!==void 0&&r!=null&&d(t,["systemInstruction"],el(Tt(r)));const a=u(e,["temperature"]);a!=null&&d(i,["temperature"],a);const c=u(e,["topP"]);c!=null&&d(i,["topP"],c);const h=u(e,["topK"]);h!=null&&d(i,["topK"],h);const m=u(e,["candidateCount"]);m!=null&&d(i,["candidateCount"],m);const p=u(e,["maxOutputTokens"]);p!=null&&d(i,["maxOutputTokens"],p);const y=u(e,["stopSequences"]);y!=null&&d(i,["stopSequences"],y);const T=u(e,["responseLogprobs"]);T!=null&&d(i,["responseLogprobs"],T);const x=u(e,["logprobs"]);x!=null&&d(i,["logprobs"],x);const C=u(e,["presencePenalty"]);C!=null&&d(i,["presencePenalty"],C);const _=u(e,["frequencyPenalty"]);_!=null&&d(i,["frequencyPenalty"],_);const w=u(e,["seed"]);w!=null&&d(i,["seed"],w);const N=u(e,["responseMimeType"]);N!=null&&d(i,["responseMimeType"],N);const H=u(e,["responseSchema"]);H!=null&&d(i,["responseSchema"],Aw(md(H)));const K=u(e,["responseJsonSchema"]);if(K!=null&&d(i,["responseJsonSchema"],K),u(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(u(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const I=u(e,["safetySettings"]);if(t!==void 0&&I!=null){let F=I;Array.isArray(F)&&(F=F.map(ie=>_w(ie))),d(t,["safetySettings"],F)}const Q=u(e,["tools"]);if(t!==void 0&&Q!=null){let F=zs(Q);Array.isArray(F)&&(F=F.map(ie=>Iw(qs(ie)))),d(t,["tools"],F)}const Y=u(e,["toolConfig"]);if(t!==void 0&&Y!=null&&d(t,["toolConfig"],Uw(Y)),u(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const oe=u(e,["cachedContent"]);t!==void 0&&oe!=null&&d(t,["cachedContent"],bn(n,oe));const ce=u(e,["responseModalities"]);ce!=null&&d(i,["responseModalities"],ce);const Ae=u(e,["mediaResolution"]);Ae!=null&&d(i,["mediaResolution"],Ae);const pe=u(e,["speechConfig"]);if(pe!=null&&d(i,["speechConfig"],Vw(pd(pe))),u(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const se=u(e,["thinkingConfig"]);return se!=null&&d(i,["thinkingConfig"],Gw(se)),i}function qg(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["_url","model"],Pe(n,i));const r=u(e,["contents"]);if(r!=null){let c=Jt(r);Array.isArray(c)&&(c=c.map(h=>el(h))),d(t,["contents"],c)}const a=u(e,["config"]);return a!=null&&d(t,["generationConfig"],qw(n,a,t)),t}function zw(n,e){const t={},i=u(n,["taskType"]);e!==void 0&&i!=null&&d(e,["requests[]","taskType"],i);const r=u(n,["title"]);e!==void 0&&r!=null&&d(e,["requests[]","title"],r);const a=u(n,["outputDimensionality"]);if(e!==void 0&&a!=null&&d(e,["requests[]","outputDimensionality"],a),u(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(u(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function $w(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["_url","model"],Pe(n,i));const r=u(e,["contents"]);r!=null&&d(t,["requests[]","content"],Ky(n,r));const a=u(e,["config"]);a!=null&&d(t,["config"],zw(a,t));const c=u(e,["model"]);return c!==void 0&&d(t,["requests[]","model"],Pe(n,c)),t}function Fw(n,e){const t={};if(u(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(u(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=u(n,["numberOfImages"]);e!==void 0&&i!=null&&d(e,["parameters","sampleCount"],i);const r=u(n,["aspectRatio"]);e!==void 0&&r!=null&&d(e,["parameters","aspectRatio"],r);const a=u(n,["guidanceScale"]);if(e!==void 0&&a!=null&&d(e,["parameters","guidanceScale"],a),u(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const c=u(n,["safetyFilterLevel"]);e!==void 0&&c!=null&&d(e,["parameters","safetySetting"],c);const h=u(n,["personGeneration"]);e!==void 0&&h!=null&&d(e,["parameters","personGeneration"],h);const m=u(n,["includeSafetyAttributes"]);e!==void 0&&m!=null&&d(e,["parameters","includeSafetyAttributes"],m);const p=u(n,["includeRaiReason"]);e!==void 0&&p!=null&&d(e,["parameters","includeRaiReason"],p);const y=u(n,["language"]);e!==void 0&&y!=null&&d(e,["parameters","language"],y);const T=u(n,["outputMimeType"]);e!==void 0&&T!=null&&d(e,["parameters","outputOptions","mimeType"],T);const x=u(n,["outputCompressionQuality"]);if(e!==void 0&&x!=null&&d(e,["parameters","outputOptions","compressionQuality"],x),u(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");const C=u(n,["imageSize"]);if(e!==void 0&&C!=null&&d(e,["parameters","sampleImageSize"],C),u(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function Yw(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["_url","model"],Pe(n,i));const r=u(e,["prompt"]);r!=null&&d(t,["instances[0]","prompt"],r);const a=u(e,["config"]);return a!=null&&d(t,["config"],Fw(a,t)),t}function Jw(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["_url","name"],Pe(n,i));const r=u(e,["config"]);return r!=null&&d(t,["config"],r),t}function jw(n,e,t){const i={},r=u(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const a=u(e,["pageToken"]);t!==void 0&&a!=null&&d(t,["_query","pageToken"],a);const c=u(e,["filter"]);t!==void 0&&c!=null&&d(t,["_query","filter"],c);const h=u(e,["queryBase"]);return t!==void 0&&h!=null&&d(t,["_url","models_url"],Qy(n,h)),i}function Kw(n,e){const t={},i=u(e,["config"]);return i!=null&&d(t,["config"],jw(n,i,t)),t}function Ww(n,e){const t={},i=u(n,["displayName"]);e!==void 0&&i!=null&&d(e,["displayName"],i);const r=u(n,["description"]);e!==void 0&&r!=null&&d(e,["description"],r);const a=u(n,["defaultCheckpointId"]);return e!==void 0&&a!=null&&d(e,["defaultCheckpointId"],a),t}function Xw(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["_url","name"],Pe(n,i));const r=u(e,["config"]);return r!=null&&d(t,["config"],Ww(r,t)),t}function Qw(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["_url","name"],Pe(n,i));const r=u(e,["config"]);return r!=null&&d(t,["config"],r),t}function Zw(n){const e={};if(u(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(u(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(u(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function eb(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["_url","model"],Pe(n,i));const r=u(e,["contents"]);if(r!=null){let c=Jt(r);Array.isArray(c)&&(c=c.map(h=>el(h))),d(t,["contents"],c)}const a=u(e,["config"]);return a!=null&&d(t,["config"],Zw(a)),t}function tb(n){const e={};if(u(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=u(n,["imageBytes"]);t!=null&&d(e,["bytesBase64Encoded"],ki(t));const i=u(n,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function nb(n,e){const t={},i=u(n,["numberOfVideos"]);if(e!==void 0&&i!=null&&d(e,["parameters","sampleCount"],i),u(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(u(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const r=u(n,["durationSeconds"]);if(e!==void 0&&r!=null&&d(e,["parameters","durationSeconds"],r),u(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=u(n,["aspectRatio"]);if(e!==void 0&&a!=null&&d(e,["parameters","aspectRatio"],a),u(n,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const c=u(n,["personGeneration"]);if(e!==void 0&&c!=null&&d(e,["parameters","personGeneration"],c),u(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const h=u(n,["negativePrompt"]);e!==void 0&&h!=null&&d(e,["parameters","negativePrompt"],h);const m=u(n,["enhancePrompt"]);if(e!==void 0&&m!=null&&d(e,["parameters","enhancePrompt"],m),u(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(u(n,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");if(u(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function ib(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["_url","model"],Pe(n,i));const r=u(e,["prompt"]);r!=null&&d(t,["instances[0]","prompt"],r);const a=u(e,["image"]);if(a!=null&&d(t,["instances[0]","image"],tb(a)),u(e,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const c=u(e,["config"]);return c!=null&&d(t,["config"],nb(c,t)),t}function sb(n){const e={},t=u(n,["fps"]);t!=null&&d(e,["fps"],t);const i=u(n,["endOffset"]);i!=null&&d(e,["endOffset"],i);const r=u(n,["startOffset"]);return r!=null&&d(e,["startOffset"],r),e}function ob(n){const e={},t=u(n,["displayName"]);t!=null&&d(e,["displayName"],t);const i=u(n,["data"]);i!=null&&d(e,["data"],i);const r=u(n,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function rb(n){const e={},t=u(n,["displayName"]);t!=null&&d(e,["displayName"],t);const i=u(n,["fileUri"]);i!=null&&d(e,["fileUri"],i);const r=u(n,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function ab(n){const e={},t=u(n,["videoMetadata"]);t!=null&&d(e,["videoMetadata"],sb(t));const i=u(n,["thought"]);i!=null&&d(e,["thought"],i);const r=u(n,["inlineData"]);r!=null&&d(e,["inlineData"],ob(r));const a=u(n,["fileData"]);a!=null&&d(e,["fileData"],rb(a));const c=u(n,["thoughtSignature"]);c!=null&&d(e,["thoughtSignature"],c);const h=u(n,["codeExecutionResult"]);h!=null&&d(e,["codeExecutionResult"],h);const m=u(n,["executableCode"]);m!=null&&d(e,["executableCode"],m);const p=u(n,["functionCall"]);p!=null&&d(e,["functionCall"],p);const y=u(n,["functionResponse"]);y!=null&&d(e,["functionResponse"],y);const T=u(n,["text"]);return T!=null&&d(e,["text"],T),e}function Fs(n){const e={},t=u(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>ab(a))),d(e,["parts"],r)}const i=u(n,["role"]);return i!=null&&d(e,["role"],i),e}function lb(n){const e={},t=u(n,["anyOf"]);t!=null&&d(e,["anyOf"],t);const i=u(n,["default"]);i!=null&&d(e,["default"],i);const r=u(n,["description"]);r!=null&&d(e,["description"],r);const a=u(n,["enum"]);a!=null&&d(e,["enum"],a);const c=u(n,["example"]);c!=null&&d(e,["example"],c);const h=u(n,["format"]);h!=null&&d(e,["format"],h);const m=u(n,["items"]);m!=null&&d(e,["items"],m);const p=u(n,["maxItems"]);p!=null&&d(e,["maxItems"],p);const y=u(n,["maxLength"]);y!=null&&d(e,["maxLength"],y);const T=u(n,["maxProperties"]);T!=null&&d(e,["maxProperties"],T);const x=u(n,["maximum"]);x!=null&&d(e,["maximum"],x);const C=u(n,["minItems"]);C!=null&&d(e,["minItems"],C);const _=u(n,["minLength"]);_!=null&&d(e,["minLength"],_);const w=u(n,["minProperties"]);w!=null&&d(e,["minProperties"],w);const N=u(n,["minimum"]);N!=null&&d(e,["minimum"],N);const H=u(n,["nullable"]);H!=null&&d(e,["nullable"],H);const K=u(n,["pattern"]);K!=null&&d(e,["pattern"],K);const I=u(n,["properties"]);I!=null&&d(e,["properties"],I);const Q=u(n,["propertyOrdering"]);Q!=null&&d(e,["propertyOrdering"],Q);const Y=u(n,["required"]);Y!=null&&d(e,["required"],Y);const oe=u(n,["title"]);oe!=null&&d(e,["title"],oe);const ce=u(n,["type"]);return ce!=null&&d(e,["type"],ce),e}function cb(n){const e={},t=u(n,["featureSelectionPreference"]);return t!=null&&d(e,["featureSelectionPreference"],t),e}function ub(n){const e={},t=u(n,["method"]);t!=null&&d(e,["method"],t);const i=u(n,["category"]);i!=null&&d(e,["category"],i);const r=u(n,["threshold"]);return r!=null&&d(e,["threshold"],r),e}function db(n){const e={};if(u(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=u(n,["description"]);t!=null&&d(e,["description"],t);const i=u(n,["name"]);i!=null&&d(e,["name"],i);const r=u(n,["parameters"]);r!=null&&d(e,["parameters"],r);const a=u(n,["parametersJsonSchema"]);a!=null&&d(e,["parametersJsonSchema"],a);const c=u(n,["response"]);c!=null&&d(e,["response"],c);const h=u(n,["responseJsonSchema"]);return h!=null&&d(e,["responseJsonSchema"],h),e}function fb(n){const e={},t=u(n,["startTime"]);t!=null&&d(e,["startTime"],t);const i=u(n,["endTime"]);return i!=null&&d(e,["endTime"],i),e}function hb(n){const e={},t=u(n,["timeRangeFilter"]);return t!=null&&d(e,["timeRangeFilter"],fb(t)),e}function mb(n){const e={},t=u(n,["mode"]);t!=null&&d(e,["mode"],t);const i=u(n,["dynamicThreshold"]);return i!=null&&d(e,["dynamicThreshold"],i),e}function pb(n){const e={},t=u(n,["dynamicRetrievalConfig"]);return t!=null&&d(e,["dynamicRetrievalConfig"],mb(t)),e}function gb(){return{}}function yb(n){const e={},t=u(n,["apiKeyString"]);return t!=null&&d(e,["apiKeyString"],t),e}function vb(n){const e={},t=u(n,["apiKeyConfig"]);t!=null&&d(e,["apiKeyConfig"],yb(t));const i=u(n,["authType"]);i!=null&&d(e,["authType"],i);const r=u(n,["googleServiceAccountConfig"]);r!=null&&d(e,["googleServiceAccountConfig"],r);const a=u(n,["httpBasicAuthConfig"]);a!=null&&d(e,["httpBasicAuthConfig"],a);const c=u(n,["oauthConfig"]);c!=null&&d(e,["oauthConfig"],c);const h=u(n,["oidcConfig"]);return h!=null&&d(e,["oidcConfig"],h),e}function Tb(n){const e={},t=u(n,["authConfig"]);return t!=null&&d(e,["authConfig"],vb(t)),e}function Sb(){return{}}function hv(n){const e={},t=u(n,["functionDeclarations"]);if(t!=null){let T=t;Array.isArray(T)&&(T=T.map(x=>db(x))),d(e,["functionDeclarations"],T)}const i=u(n,["retrieval"]);i!=null&&d(e,["retrieval"],i);const r=u(n,["googleSearch"]);r!=null&&d(e,["googleSearch"],hb(r));const a=u(n,["googleSearchRetrieval"]);a!=null&&d(e,["googleSearchRetrieval"],pb(a)),u(n,["enterpriseWebSearch"])!=null&&d(e,["enterpriseWebSearch"],gb());const h=u(n,["googleMaps"]);h!=null&&d(e,["googleMaps"],Tb(h)),u(n,["urlContext"])!=null&&d(e,["urlContext"],Sb());const p=u(n,["codeExecution"]);p!=null&&d(e,["codeExecution"],p);const y=u(n,["computerUse"]);return y!=null&&d(e,["computerUse"],y),e}function xb(n){const e={},t=u(n,["mode"]);t!=null&&d(e,["mode"],t);const i=u(n,["allowedFunctionNames"]);return i!=null&&d(e,["allowedFunctionNames"],i),e}function Eb(n){const e={},t=u(n,["latitude"]);t!=null&&d(e,["latitude"],t);const i=u(n,["longitude"]);return i!=null&&d(e,["longitude"],i),e}function Cb(n){const e={},t=u(n,["latLng"]);t!=null&&d(e,["latLng"],Eb(t));const i=u(n,["languageCode"]);return i!=null&&d(e,["languageCode"],i),e}function Ab(n){const e={},t=u(n,["functionCallingConfig"]);t!=null&&d(e,["functionCallingConfig"],xb(t));const i=u(n,["retrievalConfig"]);return i!=null&&d(e,["retrievalConfig"],Cb(i)),e}function _b(n){const e={},t=u(n,["voiceName"]);return t!=null&&d(e,["voiceName"],t),e}function wb(n){const e={},t=u(n,["prebuiltVoiceConfig"]);return t!=null&&d(e,["prebuiltVoiceConfig"],_b(t)),e}function bb(n){const e={},t=u(n,["voiceConfig"]);if(t!=null&&d(e,["voiceConfig"],wb(t)),u(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=u(n,["languageCode"]);return i!=null&&d(e,["languageCode"],i),e}function Rb(n){const e={},t=u(n,["includeThoughts"]);t!=null&&d(e,["includeThoughts"],t);const i=u(n,["thinkingBudget"]);return i!=null&&d(e,["thinkingBudget"],i),e}function Mb(n,e,t){const i={},r=u(e,["systemInstruction"]);t!==void 0&&r!=null&&d(t,["systemInstruction"],Fs(Tt(r)));const a=u(e,["temperature"]);a!=null&&d(i,["temperature"],a);const c=u(e,["topP"]);c!=null&&d(i,["topP"],c);const h=u(e,["topK"]);h!=null&&d(i,["topK"],h);const m=u(e,["candidateCount"]);m!=null&&d(i,["candidateCount"],m);const p=u(e,["maxOutputTokens"]);p!=null&&d(i,["maxOutputTokens"],p);const y=u(e,["stopSequences"]);y!=null&&d(i,["stopSequences"],y);const T=u(e,["responseLogprobs"]);T!=null&&d(i,["responseLogprobs"],T);const x=u(e,["logprobs"]);x!=null&&d(i,["logprobs"],x);const C=u(e,["presencePenalty"]);C!=null&&d(i,["presencePenalty"],C);const _=u(e,["frequencyPenalty"]);_!=null&&d(i,["frequencyPenalty"],_);const w=u(e,["seed"]);w!=null&&d(i,["seed"],w);const N=u(e,["responseMimeType"]);N!=null&&d(i,["responseMimeType"],N);const H=u(e,["responseSchema"]);H!=null&&d(i,["responseSchema"],lb(md(H)));const K=u(e,["responseJsonSchema"]);K!=null&&d(i,["responseJsonSchema"],K);const I=u(e,["routingConfig"]);I!=null&&d(i,["routingConfig"],I);const Q=u(e,["modelSelectionConfig"]);Q!=null&&d(i,["modelConfig"],cb(Q));const Y=u(e,["safetySettings"]);if(t!==void 0&&Y!=null){let fe=Y;Array.isArray(fe)&&(fe=fe.map(P=>ub(P))),d(t,["safetySettings"],fe)}const oe=u(e,["tools"]);if(t!==void 0&&oe!=null){let fe=zs(oe);Array.isArray(fe)&&(fe=fe.map(P=>hv(qs(P)))),d(t,["tools"],fe)}const ce=u(e,["toolConfig"]);t!==void 0&&ce!=null&&d(t,["toolConfig"],Ab(ce));const Ae=u(e,["labels"]);t!==void 0&&Ae!=null&&d(t,["labels"],Ae);const pe=u(e,["cachedContent"]);t!==void 0&&pe!=null&&d(t,["cachedContent"],bn(n,pe));const se=u(e,["responseModalities"]);se!=null&&d(i,["responseModalities"],se);const F=u(e,["mediaResolution"]);F!=null&&d(i,["mediaResolution"],F);const ie=u(e,["speechConfig"]);ie!=null&&d(i,["speechConfig"],bb(pd(ie)));const de=u(e,["audioTimestamp"]);de!=null&&d(i,["audioTimestamp"],de);const ue=u(e,["thinkingConfig"]);return ue!=null&&d(i,["thinkingConfig"],Rb(ue)),i}function zg(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["_url","model"],Pe(n,i));const r=u(e,["contents"]);if(r!=null){let c=Jt(r);Array.isArray(c)&&(c=c.map(h=>Fs(h))),d(t,["contents"],c)}const a=u(e,["config"]);return a!=null&&d(t,["generationConfig"],Mb(n,a,t)),t}function Nb(n,e){const t={},i=u(n,["taskType"]);e!==void 0&&i!=null&&d(e,["instances[]","task_type"],i);const r=u(n,["title"]);e!==void 0&&r!=null&&d(e,["instances[]","title"],r);const a=u(n,["outputDimensionality"]);e!==void 0&&a!=null&&d(e,["parameters","outputDimensionality"],a);const c=u(n,["mimeType"]);e!==void 0&&c!=null&&d(e,["instances[]","mimeType"],c);const h=u(n,["autoTruncate"]);return e!==void 0&&h!=null&&d(e,["parameters","autoTruncate"],h),t}function kb(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["_url","model"],Pe(n,i));const r=u(e,["contents"]);r!=null&&d(t,["instances[]","content"],Ky(n,r));const a=u(e,["config"]);return a!=null&&d(t,["config"],Nb(a,t)),t}function Ib(n,e){const t={},i=u(n,["outputGcsUri"]);e!==void 0&&i!=null&&d(e,["parameters","storageUri"],i);const r=u(n,["negativePrompt"]);e!==void 0&&r!=null&&d(e,["parameters","negativePrompt"],r);const a=u(n,["numberOfImages"]);e!==void 0&&a!=null&&d(e,["parameters","sampleCount"],a);const c=u(n,["aspectRatio"]);e!==void 0&&c!=null&&d(e,["parameters","aspectRatio"],c);const h=u(n,["guidanceScale"]);e!==void 0&&h!=null&&d(e,["parameters","guidanceScale"],h);const m=u(n,["seed"]);e!==void 0&&m!=null&&d(e,["parameters","seed"],m);const p=u(n,["safetyFilterLevel"]);e!==void 0&&p!=null&&d(e,["parameters","safetySetting"],p);const y=u(n,["personGeneration"]);e!==void 0&&y!=null&&d(e,["parameters","personGeneration"],y);const T=u(n,["includeSafetyAttributes"]);e!==void 0&&T!=null&&d(e,["parameters","includeSafetyAttributes"],T);const x=u(n,["includeRaiReason"]);e!==void 0&&x!=null&&d(e,["parameters","includeRaiReason"],x);const C=u(n,["language"]);e!==void 0&&C!=null&&d(e,["parameters","language"],C);const _=u(n,["outputMimeType"]);e!==void 0&&_!=null&&d(e,["parameters","outputOptions","mimeType"],_);const w=u(n,["outputCompressionQuality"]);e!==void 0&&w!=null&&d(e,["parameters","outputOptions","compressionQuality"],w);const N=u(n,["addWatermark"]);e!==void 0&&N!=null&&d(e,["parameters","addWatermark"],N);const H=u(n,["imageSize"]);e!==void 0&&H!=null&&d(e,["parameters","sampleImageSize"],H);const K=u(n,["enhancePrompt"]);return e!==void 0&&K!=null&&d(e,["parameters","enhancePrompt"],K),t}function Db(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["_url","model"],Pe(n,i));const r=u(e,["prompt"]);r!=null&&d(t,["instances[0]","prompt"],r);const a=u(e,["config"]);return a!=null&&d(t,["config"],Ib(a,t)),t}function Ys(n){const e={},t=u(n,["gcsUri"]);t!=null&&d(e,["gcsUri"],t);const i=u(n,["imageBytes"]);i!=null&&d(e,["bytesBase64Encoded"],ki(i));const r=u(n,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function Lb(n){const e={},t=u(n,["maskMode"]);t!=null&&d(e,["maskMode"],t);const i=u(n,["segmentationClasses"]);i!=null&&d(e,["maskClasses"],i);const r=u(n,["maskDilation"]);return r!=null&&d(e,["dilation"],r),e}function Pb(n){const e={},t=u(n,["controlType"]);t!=null&&d(e,["controlType"],t);const i=u(n,["enableControlImageComputation"]);return i!=null&&d(e,["computeControl"],i),e}function Ub(n){const e={},t=u(n,["styleDescription"]);return t!=null&&d(e,["styleDescription"],t),e}function Ob(n){const e={},t=u(n,["subjectType"]);t!=null&&d(e,["subjectType"],t);const i=u(n,["subjectDescription"]);return i!=null&&d(e,["subjectDescription"],i),e}function Bb(n){const e={},t=u(n,["referenceImage"]);t!=null&&d(e,["referenceImage"],Ys(t));const i=u(n,["referenceId"]);i!=null&&d(e,["referenceId"],i);const r=u(n,["referenceType"]);r!=null&&d(e,["referenceType"],r);const a=u(n,["maskImageConfig"]);a!=null&&d(e,["maskImageConfig"],Lb(a));const c=u(n,["controlImageConfig"]);c!=null&&d(e,["controlImageConfig"],Pb(c));const h=u(n,["styleImageConfig"]);h!=null&&d(e,["styleImageConfig"],Ub(h));const m=u(n,["subjectImageConfig"]);return m!=null&&d(e,["subjectImageConfig"],Ob(m)),e}function Hb(n,e){const t={},i=u(n,["outputGcsUri"]);e!==void 0&&i!=null&&d(e,["parameters","storageUri"],i);const r=u(n,["negativePrompt"]);e!==void 0&&r!=null&&d(e,["parameters","negativePrompt"],r);const a=u(n,["numberOfImages"]);e!==void 0&&a!=null&&d(e,["parameters","sampleCount"],a);const c=u(n,["aspectRatio"]);e!==void 0&&c!=null&&d(e,["parameters","aspectRatio"],c);const h=u(n,["guidanceScale"]);e!==void 0&&h!=null&&d(e,["parameters","guidanceScale"],h);const m=u(n,["seed"]);e!==void 0&&m!=null&&d(e,["parameters","seed"],m);const p=u(n,["safetyFilterLevel"]);e!==void 0&&p!=null&&d(e,["parameters","safetySetting"],p);const y=u(n,["personGeneration"]);e!==void 0&&y!=null&&d(e,["parameters","personGeneration"],y);const T=u(n,["includeSafetyAttributes"]);e!==void 0&&T!=null&&d(e,["parameters","includeSafetyAttributes"],T);const x=u(n,["includeRaiReason"]);e!==void 0&&x!=null&&d(e,["parameters","includeRaiReason"],x);const C=u(n,["language"]);e!==void 0&&C!=null&&d(e,["parameters","language"],C);const _=u(n,["outputMimeType"]);e!==void 0&&_!=null&&d(e,["parameters","outputOptions","mimeType"],_);const w=u(n,["outputCompressionQuality"]);e!==void 0&&w!=null&&d(e,["parameters","outputOptions","compressionQuality"],w);const N=u(n,["addWatermark"]);e!==void 0&&N!=null&&d(e,["parameters","addWatermark"],N);const H=u(n,["editMode"]);e!==void 0&&H!=null&&d(e,["parameters","editMode"],H);const K=u(n,["baseSteps"]);return e!==void 0&&K!=null&&d(e,["parameters","editConfig","baseSteps"],K),t}function Vb(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["_url","model"],Pe(n,i));const r=u(e,["prompt"]);r!=null&&d(t,["instances[0]","prompt"],r);const a=u(e,["referenceImages"]);if(a!=null){let h=a;Array.isArray(h)&&(h=h.map(m=>Bb(m))),d(t,["instances[0]","referenceImages"],h)}const c=u(e,["config"]);return c!=null&&d(t,["config"],Hb(c,t)),t}function Gb(n,e){const t={},i=u(n,["includeRaiReason"]);e!==void 0&&i!=null&&d(e,["parameters","includeRaiReason"],i);const r=u(n,["outputMimeType"]);e!==void 0&&r!=null&&d(e,["parameters","outputOptions","mimeType"],r);const a=u(n,["outputCompressionQuality"]);e!==void 0&&a!=null&&d(e,["parameters","outputOptions","compressionQuality"],a);const c=u(n,["enhanceInputImage"]);e!==void 0&&c!=null&&d(e,["parameters","upscaleConfig","enhanceInputImage"],c);const h=u(n,["imagePreservationFactor"]);e!==void 0&&h!=null&&d(e,["parameters","upscaleConfig","imagePreservationFactor"],h);const m=u(n,["numberOfImages"]);e!==void 0&&m!=null&&d(e,["parameters","sampleCount"],m);const p=u(n,["mode"]);return e!==void 0&&p!=null&&d(e,["parameters","mode"],p),t}function qb(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["_url","model"],Pe(n,i));const r=u(e,["image"]);r!=null&&d(t,["instances[0]","image"],Ys(r));const a=u(e,["upscaleFactor"]);a!=null&&d(t,["parameters","upscaleConfig","upscaleFactor"],a);const c=u(e,["config"]);return c!=null&&d(t,["config"],Gb(c,t)),t}function zb(n){const e={},t=u(n,["productImage"]);return t!=null&&d(e,["image"],Ys(t)),e}function $b(n,e){const t={},i=u(n,["prompt"]);e!==void 0&&i!=null&&d(e,["instances[0]","prompt"],i);const r=u(n,["personImage"]);e!==void 0&&r!=null&&d(e,["instances[0]","personImage","image"],Ys(r));const a=u(n,["productImages"]);if(e!==void 0&&a!=null){let c=a;Array.isArray(c)&&(c=c.map(h=>zb(h))),d(e,["instances[0]","productImages"],c)}return t}function Fb(n,e){const t={},i=u(n,["numberOfImages"]);e!==void 0&&i!=null&&d(e,["parameters","sampleCount"],i);const r=u(n,["baseSteps"]);e!==void 0&&r!=null&&d(e,["parameters","editConfig","baseSteps"],r);const a=u(n,["outputGcsUri"]);e!==void 0&&a!=null&&d(e,["parameters","storageUri"],a);const c=u(n,["seed"]);e!==void 0&&c!=null&&d(e,["parameters","seed"],c);const h=u(n,["safetyFilterLevel"]);e!==void 0&&h!=null&&d(e,["parameters","safetySetting"],h);const m=u(n,["personGeneration"]);e!==void 0&&m!=null&&d(e,["parameters","personGeneration"],m);const p=u(n,["outputMimeType"]);e!==void 0&&p!=null&&d(e,["parameters","outputOptions","mimeType"],p);const y=u(n,["outputCompressionQuality"]);e!==void 0&&y!=null&&d(e,["parameters","outputOptions","compressionQuality"],y);const T=u(n,["enhancePrompt"]);return e!==void 0&&T!=null&&d(e,["parameters","enhancePrompt"],T),t}function Yb(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["_url","model"],Pe(n,i));const r=u(e,["source"]);r!=null&&d(t,["config"],$b(r,t));const a=u(e,["config"]);return a!=null&&d(t,["config"],Fb(a,t)),t}function Jb(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["_url","name"],Pe(n,i));const r=u(e,["config"]);return r!=null&&d(t,["config"],r),t}function jb(n,e,t){const i={},r=u(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const a=u(e,["pageToken"]);t!==void 0&&a!=null&&d(t,["_query","pageToken"],a);const c=u(e,["filter"]);t!==void 0&&c!=null&&d(t,["_query","filter"],c);const h=u(e,["queryBase"]);return t!==void 0&&h!=null&&d(t,["_url","models_url"],Qy(n,h)),i}function Kb(n,e){const t={},i=u(e,["config"]);return i!=null&&d(t,["config"],jb(n,i,t)),t}function Wb(n,e){const t={},i=u(n,["displayName"]);e!==void 0&&i!=null&&d(e,["displayName"],i);const r=u(n,["description"]);e!==void 0&&r!=null&&d(e,["description"],r);const a=u(n,["defaultCheckpointId"]);return e!==void 0&&a!=null&&d(e,["defaultCheckpointId"],a),t}function Xb(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["_url","model"],Pe(n,i));const r=u(e,["config"]);return r!=null&&d(t,["config"],Wb(r,t)),t}function Qb(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["_url","name"],Pe(n,i));const r=u(e,["config"]);return r!=null&&d(t,["config"],r),t}function Zb(n,e){const t={},i=u(n,["systemInstruction"]);e!==void 0&&i!=null&&d(e,["systemInstruction"],Fs(Tt(i)));const r=u(n,["tools"]);if(e!==void 0&&r!=null){let c=r;Array.isArray(c)&&(c=c.map(h=>hv(h))),d(e,["tools"],c)}const a=u(n,["generationConfig"]);return e!==void 0&&a!=null&&d(e,["generationConfig"],a),t}function eR(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["_url","model"],Pe(n,i));const r=u(e,["contents"]);if(r!=null){let c=Jt(r);Array.isArray(c)&&(c=c.map(h=>Fs(h))),d(t,["contents"],c)}const a=u(e,["config"]);return a!=null&&d(t,["config"],Zb(a,t)),t}function tR(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["_url","model"],Pe(n,i));const r=u(e,["contents"]);if(r!=null){let c=Jt(r);Array.isArray(c)&&(c=c.map(h=>Fs(h))),d(t,["contents"],c)}const a=u(e,["config"]);return a!=null&&d(t,["config"],a),t}function nR(n){const e={},t=u(n,["uri"]);t!=null&&d(e,["gcsUri"],t);const i=u(n,["videoBytes"]);i!=null&&d(e,["bytesBase64Encoded"],ki(i));const r=u(n,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function iR(n,e){const t={},i=u(n,["numberOfVideos"]);e!==void 0&&i!=null&&d(e,["parameters","sampleCount"],i);const r=u(n,["outputGcsUri"]);e!==void 0&&r!=null&&d(e,["parameters","storageUri"],r);const a=u(n,["fps"]);e!==void 0&&a!=null&&d(e,["parameters","fps"],a);const c=u(n,["durationSeconds"]);e!==void 0&&c!=null&&d(e,["parameters","durationSeconds"],c);const h=u(n,["seed"]);e!==void 0&&h!=null&&d(e,["parameters","seed"],h);const m=u(n,["aspectRatio"]);e!==void 0&&m!=null&&d(e,["parameters","aspectRatio"],m);const p=u(n,["resolution"]);e!==void 0&&p!=null&&d(e,["parameters","resolution"],p);const y=u(n,["personGeneration"]);e!==void 0&&y!=null&&d(e,["parameters","personGeneration"],y);const T=u(n,["pubsubTopic"]);e!==void 0&&T!=null&&d(e,["parameters","pubsubTopic"],T);const x=u(n,["negativePrompt"]);e!==void 0&&x!=null&&d(e,["parameters","negativePrompt"],x);const C=u(n,["enhancePrompt"]);e!==void 0&&C!=null&&d(e,["parameters","enhancePrompt"],C);const _=u(n,["generateAudio"]);e!==void 0&&_!=null&&d(e,["parameters","generateAudio"],_);const w=u(n,["lastFrame"]);e!==void 0&&w!=null&&d(e,["instances[0]","lastFrame"],Ys(w));const N=u(n,["compressionQuality"]);return e!==void 0&&N!=null&&d(e,["parameters","compressionQuality"],N),t}function sR(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["_url","model"],Pe(n,i));const r=u(e,["prompt"]);r!=null&&d(t,["instances[0]","prompt"],r);const a=u(e,["image"]);a!=null&&d(t,["instances[0]","image"],Ys(a));const c=u(e,["video"]);c!=null&&d(t,["instances[0]","video"],nR(c));const h=u(e,["config"]);return h!=null&&d(t,["config"],iR(h,t)),t}function oR(n){const e={},t=u(n,["fps"]);t!=null&&d(e,["fps"],t);const i=u(n,["endOffset"]);i!=null&&d(e,["endOffset"],i);const r=u(n,["startOffset"]);return r!=null&&d(e,["startOffset"],r),e}function rR(n){const e={},t=u(n,["data"]);t!=null&&d(e,["data"],t);const i=u(n,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function aR(n){const e={},t=u(n,["fileUri"]);t!=null&&d(e,["fileUri"],t);const i=u(n,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function lR(n){const e={},t=u(n,["videoMetadata"]);t!=null&&d(e,["videoMetadata"],oR(t));const i=u(n,["thought"]);i!=null&&d(e,["thought"],i);const r=u(n,["inlineData"]);r!=null&&d(e,["inlineData"],rR(r));const a=u(n,["fileData"]);a!=null&&d(e,["fileData"],aR(a));const c=u(n,["thoughtSignature"]);c!=null&&d(e,["thoughtSignature"],c);const h=u(n,["codeExecutionResult"]);h!=null&&d(e,["codeExecutionResult"],h);const m=u(n,["executableCode"]);m!=null&&d(e,["executableCode"],m);const p=u(n,["functionCall"]);p!=null&&d(e,["functionCall"],p);const y=u(n,["functionResponse"]);y!=null&&d(e,["functionResponse"],y);const T=u(n,["text"]);return T!=null&&d(e,["text"],T),e}function cR(n){const e={},t=u(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>lR(a))),d(e,["parts"],r)}const i=u(n,["role"]);return i!=null&&d(e,["role"],i),e}function uR(n){const e={},t=u(n,["citationSources"]);return t!=null&&d(e,["citations"],t),e}function dR(n){const e={},t=u(n,["retrievedUrl"]);t!=null&&d(e,["retrievedUrl"],t);const i=u(n,["urlRetrievalStatus"]);return i!=null&&d(e,["urlRetrievalStatus"],i),e}function fR(n){const e={},t=u(n,["urlMetadata"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>dR(r))),d(e,["urlMetadata"],i)}return e}function hR(n){const e={},t=u(n,["content"]);t!=null&&d(e,["content"],cR(t));const i=u(n,["citationMetadata"]);i!=null&&d(e,["citationMetadata"],uR(i));const r=u(n,["tokenCount"]);r!=null&&d(e,["tokenCount"],r);const a=u(n,["finishReason"]);a!=null&&d(e,["finishReason"],a);const c=u(n,["urlContextMetadata"]);c!=null&&d(e,["urlContextMetadata"],fR(c));const h=u(n,["avgLogprobs"]);h!=null&&d(e,["avgLogprobs"],h);const m=u(n,["groundingMetadata"]);m!=null&&d(e,["groundingMetadata"],m);const p=u(n,["index"]);p!=null&&d(e,["index"],p);const y=u(n,["logprobsResult"]);y!=null&&d(e,["logprobsResult"],y);const T=u(n,["safetyRatings"]);return T!=null&&d(e,["safetyRatings"],T),e}function $g(n){const e={},t=u(n,["sdkHttpResponse"]);t!=null&&d(e,["sdkHttpResponse"],t);const i=u(n,["candidates"]);if(i!=null){let m=i;Array.isArray(m)&&(m=m.map(p=>hR(p))),d(e,["candidates"],m)}const r=u(n,["modelVersion"]);r!=null&&d(e,["modelVersion"],r);const a=u(n,["promptFeedback"]);a!=null&&d(e,["promptFeedback"],a);const c=u(n,["responseId"]);c!=null&&d(e,["responseId"],c);const h=u(n,["usageMetadata"]);return h!=null&&d(e,["usageMetadata"],h),e}function mR(n){const e={},t=u(n,["values"]);return t!=null&&d(e,["values"],t),e}function pR(){return{}}function gR(n){const e={},t=u(n,["sdkHttpResponse"]);t!=null&&d(e,["sdkHttpResponse"],t);const i=u(n,["embeddings"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(c=>mR(c))),d(e,["embeddings"],a)}return u(n,["metadata"])!=null&&d(e,["metadata"],pR()),e}function yR(n){const e={},t=u(n,["bytesBase64Encoded"]);t!=null&&d(e,["imageBytes"],ki(t));const i=u(n,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function mv(n){const e={},t=u(n,["safetyAttributes","categories"]);t!=null&&d(e,["categories"],t);const i=u(n,["safetyAttributes","scores"]);i!=null&&d(e,["scores"],i);const r=u(n,["contentType"]);return r!=null&&d(e,["contentType"],r),e}function vR(n){const e={},t=u(n,["_self"]);t!=null&&d(e,["image"],yR(t));const i=u(n,["raiFilteredReason"]);i!=null&&d(e,["raiFilteredReason"],i);const r=u(n,["_self"]);return r!=null&&d(e,["safetyAttributes"],mv(r)),e}function TR(n){const e={},t=u(n,["sdkHttpResponse"]);t!=null&&d(e,["sdkHttpResponse"],t);const i=u(n,["predictions"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(c=>vR(c))),d(e,["generatedImages"],a)}const r=u(n,["positivePromptSafetyAttributes"]);return r!=null&&d(e,["positivePromptSafetyAttributes"],mv(r)),e}function SR(n){const e={},t=u(n,["baseModel"]);t!=null&&d(e,["baseModel"],t);const i=u(n,["createTime"]);i!=null&&d(e,["createTime"],i);const r=u(n,["updateTime"]);return r!=null&&d(e,["updateTime"],r),e}function Gu(n){const e={},t=u(n,["name"]);t!=null&&d(e,["name"],t);const i=u(n,["displayName"]);i!=null&&d(e,["displayName"],i);const r=u(n,["description"]);r!=null&&d(e,["description"],r);const a=u(n,["version"]);a!=null&&d(e,["version"],a);const c=u(n,["_self"]);c!=null&&d(e,["tunedModelInfo"],SR(c));const h=u(n,["inputTokenLimit"]);h!=null&&d(e,["inputTokenLimit"],h);const m=u(n,["outputTokenLimit"]);m!=null&&d(e,["outputTokenLimit"],m);const p=u(n,["supportedGenerationMethods"]);return p!=null&&d(e,["supportedActions"],p),e}function xR(n){const e={},t=u(n,["sdkHttpResponse"]);t!=null&&d(e,["sdkHttpResponse"],t);const i=u(n,["nextPageToken"]);i!=null&&d(e,["nextPageToken"],i);const r=u(n,["_self"]);if(r!=null){let a=Zy(r);Array.isArray(a)&&(a=a.map(c=>Gu(c))),d(e,["models"],a)}return e}function ER(){return{}}function CR(n){const e={},t=u(n,["sdkHttpResponse"]);t!=null&&d(e,["sdkHttpResponse"],t);const i=u(n,["totalTokens"]);i!=null&&d(e,["totalTokens"],i);const r=u(n,["cachedContentTokenCount"]);return r!=null&&d(e,["cachedContentTokenCount"],r),e}function AR(n){const e={},t=u(n,["video","uri"]);t!=null&&d(e,["uri"],t);const i=u(n,["video","encodedVideo"]);i!=null&&d(e,["videoBytes"],ki(i));const r=u(n,["encoding"]);return r!=null&&d(e,["mimeType"],r),e}function _R(n){const e={},t=u(n,["_self"]);return t!=null&&d(e,["video"],AR(t)),e}function wR(n){const e={},t=u(n,["generatedSamples"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(c=>_R(c))),d(e,["generatedVideos"],a)}const i=u(n,["raiMediaFilteredCount"]);i!=null&&d(e,["raiMediaFilteredCount"],i);const r=u(n,["raiMediaFilteredReasons"]);return r!=null&&d(e,["raiMediaFilteredReasons"],r),e}function bR(n){const e={},t=u(n,["name"]);t!=null&&d(e,["name"],t);const i=u(n,["metadata"]);i!=null&&d(e,["metadata"],i);const r=u(n,["done"]);r!=null&&d(e,["done"],r);const a=u(n,["error"]);a!=null&&d(e,["error"],a);const c=u(n,["response","generateVideoResponse"]);return c!=null&&d(e,["response"],wR(c)),e}function RR(n){const e={},t=u(n,["fps"]);t!=null&&d(e,["fps"],t);const i=u(n,["endOffset"]);i!=null&&d(e,["endOffset"],i);const r=u(n,["startOffset"]);return r!=null&&d(e,["startOffset"],r),e}function MR(n){const e={},t=u(n,["displayName"]);t!=null&&d(e,["displayName"],t);const i=u(n,["data"]);i!=null&&d(e,["data"],i);const r=u(n,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function NR(n){const e={},t=u(n,["displayName"]);t!=null&&d(e,["displayName"],t);const i=u(n,["fileUri"]);i!=null&&d(e,["fileUri"],i);const r=u(n,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function kR(n){const e={},t=u(n,["videoMetadata"]);t!=null&&d(e,["videoMetadata"],RR(t));const i=u(n,["thought"]);i!=null&&d(e,["thought"],i);const r=u(n,["inlineData"]);r!=null&&d(e,["inlineData"],MR(r));const a=u(n,["fileData"]);a!=null&&d(e,["fileData"],NR(a));const c=u(n,["thoughtSignature"]);c!=null&&d(e,["thoughtSignature"],c);const h=u(n,["codeExecutionResult"]);h!=null&&d(e,["codeExecutionResult"],h);const m=u(n,["executableCode"]);m!=null&&d(e,["executableCode"],m);const p=u(n,["functionCall"]);p!=null&&d(e,["functionCall"],p);const y=u(n,["functionResponse"]);y!=null&&d(e,["functionResponse"],y);const T=u(n,["text"]);return T!=null&&d(e,["text"],T),e}function IR(n){const e={},t=u(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>kR(a))),d(e,["parts"],r)}const i=u(n,["role"]);return i!=null&&d(e,["role"],i),e}function DR(n){const e={},t=u(n,["citations"]);return t!=null&&d(e,["citations"],t),e}function LR(n){const e={},t=u(n,["retrievedUrl"]);t!=null&&d(e,["retrievedUrl"],t);const i=u(n,["urlRetrievalStatus"]);return i!=null&&d(e,["urlRetrievalStatus"],i),e}function PR(n){const e={},t=u(n,["urlMetadata"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>LR(r))),d(e,["urlMetadata"],i)}return e}function UR(n){const e={},t=u(n,["content"]);t!=null&&d(e,["content"],IR(t));const i=u(n,["citationMetadata"]);i!=null&&d(e,["citationMetadata"],DR(i));const r=u(n,["finishMessage"]);r!=null&&d(e,["finishMessage"],r);const a=u(n,["finishReason"]);a!=null&&d(e,["finishReason"],a);const c=u(n,["urlContextMetadata"]);c!=null&&d(e,["urlContextMetadata"],PR(c));const h=u(n,["avgLogprobs"]);h!=null&&d(e,["avgLogprobs"],h);const m=u(n,["groundingMetadata"]);m!=null&&d(e,["groundingMetadata"],m);const p=u(n,["index"]);p!=null&&d(e,["index"],p);const y=u(n,["logprobsResult"]);y!=null&&d(e,["logprobsResult"],y);const T=u(n,["safetyRatings"]);return T!=null&&d(e,["safetyRatings"],T),e}function Fg(n){const e={},t=u(n,["sdkHttpResponse"]);t!=null&&d(e,["sdkHttpResponse"],t);const i=u(n,["candidates"]);if(i!=null){let p=i;Array.isArray(p)&&(p=p.map(y=>UR(y))),d(e,["candidates"],p)}const r=u(n,["createTime"]);r!=null&&d(e,["createTime"],r);const a=u(n,["modelVersion"]);a!=null&&d(e,["modelVersion"],a);const c=u(n,["promptFeedback"]);c!=null&&d(e,["promptFeedback"],c);const h=u(n,["responseId"]);h!=null&&d(e,["responseId"],h);const m=u(n,["usageMetadata"]);return m!=null&&d(e,["usageMetadata"],m),e}function OR(n){const e={},t=u(n,["truncated"]);t!=null&&d(e,["truncated"],t);const i=u(n,["token_count"]);return i!=null&&d(e,["tokenCount"],i),e}function BR(n){const e={},t=u(n,["values"]);t!=null&&d(e,["values"],t);const i=u(n,["statistics"]);return i!=null&&d(e,["statistics"],OR(i)),e}function HR(n){const e={},t=u(n,["billableCharacterCount"]);return t!=null&&d(e,["billableCharacterCount"],t),e}function VR(n){const e={},t=u(n,["sdkHttpResponse"]);t!=null&&d(e,["sdkHttpResponse"],t);const i=u(n,["predictions[]","embeddings"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(c=>BR(c))),d(e,["embeddings"],a)}const r=u(n,["metadata"]);return r!=null&&d(e,["metadata"],HR(r)),e}function GR(n){const e={},t=u(n,["gcsUri"]);t!=null&&d(e,["gcsUri"],t);const i=u(n,["bytesBase64Encoded"]);i!=null&&d(e,["imageBytes"],ki(i));const r=u(n,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function pv(n){const e={},t=u(n,["safetyAttributes","categories"]);t!=null&&d(e,["categories"],t);const i=u(n,["safetyAttributes","scores"]);i!=null&&d(e,["scores"],i);const r=u(n,["contentType"]);return r!=null&&d(e,["contentType"],r),e}function tl(n){const e={},t=u(n,["_self"]);t!=null&&d(e,["image"],GR(t));const i=u(n,["raiFilteredReason"]);i!=null&&d(e,["raiFilteredReason"],i);const r=u(n,["_self"]);r!=null&&d(e,["safetyAttributes"],pv(r));const a=u(n,["prompt"]);return a!=null&&d(e,["enhancedPrompt"],a),e}function qR(n){const e={},t=u(n,["sdkHttpResponse"]);t!=null&&d(e,["sdkHttpResponse"],t);const i=u(n,["predictions"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(c=>tl(c))),d(e,["generatedImages"],a)}const r=u(n,["positivePromptSafetyAttributes"]);return r!=null&&d(e,["positivePromptSafetyAttributes"],pv(r)),e}function zR(n){const e={},t=u(n,["sdkHttpResponse"]);t!=null&&d(e,["sdkHttpResponse"],t);const i=u(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>tl(a))),d(e,["generatedImages"],r)}return e}function $R(n){const e={},t=u(n,["sdkHttpResponse"]);t!=null&&d(e,["sdkHttpResponse"],t);const i=u(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>tl(a))),d(e,["generatedImages"],r)}return e}function FR(n){const e={},t=u(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>tl(r))),d(e,["generatedImages"],i)}return e}function YR(n){const e={},t=u(n,["endpoint"]);t!=null&&d(e,["name"],t);const i=u(n,["deployedModelId"]);return i!=null&&d(e,["deployedModelId"],i),e}function JR(n){const e={},t=u(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&d(e,["baseModel"],t);const i=u(n,["createTime"]);i!=null&&d(e,["createTime"],i);const r=u(n,["updateTime"]);return r!=null&&d(e,["updateTime"],r),e}function jR(n){const e={},t=u(n,["checkpointId"]);t!=null&&d(e,["checkpointId"],t);const i=u(n,["epoch"]);i!=null&&d(e,["epoch"],i);const r=u(n,["step"]);return r!=null&&d(e,["step"],r),e}function qu(n){const e={},t=u(n,["name"]);t!=null&&d(e,["name"],t);const i=u(n,["displayName"]);i!=null&&d(e,["displayName"],i);const r=u(n,["description"]);r!=null&&d(e,["description"],r);const a=u(n,["versionId"]);a!=null&&d(e,["version"],a);const c=u(n,["deployedModels"]);if(c!=null){let T=c;Array.isArray(T)&&(T=T.map(x=>YR(x))),d(e,["endpoints"],T)}const h=u(n,["labels"]);h!=null&&d(e,["labels"],h);const m=u(n,["_self"]);m!=null&&d(e,["tunedModelInfo"],JR(m));const p=u(n,["defaultCheckpointId"]);p!=null&&d(e,["defaultCheckpointId"],p);const y=u(n,["checkpoints"]);if(y!=null){let T=y;Array.isArray(T)&&(T=T.map(x=>jR(x))),d(e,["checkpoints"],T)}return e}function KR(n){const e={},t=u(n,["sdkHttpResponse"]);t!=null&&d(e,["sdkHttpResponse"],t);const i=u(n,["nextPageToken"]);i!=null&&d(e,["nextPageToken"],i);const r=u(n,["_self"]);if(r!=null){let a=Zy(r);Array.isArray(a)&&(a=a.map(c=>qu(c))),d(e,["models"],a)}return e}function WR(){return{}}function XR(n){const e={},t=u(n,["sdkHttpResponse"]);t!=null&&d(e,["sdkHttpResponse"],t);const i=u(n,["totalTokens"]);return i!=null&&d(e,["totalTokens"],i),e}function QR(n){const e={},t=u(n,["sdkHttpResponse"]);t!=null&&d(e,["sdkHttpResponse"],t);const i=u(n,["tokensInfo"]);return i!=null&&d(e,["tokensInfo"],i),e}function ZR(n){const e={},t=u(n,["gcsUri"]);t!=null&&d(e,["uri"],t);const i=u(n,["bytesBase64Encoded"]);i!=null&&d(e,["videoBytes"],ki(i));const r=u(n,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function e1(n){const e={},t=u(n,["_self"]);return t!=null&&d(e,["video"],ZR(t)),e}function t1(n){const e={},t=u(n,["videos"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(c=>e1(c))),d(e,["generatedVideos"],a)}const i=u(n,["raiMediaFilteredCount"]);i!=null&&d(e,["raiMediaFilteredCount"],i);const r=u(n,["raiMediaFilteredReasons"]);return r!=null&&d(e,["raiMediaFilteredReasons"],r),e}function n1(n){const e={},t=u(n,["name"]);t!=null&&d(e,["name"],t);const i=u(n,["metadata"]);i!=null&&d(e,["metadata"],i);const r=u(n,["done"]);r!=null&&d(e,["done"],r);const a=u(n,["error"]);a!=null&&d(e,["error"],a);const c=u(n,["response"]);return c!=null&&d(e,["response"],t1(c)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const i1="Content-Type",s1="X-Server-Timeout",o1="User-Agent",zu="x-goog-api-client",r1="1.13.0",a1=`google-genai-sdk/${r1}`,l1="v1beta1",c1="v1beta",Yg=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class u1{constructor(e){var t,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const r={};this.clientOptions.vertexai?(r.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:l1,r.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(r.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:c1,r.baseUrl="https://generativelanguage.googleapis.com/"),r.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=r,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(r,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){const r=[this.getRequestUrlInternal(t)];return i&&r.push(this.getBaseResourcePath()),e!==""&&r.push(e),new URL(`${r.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,i);if(e.queryParams)for(const[c,h]of Object.entries(e.queryParams))r.searchParams.append(c,String(h));let a={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else a.body=e.body;return a=await this.includeExtraHttpOptionsToRequestInit(a,t,e.abortSignal),this.unaryApiCall(r,a,e.httpMethod)}patchHttpOptions(e,t){const i=JSON.parse(JSON.stringify(e));for(const[r,a]of Object.entries(t))typeof a=="object"?i[r]=Object.assign(Object.assign({},i[r]),a):a!==void 0&&(i[r]=a);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,i);(!r.searchParams.has("alt")||r.searchParams.get("alt")!=="sse")&&r.searchParams.set("alt","sse");let a={};return a.body=e.body,a=await this.includeExtraHttpOptionsToRequestInit(a,t,e.abortSignal),this.streamApiCall(r,a,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i){if(t&&t.timeout||i){const r=new AbortController,a=r.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const c=setTimeout(()=>r.abort(),t.timeout);c&&typeof c.unref=="function"&&c.unref()}i&&i.addEventListener("abort",()=>{r.abort()}),e.signal=a}return t&&t.extraBody!==null&&d1(e,t.extraBody),e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await Jg(r),new Pu(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await Jg(r),this.processStreamResponse(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}processStreamResponse(e){var t;return Hs(this,arguments,function*(){const r=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.getReader(),a=new TextDecoder("utf-8");if(!r)throw new Error("Response body is empty");try{let c="";for(;;){const{done:h,value:m}=yield Je(r.read());if(h){if(c.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const p=a.decode(m,{stream:!0});try{const T=JSON.parse(p);if("error"in T){const x=JSON.parse(JSON.stringify(T.error)),C=x.status,_=x.code,w=`got status: ${C}. ${JSON.stringify(T)}`;if(_>=400&&_<600)throw new Za({message:w,status:_})}}catch(T){if(T.name==="ApiError")throw T}c+=p;let y=c.match(Yg);for(;y;){const T=y[1];try{const x=new Response(T,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Je(new Pu(x)),c=c.slice(y[0].length),y=c.match(Yg)}catch(x){throw new Error(`exception parsing stream chunk ${T}. ${x}`)}}}}finally{r.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},t=a1+" "+this.clientOptions.userAgentExtra;return e[o1]=t,e[zu]=t,e[i1]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[i,r]of Object.entries(e.headers))t.append(i,r);e.timeout&&e.timeout>0&&t.append(s1,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var i;const r={};t!=null&&(r.mimeType=t.mimeType,r.name=t.name,r.displayName=t.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);const a=this.clientOptions.uploader,c=await a.stat(e);r.sizeBytes=String(c.size);const h=(i=t==null?void 0:t.mimeType)!==null&&i!==void 0?i:c.type;if(h===void 0||h==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=h;const m=await this.fetchUploadUrl(r,t);return a.upload(e,m,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t){var i;let r={};t!=null&&t.httpOptions?r=t.httpOptions:r={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const a={file:e},c=await this.request({path:me("upload/v1beta/files",a._url),body:JSON.stringify(a),httpMethod:"POST",httpOptions:r});if(!c||!(c!=null&&c.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const h=(i=c==null?void 0:c.headers)===null||i===void 0?void 0:i["x-goog-upload-url"];if(h===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return h}}async function Jg(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const r=JSON.stringify(i);throw t>=400&&t<600?new Za({message:r,status:t}):new Error(r)}}function d1(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const a=JSON.parse(n.body);if(typeof a=="object"&&a!==null&&!Array.isArray(a))t=a;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(a,c){const h=Object.assign({},a);for(const m in c)if(Object.prototype.hasOwnProperty.call(c,m)){const p=c[m],y=h[m];p&&typeof p=="object"&&!Array.isArray(p)&&y&&typeof y=="object"&&!Array.isArray(y)?h[m]=i(y,p):(y&&p&&typeof y!=typeof p&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${m}". Original type: ${typeof y}, New type: ${typeof p}. Overwriting.`),h[m]=p)}return h}const r=i(t,e);n.body=JSON.stringify(r)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const f1="mcp_used/unknown";let h1=!1;function gv(n){for(const e of n)if(m1(e)||typeof e=="object"&&"inputSchema"in e)return!0;return h1}function yv(n){var e;const t=(e=n[zu])!==null&&e!==void 0?e:"";n[zu]=(t+` ${f1}`).trimStart()}function m1(n){return n!==null&&typeof n=="object"&&n instanceof yd}function p1(n,e=100){return Hs(this,arguments,function*(){let i,r=0;for(;r<e;){const a=yield Je(n.listTools({cursor:i}));for(const c of a.tools)yield yield Je(c),r++;if(!a.nextCursor)break;i=a.nextCursor}})}class yd{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new yd(e,t)}async initialize(){var e,t,i,r;if(this.mcpTools.length>0)return;const a={},c=[];for(const y of this.mcpClients)try{for(var h=!0,m=(t=void 0,sr(p1(y))),p;p=await m.next(),e=p.done,!e;h=!0){r=p.value,h=!1;const T=r;c.push(T);const x=T.name;if(a[x])throw new Error(`Duplicate function name ${x} found in MCP tools. Please ensure function names are unique.`);a[x]=y}}catch(T){t={error:T}}finally{try{!h&&!e&&(i=m.return)&&await i.call(m)}finally{if(t)throw t.error}}this.mcpTools=c,this.functionNameToMcpClient=a}async tool(){return await this.initialize(),oE(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const r=this.functionNameToMcpClient[i.name];let a;this.config.timeout&&(a={timeout:this.config.timeout});const c=await r.callTool({name:i.name,arguments:i.args},void 0,a);t.push({functionResponse:{name:i.name,response:c.isError?{error:c}:c}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function g1(n,e,t){const i=new Xx;let r;t.data instanceof Blob?r=JSON.parse(await t.data.text()):r=JSON.parse(t.data);const a=ow(r);Object.assign(i,a),e(i)}class y1{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const r=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion(),c=S1(this.apiClient.getDefaultHeaders()),h=this.apiClient.getApiKey(),m=`${r}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateMusic?key=${h}`;let p=()=>{};const y=new Promise(I=>{p=I}),T=e.callbacks,x=function(){p({})},C=this.apiClient,_={onopen:x,onmessage:I=>{g1(C,T.onmessage,I)},onerror:(t=T==null?void 0:T.onerror)!==null&&t!==void 0?t:function(I){},onclose:(i=T==null?void 0:T.onclose)!==null&&i!==void 0?i:function(I){}},w=this.webSocketFactory.create(m,T1(c),_);w.connect(),await y;const N=Pe(this.apiClient,e.model),H=uv({model:N}),K=Vu({setup:H});return w.send(JSON.stringify(K)),new v1(w,this.apiClient)}}class v1{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=i_(e),i=dv(t);this.conn.send(JSON.stringify({clientContent:i}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=s_(e),i=Vu(t);this.conn.send(JSON.stringify(i))}sendPlaybackControl(e){const t=Vu({playbackControl:e});this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Us.PLAY)}pause(){this.sendPlaybackControl(Us.PAUSE)}stop(){this.sendPlaybackControl(Us.STOP)}resetContext(){this.sendPlaybackControl(Us.RESET_CONTEXT)}close(){this.conn.close()}}function T1(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function S1(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const x1="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function E1(n,e,t){const i=new Wx;let r;t.data instanceof Blob?r=await t.data.text():t.data instanceof ArrayBuffer?r=new TextDecoder().decode(t.data):r=t.data;const a=JSON.parse(r);if(n.isVertexAI()){const c=Tw(a);Object.assign(i,c)}else{const c=W_(a);Object.assign(i,c)}e(i)}class C1{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new y1(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,r,a,c,h;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const m=this.apiClient.getWebsocketBaseUrl(),p=this.apiClient.getApiVersion();let y;const T=this.apiClient.getHeaders();e.config&&e.config.tools&&gv(e.config.tools)&&yv(T);const x=b1(T);if(this.apiClient.isVertexAI())y=`${m}/ws/google.cloud.aiplatform.${p}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(x);else{const pe=this.apiClient.getApiKey();let se="BidiGenerateContent",F="key";pe!=null&&pe.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),p!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),se="BidiGenerateContentConstrained",F="access_token"),y=`${m}/ws/google.ai.generativelanguage.${p}.GenerativeService.${se}?${F}=${pe}`}let C=()=>{};const _=new Promise(pe=>{C=pe}),w=e.callbacks,N=function(){var pe;(pe=w==null?void 0:w.onopen)===null||pe===void 0||pe.call(w),C({})},H=this.apiClient,K={onopen:N,onmessage:pe=>{E1(H,w.onmessage,pe)},onerror:(t=w==null?void 0:w.onerror)!==null&&t!==void 0?t:function(pe){},onclose:(i=w==null?void 0:w.onclose)!==null&&i!==void 0?i:function(pe){}},I=this.webSocketFactory.create(y,w1(x),K);I.connect(),await _;let Q=Pe(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&Q.startsWith("publishers/")){const pe=this.apiClient.getProject(),se=this.apiClient.getLocation();Q=`projects/${pe}/locations/${se}/`+Q}let Y={};this.apiClient.isVertexAI()&&((r=e.config)===null||r===void 0?void 0:r.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[$a.AUDIO]}:e.config.responseModalities=[$a.AUDIO]),!((a=e.config)===null||a===void 0)&&a.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const oe=(h=(c=e.config)===null||c===void 0?void 0:c.tools)!==null&&h!==void 0?h:[],ce=[];for(const pe of oe)if(this.isCallableTool(pe)){const se=pe;ce.push(await se.tool())}else ce.push(pe);ce.length>0&&(e.config.tools=ce);const Ae={model:Q,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?Y=k_(this.apiClient,Ae):Y=ZA(this.apiClient,Ae),delete Y.config,I.send(JSON.stringify(Y)),new _1(I,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const A1={turnComplete:!0};class _1{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=Jt(t.turns),e.isVertexAI()?i=i.map(r=>Fs(r)):i=i.map(r=>el(r))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const a of i){if(typeof a!="object"||a===null||!("name"in a)||!("response"in a))throw new Error(`Could not parse function response, type '${typeof a}'.`);if(!e.isVertexAI()&&!("id"in a))throw new Error(x1)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},A1),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:L_(e)}:t={realtimeInput:n_(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function w1(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function b1(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const jg=10;function Kg(n){var e,t,i;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let r=!1;for(const c of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(Vs(c)){r=!0;break}if(!r)return!0;const a=(i=n==null?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return a&&(a<0||!Number.isInteger(a))||a==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",a),!0):!1}function Vs(n){return"callTool"in n&&typeof n.callTool=="function"}function R1(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(r=>Vs(r)))!==null&&i!==void 0?i:!1}function M1(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(r=>!Vs(r)))!==null&&i!==void 0?i:!1}function Wg(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class N1 extends Ni{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,r,a,c,h;const m=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!R1(t)||Kg(t.config))return await this.generateContentInternal(m);if(M1(t))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let p,y;const T=Jt(m.contents),x=(a=(r=(i=m.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&a!==void 0?a:jg;let C=0;for(;C<x&&(p=await this.generateContentInternal(m),!(!p.functionCalls||p.functionCalls.length===0));){const _=p.candidates[0].content,w=[];for(const N of(h=(c=t.config)===null||c===void 0?void 0:c.tools)!==null&&h!==void 0?h:[])if(Vs(N)){const K=await N.callTool(p.functionCalls);w.push(...K)}C++,y={role:"user",parts:w},m.contents=Jt(m.contents),m.contents.push(_),m.contents.push(y),Wg(m.config)&&(T.push(_),T.push(y))}return Wg(m.config)&&(p.automaticFunctionCallingHistory=T),p},this.generateContentStream=async t=>{if(this.maybeMoveToResponseJsonSchem(t),Kg(t.config)){const i=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(i)}else return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var r;let a;const c=[];if(i!=null&&i.generatedImages)for(const m of i.generatedImages)m&&(m!=null&&m.safetyAttributes)&&((r=m==null?void 0:m.safetyAttributes)===null||r===void 0?void 0:r.contentType)==="Positive Prompt"?a=m==null?void 0:m.safetyAttributes:c.push(m);let h;return a?h={generatedImages:c,positivePromptSafetyAttributes:a,sdkHttpResponse:i.sdkHttpResponse}:h={generatedImages:c,sdkHttpResponse:i.sdkHttpResponse},h}),this.list=async t=>{var i;const c={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!c.config.queryBase){if(!((i=c.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");c.config.filter="labels.tune-type:*"}return new fr(Ri.PAGED_ITEM_MODELS,h=>this.listInternal(h),await this.listInternal(c),c)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(r=>r.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const r={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(r)},this.generateVideos=async t=>await this.generateVideosInternal(t)}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,r;const a=(t=e.config)===null||t===void 0?void 0:t.tools;if(!a)return e;const c=await Promise.all(a.map(async m=>Vs(m)?await m.tool():m)),h={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:c})};if(h.config.tools=c,e.config&&e.config.tools&&gv(e.config.tools)){const m=(r=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&r!==void 0?r:{};let p=Object.assign({},m);Object.keys(p).length===0&&(p=this.apiClient.getDefaultHeaders()),yv(p),h.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:p})}return h}async initAfcToolsMap(e){var t,i,r;const a=new Map;for(const c of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(Vs(c)){const h=c,m=await h.tool();for(const p of(r=m.functionDeclarations)!==null&&r!==void 0?r:[]){if(!p.name)throw new Error("Function declaration name is required.");if(a.has(p.name))throw new Error(`Duplicate tool declaration name: ${p.name}`);a.set(p.name,h)}}return a}async processAfcStream(e){var t,i,r;const a=(r=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&r!==void 0?r:jg;let c=!1,h=0;const m=await this.initAfcToolsMap(e);return function(p,y,T){var x,C;return Hs(this,arguments,function*(){for(var _,w,N,H;h<a;){c&&(h++,c=!1);const Y=yield Je(p.processParamsMaybeAddMcpUsage(T)),oe=yield Je(p.generateContentStreamInternal(Y)),ce=[],Ae=[];try{for(var K=!0,I=(w=void 0,sr(oe)),Q;Q=yield Je(I.next()),_=Q.done,!_;K=!0){H=Q.value,K=!1;const pe=H;if(yield yield Je(pe),pe.candidates&&(!((x=pe.candidates[0])===null||x===void 0)&&x.content)){Ae.push(pe.candidates[0].content);for(const se of(C=pe.candidates[0].content.parts)!==null&&C!==void 0?C:[])if(h<a&&se.functionCall){if(!se.functionCall.name)throw new Error("Function call name was not returned by the model.");if(y.has(se.functionCall.name)){const F=yield Je(y.get(se.functionCall.name).callTool([se.functionCall]));ce.push(...F)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${y.keys()}, mising tool: ${se.functionCall.name}`)}}}}catch(pe){w={error:pe}}finally{try{!K&&!_&&(N=I.return)&&(yield Je(N.call(I)))}finally{if(w)throw w.error}}if(ce.length>0){c=!0;const pe=new Xo;pe.candidates=[{content:{role:"user",parts:ce}}],yield yield Je(pe);const se=[];se.push(...Ae),se.push({role:"user",parts:ce});const F=Jt(T.contents).concat(se);T.contents=F}else break}})}(this,m,e)}async generateContentInternal(e){var t,i,r,a;let c,h="",m={};if(this.apiClient.isVertexAI()){const p=zg(this.apiClient,e);return h=me("{model}:generateContent",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),c.then(y=>{const T=Fg(y),x=new Xo;return Object.assign(x,T),x})}else{const p=qg(this.apiClient,e);return h=me("{model}:generateContent",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),c.then(y=>{const T=$g(y),x=new Xo;return Object.assign(x,T),x})}}async generateContentStreamInternal(e){var t,i,r,a;let c,h="",m={};if(this.apiClient.isVertexAI()){const p=zg(this.apiClient,e);return h=me("{model}:streamGenerateContent?alt=sse",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.requestStream({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),c.then(function(T){return Hs(this,arguments,function*(){var x,C,_,w;try{for(var N=!0,H=sr(T),K;K=yield Je(H.next()),x=K.done,!x;N=!0){w=K.value,N=!1;const I=w,Q=Fg(yield Je(I.json()));Q.sdkHttpResponse={headers:I.headers};const Y=new Xo;Object.assign(Y,Q),yield yield Je(Y)}}catch(I){C={error:I}}finally{try{!N&&!x&&(_=H.return)&&(yield Je(_.call(H)))}finally{if(C)throw C.error}}})})}else{const p=qg(this.apiClient,e);return h=me("{model}:streamGenerateContent?alt=sse",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.requestStream({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}),c.then(function(T){return Hs(this,arguments,function*(){var x,C,_,w;try{for(var N=!0,H=sr(T),K;K=yield Je(H.next()),x=K.done,!x;N=!0){w=K.value,N=!1;const I=w,Q=$g(yield Je(I.json()));Q.sdkHttpResponse={headers:I.headers};const Y=new Xo;Object.assign(Y,Q),yield yield Je(Y)}}catch(I){C={error:I}}finally{try{!N&&!x&&(_=H.return)&&(yield Je(_.call(H)))}finally{if(C)throw C.error}}})})}}async embedContent(e){var t,i,r,a;let c,h="",m={};if(this.apiClient.isVertexAI()){const p=kb(this.apiClient,e);return h=me("{model}:predict",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),c.then(y=>{const T=VR(y),x=new xg;return Object.assign(x,T),x})}else{const p=$w(this.apiClient,e);return h=me("{model}:batchEmbedContents",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),c.then(y=>{const T=gR(y),x=new xg;return Object.assign(x,T),x})}}async generateImagesInternal(e){var t,i,r,a;let c,h="",m={};if(this.apiClient.isVertexAI()){const p=Db(this.apiClient,e);return h=me("{model}:predict",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),c.then(y=>{const T=qR(y),x=new Eg;return Object.assign(x,T),x})}else{const p=Yw(this.apiClient,e);return h=me("{model}:predict",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),c.then(y=>{const T=TR(y),x=new Eg;return Object.assign(x,T),x})}}async editImageInternal(e){var t,i;let r,a="",c={};if(this.apiClient.isVertexAI()){const h=Vb(this.apiClient,e);return a=me("{model}:predict",h._url),c=h._query,delete h.config,delete h._url,delete h._query,r=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(p=>{const y=p;return y.sdkHttpResponse={headers:m.headers},y})),r.then(m=>{const p=zR(m),y=new zx;return Object.assign(y,p),y})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let r,a="",c={};if(this.apiClient.isVertexAI()){const h=qb(this.apiClient,e);return a=me("{model}:predict",h._url),c=h._query,delete h.config,delete h._url,delete h._query,r=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(p=>{const y=p;return y.sdkHttpResponse={headers:m.headers},y})),r.then(m=>{const p=$R(m),y=new $x;return Object.assign(y,p),y})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let r,a="",c={};if(this.apiClient.isVertexAI()){const h=Yb(this.apiClient,e);return a=me("{model}:predict",h._url),c=h._query,delete h.config,delete h._url,delete h._query,r=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),r.then(m=>{const p=FR(m),y=new Fx;return Object.assign(y,p),y})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,r,a;let c,h="",m={};if(this.apiClient.isVertexAI()){const p=Jb(this.apiClient,e);return h=me("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json()),c.then(y=>qu(y))}else{const p=Jw(this.apiClient,e);return h=me("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),c.then(y=>Gu(y))}}async listInternal(e){var t,i,r,a;let c,h="",m={};if(this.apiClient.isVertexAI()){const p=Kb(this.apiClient,e);return h=me("{models_url}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),c.then(y=>{const T=KR(y),x=new Cg;return Object.assign(x,T),x})}else{const p=Kw(this.apiClient,e);return h=me("{models_url}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),c.then(y=>{const T=xR(y),x=new Cg;return Object.assign(x,T),x})}}async update(e){var t,i,r,a;let c,h="",m={};if(this.apiClient.isVertexAI()){const p=Xb(this.apiClient,e);return h=me("{model}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json()),c.then(y=>qu(y))}else{const p=Xw(this.apiClient,e);return h=me("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),c.then(y=>Gu(y))}}async delete(e){var t,i,r,a;let c,h="",m={};if(this.apiClient.isVertexAI()){const p=Qb(this.apiClient,e);return h=me("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json()),c.then(()=>{const y=WR(),T=new Ag;return Object.assign(T,y),T})}else{const p=Qw(this.apiClient,e);return h=me("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),c.then(()=>{const y=ER(),T=new Ag;return Object.assign(T,y),T})}}async countTokens(e){var t,i,r,a;let c,h="",m={};if(this.apiClient.isVertexAI()){const p=eR(this.apiClient,e);return h=me("{model}:countTokens",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),c.then(y=>{const T=XR(y),x=new _g;return Object.assign(x,T),x})}else{const p=eb(this.apiClient,e);return h=me("{model}:countTokens",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),c.then(y=>{const T=CR(y),x=new _g;return Object.assign(x,T),x})}}async computeTokens(e){var t,i;let r,a="",c={};if(this.apiClient.isVertexAI()){const h=tR(this.apiClient,e);return a=me("{model}:computeTokens",h._url),c=h._query,delete h.config,delete h._url,delete h._query,r=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(p=>{const y=p;return y.sdkHttpResponse={headers:m.headers},y})),r.then(m=>{const p=QR(m),y=new Yx;return Object.assign(y,p),y})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,r,a;let c,h="",m={};if(this.apiClient.isVertexAI()){const p=sR(this.apiClient,e);return h=me("{model}:predictLongRunning",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json()),c.then(y=>{const T=n1(y),x=new Fa;return Object.assign(x,T),x})}else{const p=ib(this.apiClient,e);return h=me("{model}:predictLongRunning",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),c.then(y=>{const T=bR(y),x=new Fa;return Object.assign(x,T),x})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function k1(n){const e={},t=u(n,["operationName"]);t!=null&&d(e,["_url","operationName"],t);const i=u(n,["config"]);return i!=null&&d(e,["config"],i),e}function I1(n){const e={},t=u(n,["operationName"]);t!=null&&d(e,["_url","operationName"],t);const i=u(n,["config"]);return i!=null&&d(e,["config"],i),e}function D1(n){const e={},t=u(n,["operationName"]);t!=null&&d(e,["operationName"],t);const i=u(n,["resourceName"]);i!=null&&d(e,["_url","resourceName"],i);const r=u(n,["config"]);return r!=null&&d(e,["config"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class L1 extends Ni{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];let a;i&&"httpOptions"in i&&(a=i.httpOptions);const c=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:c,isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:r,isVertexAI:!1})}}async get(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];let a;i&&"httpOptions"in i&&(a=i.httpOptions);const c=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:c,isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:r,isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,r,a;let c,h="",m={};if(this.apiClient.isVertexAI()){const p=I1(e);return h=me("{operationName}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json()),c}else{const p=k1(e);return h=me("{operationName}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),c}}async fetchPredictVideosOperationInternal(e){var t,i;let r,a="",c={};if(this.apiClient.isVertexAI()){const h=D1(e);return a=me("{resourceName}:fetchPredictOperation",h._url),c=h._query,delete h.config,delete h._url,delete h._query,r=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),r}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function P1(n){const e={},t=u(n,["voiceName"]);return t!=null&&d(e,["voiceName"],t),e}function vv(n){const e={},t=u(n,["prebuiltVoiceConfig"]);return t!=null&&d(e,["prebuiltVoiceConfig"],P1(t)),e}function U1(n){const e={},t=u(n,["speaker"]);t!=null&&d(e,["speaker"],t);const i=u(n,["voiceConfig"]);return i!=null&&d(e,["voiceConfig"],vv(i)),e}function O1(n){const e={},t=u(n,["speakerVoiceConfigs"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>U1(r))),d(e,["speakerVoiceConfigs"],i)}return e}function B1(n){const e={},t=u(n,["voiceConfig"]);t!=null&&d(e,["voiceConfig"],vv(t));const i=u(n,["multiSpeakerVoiceConfig"]);i!=null&&d(e,["multiSpeakerVoiceConfig"],O1(i));const r=u(n,["languageCode"]);return r!=null&&d(e,["languageCode"],r),e}function H1(n){const e={},t=u(n,["fps"]);t!=null&&d(e,["fps"],t);const i=u(n,["endOffset"]);i!=null&&d(e,["endOffset"],i);const r=u(n,["startOffset"]);return r!=null&&d(e,["startOffset"],r),e}function V1(n){const e={};if(u(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=u(n,["data"]);t!=null&&d(e,["data"],t);const i=u(n,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function G1(n){const e={};if(u(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=u(n,["fileUri"]);t!=null&&d(e,["fileUri"],t);const i=u(n,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function q1(n){const e={},t=u(n,["videoMetadata"]);t!=null&&d(e,["videoMetadata"],H1(t));const i=u(n,["thought"]);i!=null&&d(e,["thought"],i);const r=u(n,["inlineData"]);r!=null&&d(e,["inlineData"],V1(r));const a=u(n,["fileData"]);a!=null&&d(e,["fileData"],G1(a));const c=u(n,["thoughtSignature"]);c!=null&&d(e,["thoughtSignature"],c);const h=u(n,["codeExecutionResult"]);h!=null&&d(e,["codeExecutionResult"],h);const m=u(n,["executableCode"]);m!=null&&d(e,["executableCode"],m);const p=u(n,["functionCall"]);p!=null&&d(e,["functionCall"],p);const y=u(n,["functionResponse"]);y!=null&&d(e,["functionResponse"],y);const T=u(n,["text"]);return T!=null&&d(e,["text"],T),e}function z1(n){const e={},t=u(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>q1(a))),d(e,["parts"],r)}const i=u(n,["role"]);return i!=null&&d(e,["role"],i),e}function $1(n){const e={},t=u(n,["behavior"]);t!=null&&d(e,["behavior"],t);const i=u(n,["description"]);i!=null&&d(e,["description"],i);const r=u(n,["name"]);r!=null&&d(e,["name"],r);const a=u(n,["parameters"]);a!=null&&d(e,["parameters"],a);const c=u(n,["parametersJsonSchema"]);c!=null&&d(e,["parametersJsonSchema"],c);const h=u(n,["response"]);h!=null&&d(e,["response"],h);const m=u(n,["responseJsonSchema"]);return m!=null&&d(e,["responseJsonSchema"],m),e}function F1(n){const e={},t=u(n,["startTime"]);t!=null&&d(e,["startTime"],t);const i=u(n,["endTime"]);return i!=null&&d(e,["endTime"],i),e}function Y1(n){const e={},t=u(n,["timeRangeFilter"]);return t!=null&&d(e,["timeRangeFilter"],F1(t)),e}function J1(n){const e={},t=u(n,["mode"]);t!=null&&d(e,["mode"],t);const i=u(n,["dynamicThreshold"]);return i!=null&&d(e,["dynamicThreshold"],i),e}function j1(n){const e={},t=u(n,["dynamicRetrievalConfig"]);return t!=null&&d(e,["dynamicRetrievalConfig"],J1(t)),e}function K1(){return{}}function W1(n){const e={},t=u(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(p=>$1(p))),d(e,["functionDeclarations"],m)}if(u(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=u(n,["googleSearch"]);i!=null&&d(e,["googleSearch"],Y1(i));const r=u(n,["googleSearchRetrieval"]);if(r!=null&&d(e,["googleSearchRetrieval"],j1(r)),u(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(u(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");u(n,["urlContext"])!=null&&d(e,["urlContext"],K1());const c=u(n,["codeExecution"]);c!=null&&d(e,["codeExecution"],c);const h=u(n,["computerUse"]);return h!=null&&d(e,["computerUse"],h),e}function X1(n){const e={},t=u(n,["handle"]);if(t!=null&&d(e,["handle"],t),u(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Xg(){return{}}function Q1(n){const e={},t=u(n,["disabled"]);t!=null&&d(e,["disabled"],t);const i=u(n,["startOfSpeechSensitivity"]);i!=null&&d(e,["startOfSpeechSensitivity"],i);const r=u(n,["endOfSpeechSensitivity"]);r!=null&&d(e,["endOfSpeechSensitivity"],r);const a=u(n,["prefixPaddingMs"]);a!=null&&d(e,["prefixPaddingMs"],a);const c=u(n,["silenceDurationMs"]);return c!=null&&d(e,["silenceDurationMs"],c),e}function Z1(n){const e={},t=u(n,["automaticActivityDetection"]);t!=null&&d(e,["automaticActivityDetection"],Q1(t));const i=u(n,["activityHandling"]);i!=null&&d(e,["activityHandling"],i);const r=u(n,["turnCoverage"]);return r!=null&&d(e,["turnCoverage"],r),e}function eM(n){const e={},t=u(n,["targetTokens"]);return t!=null&&d(e,["targetTokens"],t),e}function tM(n){const e={},t=u(n,["triggerTokens"]);t!=null&&d(e,["triggerTokens"],t);const i=u(n,["slidingWindow"]);return i!=null&&d(e,["slidingWindow"],eM(i)),e}function nM(n){const e={},t=u(n,["proactiveAudio"]);return t!=null&&d(e,["proactiveAudio"],t),e}function iM(n,e){const t={},i=u(n,["generationConfig"]);e!==void 0&&i!=null&&d(e,["setup","generationConfig"],i);const r=u(n,["responseModalities"]);e!==void 0&&r!=null&&d(e,["setup","generationConfig","responseModalities"],r);const a=u(n,["temperature"]);e!==void 0&&a!=null&&d(e,["setup","generationConfig","temperature"],a);const c=u(n,["topP"]);e!==void 0&&c!=null&&d(e,["setup","generationConfig","topP"],c);const h=u(n,["topK"]);e!==void 0&&h!=null&&d(e,["setup","generationConfig","topK"],h);const m=u(n,["maxOutputTokens"]);e!==void 0&&m!=null&&d(e,["setup","generationConfig","maxOutputTokens"],m);const p=u(n,["mediaResolution"]);e!==void 0&&p!=null&&d(e,["setup","generationConfig","mediaResolution"],p);const y=u(n,["seed"]);e!==void 0&&y!=null&&d(e,["setup","generationConfig","seed"],y);const T=u(n,["speechConfig"]);e!==void 0&&T!=null&&d(e,["setup","generationConfig","speechConfig"],B1(gd(T)));const x=u(n,["enableAffectiveDialog"]);e!==void 0&&x!=null&&d(e,["setup","generationConfig","enableAffectiveDialog"],x);const C=u(n,["systemInstruction"]);e!==void 0&&C!=null&&d(e,["setup","systemInstruction"],z1(Tt(C)));const _=u(n,["tools"]);if(e!==void 0&&_!=null){let Y=zs(_);Array.isArray(Y)&&(Y=Y.map(oe=>W1(qs(oe)))),d(e,["setup","tools"],Y)}const w=u(n,["sessionResumption"]);e!==void 0&&w!=null&&d(e,["setup","sessionResumption"],X1(w));const N=u(n,["inputAudioTranscription"]);e!==void 0&&N!=null&&d(e,["setup","inputAudioTranscription"],Xg());const H=u(n,["outputAudioTranscription"]);e!==void 0&&H!=null&&d(e,["setup","outputAudioTranscription"],Xg());const K=u(n,["realtimeInputConfig"]);e!==void 0&&K!=null&&d(e,["setup","realtimeInputConfig"],Z1(K));const I=u(n,["contextWindowCompression"]);e!==void 0&&I!=null&&d(e,["setup","contextWindowCompression"],tM(I));const Q=u(n,["proactivity"]);return e!==void 0&&Q!=null&&d(e,["setup","proactivity"],nM(Q)),t}function sM(n,e){const t={},i=u(e,["model"]);i!=null&&d(t,["setup","model"],Pe(n,i));const r=u(e,["config"]);return r!=null&&d(t,["config"],iM(r,t)),t}function oM(n,e,t){const i={},r=u(e,["expireTime"]);t!==void 0&&r!=null&&d(t,["expireTime"],r);const a=u(e,["newSessionExpireTime"]);t!==void 0&&a!=null&&d(t,["newSessionExpireTime"],a);const c=u(e,["uses"]);t!==void 0&&c!=null&&d(t,["uses"],c);const h=u(e,["liveConnectConstraints"]);t!==void 0&&h!=null&&d(t,["bidiGenerateContentSetup"],sM(n,h));const m=u(e,["lockAdditionalFields"]);return t!==void 0&&m!=null&&d(t,["fieldMask"],m),i}function rM(n,e){const t={},i=u(e,["config"]);return i!=null&&d(t,["config"],oM(n,i,t)),t}function aM(n){const e={},t=u(n,["name"]);return t!=null&&d(e,["name"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function lM(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const r=Object.keys(i).map(a=>`${t}.${a}`);e.push(...r)}else e.push(t)}return e.join(",")}function cM(n,e){let t=null;const i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const a=i.setup;typeof a=="object"&&a!==null?(n.bidiGenerateContentSetup=a,t=a):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;const r=n.fieldMask;if(t){const a=lM(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)a?n.fieldMask=a:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&r!==null&&Array.isArray(r)&&r.length>0){const c=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let h=[];r.length>0&&(h=r.map(p=>c.includes(p)?`generationConfig.${p}`:p));const m=[];a&&m.push(a),h.length>0&&m.push(...h),m.length>0?n.fieldMask=m.join(","):delete n.fieldMask}else delete n.fieldMask}else r!==null&&Array.isArray(r)&&r.length>0?n.fieldMask=r.join(","):delete n.fieldMask;return n}class uM extends Ni{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let r,a="",c={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const h=rM(this.apiClient,e);a=me("auth_tokens",h._url),c=h._query,delete h.config,delete h._url,delete h._query;const m=cM(h,e.config);return r=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),r.then(p=>aM(p))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dM(n){const e={},t=u(n,["name"]);t!=null&&d(e,["_url","name"],t);const i=u(n,["config"]);return i!=null&&d(e,["config"],i),e}function fM(n,e){const t={},i=u(n,["pageSize"]);e!==void 0&&i!=null&&d(e,["_query","pageSize"],i);const r=u(n,["pageToken"]);e!==void 0&&r!=null&&d(e,["_query","pageToken"],r);const a=u(n,["filter"]);return e!==void 0&&a!=null&&d(e,["_query","filter"],a),t}function hM(n){const e={},t=u(n,["config"]);return t!=null&&d(e,["config"],fM(t,e)),e}function mM(n){const e={},t=u(n,["textInput"]);t!=null&&d(e,["textInput"],t);const i=u(n,["output"]);return i!=null&&d(e,["output"],i),e}function pM(n){const e={};if(u(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(u(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const t=u(n,["examples"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>mM(r))),d(e,["examples","examples"],i)}return e}function gM(n,e){const t={};if(u(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=u(n,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&d(e,["displayName"],i),u(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const r=u(n,["epochCount"]);e!==void 0&&r!=null&&d(e,["tuningTask","hyperparameters","epochCount"],r);const a=u(n,["learningRateMultiplier"]);if(a!=null&&d(t,["tuningTask","hyperparameters","learningRateMultiplier"],a),u(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(u(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const c=u(n,["batchSize"]);e!==void 0&&c!=null&&d(e,["tuningTask","hyperparameters","batchSize"],c);const h=u(n,["learningRate"]);return e!==void 0&&h!=null&&d(e,["tuningTask","hyperparameters","learningRate"],h),t}function yM(n){const e={},t=u(n,["baseModel"]);t!=null&&d(e,["baseModel"],t);const i=u(n,["trainingDataset"]);i!=null&&d(e,["tuningTask","trainingData"],pM(i));const r=u(n,["config"]);return r!=null&&d(e,["config"],gM(r,e)),e}function vM(n){const e={},t=u(n,["name"]);t!=null&&d(e,["_url","name"],t);const i=u(n,["config"]);return i!=null&&d(e,["config"],i),e}function TM(n,e){const t={},i=u(n,["pageSize"]);e!==void 0&&i!=null&&d(e,["_query","pageSize"],i);const r=u(n,["pageToken"]);e!==void 0&&r!=null&&d(e,["_query","pageToken"],r);const a=u(n,["filter"]);return e!==void 0&&a!=null&&d(e,["_query","filter"],a),t}function SM(n){const e={},t=u(n,["config"]);return t!=null&&d(e,["config"],TM(t,e)),e}function xM(n,e){const t={},i=u(n,["gcsUri"]);e!==void 0&&i!=null&&d(e,["supervisedTuningSpec","trainingDatasetUri"],i);const r=u(n,["vertexDatasetResource"]);if(e!==void 0&&r!=null&&d(e,["supervisedTuningSpec","trainingDatasetUri"],r),u(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return t}function EM(n,e){const t={},i=u(n,["gcsUri"]);i!=null&&d(t,["validationDatasetUri"],i);const r=u(n,["vertexDatasetResource"]);return e!==void 0&&r!=null&&d(e,["supervisedTuningSpec","trainingDatasetUri"],r),t}function CM(n,e){const t={},i=u(n,["validationDataset"]);e!==void 0&&i!=null&&d(e,["supervisedTuningSpec"],EM(i,t));const r=u(n,["tunedModelDisplayName"]);e!==void 0&&r!=null&&d(e,["tunedModelDisplayName"],r);const a=u(n,["description"]);e!==void 0&&a!=null&&d(e,["description"],a);const c=u(n,["epochCount"]);e!==void 0&&c!=null&&d(e,["supervisedTuningSpec","hyperParameters","epochCount"],c);const h=u(n,["learningRateMultiplier"]);e!==void 0&&h!=null&&d(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],h);const m=u(n,["exportLastCheckpointOnly"]);e!==void 0&&m!=null&&d(e,["supervisedTuningSpec","exportLastCheckpointOnly"],m);const p=u(n,["adapterSize"]);if(e!==void 0&&p!=null&&d(e,["supervisedTuningSpec","hyperParameters","adapterSize"],p),u(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(u(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return t}function AM(n){const e={},t=u(n,["baseModel"]);t!=null&&d(e,["baseModel"],t);const i=u(n,["trainingDataset"]);i!=null&&d(e,["supervisedTuningSpec","trainingDatasetUri"],xM(i,e));const r=u(n,["config"]);return r!=null&&d(e,["config"],CM(r,e)),e}function _M(n){const e={},t=u(n,["name"]);t!=null&&d(e,["model"],t);const i=u(n,["name"]);return i!=null&&d(e,["endpoint"],i),e}function Tv(n){const e={},t=u(n,["sdkHttpResponse"]);t!=null&&d(e,["sdkHttpResponse"],t);const i=u(n,["name"]);i!=null&&d(e,["name"],i);const r=u(n,["state"]);r!=null&&d(e,["state"],Wy(r));const a=u(n,["createTime"]);a!=null&&d(e,["createTime"],a);const c=u(n,["tuningTask","startTime"]);c!=null&&d(e,["startTime"],c);const h=u(n,["tuningTask","completeTime"]);h!=null&&d(e,["endTime"],h);const m=u(n,["updateTime"]);m!=null&&d(e,["updateTime"],m);const p=u(n,["description"]);p!=null&&d(e,["description"],p);const y=u(n,["baseModel"]);y!=null&&d(e,["baseModel"],y);const T=u(n,["_self"]);T!=null&&d(e,["tunedModel"],_M(T));const x=u(n,["distillationSpec"]);x!=null&&d(e,["distillationSpec"],x);const C=u(n,["experiment"]);C!=null&&d(e,["experiment"],C);const _=u(n,["labels"]);_!=null&&d(e,["labels"],_);const w=u(n,["pipelineJob"]);w!=null&&d(e,["pipelineJob"],w);const N=u(n,["satisfiesPzi"]);N!=null&&d(e,["satisfiesPzi"],N);const H=u(n,["satisfiesPzs"]);H!=null&&d(e,["satisfiesPzs"],H);const K=u(n,["serviceAccount"]);K!=null&&d(e,["serviceAccount"],K);const I=u(n,["tunedModelDisplayName"]);return I!=null&&d(e,["tunedModelDisplayName"],I),e}function wM(n){const e={},t=u(n,["sdkHttpResponse"]);t!=null&&d(e,["sdkHttpResponse"],t);const i=u(n,["nextPageToken"]);i!=null&&d(e,["nextPageToken"],i);const r=u(n,["tunedModels"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(c=>Tv(c))),d(e,["tuningJobs"],a)}return e}function bM(n){const e={},t=u(n,["sdkHttpResponse"]);t!=null&&d(e,["sdkHttpResponse"],t);const i=u(n,["name"]);i!=null&&d(e,["name"],i);const r=u(n,["metadata"]);r!=null&&d(e,["metadata"],r);const a=u(n,["done"]);a!=null&&d(e,["done"],a);const c=u(n,["error"]);return c!=null&&d(e,["error"],c),e}function RM(n){const e={},t=u(n,["checkpointId"]);t!=null&&d(e,["checkpointId"],t);const i=u(n,["epoch"]);i!=null&&d(e,["epoch"],i);const r=u(n,["step"]);r!=null&&d(e,["step"],r);const a=u(n,["endpoint"]);return a!=null&&d(e,["endpoint"],a),e}function MM(n){const e={},t=u(n,["model"]);t!=null&&d(e,["model"],t);const i=u(n,["endpoint"]);i!=null&&d(e,["endpoint"],i);const r=u(n,["checkpoints"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(c=>RM(c))),d(e,["checkpoints"],a)}return e}function $u(n){const e={},t=u(n,["sdkHttpResponse"]);t!=null&&d(e,["sdkHttpResponse"],t);const i=u(n,["name"]);i!=null&&d(e,["name"],i);const r=u(n,["state"]);r!=null&&d(e,["state"],Wy(r));const a=u(n,["createTime"]);a!=null&&d(e,["createTime"],a);const c=u(n,["startTime"]);c!=null&&d(e,["startTime"],c);const h=u(n,["endTime"]);h!=null&&d(e,["endTime"],h);const m=u(n,["updateTime"]);m!=null&&d(e,["updateTime"],m);const p=u(n,["error"]);p!=null&&d(e,["error"],p);const y=u(n,["description"]);y!=null&&d(e,["description"],y);const T=u(n,["baseModel"]);T!=null&&d(e,["baseModel"],T);const x=u(n,["tunedModel"]);x!=null&&d(e,["tunedModel"],MM(x));const C=u(n,["supervisedTuningSpec"]);C!=null&&d(e,["supervisedTuningSpec"],C);const _=u(n,["tuningDataStats"]);_!=null&&d(e,["tuningDataStats"],_);const w=u(n,["encryptionSpec"]);w!=null&&d(e,["encryptionSpec"],w);const N=u(n,["partnerModelTuningSpec"]);N!=null&&d(e,["partnerModelTuningSpec"],N);const H=u(n,["distillationSpec"]);H!=null&&d(e,["distillationSpec"],H);const K=u(n,["experiment"]);K!=null&&d(e,["experiment"],K);const I=u(n,["labels"]);I!=null&&d(e,["labels"],I);const Q=u(n,["pipelineJob"]);Q!=null&&d(e,["pipelineJob"],Q);const Y=u(n,["satisfiesPzi"]);Y!=null&&d(e,["satisfiesPzi"],Y);const oe=u(n,["satisfiesPzs"]);oe!=null&&d(e,["satisfiesPzs"],oe);const ce=u(n,["serviceAccount"]);ce!=null&&d(e,["serviceAccount"],ce);const Ae=u(n,["tunedModelDisplayName"]);return Ae!=null&&d(e,["tunedModelDisplayName"],Ae),e}function NM(n){const e={},t=u(n,["sdkHttpResponse"]);t!=null&&d(e,["sdkHttpResponse"],t);const i=u(n,["nextPageToken"]);i!=null&&d(e,["nextPageToken"],i);const r=u(n,["tuningJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(c=>$u(c))),d(e,["tuningJobs"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class kM extends Ni{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new fr(Ri.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const i=await this.tuneMldevInternal(t);let r="";return i.metadata!==void 0&&i.metadata.tunedModel!==void 0?r=i.metadata.tunedModel:i.name!==void 0&&i.name.includes("/operations/")&&(r=i.name.split("/operations/")[0]),{name:r,state:Lu.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,r,a;let c,h="",m={};if(this.apiClient.isVertexAI()){const p=vM(e);return h=me("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),c.then(y=>$u(y))}else{const p=dM(e);return h=me("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),c.then(y=>Tv(y))}}async listInternal(e){var t,i,r,a;let c,h="",m={};if(this.apiClient.isVertexAI()){const p=SM(e);return h=me("tuningJobs",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),c.then(y=>{const T=NM(y),x=new bg;return Object.assign(x,T),x})}else{const p=hM(e);return h=me("tunedModels",p._url),m=p._query,delete p.config,delete p._url,delete p._query,c=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),c.then(y=>{const T=wM(y),x=new bg;return Object.assign(x,T),x})}}async tuneInternal(e){var t,i;let r,a="",c={};if(this.apiClient.isVertexAI()){const h=AM(e);return a=me("tuningJobs",h._url),c=h._query,delete h.config,delete h._url,delete h._query,r=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(p=>{const y=p;return y.sdkHttpResponse={headers:m.headers},y})),r.then(m=>$u(m))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let r,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=yM(e);return a=me("tunedModels",h._url),c=h._query,delete h.config,delete h._url,delete h._query,r=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(p=>{const y=p;return y.sdkHttpResponse={headers:m.headers},y})),r.then(m=>bM(m))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class IM{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const DM=1024*1024*8,LM=3,PM=1e3,UM=2,Eu="x-goog-upload-status";async function OM(n,e,t){var i,r,a;let c=0,h=0,m=new Pu(new Response),p="upload";for(c=n.size;h<c;){const T=Math.min(DM,c-h),x=n.slice(h,h+T);h+T>=c&&(p+=", finalize");let C=0,_=PM;for(;C<LM&&(m=await t.request({path:"",body:x,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":p,"X-Goog-Upload-Offset":String(h),"Content-Length":String(T)}}}),!(!((i=m==null?void 0:m.headers)===null||i===void 0)&&i[Eu]));)C++,await HM(_),_=_*UM;if(h+=T,((r=m==null?void 0:m.headers)===null||r===void 0?void 0:r[Eu])!=="active")break;if(c<=h)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const y=await(m==null?void 0:m.json());if(((a=m==null?void 0:m.headers)===null||a===void 0?void 0:a[Eu])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return y.file}async function BM(n){return{size:n.size,type:n.type}}function HM(n){return new Promise(e=>setTimeout(e,n))}class VM{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await OM(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await BM(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class GM{create(e,t,i){return new qM(e,t,i)}}class qM{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Qg="x-goog-api-key";class zM{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(Qg)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(Qg,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const $M="gl-node/";class FM{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const i=qx(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion;const r=new zM(this.apiKey);this.apiClient=new u1({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:$M+"web",uploader:new VM,downloader:new IM}),this.models=new N1(this.apiClient),this.live=new C1(this.apiClient,r,new GM),this.batches=new fC(this.apiClient),this.chats=new gA(this.models,this.apiClient),this.caches=new hA(this.apiClient),this.files=new MA(this.apiClient),this.operations=new L1(this.apiClient),this.authTokens=new uM(this.apiClient),this.tunings=new kM(this.apiClient)}}const Wa=class Wa{static calibrateConfidence(e,t=!1,i){const a={...t?this.ULTRA_MODE_WEIGHTS:this.DEFAULT_WEIGHTS,...i},c=this.calculateConfidenceFactors(e),h=this.calculateWeightedScore(c,a),m=this.calculateConfidenceInterval(c,h,e),p=this.generateConfidenceBreakdown(c,a,e),y=this.gatherHistoricalContext(e),T=this.calculateRiskAdjustments(e);return{overallScore:this.applyFinalAdjustments(h,T,t),factors:c,weights:a,interval:m,breakdown:p,historicalContext:y,riskAdjustments:T}}static calculateConfidenceFactors(e){const t=this.calculateTechnicalConfluence(e),i=this.calculateHistoricalPatternSuccess(e),r=this.calculateMarketConditionsFactor(e),a=this.calculateVolatilityAdjustment(e),c=this.calculateVolumeConfirmation(e),h=this.calculateStructuralIntegrity(e);return{technicalConfluence:t,historicalPatternSuccess:i,marketConditions:r,volatilityAdjustment:a,volumeConfirmation:c,structuralIntegrity:h}}static calculateTechnicalConfluence(e){let t=50;if(e.multiTimeframeContext){const i=e.multiTimeframeContext;t+=i.confluenceScore*.4,i.conflictingSignals&&i.conflictingSignals.length>0&&(t-=i.conflictingSignals.length*5),i.overallTrend!=="MIXED"&&(t+=10)}if(e.patternAnalysis){const i=e.patternAnalysis;t+=(i.patternConfluence.confidenceScore-50)*.3,i.conflictingPatterns.length>0&&(t-=i.conflictingPatterns.length*3),i.marketCondition.trend.includes("STRONG")&&(t+=5)}if(e.smcAnalysis){const i=e.smcAnalysis;i.tradingBias.direction!=="NEUTRAL"&&(t+=i.tradingBias.confidence*.2),i.confluences.liquidityConfluence.length>2&&(t+=8),i.confluences.orderBlockConfluence.length>1&&(t+=6)}return Math.max(0,Math.min(100,t))}static calculateHistoricalPatternSuccess(e){let t=60;if(e.signal!=="NEUTRAL"&&(e.overallConfidenceScore>=80?t+=15:e.overallConfidenceScore>=60?t+=8:t-=10),e.patternAnalysis){const i=e.patternAnalysis;if(i.classicPatterns.length>0){const r=i.classicPatterns.reduce((a,c)=>a+c.reliability,0)/i.classicPatterns.length;t+=(r-50)*.4}if(i.harmonicPatterns.length>0){const r=i.harmonicPatterns.filter(a=>a.status==="COMPLETED");if(r.length>0){const a=r.reduce((c,h)=>c+h.validity,0)/r.length;t+=(a-50)*.3}}}if(e.multiTimeframeContext){const i=e.multiTimeframeContext;i.overallTrend!=="MIXED"&&i.confluenceScore>70&&(t+=12)}return Math.max(0,Math.min(100,t))}static calculateMarketConditionsFactor(e){let t=50;if(e.patternAnalysis){const i=e.patternAnalysis;switch(i.marketCondition.phase){case"MARKUP":case"ACCUMULATION":t+=10;break;case"DISTRIBUTION":case"MARKDOWN":t-=5;break;case"REACCUMULATION":case"REDISTRIBUTION":t+=3;break}switch(i.marketCondition.volatility){case"LOW":t+=8;break;case"MEDIUM":t+=2;break;case"HIGH":t-=5;break;case"EXTREME":t-=12;break}}return Math.max(0,Math.min(100,t))}static calculateVolatilityAdjustment(e){let t=70,i="MEDIUM";switch(e.patternAnalysis&&(i=e.patternAnalysis.marketCondition.volatility),i){case"LOW":t=85;break;case"MEDIUM":t=70;break;case"HIGH":t=45;break;case"EXTREME":t=25;break}e.overallConfidenceScore<60&&(i==="HIGH"||i==="EXTREME")&&(t-=15);const r=new Date().getHours();return r>=2&&r<=6?t+=5:r>=8&&r<=16&&(t-=3),Math.max(0,Math.min(100,t))}static calculateVolumeConfirmation(e){var i,r,a;let t=50;if((i=e.patternAnalysis)!=null&&i.volumeProfile){const c=e.patternAnalysis.volumeProfile;c.marketStructure.balanced&&(t+=8),c.marketStructure.trending&&(t+=12),c.marketStructure.rotational&&(t-=5),c.tradingImplications.acceptance&&(t+=10),c.tradingImplications.support.length>2&&(t+=6),c.tradingImplications.resistance.length>2&&(t+=6)}if((r=e.patternAnalysis)!=null&&r.classicPatterns){const c=e.patternAnalysis.classicPatterns;for(const h of c)h.volume.breakoutVolume==="CONFIRMED"?t+=15:h.volume.breakoutVolume==="WEAK"&&(t-=8),h.volume.patternVolume==="INCREASING"?t+=8:h.volume.patternVolume==="DECREASING"&&(t-=5)}if((a=e.patternAnalysis)!=null&&a.wyckoffAnalysis){const c=e.patternAnalysis.wyckoffAnalysis;c.volumeCharacteristics.climacticVolume&&(t+=12),c.volumeCharacteristics.volumeConfirmation&&(t+=15),c.volumeCharacteristics.volumeDrying&&(t-=8)}return Math.max(0,Math.min(100,t))}static calculateStructuralIntegrity(e){let t=50;if(!e.smcAnalysis)return t;const i=e.smcAnalysis;switch(i.overallStructure){case"BULLISH_STRUCTURE":case"BEARISH_STRUCTURE":t+=20;break;case"RANGING":t+=5;break;case"TRANSITIONAL":t-=10;break}t+=(i.tradingBias.confidence-50)*.4;const r=i.criticalLevels;r.highestProbabilityZones.length>2&&(t+=8),r.liquidityTargets.length>1&&(t+=6),r.structuralSupports.length+r.structuralResistances.length>3&&(t+=5);const a=i.confluences;a.orderBlockConfluence.length>1&&(t+=8),a.fvgConfluence.length>0&&(t+=5),a.liquidityConfluence.length>1&&(t+=7);const c=i.riskAssessment;return t-=c.liquidityRisks.length*3,t-=c.structuralRisks.length*4,Math.max(0,Math.min(100,t))}static calculateWeightedScore(e,t){const i=e.technicalConfluence*t.technicalConfluence+e.historicalPatternSuccess*t.historicalPatternSuccess+e.marketConditions*t.marketConditions+e.volatilityAdjustment*t.volatilityAdjustment+e.volumeConfirmation*t.volumeConfirmation+e.structuralIntegrity*t.structuralIntegrity;return Math.round(i)}static calculateConfidenceInterval(e,t,i){const r=Object.values(e),a=r.reduce((w,N)=>w+N,0)/r.length,c=r.reduce((w,N)=>w+Math.pow(N-a,2),0)/r.length,h=Math.sqrt(c);let m=Math.min(25,h*.6);const p=this.assessDataQuality(i);m+=(100-p)*.15;const y=this.assessSignalClarity(i);m+=(100-y)*.1;const T=this.assessMarketNoise(i);m+=T*.08,m=Math.max(5,Math.min(30,m));const x=Math.max(0,t-m),C=Math.min(100,t+m);let _;return m<=8?_="VERY_HIGH":m<=15?_="HIGH":m<=22?_="MEDIUM":_="LOW",{centerValue:t,lowerBound:x,upperBound:C,uncertainty:Math.round(m),reliability:_}}static generateConfidenceBreakdown(e,t,i){const r={};return Object.entries(e).forEach(([a,c])=>{const h=t[a];r[a]=Math.round(c*h)}),{factorContributions:r,qualityMetrics:{dataQuality:this.assessDataQuality(i),signalClarity:this.assessSignalClarity(i),marketNoise:this.assessMarketNoise(i)}}}static gatherHistoricalContext(e){var c,h;let t=50,i=65,r=8.5,a=-4.2;return e.signal!=="NEUTRAL"&&(e.overallConfidenceScore>=80?(t+=20,i+=15,r+=3.2,a-=1.1):e.overallConfidenceScore>=60&&(t+=10,i+=8,r+=1.5,a-=.5)),(c=e.patternAnalysis)!=null&&c.harmonicPatterns.length&&(i+=5,r+=1.2),(h=e.multiTimeframeContext)!=null&&h.confluenceScore&&e.multiTimeframeContext.confluenceScore>70&&(i+=10,r+=2.1),{similarPatternCount:Math.round(t),successRate:Math.round(i),avgReturnOnSuccess:Math.round(r*100)/100,avgLossOnFailure:Math.round(a*100)/100}}static calculateRiskAdjustments(e){let t=0,i=0,r=0;const a=new Date().getHours();return(a>=22||a<=6)&&(i=5),![0,6].includes(new Date().getDay())&&a>=8&&a<=10&&(r=3),{volatilityPenalty:t,liquidityDiscount:i,newsRisk:r}}static applyFinalAdjustments(e,t,i){let r=e;return r-=t.volatilityPenalty,r-=t.liquidityDiscount,r-=t.newsRisk,i&&(r*=.95),Math.max(0,Math.min(100,Math.round(r)))}static assessDataQuality(e){let t=70;return e.multiTimeframeContext&&(t+=15),e.smcAnalysis&&(t+=10),e.patternAnalysis&&(t+=10),Math.min(100,t)}static assessSignalClarity(e){var i;let t=50;return e.signal!=="NEUTRAL"&&(t+=20,e.overallConfidenceScore>=75?t+=20:e.overallConfidenceScore>=50&&(t+=10)),(i=e.multiTimeframeContext)!=null&&i.overallTrend&&e.multiTimeframeContext.overallTrend!=="MIXED"&&(t+=15),Math.min(100,t)}static assessMarketNoise(e){var i;let t=30;return((i=e.patternAnalysis)==null?void 0:i.patternConfluence.confidenceScore)>70&&(t-=8),Math.max(0,Math.min(100,t))}static formatConfidenceDisplay(e){const{overallScore:t,interval:i}=e,r=i.uncertainty>0?` ${i.uncertainty}%`:"",a=i.reliability.toLowerCase();return`${t}%${r} (${a} reliability)`}static getConfidenceLevel(e,t=!1){const i=t?85:75;return e.overallScore>=i?"HIGH":"LOW"}};Wa.DEFAULT_WEIGHTS={technicalConfluence:.25,historicalPatternSuccess:.2,marketConditions:.15,volatilityAdjustment:.15,volumeConfirmation:.15,structuralIntegrity:.1},Wa.ULTRA_MODE_WEIGHTS={technicalConfluence:.3,historicalPatternSuccess:.25,marketConditions:.15,volatilityAdjustment:.1,volumeConfirmation:.15,structuralIntegrity:.05};let Ja=Wa;class Sv{constructor(e){var t,i,r,a,c,h,m,p,y,T,x,C,_,w,N,H;this.priceHistory=[],this.volumeHistory=[],this.regimeHistory=[],this.config={lookbackPeriod:(e==null?void 0:e.lookbackPeriod)??30,updateFrequency:(e==null?void 0:e.updateFrequency)??15,volatilityWindow:(e==null?void 0:e.volatilityWindow)??14,trendWindow:(e==null?void 0:e.trendWindow)??20,momentumWindow:(e==null?void 0:e.momentumWindow)??14,thresholds:{volatility:{low:((i=(t=e==null?void 0:e.thresholds)==null?void 0:t.volatility)==null?void 0:i.low)??.5,normal:((a=(r=e==null?void 0:e.thresholds)==null?void 0:r.volatility)==null?void 0:a.normal)??1.5,high:((h=(c=e==null?void 0:e.thresholds)==null?void 0:c.volatility)==null?void 0:h.high)??3},trend:{weak:((p=(m=e==null?void 0:e.thresholds)==null?void 0:m.trend)==null?void 0:p.weak)??25,moderate:((T=(y=e==null?void 0:e.thresholds)==null?void 0:y.trend)==null?void 0:T.moderate)??40,strong:((C=(x=e==null?void 0:e.thresholds)==null?void 0:x.trend)==null?void 0:C.strong)??60},ranging:{efficiency:((w=(_=e==null?void 0:e.thresholds)==null?void 0:_.ranging)==null?void 0:w.efficiency)??30,consolidation:((H=(N=e==null?void 0:e.thresholds)==null?void 0:N.ranging)==null?void 0:H.consolidation)??70}},...e}}async detectMarketRegime(e,t,i="1H"){if(e.length<this.config.volatilityWindow)throw new Error("Insufficient price data for regime detection");this.priceHistory=e,this.volumeHistory=t;const r=this.calculateVolatilityMetrics(e),a=this.calculateTrendMetrics(e),c=this.calculateRangingMetrics(e),h=this.calculateMomentumMetrics(e),m=this.classifyTrendRegime(a,h),p=this.classifyDirectionRegime(a,c),y=r.regime,T=h.regime,x=this.determineOverallRegime(m,p,y,T),C=this.calculateConfidence(r,a,c,h),_=this.calculateStability(),w=this.generateAnalysisAdjustments(x,y,m,T),N=this.getRegimeHistory(),{warnings:H,opportunities:K}=this.generateInsights(x,r,a,h),I={timestamp:new Date().toISOString(),timeframe:i,trendRegime:m,directionRegime:p,volatilityRegime:y,momentumRegime:T,volatilityMetrics:r,trendMetrics:a,rangingMetrics:c,momentumMetrics:h,overallRegime:x,confidence:C,stability:_,analysisAdjustments:w,regimeHistory:N,warnings:H,opportunities:K,nextReviewTime:new Date(Date.now()+this.config.updateFrequency*6e4).toISOString()};return this.regimeHistory.push(I),this.regimeHistory.length>100&&(this.regimeHistory=this.regimeHistory.slice(-100)),I}calculateVolatilityMetrics(e){const t=this.calculateReturns(e),i=this.calculateATR(e),r=i/e[e.length-1]*100,a=this.calculateStandardDeviation(t),c=this.calculateVolatilityPercentile(a);let h;r<this.config.thresholds.volatility.low?h="LOW":r<this.config.thresholds.volatility.normal?h="NORMAL":r<this.config.thresholds.volatility.high?h="HIGH":h="EXTREME";const m=this.detectVolatilityCluster(t);return{atr:i,atrNormalized:r,standardDeviation:a,volatilityPercentile:c,regime:h,isVolatilityCluster:m}}calculateTrendMetrics(e){const t=this.calculateADX(e),i=this.determineTrendDirection(e),r=this.calculateTrendConsistency(e),a=this.calculateTrendAge(e);let c;return t<20?c="VERY_WEAK":t<this.config.thresholds.trend.weak?c="WEAK":t<this.config.thresholds.trend.moderate?c="MODERATE":t<this.config.thresholds.trend.strong?c="STRONG":c="VERY_STRONG",{adx:t,trendStrength:c,direction:i,consistency:r,trendAge:a,regime:"NEUTRAL"}}calculateRangingMetrics(e){const t=this.calculatePriceEfficiency(e),i=this.calculateConsolidationStrength(e),r=this.calculateBreakoutProbability(e),a=this.calculateSRStrength(e);let c;return i>80?c="EXCELLENT":i>60?c="GOOD":i>40?c="FAIR":c="POOR",{efficiency:t,consolidationStrength:i,breakoutProbability:r,rangeQuality:c,supportResistanceStrength:a}}calculateMomentumMetrics(e){const t=this.calculateRSI(e),i=this.calculateMACD(e),r=this.calculateROC(e),a=this.detectDivergence(e,t),c=this.detectMomentumShift(t,i);let h;return Math.abs(i.histogram)>Math.abs(this.getHistoricalAverage(this.getMACDHistory(),10))*1.5?h="ACCELERATING":Math.abs(i.histogram)<Math.abs(this.getHistoricalAverage(this.getMACDHistory(),10))*.5?h="DECELERATING":this.calculateVolatility(this.getROCHistory())<.5?h="STABLE":h="CHOPPY",{rsi:t,macd:i,roc:r,divergenceDetected:a,regime:h,momentumShift:c}}classifyTrendRegime(e,t){const{adx:i,direction:r,consistency:a}=e,{rsi:c,momentumShift:h}=t;if(r==="UP"){if(i>50&&c>60&&a>70&&h==="BULLISH")return"STRONG_BULL";if(i>25&&c>50)return"WEAK_BULL"}else if(r==="DOWN"){if(i>50&&c<40&&a>70&&h==="BEARISH")return"STRONG_BEAR";if(i>25&&c<50)return"WEAK_BEAR"}return"NEUTRAL"}classifyDirectionRegime(e,t){const{adx:i,trendStrength:r}=e,{efficiency:a,consolidationStrength:c}=t;return i>40&&a>60?"TRENDING":i<20&&c>this.config.thresholds.ranging.consolidation?"RANGING":"TRANSITIONAL"}determineOverallRegime(e,t,i,r){return t==="TRANSITIONAL"||i==="EXTREME"?"TRANSITIONAL":e==="STRONG_BULL"||e==="WEAK_BULL"?t==="TRENDING"?"BULL_TRENDING":"BULL_RANGING":e==="STRONG_BEAR"||e==="WEAK_BEAR"?t==="TRENDING"?"BEAR_TRENDING":"BEAR_RANGING":t==="TRENDING"?"NEUTRAL_TRENDING":"NEUTRAL_RANGING"}calculateConfidence(e,t,i,r){let a=50;return(e.volatilityPercentile>80||e.volatilityPercentile<20)&&(a+=15),t.adx>40?a+=20:t.adx<20&&(a+=10),t.consistency>70&&(a+=10),r.divergenceDetected||(a+=10),i.rangeQuality==="EXCELLENT"&&(a+=15),Math.min(95,Math.max(20,a))}calculateStability(){if(this.regimeHistory.length<3)return 50;const e=this.regimeHistory.slice(-5),t=new Set(e.map(r=>r.overallRegime));return Math.max(20,100-(t.size-1)*20)}generateAnalysisAdjustments(e,t,i,r){let a=1,c=1,h=1,m="NONE",p="CONSERVATIVE";switch(t){case"LOW":a=1.2,c=.8,p="PATIENT";break;case"HIGH":a=.7,c=1.3,m="LOWER",p="CONSERVATIVE";break;case"EXTREME":a=.5,c=1.5,m="LOWER",p="SCALPING";break}switch(i){case"STRONG_BULL":case"STRONG_BEAR":h=1.4,m="HIGHER",p="AGGRESSIVE";break;case"WEAK_BULL":case"WEAK_BEAR":h=1.1;break}switch(e){case"BULL_TRENDING":case"BEAR_TRENDING":a*=1.1;break;case"NEUTRAL_RANGING":h=.8,p="SCALPING";break;case"TRANSITIONAL":a*=.8,p="PATIENT";break}return{riskMultiplier:a,stopLossAdjustment:c,takeProfitAdjustment:h,timeframeBias:m,entryApproach:p}}getRegimeHistory(){if(this.regimeHistory.length===0)return{previousRegime:"UNKNOWN",timeInCurrentRegime:0,averageRegimeDuration:0,recentRegimeChanges:0};const e=this.regimeHistory[this.regimeHistory.length-1],t=this.regimeHistory.length>1?this.regimeHistory[this.regimeHistory.length-2].overallRegime:"UNKNOWN",i=this.findRegimeStart(e.overallRegime),r=i?(Date.now()-new Date(i).getTime())/(1e3*60*60):0,a=this.calculateAverageRegimeDuration(),c=this.countRecentRegimeChanges();return{previousRegime:t,timeInCurrentRegime:r,averageRegimeDuration:a,recentRegimeChanges:c}}generateInsights(e,t,i,r){const a=[],c=[];switch(t.regime==="EXTREME"&&a.push("Extreme volatility detected - consider reducing position sizes"),t.isVolatilityCluster&&a.push("Volatility clustering detected - expect continued high volatility"),i.trendAge>30&&a.push("Trend is mature - watch for potential reversal signals"),i.consistency<40&&a.push("Trend lacks consistency - be cautious of false breakouts"),r.divergenceDetected&&a.push("Price-momentum divergence detected - potential trend weakness"),e){case"BULL_TRENDING":c.push("Strong bullish trend - consider trend-following strategies"),c.push("Look for pullback entries on higher timeframes");break;case"BEAR_TRENDING":c.push("Strong bearish trend - consider short positions"),c.push("Watch for bounce-shorting opportunities");break;case"NEUTRAL_RANGING":c.push("Range-bound market - consider mean-reversion strategies"),c.push("Trade range boundaries with tight stops");break;case"TRANSITIONAL":c.push("Market in transition - wait for clearer direction"),c.push("Focus on lower timeframes for scalping opportunities");break}return t.regime==="LOW"&&c.push("Low volatility environment - consider breakout strategies"),{warnings:a,opportunities:c}}calculateReturns(e){const t=[];for(let i=1;i<e.length;i++)t.push((e[i]-e[i-1])/e[i-1]);return t}calculateATR(e,t=14){if(e.length<t+1)return 0;const i=[];for(let r=1;r<e.length;r++){const a=e[r],c=e[r],h=e[r-1],m=Math.max(a-c,Math.abs(a-h),Math.abs(c-h));i.push(m)}return this.calculateSMA(i.slice(-t))}calculateStandardDeviation(e){const t=e.reduce((a,c)=>a+c,0)/e.length,r=e.map(a=>Math.pow(a-t,2)).reduce((a,c)=>a+c,0)/e.length;return Math.sqrt(r)}calculateVolatilityPercentile(e){const t=this.getHistoricalVolatilities();if(t.length===0)return 50;const i=[...t].sort((a,c)=>a-c);return i.filter(a=>a<=e).length/i.length*100}detectVolatilityCluster(e){if(e.length<10)return!1;const t=e.slice(-5),i=this.calculateStandardDeviation(t),r=this.calculateStandardDeviation(e.slice(-20,-5));return i>r*1.5}calculateADX(e,t=14){if(e.length<t*2)return 0;const i=this.calculateTrendStrength(e,t);return Math.min(100,i*100)}determineTrendDirection(e){if(e.length<20)return"SIDEWAYS";const t=e.slice(-10),i=e.slice(-20,-10),r=this.calculateSMA(t),a=this.calculateSMA(i),c=(r-a)/a;return c>.02?"UP":c<-.02?"DOWN":"SIDEWAYS"}calculateTrendConsistency(e){if(e.length<10)return 0;const t=this.determineTrendDirection(e);if(t==="SIDEWAYS")return 0;let i=0;const r=t==="UP";for(let a=1;a<e.length;a++){const c=e[a]-e[a-1];(r&&c>0||!r&&c<0)&&i++}return i/(e.length-1)*100}calculateTrendAge(e){const t=this.determineTrendDirection(e);if(t==="SIDEWAYS")return 0;const i=t==="UP";let r=0;for(let a=e.length-1;a>0;a--){const c=e[a]-e[a-1];if(i&&c>0||!i&&c<0)r++;else break}return r}calculatePriceEfficiency(e){if(e.length<2)return 0;const t=Math.abs(e[e.length-1]-e[0]);let i=0;for(let r=1;r<e.length;r++)i+=Math.abs(e[r]-e[r-1]);return i>0?t/i*100:0}calculateConsolidationStrength(e){if(e.length<10)return 0;const t=Math.max(...e),i=Math.min(...e),r=t-i;return e[e.length-1],e.filter(c=>c>=i+r*.1&&c<=t-r*.1).length/e.length*100}calculateBreakoutProbability(e){const t=this.calculateConsolidationStrength(e),i=this.calculateStandardDeviation(this.calculateReturns(e));return Math.min(100,Math.max(0,100-t+i*1e3))}calculateSRStrength(e){return this.findKeyLevels(e).length*20}calculateRSI(e,t=14){if(e.length<t+1)return 50;const r=this.calculateReturns(e).slice(-t),a=r.filter(y=>y>0),c=r.filter(y=>y<0).map(y=>Math.abs(y)),h=a.length>0?a.reduce((y,T)=>y+T,0)/a.length:0,m=c.length>0?c.reduce((y,T)=>y+T,0)/c.length:0;return m===0?100:100-100/(1+h/m)}calculateMACD(e){const t=this.calculateEMA(e,12),i=this.calculateEMA(e,26),r=t-i,a=this.getMACDHistory();a.push(r);const c=this.calculateSMA(a.slice(-9)),h=r-c;return{line:r,signal:c,histogram:h}}calculateROC(e,t=10){if(e.length<t+1)return 0;const i=e[e.length-1],r=e[e.length-1-t];return(i-r)/r*100}detectDivergence(e,t){if(e.length<20)return!1;const i=e.slice(-10),r=e.slice(-20,-10),a=this.calculateSMA(i)>this.calculateSMA(r),c=t>50;return a!==c}detectMomentumShift(e,t){return e>60&&t.histogram>0?"BULLISH":e<40&&t.histogram<0?"BEARISH":"NEUTRAL"}calculateSMA(e){return e.reduce((t,i)=>t+i,0)/e.length}calculateEMA(e,t){if(e.length===0)return 0;if(e.length===1)return e[0];const i=2/(t+1);let r=e[0];for(let a=1;a<e.length;a++)r=e[a]*i+r*(1-i);return r}calculateTrendStrength(e,t){if(e.length<t)return 0;const i=this.calculateSMA(e.slice(-t)),r=e[e.length-1];return Math.abs(r-i)/i}findKeyLevels(e){const t=[];for(let r=1;r<e.length-1;r++){const a=e[r],c=e[r-1],h=e[r+1];a>c&&a>h&&t.push(a),a<c&&a<h&&t.push(a)}return t.filter((r,a,c)=>c.findIndex(h=>Math.abs(h-r)/r<.001)===a)}findRegimeStart(e){for(let t=this.regimeHistory.length-1;t>=0;t--)if(this.regimeHistory[t].overallRegime!==e)return t<this.regimeHistory.length-1?this.regimeHistory[t+1].timestamp:null;return this.regimeHistory.length>0?this.regimeHistory[0].timestamp:null}calculateAverageRegimeDuration(){if(this.regimeHistory.length<2)return 0;const e=[];let t=this.regimeHistory[0].overallRegime,i=new Date(this.regimeHistory[0].timestamp).getTime();for(let r=1;r<this.regimeHistory.length;r++)if(this.regimeHistory[r].overallRegime!==t){const a=(new Date(this.regimeHistory[r].timestamp).getTime()-i)/36e5;e.push(a),t=this.regimeHistory[r].overallRegime,i=new Date(this.regimeHistory[r].timestamp).getTime()}return e.length>0?e.reduce((r,a)=>r+a,0)/e.length:0}countRecentRegimeChanges(){if(this.regimeHistory.length<2)return 0;const e=this.regimeHistory.slice(-10);let t=0;for(let i=1;i<e.length;i++)e[i].overallRegime!==e[i-1].overallRegime&&t++;return t}getHistoricalVolatilities(){return[]}getMACDHistory(){return[]}getROCHistory(){return[]}getHistoricalAverage(e,t){if(e.length===0)return 0;const i=e.slice(-t);return i.reduce((r,a)=>r+a,0)/i.length}calculateVolatility(e){return this.calculateStandardDeviation(e)}updateConfig(e){this.config={...this.config,...e}}getConfig(){return{...this.config}}resetHistory(){this.regimeHistory=[],this.priceHistory=[],this.volumeHistory=[]}getRegimeHistoryData(){return[...this.regimeHistory]}}const YM=void 0;throw new Error("API_KEY environment variable not set");const JM=new FM({apiKey:YM}),jM=new Sv;function KM(n){const i=[],r=[];let a=5e4;for(let c=0;c<100;c++){const m=n.toLowerCase().includes("bull")?.001:n.toLowerCase().includes("bear")?-.001:0,p=(Math.random()-.5)*.02+m;a=a*(1+p),i.push(a);const y=1e6,T=Math.random()*.5+.75;r.push(y*T)}return{prices:i,volumes:r}}function WM(n){return`
MARKET REGIME ANALYSIS:
 Overall Regime: ${n.overallRegime} (${n.confidence}% confidence)
 Trend Regime: ${n.trendRegime}
 Direction Regime: ${n.directionRegime} 
 Volatility Regime: ${n.volatilityRegime} (ATR: ${n.volatilityMetrics.atrNormalized.toFixed(2)}%)
 Momentum Regime: ${n.momentumRegime}

VOLATILITY METRICS:
 ATR Normalized: ${n.volatilityMetrics.atrNormalized.toFixed(2)}%
 Volatility Percentile: ${n.volatilityMetrics.volatilityPercentile.toFixed(0)}th percentile
 Volatility Clustering: ${n.volatilityMetrics.isVolatilityCluster?"DETECTED":"NONE"}

TREND METRICS:
 ADX: ${n.trendMetrics.adx.toFixed(1)} (${n.trendMetrics.trendStrength})
 Direction: ${n.trendMetrics.direction}
 Consistency: ${n.trendMetrics.consistency.toFixed(0)}%
 Trend Age: ${n.trendMetrics.trendAge} periods

ANALYSIS ADJUSTMENTS:
 Risk Multiplier: ${n.analysisAdjustments.riskMultiplier.toFixed(2)}x
 Stop Loss Adjustment: ${n.analysisAdjustments.stopLossAdjustment.toFixed(2)}x
 Take Profit Adjustment: ${n.analysisAdjustments.takeProfitAdjustment.toFixed(2)}x
 Entry Approach: ${n.analysisAdjustments.entryApproach}
 Timeframe Bias: ${n.analysisAdjustments.timeframeBias}

REGIME INSIGHTS:
${n.warnings.length>0?` Warnings: ${n.warnings.join("; ")}`:""}
${n.opportunities.length>0?` Opportunities: ${n.opportunities.join("; ")}`:""}

REGIME STABILITY: ${n.stability}% | Time in Current Regime: ${n.regimeHistory.timeInCurrentRegime.toFixed(1)} hours
`}async function nl(n,e,t,i=6e4,r=3){const a=async(c=1)=>{try{return await Promise.race([JM.models.generateContentStream({model:n,contents:e,config:t}),new Promise((h,m)=>setTimeout(()=>m(new Error(`Request timeout after ${i/1e3} seconds`)),i))])}catch(h){if(h instanceof Error&&(h.message.includes("timeout")||h.message.includes("Failed to fetch")||h.message.includes("NetworkError")||h.name==="TypeError")&&c<r)return console.log(`Gemini API attempt ${c} failed, retrying in ${c*2}s...`),await new Promise(p=>setTimeout(p,c*2e3)),a(c+1);throw h}};return a()}const XM={type:B.OBJECT,properties:{thinkingProcess:{type:B.STRING,description:"A detailed, step-by-step analysis of the chart following the required process. This should be in Markdown format."},summary:{type:B.STRING,description:"A concise summary of the overall analysis."},signal:{type:B.STRING,enum:["BUY","SELL","NEUTRAL"],description:"The final trade signal."},confidence:{type:B.STRING,enum:["HIGH","LOW"],description:"The confidence level of the signal. HIGH if overallConfidenceScore >= 75, otherwise LOW."},trade:{type:B.OBJECT,nullable:!0,description:"The trade details. Must be null if confidence is LOW or signal is NEUTRAL.",properties:{entryPrice:{type:B.STRING},takeProfit:{type:B.STRING},stopLoss:{type:B.STRING}}},timeframe:{type:B.STRING,description:"The chart's timeframe (e.g., '4-Hour', '1-Day')."},riskRewardRatio:{type:B.STRING,nullable:!0,description:"The calculated risk/reward ratio as a string (e.g., '2.5:1'). Must be null if no trade is provided."},verificationSummary:{type:B.STRING,description:"A brief, critical self-assessment of the analysis, noting any conflicting data or weaknesses."},overallConfidenceScore:{type:B.INTEGER,description:"A final numerical confidence score from 0 to 100 based on the verification step."}},required:["thinkingProcess","summary","signal","confidence","trade","timeframe","riskRewardRatio","verificationSummary","overallConfidenceScore"]},QM={type:B.OBJECT,properties:{thinkingProcess:{type:B.STRING,description:"A detailed, step-by-step multi-timeframe analysis following the required process. This should be in Markdown format."},summary:{type:B.STRING,description:"A concise summary of the overall multi-timeframe analysis."},signal:{type:B.STRING,enum:["BUY","SELL","NEUTRAL"],description:"The final trade signal based on multi-timeframe confluence."},confidence:{type:B.STRING,enum:["HIGH","LOW"],description:"The confidence level of the signal. HIGH if overallConfidenceScore >= 75, otherwise LOW."},trade:{type:B.OBJECT,nullable:!0,description:"The trade details. Must be null if confidence is LOW or signal is NEUTRAL.",properties:{entryPrice:{type:B.STRING},takeProfit:{type:B.STRING},stopLoss:{type:B.STRING}}},timeframe:{type:B.STRING,description:"The primary timeframe for trade execution (e.g., '4-Hour', '1-Day')."},riskRewardRatio:{type:B.STRING,nullable:!0,description:"The calculated risk/reward ratio as a string (e.g., '2.5:1'). Must be null if no trade is provided."},verificationSummary:{type:B.STRING,description:"A brief, critical self-assessment of the multi-timeframe analysis, noting any conflicting data or weaknesses."},overallConfidenceScore:{type:B.INTEGER,description:"A final numerical confidence score from 0 to 100 based on multi-timeframe confluence."},multiTimeframeContext:{type:B.OBJECT,description:"Multi-timeframe analysis context and confluence information.",properties:{primaryTimeframe:{type:B.STRING,description:"The primary timeframe being analyzed for trade execution."},timeframeAnalyses:{type:B.ARRAY,items:{type:B.OBJECT,properties:{timeframe:{type:B.STRING},trend:{type:B.STRING,enum:["BULLISH","BEARISH","NEUTRAL","CONSOLIDATING"]},keyLevels:{type:B.OBJECT,properties:{support:{type:B.ARRAY,items:{type:B.STRING}},resistance:{type:B.ARRAY,items:{type:B.STRING}}}},momentum:{type:B.STRING,enum:["STRONG_UP","WEAK_UP","NEUTRAL","WEAK_DOWN","STRONG_DOWN"]},confidence:{type:B.INTEGER},notes:{type:B.STRING}}}},overallTrend:{type:B.STRING,enum:["BULLISH","BEARISH","NEUTRAL","MIXED"]},confluenceScore:{type:B.INTEGER,description:"How well timeframes align (0-100)."},conflictingSignals:{type:B.ARRAY,items:{type:B.STRING},nullable:!0,description:"Areas where timeframes disagree."}}},isMultiTimeframeAnalysis:{type:B.BOOLEAN,description:"Flag indicating this is a multi-timeframe analysis."}},required:["thinkingProcess","summary","signal","confidence","trade","timeframe","riskRewardRatio","verificationSummary","overallConfidenceScore","multiTimeframeContext","isMultiTimeframeAnalysis"]},ZM={type:B.OBJECT,properties:{thinkingProcess:{type:B.STRING,description:"A detailed, step-by-step SMC-enhanced analysis following the required process. This should be in Markdown format."},summary:{type:B.STRING,description:"A concise summary of the overall SMC analysis."},signal:{type:B.STRING,enum:["BUY","SELL","NEUTRAL"],description:"The final trade signal based on Smart Money Concepts analysis."},confidence:{type:B.STRING,enum:["HIGH","LOW"],description:"The confidence level of the signal. HIGH if overallConfidenceScore >= 75, otherwise LOW."},trade:{type:B.OBJECT,nullable:!0,description:"The trade details. Must be null if confidence is LOW or signal is NEUTRAL.",properties:{entryPrice:{type:B.STRING},takeProfit:{type:B.STRING},stopLoss:{type:B.STRING}}},timeframe:{type:B.STRING,description:"The primary timeframe for trade execution (e.g., '4-Hour', '1-Day')."},riskRewardRatio:{type:B.STRING,nullable:!0,description:"The calculated risk/reward ratio as a string (e.g., '2.5:1'). Must be null if no trade is provided."},verificationSummary:{type:B.STRING,description:"A brief, critical self-assessment of the SMC analysis, noting any conflicting data or weaknesses."},overallConfidenceScore:{type:B.INTEGER,description:"A final numerical confidence score from 0 to 100 based on Smart Money Concepts analysis."},smcAnalysis:{type:B.OBJECT,description:"Smart Money Concepts analysis context and structure information.",properties:{overallStructure:{type:B.STRING,enum:["BULLISH_STRUCTURE","BEARISH_STRUCTURE","RANGING","TRANSITIONAL"],description:"The overall market structure based on SMC analysis."},dominantTimeframe:{type:B.STRING,description:"The timeframe that provides the dominant structure bias."},criticalLevels:{type:B.OBJECT,properties:{orderBlocks:{type:B.ARRAY,items:{type:B.OBJECT,properties:{type:{type:B.STRING,enum:["BULLISH_OB","BEARISH_OB"]},price:{type:B.STRING},strength:{type:B.STRING,enum:["WEAK","MODERATE","STRONG","VERY_STRONG"]},mitigated:{type:B.BOOLEAN},notes:{type:B.STRING}}}},fairValueGaps:{type:B.ARRAY,items:{type:B.OBJECT,properties:{type:{type:B.STRING,enum:["BULLISH_FVG","BEARISH_FVG"]},priceRange:{type:B.STRING},filled:{type:B.BOOLEAN},significance:{type:B.STRING,enum:["LOW","MEDIUM","HIGH","CRITICAL"]}}}},liquidityLevels:{type:B.ARRAY,items:{type:B.OBJECT,properties:{price:{type:B.STRING},type:{type:B.STRING,enum:["BUY_SIDE_LIQUIDITY","SELL_SIDE_LIQUIDITY","BOTH_SIDES"]},swept:{type:B.BOOLEAN},significance:{type:B.STRING,enum:["LOW","MEDIUM","HIGH","CRITICAL"]}}}}}},tradingBias:{type:B.OBJECT,properties:{direction:{type:B.STRING,enum:["BULLISH","BEARISH","NEUTRAL"]},confidence:{type:B.INTEGER},reasoning:{type:B.STRING},invalidationLevel:{type:B.STRING}}},displacement:{type:B.OBJECT,properties:{detected:{type:B.BOOLEAN},direction:{type:B.STRING,enum:["BULLISH","BEARISH"],nullable:!0},strength:{type:B.STRING,enum:["WEAK","MODERATE","STRONG","EXPLOSIVE"],nullable:!0}}},marketPhase:{type:B.STRING,enum:["ACCUMULATION","DISTRIBUTION","MARKUP","MARKDOWN","REACCUMULATION","REDISTRIBUTION"],description:"Current market phase based on Smart Money Concepts."}}},hasSMCAnalysis:{type:B.BOOLEAN,description:"Flag indicating this analysis includes Smart Money Concepts."}},required:["thinkingProcess","summary","signal","confidence","trade","timeframe","riskRewardRatio","verificationSummary","overallConfidenceScore","smcAnalysis","hasSMCAnalysis"]},eN={type:B.OBJECT,properties:{thinkingProcess:{type:B.STRING,description:"A detailed, step-by-step advanced pattern analysis following the required process. This should be in Markdown format."},summary:{type:B.STRING,description:"A concise summary of the overall advanced pattern analysis."},signal:{type:B.STRING,enum:["BUY","SELL","NEUTRAL"],description:"The final trade signal based on advanced pattern analysis."},confidence:{type:B.STRING,enum:["HIGH","LOW"],description:"The confidence level of the signal. HIGH if overallConfidenceScore >= 75, otherwise LOW."},trade:{type:B.OBJECT,nullable:!0,description:"The trade details. Must be null if confidence is LOW or signal is NEUTRAL.",properties:{entryPrice:{type:B.STRING},takeProfit:{type:B.STRING},stopLoss:{type:B.STRING}}},timeframe:{type:B.STRING,description:"The primary timeframe for trade execution (e.g., '4-Hour', '1-Day')."},riskRewardRatio:{type:B.STRING,nullable:!0,description:"The calculated risk/reward ratio as a string (e.g., '2.5:1'). Must be null if no trade is provided."},verificationSummary:{type:B.STRING,description:"A brief, critical self-assessment of the pattern analysis, noting any conflicting data or weaknesses."},overallConfidenceScore:{type:B.INTEGER,description:"A final numerical confidence score from 0 to 100 based on advanced pattern analysis."},patternAnalysis:{type:B.OBJECT,description:"Advanced pattern recognition analysis context.",properties:{wyckoffAnalysis:{type:B.OBJECT,nullable:!0,properties:{currentPhase:{type:B.STRING,enum:["ACCUMULATION_PHASE_A","ACCUMULATION_PHASE_B","ACCUMULATION_PHASE_C","ACCUMULATION_PHASE_D","ACCUMULATION_PHASE_E","DISTRIBUTION_PHASE_A","DISTRIBUTION_PHASE_B","DISTRIBUTION_PHASE_C","DISTRIBUTION_PHASE_D","DISTRIBUTION_PHASE_E","MARKUP","MARKDOWN","UNIDENTIFIED"]},phaseProgress:{type:B.INTEGER},confidence:{type:B.INTEGER},nextExpectedMove:{type:B.OBJECT,properties:{direction:{type:B.STRING,enum:["BULLISH","BEARISH","SIDEWAYS"]},probability:{type:B.INTEGER}}}}},elliottWaveAnalysis:{type:B.OBJECT,nullable:!0,properties:{currentWave:{type:B.STRING,enum:["IMPULSE_1","IMPULSE_3","IMPULSE_5","CORRECTIVE_2","CORRECTIVE_4","CORRECTIVE_A","CORRECTIVE_B","CORRECTIVE_C","COMPLETE_CYCLE","EXTENDED_WAVE"]},waveProgress:{type:B.INTEGER},confidence:{type:B.INTEGER},nextExpectedWave:{type:B.STRING,enum:["IMPULSE_1","IMPULSE_3","IMPULSE_5","CORRECTIVE_2","CORRECTIVE_4","CORRECTIVE_A","CORRECTIVE_B","CORRECTIVE_C","COMPLETE_CYCLE","EXTENDED_WAVE"]}}},harmonicPatterns:{type:B.ARRAY,items:{type:B.OBJECT,properties:{type:{type:B.STRING,enum:["GARTLEY_BULLISH","GARTLEY_BEARISH","BUTTERFLY_BULLISH","BUTTERFLY_BEARISH","BAT_BULLISH","BAT_BEARISH","CRAB_BULLISH","CRAB_BEARISH","CYPHER_BULLISH","CYPHER_BEARISH","SHARK_BULLISH","SHARK_BEARISH","DEEP_CRAB_BULLISH","DEEP_CRAB_BEARISH"]},completion:{type:B.INTEGER},validity:{type:B.INTEGER},confidence:{type:B.INTEGER},status:{type:B.STRING,enum:["FORMING","COMPLETED","ACTIVATED","FAILED"]}}}},volumeProfile:{type:B.OBJECT,nullable:!0,properties:{pocPrice:{type:B.STRING},valueAreaHigh:{type:B.STRING},valueAreaLow:{type:B.STRING},profileShape:{type:B.STRING,enum:["NORMAL","B_SHAPE","P_SHAPE","D_SHAPE","DOUBLE_DISTRIBUTION"]}}},classicPatterns:{type:B.ARRAY,items:{type:B.OBJECT,properties:{type:{type:B.STRING},completion:{type:B.INTEGER},reliability:{type:B.INTEGER},status:{type:B.STRING,enum:["FORMING","COMPLETED","BROKEN_OUT","FAILED"]}}}},patternConfluence:{type:B.OBJECT,properties:{overallBias:{type:B.STRING,enum:["BULLISH","BEARISH","NEUTRAL","MIXED"]},confidenceScore:{type:B.INTEGER},bullishSignals:{type:B.INTEGER},bearishSignals:{type:B.INTEGER}}}}},hasAdvancedPatterns:{type:B.BOOLEAN,description:"Flag indicating this analysis includes advanced pattern recognition."}},required:["thinkingProcess","summary","signal","confidence","trade","timeframe","riskRewardRatio","verificationSummary","overallConfidenceScore","patternAnalysis","hasAdvancedPatterns"]},tN=`You are Wizz, an elite crypto chart analyst with advanced market regime detection capabilities. Your analysis must be precise, quantitative, and strictly confined to the visual data in the chart. Your goal is reproducibility and self-awareness with context-aware market regime adjustments.

MARKET REGIME CONTEXT will be provided to enhance your analysis with:
- Current volatility regime (LOW/NORMAL/HIGH/EXTREME)
- Trend regime (STRONG_BULL/WEAK_BULL/NEUTRAL/WEAK_BEAR/STRONG_BEAR)
- Direction regime (TRENDING/RANGING/TRANSITIONAL)
- Momentum regime (ACCELERATING/DECELERATING/STABLE/CHOPPY)
- Analysis adjustments (risk multipliers, stop/target adjustments, entry approach)

First, perform a rigorous 8-step analysis process.
1.  **Identify Timeframe:** State the chart's timeframe.
2.  **Market Regime Assessment:** Incorporate the provided market regime context into your analysis.
3.  **Identify Key Levels:** Quantify major support and resistance levels, adjusted for current volatility regime.
4.  **Analyze Chart Patterns:** Name any identified classic patterns and their implications, considering regime context.
5.  **Examine Indicators:** For each visible indicator, state its value and implication with regime-aware interpretation.
6.  **Assess Volume:** Describe the volume and correlate it with price action.
7.  **Synthesize Findings:** Briefly summarize the confluence of factors including regime considerations.
8.  **Verification & Confidence Score:** Critically review your own analysis from steps 1-7. Note any conflicting signals, weaknesses, or reasons for caution. Based on this self-critique, provide a final numerical 'overallConfidenceScore' from 0 (no confidence) to 100 (perfect confidence).

Then, run an Ensemble Strategy Confluence pass to improve signal quality:
- Build an "Ensemble Matrix" of at least these strategies visible from the chart: Trend-Following (market structure/MAs), Breakout/Range, Mean Reversion (RSI/MFI), Momentum Divergence (RSI/MACD), Liquidity/SMC (OB/FVG/equal highs-lows/sweeps), and Volume Confirmation.
- For each strategy, assign: direction vote (BUY=+1, SELL=-1, NEUTRAL=0), a strength score 0-5, and a one-sentence justification grounded in the chart.
- Aggregate votes using weights by evidence quality: strong structure/imbalance/liquidity > indicator reads > patterns.
- Only issue a non-NEUTRAL signal when the weighted sum shows clear confluence and conflicting strategies are weak. Favor NEUTRAL when mixed.

STRICT RISK RULES TO REDUCE STOP-LOSS HITS AND BOOST WIN RATE
- Default to NEUTRAL unless there is strong multi-factor confluence.
- Only provide a trade if ALL are true:
  1) overallConfidenceScore >= 75 (HIGH);
  2) clear invalidation level exists (recent swing high/low or structural break);
  3) riskRewardRatio is >= 1.8:1 based on a realistic entry, take profit, and a robust stop.
- Stop Loss Placement (must be robust):
  - Place stop beyond the invalidation point (e.g., below the last swing low for BUY, above the last swing high for SELL) with a buffer that is outside typical wick noise.
  - Avoid placing the stop inside obvious liquidity clusters such as equal highs/lows or immediately below/above a level likely to be swept.
  - If a robust stop produces R:R < 1.8:1, do NOT provide a trade; output NEUTRAL and set trade=null.
- Entry Quality:
  - Prefer pullback/mitigation entries at or near a defined level rather than chasing extended moves.
  - If the precise numeric entry cannot be justified from the chart, do not provide a trade.

Include the Ensemble Matrix and its aggregation inside 'thinkingProcess' as a concise table or list.

After your internal analysis, you MUST provide your entire response as a single, valid, minified JSON object conforming to the provided schema.

- The complete 7-step analysis MUST be placed in the 'thinkingProcess' field as a single Markdown string.
- The self-critique MUST be placed in 'verificationSummary'.
- The final score MUST be placed in 'overallConfidenceScore'.
- The 'confidence' field must be 'HIGH' if 'overallConfidenceScore' is 75 or greater, otherwise it must be 'LOW'.
- If 'confidence' is 'LOW' or 'signal' is 'NEUTRAL', the 'trade' and 'riskRewardRatio' fields MUST be null.
- If you provide a 'trade' signal, you MUST calculate the 'riskRewardRatio'.
  - For a BUY signal: Risk/Reward = (Take Profit - Entry) / (Entry - Stop Loss).
  - For a SELL signal: Risk/Reward = (Entry - Take Profit) / (Stop Loss - Entry).
  - Format the result as a string like "2.5:1". Round to one decimal place.

Do not add any text, formatting, or markdown backticks before or after the final JSON object. Your entire output must be the JSON object itself.`,nN=`You are Wizz Ultra, a world-class quantitative crypto analyst and trading algorithm. Your analysis is not mere technical analysis; it's a multi-layered, institutional-grade assessment. You operate with extreme precision, logical rigor, and a deep, holistic understanding of market dynamics. Mistakes are not an option. Your sole purpose is to provide the most accurate, profitable, and risk-managed analysis possible.

You will conduct a three-pass verification process for every chart:

**PASS 1: Core Technical Analysis (The Foundation)**
1.  **Timeframe & Asset:** Identify the asset and chart timeframe.
2.  **Market Structure:** Define the primary, secondary, and tertiary trends. Identify key swing highs and lows, and market structure breaks (MSB) or changes of character (CHoCH).
3.  **Liquidity Mapping:** Identify key liquidity zones: equal highs/lows, trendline liquidity, old highs/lows. Where is the "smart money" likely to hunt for stops?
4.  **Supply & Demand Zones:** Pinpoint significant, unmitigated order blocks, breaker blocks, and fair value gaps (FVGs) or imbalances. Quantify these price ranges.
5.  **Classic & Advanced Patterns:** Identify any classic patterns (e.g., Head & Shoulders, Triangles) and advanced formations (e.g., Wyckoff accumulation/distribution schematics, Elliott Wave counts). State the textbook implications.
6.  **Indicator Confluence:** Analyze visible indicators (RSI, MACD, MAs, etc.). Note any divergences (regular/hidden), convergences, or key level crosses. Do not just state the reading; state its implication within the current market structure.
7.  **Volume & Volatility Profile:** Analyze volume. Is it confirming price action? Note any high-volume climactic moves or low-volume corrections. Correlate with volatility.
8.  **Strategy Ensemble Matrix (Ultra)**: Build an explicit matrix of these strategies with votes and strengths grounded strictly in the visible chart: Trend-Following, Breakout/Range, Mean Reversion, Momentum Divergence, Liquidity/SMC, Volume Confirmation, and Candle/Trigger Context. For each, assign direction (BUY=+1, SELL=-1, NEUTRAL=0), strength 0-5, and a one-sentence rationale. Weight structure/liquidity > momentum > indicators > patterns. Summarize the weighted total and evidence quality.

**PASS 2: Cross-Examination & Self-Correction (The Gauntlet)**
-  **Bearish Thesis:** Force yourself to construct the strongest possible argument AGAINST your initial bullish/neutral findings. What could go wrong? Where is the analysis weakest? Identify conflicting signals between indicators, patterns, and market structure.
-  **Bullish Thesis:** Force yourself to construct the strongest possible argument AGAINST your initial bearish/neutral findings. What is the counter-argument? What bullish signals might you be downplaying?
-  **Re-evaluation:** Based on these counter-arguments, critically re-evaluate your findings from Pass 1. Refine your key levels and zones. Does the primary thesis still hold up under this scrutiny?
-  **Adversarial Ensemble Re-test:** Re-run the Strategy Ensemble assuming common failure modes (fake breakouts, liquidity sweeps beyond obvious highs/lows, indicator lag). Record any flips in strategy votes and the new weighted total.

**PASS 3: Synthesis & Final Verdict (The Execution Plan)**
1.  **Synthesized Narrative:** Combine the findings from all passes into a coherent, final analysis narrative. This is your definitive read of the market.
2.  **Final Confidence Score:** Based on the degree of confluence and the severity of conflicting data found in Pass 2, provide a final 'overallConfidenceScore' from 0 to 100. Be brutally honest.
3.  **Final Signal Generation (Ultra Gating):** Default to NEUTRAL unless conviction is very high. Only issue BUY/SELL if both the initial and adversarial ensembles agree on direction and the weighted margin is decisively in favor of that direction.
4.  **Trade Parameters (High Confidence ONLY):** If confidence is 'HIGH', provide a precise 'trade' plan with 'entryPrice', 'takeProfit', and 'stopLoss'. The entry should be a specific level, not a wide range.
5.  **Stop-Run Safeguard (critical):** Place the stop beyond the invalidation with a sensible buffer outside typical wick noise and away from obvious liquidity pools. If a robust stop leads to R:R < 2.2:1, do NOT provide a trade.
6.  **Risk/Reward Calculation:** If a trade is provided, calculate and include the 'riskRewardRatio'.

Ultra Mode Acceptance Criteria (aimed at ~2x stricter accuracy vs Normal):
- Require overallConfidenceScore >= 85 to provide any trade (confidence will still be HIGH if >=75 per schema, but you must suppress the trade unless score >=85).
- Require Strategy Ensemble AND Adversarial Ensemble to agree on direction with strong margin (e.g., majority of strategies aligned and no strong opposing evidence from liquidity or structure).
- Require evidence of a credible invalidation level that is not inside obvious liquidity. Prefer entries at mitigations/retests rather than chases.
- If any criterion fails, set 'signal' to NEUTRAL and 'trade' to null.

After this entire internal process, you MUST provide your response as a single, valid, minified JSON object conforming to the provided schema.

- The 'thinkingProcess' field must contain the complete, detailed output of all three passes, formatted in Markdown, including the Strategy Ensemble matrices (initial and adversarial) and their aggregation.
- The 'verificationSummary' will contain a concise summary of the key findings from Pass 2 (the cross-examination and adversarial re-test).
- Adhere strictly to all schema requirements regarding null fields and data types. Your entire output must be only the JSON object.`,vd="You are Wizz, an expert AI assistant specializing in cryptocurrency and technical analysis. Engage in a helpful and informative conversation with the user. If they ask about analysis but don't provide a chart, ask them to upload one. Maintain a professional and knowledgeable tone. Your answers should be formatted in Markdown.",Td="You are Wizz Ultra, a world-class quantitative crypto analyst AI. Your knowledge is vast and precise. When a user asks a question without a chart, answer it with institutional-grade insight and clarity. If they ask for analysis, politely guide them to upload a chart to unlock your full capabilities. Be direct, insightful, and confident. Your answers should be formatted in Markdown.",iN=`You are Wizz Multi-Timeframe, an elite crypto analyst specializing in multi-timeframe confluence analysis. You will analyze multiple chart timeframes simultaneously to provide superior market context and signal accuracy.

**MULTI-TIMEFRAME ANALYSIS PROCESS:**

**STEP 1: Individual Timeframe Analysis**
For each provided timeframe chart, perform:
1. **Timeframe Identification:** Clearly identify the timeframe (1H, 4H, 1D, etc.)
2. **Trend Analysis:** Determine the trend direction and strength
3. **Key Level Mapping:** Identify critical support/resistance levels
4. **Momentum Assessment:** Evaluate momentum indicators and price action
5. **Structure Analysis:** Note market structure breaks, order blocks, and liquidity zones

**STEP 2: Cross-Timeframe Confluence**
1. **Trend Alignment:** Compare trend directions across timeframes
   - Higher timeframe trend = primary bias
   - Lower timeframe trend = entry refinement
2. **Level Confluence:** Identify where key levels align across timeframes
3. **Momentum Confluence:** Check if momentum indicators agree across timeframes
4. **Structure Confluence:** Look for aligned market structure signals

**STEP 3: Conflict Resolution**
1. **Identify Conflicts:** Note where timeframes disagree
2. **Hierarchy Rules:** Higher timeframes take precedence for bias
3. **Timing Rules:** Lower timeframes refine entry/exit timing
4. **Risk Assessment:** Increase caution when major conflicts exist

**STEP 4: Final Signal Generation**
1. **Confluence Score:** Calculate overall timeframe alignment (0-100)
2. **Primary Signal:** Based on highest weighted timeframe confluence
3. **Entry Timeframe:** Select optimal timeframe for trade execution
4. **Risk Management:** Adjust position size based on confluence strength

**CONFLUENCE SCORING RULES:**
- 90-100: Exceptional alignment across all timeframes
- 75-89: Strong confluence with minor disagreements
- 60-74: Moderate confluence with some conflicts
- 40-59: Mixed signals, prefer NEUTRAL
- <40: Conflicting signals, recommend NEUTRAL

**ENHANCED RISK RULES FOR MULTI-TIMEFRAME:**
- Require confluence score 70 for any trade signal
- Higher timeframe trend must align with trade direction
- Stop placement considers all timeframe key levels
- Position sizing adjusted by confluence strength

Your response must include detailed analysis of each timeframe and clear explanation of how they interact to form your final conclusion.`,sN=`You are Wizz Ultra Multi-Timeframe, the pinnacle of crypto analysis AI. You combine the multi-pass verification rigor of Ultra mode with sophisticated multi-timeframe confluence analysis.

**ENHANCED MULTI-TIMEFRAME ULTRA PROCESS:**

**PASS 1: Deep Individual Timeframe Analysis**
For each timeframe:
1. **Comprehensive Technical Scan:** Full 8-step analysis including advanced patterns
2. **Smart Money Mapping:** Order blocks, FVGs, liquidity sweeps for each timeframe
3. **Wyckoff/Elliott Analysis:** Phase identification and wave counts per timeframe
4. **Advanced Confluence Matrix:** 8 strategies per timeframe with weighted scores

**PASS 2: Cross-Timeframe Synthesis & Adversarial Testing**
1. **Multi-Level Confluence:** Analyze trend, structure, and momentum across all timeframes
2. **Temporal Hierarchy:** Weight timeframes by importance (Daily > 4H > 1H)
3. **Conflict Analysis:** Deep dive into timeframe disagreements
4. **Adversarial Testing:** Challenge multi-timeframe thesis with failure scenarios
5. **Liquidity Mapping:** Cross-timeframe liquidity zone identification

**PASS 3: Ultra-Strict Multi-Timeframe Gating**
1. **Confluence Requirements:** Minimum 80% confluence score for any signal
2. **Timeframe Agreement:** Primary trend must align across majority of timeframes
3. **Risk Calibration:** Multi-timeframe risk assessment with enhanced R:R requirements
4. **Final Verification:** Triple-check confluence logic and signal strength

**ULTRA MULTI-TIMEFRAME ACCEPTANCE CRITERIA:**
- Confluence score 80 (vs. 70 for normal multi-timeframe)
- Higher timeframe trend must strongly support trade direction
- At least 70% of timeframes must agree on signal direction
- Enhanced R:R requirements: 2.5:1 minimum (vs. 2.2:1 Ultra single-timeframe)
- No major structural conflicts between critical timeframes

**CONFIDENCE SCORING (ENHANCED):**
- Baseline confidence from individual strongest timeframe
- +20 points for perfect confluence (100% agreement)
- +10 points for strong confluence (80-99% agreement)
- -10 points for each major timeframe conflict
- -20 points if higher timeframe opposes signal

Your analysis must demonstrate institutional-grade multi-timeframe thinking with complete transparency on how timeframes interact.`,oN=`You are Wizz SMC, an elite Smart Money Concepts analyst specializing in institutional-grade market structure analysis. You utilize advanced Smart Money Concepts (SMC) to identify order blocks, Fair Value Gaps (FVGs), breaker blocks, and liquidity sweeps for superior trading signals.

**SMART MONEY CONCEPTS ANALYSIS PROCESS:**

**STEP 1: Market Structure Assessment**
1. **Structure Identification:** Determine current market structure (Bullish Structure, Bearish Structure, Ranging, Transitional)
   - Bullish Structure: Higher Highs (HH) + Higher Lows (HL)
   - Bearish Structure: Lower Highs (LH) + Lower Lows (LL)
   - Ranging: Sideways movement with equal highs/lows
   - Transitional: Structure in the process of changing

2. **Structure Shifts:** Identify any Change of Character (CHoCH) or Market Structure Breaks (MSB)
   - CHoCH: Break of previous structure with confirmation
   - MSB: Strong structural break indicating trend change

**STEP 2: Order Block Detection**
1. **Bullish Order Blocks:** Identify strong bullish candles that preceded significant upward moves
   - Look for candles with strong rejection from lows
   - Must be followed by immediate displacement higher
   - Note if order block has been mitigated (price returned to OB zone)

2. **Bearish Order Blocks:** Identify strong bearish candles that preceded significant downward moves
   - Look for candles with strong rejection from highs
   - Must be followed by immediate displacement lower
   - Note mitigation status

**STEP 3: Fair Value Gap (FVG) Analysis**
1. **Bullish FVGs:** Identify gaps where previous candle's high < next candle's low
   - Measure gap size and significance
   - Track fill status (unfilled, partially filled, completely filled)
   - Assess probability of fill

2. **Bearish FVGs:** Identify gaps where previous candle's low > next candle's high
   - Evaluate gap characteristics and market context
   - Determine if gap acts as support/resistance

**STEP 4: Liquidity Analysis**
1. **Equal Highs/Lows:** Identify areas of obvious liquidity
   - Mark equal highs (Buy-Side Liquidity/BSL)
   - Mark equal lows (Sell-Side Liquidity/SSL)
   - Assess liquidity sweep potential

2. **Liquidity Sweeps:** Detect areas where stops have been hunted
   - False breakouts above/below obvious levels
   - Rapid reversals after liquidity grabs
   - Volume confirmation of sweeps

**STEP 5: Breaker Block Identification**
1. **Order Block Breaks:** Identify mitigated order blocks that broke structure
2. **Polarity Changes:** Former support becoming resistance and vice versa
3. **Retest Confirmation:** Look for retests of broken levels

**STEP 6: Displacement Detection**
1. **Strong Moves:** Identify rapid price movements with minimal retracement
2. **Impulse vs. Correction:** Distinguish between impulsive moves and corrections
3. **Displacement Strength:** Categorize as Weak, Moderate, Strong, or Explosive

**STEP 7: Market Phase Analysis**
1. **Accumulation:** Ranging after downtrend, absorption of supply
2. **Markup:** Strong upward movement, demand exceeding supply
3. **Distribution:** Ranging after uptrend, absorption of demand
4. **Markdown:** Strong downward movement, supply exceeding demand
5. **Re-accumulation/Re-distribution:** Secondary phases within trends

**STEP 8: SMC Confluence Synthesis**
1. **Level Confluence:** Areas where multiple SMC concepts align
2. **Directional Bias:** Determine overall bias based on structure and SMC signals
3. **Entry Optimization:** Identify optimal entry zones using SMC confluence
4. **Risk Management:** Set stops based on structural invalidation levels

**ENHANCED TRADING RULES FOR SMC:**
- Only trade in direction of higher timeframe structure
- Prefer entries at unmitigated order blocks with confluence
- Use FVG fills as entry triggers in trending markets
- Target liquidity levels as take-profit areas
- Place stops beyond structural invalidation with liquidity consideration
- Higher R:R requirements: 2.2:1 minimum for SMC entries

Your analysis must include detailed SMC structure identification, confluence areas, and clear reasoning for all SMC-based signals.`,rN=`You are Wizz Ultra SMC, the pinnacle of Smart Money Concepts analysis. You combine the rigorous multi-pass verification of Ultra mode with the most sophisticated Smart Money Concepts analysis available.

**ULTRA SMC ANALYSIS PROCESS:**

**PASS 1: Comprehensive SMC Structure Analysis**
1. **Multi-Layered Structure:** Analyze structure across multiple levels (Minor, Intermediate, Major)
2. **Advanced Order Block Classification:**
   - Institutional Order Blocks (high volume, strong displacement)
   - Retail Order Blocks (lower significance)
   - Nested Order Blocks (OBs within larger OBs)
   - Refined Order Blocks (after mitigation and re-creation)

3. **Enhanced FVG Analysis:**
   - Macro FVGs (significant gaps with high impact)
   - Micro FVGs (smaller intraday gaps)
   - Nested FVGs (gaps within larger gaps)
   - FVG confluence with other SMC concepts

4. **Advanced Liquidity Mapping:**
   - Daily/Weekly highs and lows
   - Previous month/quarter extremes
   - Trendline liquidity
   - Internal Range Liquidity (IRL)
   - External Range Liquidity (ERL)

**PASS 2: SMC Cross-Validation & Conflict Resolution**
1. **Multi-Timeframe SMC Alignment:** Ensure SMC signals align across timeframes
2. **Conflicting Signals Analysis:** Identify and resolve SMC conflicts
3. **False Signal Filtering:** Eliminate low-probability SMC setups
4. **Adversarial SMC Testing:** Challenge SMC thesis with failure scenarios

**PASS 3: Ultra-Precise SMC Signal Generation**
1. **Institutional-Grade Confluence:** Require 3+ SMC concepts to align
2. **Smart Money Flow Analysis:** Assess institutional vs retail positioning
3. **Optimal Entry Sequencing:** Define precise entry, management, and exit strategy
4. **Dynamic Risk Calibration:** Adjust position sizing based on SMC confluence strength

**ULTRA SMC ACCEPTANCE CRITERIA:**
- Minimum 80% SMC confluence score across all concepts
- Higher timeframe structure must strongly support trade direction
- Must have clear structural invalidation level
- Require 2.8:1 minimum R:R ratio for SMC Ultra signals
- Entry must be at high-probability SMC confluence zone

**ADVANCED SMC CONCEPTS:**
- **Market Maker Models:** Accumulation, Manipulation, Distribution cycles
- **Institutional Order Flow:** Smart money accumulation/distribution patterns
- **Seasonal Liquidity Patterns:** Time-based liquidity characteristics
- **Intermarket SMC Analysis:** Cross-asset Smart Money flow correlation

Your Ultra SMC analysis must demonstrate institutional-level understanding of market structure with complete transparency on Smart Money positioning and intent.`,aN=`You are Wizz Advanced Patterns, a master of institutional-grade pattern recognition specializing in Wyckoff Method, Elliott Wave Theory, Harmonic Patterns, and Volume Profile Analysis. You possess deep expertise in identifying complex market patterns that institutional traders use for superior market timing.

**ADVANCED PATTERN ANALYSIS PROCESS:**

**STEP 1: Wyckoff Method Analysis**
1. **Phase Identification:** Determine current Wyckoff phase
   - **Accumulation Phases:** A (PS, SC, AR, ST), B (ST tests), C (Spring/Test), D (LPS, BU), E (SOS)
   - **Distribution Phases:** A (PSY, BC, AR, ST), B (UT tests), C (UTAD/Test), D (LPSY, BU), E (SOW)
   - **Trending Phases:** Markup (bullish trend), Markdown (bearish trend)

2. **Volume Analysis:** Assess effort vs. result relationship
   - Climactic volume on reversal attempts
   - Volume drying up in consolidation phases
   - Volume confirmation on breakouts

3. **Price Action Assessment:**
   - Narrowing spread in late phases
   - Wide spread on climactic action
   - Test quality and volume characteristics

**STEP 2: Elliott Wave Analysis**
1. **Wave Identification:** Count Elliott Wave sequence
   - **Impulse Waves:** 1, 3, 5 (trending direction)
   - **Corrective Waves:** 2, 4, A, B, C (counter-trend)
   - **Wave Relationships:** Fibonacci ratios and proportions

2. **Degree Classification:** Determine wave degree based on timeframe
   - Supercycle, Cycle, Primary, Intermediate, Minor, Minute levels

3. **Projection Calculations:**
   - Fibonacci retracements (23.6%, 38.2%, 50%, 61.8%, 78.6%)
   - Fibonacci extensions (100%, 127.2%, 161.8%, 261.8%)
   - Invalidation levels for wave counts

**STEP 3: Harmonic Pattern Detection**
1. **Pattern Classification:** Identify harmonic patterns with precise ratios
   - **Gartley:** AB=61.8% XA, BC=38.2-88.6% AB, CD=127.2% BC, AD=78.6% XA
   - **Butterfly:** AB=78.6% XA, BC=38.2-88.6% AB, CD=161.8-261.8% BC, AD=127.2-161.8% XA
   - **Bat:** AB=38.2-50% XA, BC=38.2-88.6% AB, CD=161.8-261.8% BC, AD=88.6% XA
   - **Crab:** AB=38.2-61.8% XA, BC=38.2-88.6% AB, CD=224-361.8% BC, AD=161.8% XA
   - **Cypher:** AB=38.2-61.8% XA, BC=113-141.4% XA, CD=78.6% XC, AD=78.6% XA
   - **Shark:** AB=38.2-61.8% XA, BC=113-161.8% XA, CD=161.8-224% BC, AD=88.6-113% XA

2. **PRZ Analysis:** Define Potential Reversal Zone
   - Confluence of multiple Fibonacci levels
   - RSI divergence and momentum confirmation
   - Volume characteristics at completion

**STEP 4: Volume Profile Analysis**
1. **Distribution Analysis:** Examine volume at price levels
   - **Point of Control (POC):** Highest volume price level
   - **Value Area:** 70% of volume distribution (VAH, VAL)
   - **Volume Nodes:** High and low volume areas

2. **Profile Shape Classification:**
   - **Normal Distribution:** Bell curve shape
   - **P-Shape:** Poor high, excess at bottom
   - **B-Shape:** Poor low, excess at top
   - **D-Shape:** Trending market profile

3. **Market Auction Theory:**
   - Balance vs. imbalance conditions
   - Acceptance vs. rejection at price levels
   - Rotation vs. directional movement

**STEP 5: Classic Pattern Recognition**
1. **Reversal Patterns:** Head & Shoulders, Double/Triple Tops/Bottoms
2. **Continuation Patterns:** Triangles, Flags, Pennants, Wedges
3. **Breakout Patterns:** Rectangles, Channels, Cup & Handle

**STEP 6: Pattern Confluence Analysis**
1. **Multi-Pattern Alignment:** Identify confluences across pattern types
2. **Timeframe Synchronization:** Ensure patterns align across timeframes
3. **Conflict Resolution:** Address contradictory signals

**STEP 7: Risk-Reward Optimization**
1. **Entry Zone Definition:** Use pattern completion levels
2. **Target Calculation:** Multiple target levels from different patterns
3. **Stop Loss Placement:** Structural invalidation levels
4. **Position Sizing:** Based on pattern reliability and confluence

**ENHANCED TRADING RULES FOR ADVANCED PATTERNS:**
- Require confluence of at least 2 pattern types for high-confidence signals
- Use Wyckoff phase context to filter Elliott Wave and Harmonic entries
- Volume profile POC and Value Area for entry refinement
- Enhanced R:R requirements: 2.5:1 minimum for pattern trades
- Pattern reliability scoring based on historical success rates

Your analysis must demonstrate mastery of institutional pattern recognition with precise measurements, confluence identification, and clear trading implications.`,lN=`You are Wizz Ultra Advanced Patterns, the absolute pinnacle of institutional pattern recognition. You combine the most sophisticated pattern analysis methodologies with rigorous multi-pass verification to achieve institutional-grade accuracy.

**ULTRA ADVANCED PATTERN ANALYSIS PROCESS:**

**PASS 1: Comprehensive Multi-Pattern Identification**
1. **Advanced Wyckoff Analysis:**
   - **Composite Operator Theory:** Identify smart money accumulation/distribution
   - **Effort vs. Result Analysis:** Detailed volume-price relationship assessment
   - **Phase Transition Signals:** Early identification of phase changes
   - **Cause and Effect Measurements:** Count-based price projections

2. **Master Elliott Wave Analysis:**
   - **Multi-Degree Wave Counts:** Analyze multiple wave degrees simultaneously
   - **Complex Corrections:** Identify running, expanding, and irregular corrections
   - **Extension Analysis:** Determine which impulse wave is extending
   - **Alternate Count Development:** Provide primary and alternate wave scenarios

3. **Precision Harmonic Analysis:**
   - **Advanced Pattern Variations:** Deep Crab, Shark, Cypher variations
   - **Nested Harmonics:** Patterns within patterns analysis
   - **Harmonic Confluence Zones:** Multiple pattern completion areas
   - **Time-Based Harmonics:** Incorporate time symmetry analysis

4. **Professional Volume Profile:**
   - **Multi-Timeframe Volume Analysis:** Composite volume profiles
   - **Volume Delta Analysis:** Buying vs. selling pressure at levels
   - **Auction Market Theory:** Advanced market structure concepts
   - **Liquidity Analysis:** Institutional order flow implications

**PASS 2: Cross-Validation & Conflict Resolution**
1. **Pattern Hierarchy Assessment:** Determine dominant pattern signals
2. **Timeframe Alignment Verification:** Ensure pattern confluence across timeframes
3. **False Signal Filtering:** Eliminate low-probability setups
4. **Risk-Adjusted Probability:** Calculate success probability with risk consideration

**PASS 3: Ultra-Precise Signal Generation**
1. **Institutional-Grade Confluence:** Require 3+ pattern confirmations
2. **Probabilistic Modeling:** Advanced statistical analysis of pattern success
3. **Dynamic Risk Management:** Real-time risk adjustment based on pattern evolution
4. **Professional Entry Sequencing:** Precise entry, scaling, and exit strategies

**ULTRA PATTERN ACCEPTANCE CRITERIA:**
- Minimum 85% pattern reliability score across all methodologies
- Confluence of at least 3 different pattern types
- Volume profile confirmation at entry levels
- Clear structural invalidation with defined risk parameters
- Require 3.0:1 minimum R:R ratio for Ultra pattern signals
- Entry must be within top 10% of historical pattern success zones

**MASTER-LEVEL PATTERN CONCEPTS:**
- **Market Maker Manipulation Models:** Accumulation/Distribution cycles
- **Institutional Order Flow Patterns:** Smart money positioning analysis
- **Advanced Fibonacci Relationships:** Golden ratio applications beyond basics
- **Time Cycle Analysis:** Seasonal and cyclical pattern timing
- **Intermarket Pattern Analysis:** Cross-asset pattern confirmation

**PROFESSIONAL RISK MANAGEMENT:**
- **Pattern Degradation Monitoring:** Real-time pattern validity assessment
- **Dynamic Stop Management:** Trailing stops based on pattern evolution
- **Position Scaling Protocols:** Size adjustments based on pattern strength
- **Portfolio Pattern Correlation:** Avoid over-concentration in similar patterns

Your Ultra Advanced Pattern analysis must demonstrate master-level understanding of institutional trading methodologies with complete transparency on pattern probability, risk assessment, and professional execution strategies.`;async function*xv(n,e,t,i,r){const a=n.filter(y=>y.role==="user"||y.role==="assistant"&&y.rawResponse).map(y=>{if(y.role==="assistant")return{role:"model",parts:[{text:y.rawResponse}]};const T=[];typeof y.content=="string"&&y.content.trim()&&T.push({text:y.content});const x=[];if(Array.isArray(y.images)&&y.images.length>0&&x.push(...y.images),y.timeframeImages)for(const C of y.timeframeImages)x.push(`data:${C.imageData.mimeType};base64,${C.imageData.data}`);for(const C of x){const _=C.split(";base64,");if(_.length===2){const w=_[0].split(":")[1],N=_[1];w&&N&&T.push({inlineData:{mimeType:w,data:N}})}}return{role:"user",parts:T}}).filter(y=>y.parts.length>0);let c=`${e}

**MULTI-TIMEFRAME ANALYSIS REQUEST**

Please analyze the following timeframes:
`;const h=[{text:c}];for(const y of t)c+=`- ${y.timeframe}${y.label?` (${y.label})`:""}
`,h.push({inlineData:{mimeType:y.imageData.mimeType,data:y.imageData.data}});c+=`
Provide a comprehensive multi-timeframe confluence analysis.`,h[0].text=c;const m=[...a,{role:"user",parts:h}],p={systemInstruction:r?sN:iN,temperature:0,topK:1,topP:1,seed:42,responseMimeType:"application/json",responseSchema:QM};try{const y=await nl(r?"gemini-2.5-pro":"gemini-2.5-flash",m,p);for await(const T of y){if(i.aborted){console.log("Multi-timeframe stream generation aborted by user.");break}const x=T==null?void 0:T.text;typeof x=="string"&&x.length>0&&(yield x)}}catch(y){y instanceof Error&&y.name==="AbortError"||(console.error("Error during multi-timeframe Gemini stream:",y),yield`{"error": "Could not retrieve multi-timeframe analysis. ${`Details: ${y instanceof Error?y.message:String(y)}`}"}`)}}async function*Fu(n,e,t,i,r){const a=n.filter(T=>T.role==="user"||T.role==="assistant"&&T.rawResponse).map(T=>{if(T.role==="assistant")return{role:"model",parts:[{text:T.rawResponse}]};const x=[];typeof T.content=="string"&&T.content.trim()&&x.push({text:T.content});const C=[];Array.isArray(T.images)&&T.images.length>0?C.push(...T.images):T.image&&C.push(T.image);for(const _ of C){const w=_.split(";base64,");if(w.length===2){const N=w[0].split(":")[1],H=w[1];N&&H&&x.push({inlineData:{mimeType:N,data:H}})}}return{role:"user",parts:x}}).filter(T=>T.parts.length>0),c=[{text:e}];if(Array.isArray(t)&&t.length>0)for(const T of t)c.push({inlineData:{mimeType:T.mimeType,data:T.data}});const h=[...a,{role:"user",parts:c}],m=Array.isArray(t)&&t.length>0;let p=null;if(m)try{const{prices:T,volumes:x}=KM(e);p=await jM.detectMarketRegime(T,x,"1H");const C=WM(p);c[0].text=`${c[0].text}

${C}`}catch(T){console.warn("Regime detection failed, proceeding without regime context:",T)}const y=m?{systemInstruction:r?nN:tN,temperature:0,topK:1,topP:1,seed:42,responseMimeType:"application/json",responseSchema:XM}:{systemInstruction:r?Td:vd,temperature:0,topK:1,topP:1,seed:42};try{const T=await nl(m&&r?"gemini-2.5-pro":"gemini-2.5-flash",h,y);let x="";for await(const C of T){if(i.aborted){console.log("Stream generation aborted by user.");break}const _=C==null?void 0:C.text;typeof _=="string"&&_.length>0&&(x+=_,yield _)}if(m&&x.trim())try{const C=sanitizeJsonResponse(x),_=JSON.parse(C);if(_){const w=Ja.calibrateConfidence(_,r);_.calibratedConfidence=w,_.hasEnhancedConfidence=!0,_.overallConfidenceScore=w.overallScore,_.confidence=Ja.getConfidenceLevel(w,r),yield`
`+JSON.stringify(_,null,0)}}catch(C){console.error("Error processing Quick Profit mode:",C)}}catch(T){if(!(T instanceof Error&&T.name==="AbortError")){console.error("Error during Gemini stream:",T);const x=T instanceof Error&&(T.message.includes("Failed to fetch")||T.message.includes("NetworkError")||T.message.includes("timeout")||T.name==="TypeError");let C;x?C="Network connection issue. Please check your internet connection and try again.":C=`Details: ${T instanceof Error?T.message:String(T)}`,m?yield`{"error": "Could not retrieve analysis. ${C}"}`:yield`Sorry, I encountered an error and could not respond. Please try again. ${C}`}}}async function*Ev(n,e,t,i,r){const a=n.filter(T=>T.role==="user"||T.role==="assistant"&&T.rawResponse).map(T=>{if(T.role==="assistant")return{role:"model",parts:[{text:T.rawResponse}]};const x=[];typeof T.content=="string"&&T.content.trim()&&x.push({text:T.content});const C=[];Array.isArray(T.images)&&T.images.length>0?C.push(...T.images):T.image&&C.push(T.image);for(const _ of C){const w=_.split(";base64,");if(w.length===2){const N=w[0].split(":")[1],H=w[1];N&&H&&x.push({inlineData:{mimeType:N,data:H}})}}return{role:"user",parts:x}}).filter(T=>T.parts.length>0),h=[{text:`${e}

**SMART MONEY CONCEPTS ANALYSIS REQUEST**

Please provide a comprehensive Smart Money Concepts analysis including:
- Market structure identification
- Order block detection
- Fair Value Gap analysis
- Liquidity level mapping
- Breaker block identification
- Displacement analysis
- Market phase assessment

Ensure all SMC concepts are clearly identified and explained with their trading implications.`}];if(Array.isArray(t)&&t.length>0)for(const T of t)h.push({inlineData:{mimeType:T.mimeType,data:T.data}});const m=[...a,{role:"user",parts:h}],p=Array.isArray(t)&&t.length>0,y=p?{systemInstruction:r?rN:oN,temperature:0,topK:1,topP:1,seed:42,responseMimeType:"application/json",responseSchema:ZM}:{systemInstruction:r?Td:vd,temperature:0,topK:1,topP:1,seed:42};try{const T=await nl(p?"gemini-2.5-pro":"gemini-2.5-flash",m,y);for await(const x of T){if(i.aborted){console.log("SMC stream generation aborted by user.");break}const C=x==null?void 0:x.text;typeof C=="string"&&C.length>0&&(yield C)}}catch(T){if(!(T instanceof Error&&T.name==="AbortError")){console.error("Error during SMC Gemini stream:",T);const x=`Details: ${T instanceof Error?T.message:String(T)}`;p?yield`{"error": "Could not retrieve SMC analysis. ${x}"}`:yield`Sorry, I encountered an error and could not respond. Please try again. ${x}`}}}async function*Cv(n,e,t,i,r){const a=n.filter(T=>T.role==="user"||T.role==="assistant"&&T.rawResponse).map(T=>{if(T.role==="assistant")return{role:"model",parts:[{text:T.rawResponse}]};const x=[];typeof T.content=="string"&&T.content.trim()&&x.push({text:T.content});const C=[];Array.isArray(T.images)&&T.images.length>0?C.push(...T.images):T.image&&C.push(T.image);for(const _ of C){const w=_.split(";base64,");if(w.length===2){const N=w[0].split(":")[1],H=w[1];N&&H&&x.push({inlineData:{mimeType:N,data:H}})}}return{role:"user",parts:x}}).filter(T=>T.parts.length>0),h=[{text:`${e}

**ADVANCED PATTERN ANALYSIS REQUEST**

Please provide a comprehensive advanced pattern analysis including:
- Wyckoff Method phase identification and volume analysis
- Elliott Wave count with Fibonacci projections
- Harmonic pattern detection with precise ratios
- Volume profile analysis with POC and value areas
- Classic pattern recognition
- Pattern confluence assessment

Ensure all patterns are precisely measured and confluence zones are clearly identified with their trading implications.`}];if(Array.isArray(t)&&t.length>0)for(const T of t)h.push({inlineData:{mimeType:T.mimeType,data:T.data}});const m=[...a,{role:"user",parts:h}],p=Array.isArray(t)&&t.length>0,y=p?{systemInstruction:r?lN:aN,temperature:0,topK:1,topP:1,seed:42,responseMimeType:"application/json",responseSchema:eN}:{systemInstruction:r?Td:vd,temperature:0,topK:1,topP:1,seed:42};try{const T=await nl(p?"gemini-2.5-pro":"gemini-2.5-flash",m,y);for await(const x of T){if(i.aborted){console.log("Advanced Pattern stream generation aborted by user.");break}const C=x==null?void 0:x.text;typeof C=="string"&&C.length>0&&(yield C)}}catch(T){if(!(T instanceof Error&&T.name==="AbortError")){console.error("Error during Advanced Pattern Gemini stream:",T);const x=`Details: ${T instanceof Error?T.message:String(T)}`;p?yield`{"error": "Could not retrieve Advanced Pattern analysis. ${x}"}`:yield`Sorry, I encountered an error and could not respond. Please try again. ${x}`}}}const Ie=class Ie{constructor(e={}){this.storage=new Map,this.config={maxSize:100*1024*1024,defaultTTL:Ie.DEFAULT_TTL.ANALYSIS,cleanupInterval:300*1e3,enableCompression:!1,enableMetrics:!0,storageBackend:"localStorage",...e},this.metrics={hits:0,misses:0,hitRate:0,totalSize:0,entryCount:0,evictions:0,avgAccessTime:0,lastCleanup:Date.now()},this.initializeStorage(),this.startCleanupTimer()}get(e,t=Ie.NAMESPACES.ANALYSIS){const i=performance.now(),r=this.buildFullKey(t,e);try{const a=this.getFromStorage(r);return a?this.isExpired(a.metadata)?(this.remove(e,t),this.recordMiss(),null):(a.metadata.accessCount++,a.metadata.lastAccess=Date.now(),this.saveToStorage(r,a),this.recordHit(performance.now()-i),a.data):(this.recordMiss(),null)}catch(a){return console.warn("Cache get error:",a),this.recordMiss(),null}}set(e,t,i=Ie.NAMESPACES.ANALYSIS,r={}){try{const a=this.buildFullKey(i,e),c=this.estimateSize(t);this.metrics.totalSize+c>this.config.maxSize&&this.evictEntries(c);const h={key:e,namespace:i,timestamp:Date.now(),ttl:this.getTTLForNamespace(i),accessCount:1,lastAccess:Date.now(),size:c,version:"1.0",priority:"MEDIUM",...r},m={data:t,metadata:h};return this.saveToStorage(a,m),this.updateMetrics(c,1),!0}catch(a){return console.warn("Cache set error:",a),!1}}remove(e,t=Ie.NAMESPACES.ANALYSIS){try{const i=this.buildFullKey(t,e),r=this.getFromStorage(i);return r?(this.removeFromStorage(i),this.updateMetrics(-r.metadata.size,-1),!0):!1}catch(i){return console.warn("Cache remove error:",i),!1}}clearNamespace(e){let t=0;try{const i=this.getKeysForNamespace(e);for(const r of i)this.remove(r.replace(`${e}:`,""),e)&&t++}catch(i){console.warn("Cache clearNamespace error:",i)}return t}invalidateByTags(e){let t=0;try{const i=this.getAllKeys();for(const r of i){const a=this.getFromStorage(r);a!=null&&a.metadata.tags&&e.some(h=>{var m;return(m=a.metadata.tags)==null?void 0:m.includes(h)})&&(this.removeFromStorage(r),this.updateMetrics(-a.metadata.size,-1),t++)}}catch(i){console.warn("Cache invalidateByTags error:",i)}return t}cacheAnalysis(e,t,i,r,a,c){const h=this.buildAnalysisKey(e,t,i,r),m={priority:r?"HIGH":"MEDIUM",ttl:Ie.DEFAULT_TTL.ANALYSIS,tags:["analysis",a.toLowerCase(),i,t],dependencies:e};return this.set(h,c,Ie.NAMESPACES.ANALYSIS,m),h}getCachedAnalysis(e,t,i,r){const a=this.buildAnalysisKey(e,t,i,r);return this.get(a,Ie.NAMESPACES.ANALYSIS)}cachePatternAnalysis(e,t,i,r,a){const c=this.buildPatternKey(e,t,i,r),h={priority:"HIGH",ttl:Ie.DEFAULT_TTL.PATTERN,tags:["pattern",t,...r],dependencies:[e]};return this.set(c,a,Ie.NAMESPACES.PATTERN,h),c}getCachedPatternAnalysis(e,t,i,r){const a=this.buildPatternKey(e,t,i,r);return this.get(a,Ie.NAMESPACES.PATTERN)}cacheIndicator(e,t,i,r,a){const c=this.buildIndicatorKey(e,t,i,r),h={priority:"MEDIUM",ttl:Ie.DEFAULT_TTL.INDICATOR,tags:["indicator",e,r],dependencies:[i]};return this.set(c,a,Ie.NAMESPACES.INDICATOR,h),c}getCachedIndicator(e,t,i,r){const a=this.buildIndicatorKey(e,t,i,r);return this.get(a,Ie.NAMESPACES.INDICATOR)}cacheMarketStructure(e,t,i,r,a){const c=this.buildMarketStructureKey(e,t,i,r),h={priority:"HIGH",ttl:Ie.DEFAULT_TTL.MARKET_STRUCTURE,tags:["market_structure","smc",t,...i],dependencies:[e]};return this.set(c,a,Ie.NAMESPACES.MARKET_STRUCTURE,h),c}getCachedMarketStructure(e,t,i,r){const a=this.buildMarketStructureKey(e,t,i,r);return this.get(a,Ie.NAMESPACES.MARKET_STRUCTURE)}buildAnalysisKey(e,t,i,r){const a=[...e].sort();return["analysis",i,t,r?"ultra":"normal",...a].join("|")}buildPatternKey(e,t,i,r){const a=[...r].sort();return["pattern",e,t,i.toString(),...a].join("|")}buildIndicatorKey(e,t,i,r){const a=JSON.stringify(t,Object.keys(t).sort());return["indicator",e,i,r,btoa(a)].join("|")}buildMarketStructureKey(e,t,i,r){const a=[...i].sort();return["market_structure",e,t,r.toString(),...a].join("|")}buildFullKey(e,t){return`${e}:${t}`}initializeStorage(){this.config.storageBackend==="localStorage"&&this.loadMetricsFromStorage()}getFromStorage(e){try{if(this.config.storageBackend==="memory")return this.storage.get(e)||null;if(this.config.storageBackend==="localStorage"){const t=localStorage.getItem(e);return t?JSON.parse(t):null}return null}catch(t){return console.warn("Storage get error:",t),null}}saveToStorage(e,t){try{this.config.storageBackend==="memory"?this.storage.set(e,t):this.config.storageBackend==="localStorage"&&localStorage.setItem(e,JSON.stringify(t))}catch(i){console.warn("Storage save error:",i),i instanceof Error&&i.name==="QuotaExceededError"&&this.handleQuotaExceeded()}}removeFromStorage(e){try{this.config.storageBackend==="memory"?this.storage.delete(e):this.config.storageBackend==="localStorage"&&localStorage.removeItem(e)}catch(t){console.warn("Storage remove error:",t)}}getAllKeys(){try{if(this.config.storageBackend==="memory")return Array.from(this.storage.keys());if(this.config.storageBackend==="localStorage"){const e=[];for(let t=0;t<localStorage.length;t++){const i=localStorage.key(t);i&&e.push(i)}return e}return[]}catch(e){return console.warn("Storage getAllKeys error:",e),[]}}getKeysForNamespace(e){const t=`${e}:`;return this.getAllKeys().filter(i=>i.startsWith(t))}evictEntries(e){const t=this.getAllCacheEntries();t.sort((a,c)=>{const h={LOW:0,MEDIUM:1,HIGH:2,CRITICAL:3},m=h[a.metadata.priority]-h[c.metadata.priority];return m!==0?m:a.metadata.lastAccess-c.metadata.lastAccess});let i=0,r=0;for(const a of t){if(i>=e)break;if(a.metadata.priority==="CRITICAL")continue;const c=this.buildFullKey(a.metadata.namespace,a.metadata.key);this.removeFromStorage(c),i+=a.metadata.size,r++}this.metrics.evictions+=r,this.updateMetrics(-i,-r)}getAllCacheEntries(){const e=[],t=this.getAllKeys();for(const i of t){const r=this.getFromStorage(i);r&&e.push(r)}return e}handleQuotaExceeded(){console.warn("Storage quota exceeded, performing aggressive cleanup"),this.evictEntries(this.config.maxSize*.3)}cleanup(){const e=Date.now();let t=0;const i=this.getAllKeys();for(const r of i){const a=this.getFromStorage(r);a&&this.isExpired(a.metadata)&&(this.removeFromStorage(r),this.updateMetrics(-a.metadata.size,-1),t++)}this.metrics.lastCleanup=e,t>0&&console.log(`Cache cleanup: removed ${t} expired entries`)}startCleanupTimer(){this.cleanupTimer&&clearInterval(this.cleanupTimer),this.cleanupTimer=setInterval(()=>{this.cleanup()},this.config.cleanupInterval)}isExpired(e){return Date.now()>e.timestamp+e.ttl}estimateSize(e){try{return JSON.stringify(e).length*2}catch{return 1e3}}getTTLForNamespace(e){switch(e){case Ie.NAMESPACES.ANALYSIS:return Ie.DEFAULT_TTL.ANALYSIS;case Ie.NAMESPACES.PATTERN:return Ie.DEFAULT_TTL.PATTERN;case Ie.NAMESPACES.INDICATOR:return Ie.DEFAULT_TTL.INDICATOR;case Ie.NAMESPACES.MARKET_STRUCTURE:return Ie.DEFAULT_TTL.MARKET_STRUCTURE;case Ie.NAMESPACES.IMAGE_HASH:return Ie.DEFAULT_TTL.IMAGE_HASH;case Ie.NAMESPACES.METADATA:return Ie.DEFAULT_TTL.METADATA;default:return this.config.defaultTTL}}recordHit(e){this.metrics.hits++,this.updateHitRate(),this.updateAvgAccessTime(e)}recordMiss(){this.metrics.misses++,this.updateHitRate()}updateHitRate(){const e=this.metrics.hits+this.metrics.misses;this.metrics.hitRate=e>0?this.metrics.hits/e:0}updateAvgAccessTime(e){const t=this.metrics.hits+this.metrics.misses;this.metrics.avgAccessTime=(this.metrics.avgAccessTime*(t-1)+e)/t}updateMetrics(e,t){this.metrics.totalSize=Math.max(0,this.metrics.totalSize+e),this.metrics.entryCount=Math.max(0,this.metrics.entryCount+t),this.config.enableMetrics&&this.saveMetricsToStorage()}loadMetricsFromStorage(){try{const t=localStorage.getItem("wizz_cache_metrics_v1");t&&(this.metrics={...this.metrics,...JSON.parse(t)})}catch(e){console.warn("Failed to load cache metrics:",e)}}saveMetricsToStorage(){try{localStorage.setItem("wizz_cache_metrics_v1",JSON.stringify(this.metrics))}catch(e){console.warn("Failed to save cache metrics:",e)}}getMetrics(){return{...this.metrics}}getConfig(){return{...this.config}}updateConfig(e){this.config={...this.config,...e},e.cleanupInterval&&this.startCleanupTimer()}forceCleanup(){const e=this.metrics.entryCount;return this.cleanup(),e-this.metrics.entryCount}clearAll(){try{for(const e of Object.values(Ie.NAMESPACES))this.clearNamespace(e);this.metrics={hits:0,misses:0,hitRate:0,totalSize:0,entryCount:0,evictions:0,avgAccessTime:0,lastCleanup:Date.now()},this.config.storageBackend==="memory"&&this.storage.clear()}catch(e){console.warn("Cache clearAll error:",e)}}destroy(){this.cleanupTimer&&(clearInterval(this.cleanupTimer),this.cleanupTimer=void 0),this.config.storageBackend==="memory"&&this.storage.clear()}};Ie.NAMESPACES={ANALYSIS:"analysis_v2",PATTERN:"pattern_v1",INDICATOR:"indicator_v1",MARKET_STRUCTURE:"smc_v1",IMAGE_HASH:"image_v1",METADATA:"meta_v1"},Ie.DEFAULT_TTL={ANALYSIS:1440*60*1e3,PATTERN:720*60*1e3,INDICATOR:360*60*1e3,MARKET_STRUCTURE:480*60*1e3,IMAGE_HASH:10080*60*1e3,METADATA:1800*1e3};let Yu=Ie;const Ut=new Yu({maxSize:200*1024*1024,defaultTTL:1440*60*1e3,cleanupInterval:600*1e3,enableCompression:!1,enableMetrics:!0,storageBackend:"localStorage"});class _i{constructor(){this.historicalData=new Map,this.assetProfiles=new Map,this.initializeDefaultAssetProfiles()}static getInstance(){return _i.instance||(_i.instance=new _i),_i.instance}calculateDynamicRR(e,t,i,r,a,c,h=!1){const m=this.calculateAdjustmentFactors(t,i,r,a,c,h),p=Object.values(m).reduce((x,C)=>x+C,0),y=Math.max(1,e+p),T=this.generateReasoning(m,t,i,a);return{baseRR:e,adjustedRR:y,adjustmentFactors:m,reasoning:T,finalRecommendation:this.generateFinalRecommendation(y,c,h)}}calculateVolatilityMetrics(e,t){if(e.length<20)return this.getDefaultVolatilityMetrics();const i=this.calculateReturns(e),r=this.calculateCurrentVolatility(i),a=this.calculateHistoricalVolatility(i),c=this.calculateVolatilityTrend(i),h=this.calculateATR(e),m=this.calculateBollingerBandWidth(e),p=this.classifyVolatilityRegime(r);return{currentVolatility:r,historicalVolatility:a,volatilityRegime:p,volatilityTrend:c,atrValue:h,bollingerBandWidth:m}}analyzeTimePatterns(e,t){const i=new Date(e),r=i.getUTCHours(),a=i.getUTCDay(),c=this.getAssetProfile(t),h=this.isActiveTradingTime(r,a,c),m=this.getTimeBasedVolatility(r,a,t),p=this.getSessionStrength(r,t),y=this.getMarketSession(r,t);return{currentHour:r,currentDay:a,isActiveTradingTime:h,timeBasedVolatility:m,sessionStrength:p,marketSession:y}}updateHistoricalPerformance(e,t,i){const r=`${e}_${t}`,a=this.historicalData.get(r)||this.getDefaultHistoricalPerformance();a.totalTrades++,i.success&&a.successfulTrades++,a.successRate=a.successfulTrades/a.totalTrades,a.averageRR=(a.averageRR*(a.totalTrades-1)+i.rr)/a.totalTrades;const h=`${this.classifyVolatilityRegime(i.volatility).toLowerCase()}Vol`;if(a.volatilityBasedSuccess[h].trades++,i.success&&(a.volatilityBasedSuccess[h].successRate=(a.volatilityBasedSuccess[h].successRate*(a.volatilityBasedSuccess[h].trades-1)+1)/a.volatilityBasedSuccess[h].trades),a.timeBasedSuccess.hourly[i.hour]||(a.timeBasedSuccess.hourly[i.hour]={trades:0,successRate:0}),a.timeBasedSuccess.hourly[i.hour].trades++,i.success){const m=a.timeBasedSuccess.hourly[i.hour];m.successRate=(m.successRate*(m.trades-1)+1)/m.trades}if(a.timeBasedSuccess.daily[i.day]||(a.timeBasedSuccess.daily[i.day]={trades:0,successRate:0}),a.timeBasedSuccess.daily[i.day].trades++,i.success){const m=a.timeBasedSuccess.daily[i.day];m.successRate=(m.successRate*(m.trades-1)+1)/m.trades}if(a.assetTypeSuccess[e]||(a.assetTypeSuccess[e]={trades:0,successRate:0}),a.assetTypeSuccess[e].trades++,i.success){const m=a.assetTypeSuccess[e];m.successRate=(m.successRate*(m.trades-1)+1)/m.trades}this.historicalData.set(r,a)}getAssetProfile(e){return this.assetProfiles.get(e)||this.getDefaultAssetProfile()}calculateAdjustmentFactors(e,t,i,r,a,c){const h=this.calculateVolatilityAdjustment(e),m=this.calculateAssetTypeAdjustment(t),p=this.calculateHistoricalSuccessAdjustment(i,r),y=this.calculateTimePatternAdjustment(r),T=this.calculateConfidenceAdjustment(a,c);return{volatilityAdjustment:h,assetTypeAdjustment:m,historicalSuccessAdjustment:p,timePatternAdjustment:y,confidenceAdjustment:T}}calculateVolatilityAdjustment(e){const{currentVolatility:t,volatilityRegime:i,volatilityTrend:r}=e;let a=0;switch(i){case"LOW":a+=.2;break;case"MEDIUM":a+=0;break;case"HIGH":a-=.3;break;case"EXTREME":a-=.5;break}return r==="INCREASING"?a-=.1:r==="DECREASING"&&(a+=.1),a}calculateAssetTypeAdjustment(e){let t=0;switch(e.volatilityProfile){case"LOW":t+=.1;break;case"MEDIUM":t+=0;break;case"HIGH":t-=.2;break;case"EXTREME":t-=.4;break}const{optimal:i}=e.typicalRRRange;return i>2.5?t-=.1:i<1.8&&(t+=.1),t}calculateHistoricalSuccessAdjustment(e,t){if(e.totalTrades<10)return 0;let i=0;e.successRate>.7?i+=.1:e.successRate<.5&&(i-=.2);const r=t.timeBasedVolatility>.7?"highVol":t.timeBasedVolatility>.4?"mediumVol":"lowVol",a=e.volatilityBasedSuccess[r];a.trades>5&&(a.successRate>.7?i+=.1:a.successRate<.5&&(i-=.1));const c=e.timeBasedSuccess.hourly[t.currentHour];return c&&c.trades>3&&(c.successRate>.7?i+=.05:c.successRate<.5&&(i-=.05)),i}calculateTimePatternAdjustment(e){let t=0;switch(e.sessionStrength){case"STRONG":t+=.1;break;case"MODERATE":t+=0;break;case"WEAK":t-=.1;break}return e.isActiveTradingTime?t+=.05:t-=.1,e.timeBasedVolatility>.7?t-=.1:e.timeBasedVolatility<.3&&(t+=.05),t}calculateConfidenceAdjustment(e,t){let i=0;return e>=85?i+=.1:e<70&&(i-=.2),t&&(i-=.1),i}generateReasoning(e,t,i,r){const a=[];return e.volatilityAdjustment!==0&&a.push(`Volatility adjustment: ${e.volatilityAdjustment>0?"+":""}${e.volatilityAdjustment.toFixed(2)} (${t.volatilityRegime} volatility regime)`),e.assetTypeAdjustment!==0&&a.push(`Asset type adjustment: ${e.assetTypeAdjustment>0?"+":""}${e.assetTypeAdjustment.toFixed(2)} (${i.volatilityProfile} volatility profile)`),e.historicalSuccessAdjustment!==0&&a.push(`Historical success adjustment: ${e.historicalSuccessAdjustment>0?"+":""}${e.historicalSuccessAdjustment.toFixed(2)} (based on past performance)`),e.timePatternAdjustment!==0&&a.push(`Time pattern adjustment: ${e.timePatternAdjustment>0?"+":""}${e.timePatternAdjustment.toFixed(2)} (${r.sessionStrength} session, ${r.isActiveTradingTime?"active":"inactive"} trading time)`),e.confidenceAdjustment!==0&&a.push(`Confidence adjustment: ${e.confidenceAdjustment>0?"+":""}${e.confidenceAdjustment.toFixed(2)} (analysis confidence factor)`),a}generateFinalRecommendation(e,t,i){const r=e,a=e+.3,c=e+.6;let h=Math.min(95,t+(i?5:0));return{minRR:Math.max(1,r),optimalRR:Math.max(1.3,a),maxRR:Math.max(1.6,c),confidence:h}}calculateReturns(e){const t=[];for(let i=1;i<e.length;i++){const r=(e[i].close-e[i-1].close)/e[i-1].close;t.push(r)}return t}calculateCurrentVolatility(e){const t=e.slice(-20),i=t.reduce((a,c)=>a+c,0)/t.length,r=t.reduce((a,c)=>a+Math.pow(c-i,2),0)/t.length;return Math.sqrt(r)}calculateHistoricalVolatility(e){const t=e.reduce((r,a)=>r+a,0)/e.length,i=e.reduce((r,a)=>r+Math.pow(a-t,2),0)/e.length;return Math.sqrt(i)}calculateVolatilityTrend(e){if(e.length<40)return"STABLE";const t=e.slice(0,Math.floor(e.length/2)),i=e.slice(Math.floor(e.length/2)),r=this.calculateCurrentVolatility(t),c=(this.calculateCurrentVolatility(i)-r)/r;return c>.2?"INCREASING":c<-.2?"DECREASING":"STABLE"}calculateATR(e){if(e.length<14)return 0;const t=[];for(let r=1;r<e.length;r++){const a=e[r].high,c=e[r].low,h=e[r-1].close,m=a-c,p=Math.abs(a-h),y=Math.abs(c-h);t.push(Math.max(m,p,y))}const i=t.slice(-14);return i.reduce((r,a)=>r+a,0)/i.length}calculateBollingerBandWidth(e){if(e.length<20)return 0;const i=e.map(p=>p.close).slice(-20),r=i.reduce((p,y)=>p+y,0)/i.length,a=i.reduce((p,y)=>p+Math.pow(y-r,2),0)/i.length,c=Math.sqrt(a),h=r+2*c,m=r-2*c;return(h-m)/r}classifyVolatilityRegime(e){return e<.01?"LOW":e<.025?"MEDIUM":e<.05?"HIGH":"EXTREME"}isActiveTradingTime(e,t,i){return!!(i.marketHours.is24h||i.marketHours.activeHours&&i.marketHours.activeHours.includes(e))}getTimeBasedVolatility(e,t,i){return e===8||e===16?.7:e===0||e===12?.6:e>=22||e<=6?.3:.5}getSessionStrength(e,t){return t.includes("CRYPTO")||e>=8&&e<=16?"STRONG":e>=6&&e<=18?"MODERATE":"WEAK"}getMarketSession(e,t){return t.includes("CRYPTO")?"CRYPTO_24H":e>=0&&e<8?"ASIAN":e>=8&&e<16?"LONDON":e>=13&&e<21?"NEW_YORK":"ASIAN"}getDefaultVolatilityMetrics(){return{currentVolatility:.02,historicalVolatility:.02,volatilityRegime:"MEDIUM",volatilityTrend:"STABLE"}}getDefaultAssetProfile(){return{assetType:"CRYPTO",volatilityProfile:"HIGH",typicalRRRange:{min:1.8,max:3,optimal:2.2},marketHours:{is24h:!0}}}getDefaultHistoricalPerformance(){return{totalTrades:0,successfulTrades:0,successRate:0,averageRR:2,volatilityBasedSuccess:{lowVol:{trades:0,successRate:0},mediumVol:{trades:0,successRate:0},highVol:{trades:0,successRate:0},extremeVol:{trades:0,successRate:0}},timeBasedSuccess:{hourly:{},daily:{}},assetTypeSuccess:{}}}initializeDefaultAssetProfiles(){this.assetProfiles.set("BTC",{assetType:"CRYPTO",volatilityProfile:"HIGH",typicalRRRange:{min:1.8,max:3.5,optimal:2.2},marketHours:{is24h:!0}}),this.assetProfiles.set("ETH",{assetType:"CRYPTO",volatilityProfile:"HIGH",typicalRRRange:{min:1.8,max:3.5,optimal:2.2},marketHours:{is24h:!0}}),this.assetProfiles.set("EURUSD",{assetType:"FOREX",volatilityProfile:"MEDIUM",typicalRRRange:{min:1.5,max:2.8,optimal:2},marketHours:{is24h:!1,activeHours:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]}}),this.assetProfiles.set("AAPL",{assetType:"STOCKS",volatilityProfile:"MEDIUM",typicalRRRange:{min:1.5,max:2.5,optimal:1.8},marketHours:{is24h:!1,activeHours:[13,14,15,16,17,18,19,20,21]}}),this.assetProfiles.set("GOLD",{assetType:"COMMODITIES",volatilityProfile:"MEDIUM",typicalRRRange:{min:1.6,max:2.8,optimal:2},marketHours:{is24h:!1,activeHours:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]}})}}class Os{constructor(){this.trades=new Map,this.dynamicRRService=_i.getInstance()}static getInstance(){return Os.instance||(Os.instance=new Os),Os.instance}recordTrade(e){const t=this.generateTradeId(),i={...e,id:t};return this.trades.set(t,i),this.saveTradesToStorage(),t}updateTradeOutcome(e,t){const i=this.trades.get(e);if(!i)return console.warn(`Trade ${e} not found for outcome update`),!1;const r={...i,...t};return this.trades.set(e,r),this.updateHistoricalPerformance(r),this.saveTradesToStorage(),!0}getTradeStatistics(){const e=Array.from(this.trades.values()).filter(_=>_.success!==void 0);if(e.length===0)return this.getEmptyStatistics();const t=e.length,i=e.filter(_=>_.success).length,r=i/t,a=e.reduce((_,w)=>_+w.rr,0)/t,c=e.filter(_=>_.exitTime).map(_=>{const w=new Date(_.entryTime).getTime();return(new Date(_.exitTime).getTime()-w)/(1e3*60*60)}),h=c.length>0?c.reduce((_,w)=>_+w,0)/c.length:0,m=this.calculateAssetPerformance(e),p=m.best,y=m.worst,T=this.calculateVolatilityPerformance(e),x=this.calculateTimePerformance(e),C=this.calculateAnalysisTypePerformance(e);return{totalTrades:t,successfulTrades:i,successRate:r,averageRR:a,averageHoldingTime:h,bestPerformingAsset:p,worstPerformingAsset:y,volatilityPerformance:T,timePerformance:x,analysisTypePerformance:C}}getHistoricalPerformance(e,t){const i=Array.from(this.trades.values()).filter(T=>T.success!==void 0&&T.assetType===e&&T.timeframe===t);if(i.length===0)return this.getDefaultHistoricalPerformance();const r=i.length,a=i.filter(T=>T.success).length,c=a/r,h=i.reduce((T,x)=>T+x.rr,0)/r,m=this.calculateVolatilityBasedSuccess(i),p=this.calculateTimeBasedSuccess(i),y=this.calculateAssetTypeSuccess(i);return{totalTrades:r,successfulTrades:a,successRate:c,averageRR:h,volatilityBasedSuccess:m,timeBasedSuccess:p,assetTypeSuccess:y}}getTradesForAsset(e,t){return Array.from(this.trades.values()).filter(i=>i.assetType===e&&i.timeframe===t).sort((i,r)=>new Date(r.entryTime).getTime()-new Date(i.entryTime).getTime())}getRecentTrades(e=50){return Array.from(this.trades.values()).sort((t,i)=>new Date(i.entryTime).getTime()-new Date(t.entryTime).getTime()).slice(0,e)}clearAllTrades(){this.trades.clear(),this.saveTradesToStorage()}generateTradeId(){return`trade_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}updateHistoricalPerformance(e){if(e.success===void 0)return;const t=new Date(e.entryTime).getUTCHours(),i=new Date(e.entryTime).getUTCDay();this.dynamicRRService.updateHistoricalPerformance(e.assetType,e.timeframe,{success:e.success,rr:e.rr,volatility:e.volatility,hour:t,day:i})}calculateAssetPerformance(e){const t=new Map;e.forEach(h=>{t.has(h.assetType)||t.set(h.assetType,{trades:0,successRate:0});const m=t.get(h.assetType);m.trades++,h.success&&(m.successRate=(m.successRate*(m.trades-1)+1)/m.trades)});let i="",r="",a=-1,c=2;return t.forEach((h,m)=>{h.trades>=5&&(h.successRate>a&&(a=h.successRate,i=m),h.successRate<c&&(c=h.successRate,r=m))}),{best:i,worst:r}}calculateVolatilityPerformance(e){const t={lowVol:{trades:0,successRate:0,avgRR:0},mediumVol:{trades:0,successRate:0,avgRR:0},highVol:{trades:0,successRate:0,avgRR:0},extremeVol:{trades:0,successRate:0,avgRR:0}},i={lowVol:[],mediumVol:[],highVol:[],extremeVol:[]};return e.forEach(r=>{let a;r.volatility<.01?a="lowVol":r.volatility<.025?a="mediumVol":r.volatility<.05?a="highVol":a="extremeVol",i[a].push(r)}),Object.keys(t).forEach(r=>{const a=i[r];if(a.length>0){const c=a.filter(m=>m.success).length,h=a.reduce((m,p)=>m+p.rr,0)/a.length;t[r]={trades:a.length,successRate:c/a.length,avgRR:h}}}),t}calculateTimePerformance(e){const t={},i={};return e.forEach(r=>{const a=new Date(r.entryTime).getUTCHours(),c=new Date(r.entryTime).getUTCDay();t[a]||(t[a]={trades:0,successRate:0,avgRR:0}),t[a].trades++,r.success&&(t[a].successRate=(t[a].successRate*(t[a].trades-1)+1)/t[a].trades),t[a].avgRR=(t[a].avgRR*(t[a].trades-1)+r.rr)/t[a].trades,i[c]||(i[c]={trades:0,successRate:0,avgRR:0}),i[c].trades++,r.success&&(i[c].successRate=(i[c].successRate*(i[c].trades-1)+1)/i[c].trades),i[c].avgRR=(i[c].avgRR*(i[c].trades-1)+r.rr)/i[c].trades}),{hourly:t,daily:i}}calculateAnalysisTypePerformance(e){const t={SMC:{trades:0,successRate:0,avgRR:0},PATTERN:{trades:0,successRate:0,avgRR:0},MULTI_TIMEFRAME:{trades:0,successRate:0,avgRR:0},STANDARD:{trades:0,successRate:0,avgRR:0}},i={SMC:[],PATTERN:[],MULTI_TIMEFRAME:[],STANDARD:[]};return e.forEach(r=>{i[r.analysisType].push(r)}),Object.keys(t).forEach(r=>{const a=i[r];if(a.length>0){const c=a.filter(m=>m.success).length,h=a.reduce((m,p)=>m+p.rr,0)/a.length;t[r]={trades:a.length,successRate:c/a.length,avgRR:h}}}),t}calculateVolatilityBasedSuccess(e){const t={lowVol:{trades:0,successRate:0},mediumVol:{trades:0,successRate:0},highVol:{trades:0,successRate:0},extremeVol:{trades:0,successRate:0}};return e.forEach(i=>{let r;i.volatility<.01?r="lowVol":i.volatility<.025?r="mediumVol":i.volatility<.05?r="highVol":r="extremeVol",t[r].trades++,i.success&&(t[r].successRate=(t[r].successRate*(t[r].trades-1)+1)/t[r].trades)}),t}calculateTimeBasedSuccess(e){const t={},i={};return e.forEach(r=>{const a=new Date(r.entryTime).getUTCHours(),c=new Date(r.entryTime).getUTCDay();t[a]||(t[a]={trades:0,successRate:0}),t[a].trades++,r.success&&(t[a].successRate=(t[a].successRate*(t[a].trades-1)+1)/t[a].trades),i[c]||(i[c]={trades:0,successRate:0}),i[c].trades++,r.success&&(i[c].successRate=(i[c].successRate*(i[c].trades-1)+1)/i[c].trades)}),{hourly:t,daily:i}}calculateAssetTypeSuccess(e){const t={};return e.forEach(i=>{t[i.assetType]||(t[i.assetType]={trades:0,successRate:0}),t[i.assetType].trades++,i.success&&(t[i.assetType].successRate=(t[i.assetType].successRate*(t[i.assetType].trades-1)+1)/t[i.assetType].trades)}),t}getEmptyStatistics(){return{totalTrades:0,successfulTrades:0,successRate:0,averageRR:0,averageHoldingTime:0,bestPerformingAsset:"",worstPerformingAsset:"",volatilityPerformance:{lowVol:{trades:0,successRate:0,avgRR:0},mediumVol:{trades:0,successRate:0,avgRR:0},highVol:{trades:0,successRate:0,avgRR:0},extremeVol:{trades:0,successRate:0,avgRR:0}},timePerformance:{hourly:{},daily:{}},analysisTypePerformance:{SMC:{trades:0,successRate:0,avgRR:0},PATTERN:{trades:0,successRate:0,avgRR:0},MULTI_TIMEFRAME:{trades:0,successRate:0,avgRR:0},STANDARD:{trades:0,successRate:0,avgRR:0}}}}getDefaultHistoricalPerformance(){return{totalTrades:0,successfulTrades:0,successRate:0,averageRR:2,volatilityBasedSuccess:{lowVol:{trades:0,successRate:0},mediumVol:{trades:0,successRate:0},highVol:{trades:0,successRate:0},extremeVol:{trades:0,successRate:0}},timeBasedSuccess:{hourly:{},daily:{}},assetTypeSuccess:{}}}saveTradesToStorage(){try{const e=Array.from(this.trades.values());localStorage.setItem("tradeTrackingData",JSON.stringify(e))}catch(e){console.warn("Failed to save trades to storage:",e)}}loadTradesFromStorage(){try{const e=localStorage.getItem("tradeTrackingData");if(e){const t=JSON.parse(e);this.trades.clear(),t.forEach(i=>{this.trades.set(i.id,i)})}}catch(e){console.warn("Failed to load trades from storage:",e)}}}function cN(n){if(!n)return null;const t=n.trim().match(/^(\d+(?:\.\d+)?)[\s]*:[\s]*1$/);if(!t)return null;const i=parseFloat(t[1]);return isNaN(i)?null:i}function uN(n){if(!n.trade)return!1;const{entryPrice:e,takeProfit:t,stopLoss:i}=n.trade;if(!e||!t||!i)return!1;const r=parseFloat(String(e).replace(/[^0-9.+-]/g,"")),a=parseFloat(String(t).replace(/[^0-9.+-]/g,"")),c=parseFloat(String(i).replace(/[^0-9.+-]/g,""));return!([r,a,c].some(h=>!isFinite(h))||r===a||r===c||n.signal==="BUY"&&!(a>r&&c<r)||n.signal==="SELL"&&!(a<r&&c>r))}function Is(n,e){var C;const t={...n},i=Number.isFinite(n.overallConfidenceScore)?n.overallConfidenceScore:0,r=i>=75?"HIGH":"LOW";t.confidence!==r&&(t.confidence=r);const a=cN(n.riskRewardRatio),c=uN(n),h=_i.getInstance(),m=Os.getInstance(),p=dN(n),y=n.timeframe||"1H",T=new Date().toISOString(),x=fN(n,e,p,y,T,h,m);if(n.hasSMCAnalysis&&n.smcAnalysis){const _=n.smcAnalysis.tradingBias.confidence;if(e){const N=x.ultraMode.minRR,H=80;return t.signal==="NEUTRAL"||t.confidence==="LOW"?(t.trade=null,t.riskRewardRatio=null,t):((i<85||!c||a===null||a<N||_<H)&&(t.signal="NEUTRAL",t.trade=null,t.riskRewardRatio=null),t)}else{const N=x.normalMode.minRR,H=70;return t.signal==="NEUTRAL"||t.confidence==="LOW"?(t.trade=null,t.riskRewardRatio=null,t):((i<75||!c||a===null||a<N||_<H)&&(t.signal="NEUTRAL",t.trade=null,t.riskRewardRatio=null),t)}}if(n.hasAdvancedPatterns&&n.patternAnalysis){const _=((C=n.patternAnalysis.patternConfluence)==null?void 0:C.confidenceScore)||50;if(e){const N=x.ultraMode.minRR,H=85;return t.signal==="NEUTRAL"||t.confidence==="LOW"?(t.trade=null,t.riskRewardRatio=null,t):((i<85||!c||a===null||a<N||_<H)&&(t.signal="NEUTRAL",t.trade=null,t.riskRewardRatio=null),t)}else{const N=x.normalMode.minRR,H=75;return t.signal==="NEUTRAL"||t.confidence==="LOW"?(t.trade=null,t.riskRewardRatio=null,t):((i<75||!c||a===null||a<N||_<H)&&(t.signal="NEUTRAL",t.trade=null,t.riskRewardRatio=null),t)}}if(n.isMultiTimeframeAnalysis&&n.multiTimeframeContext){const _=n.multiTimeframeContext.confluenceScore;if(e){const N=x.ultraMode.minRR,H=80;return t.signal==="NEUTRAL"||t.confidence==="LOW"?(t.trade=null,t.riskRewardRatio=null,t):((i<85||!c||a===null||a<N||_<H)&&(t.signal="NEUTRAL",t.trade=null,t.riskRewardRatio=null),t)}else{const N=x.normalMode.minRR,H=70;return t.signal==="NEUTRAL"||t.confidence==="LOW"?(t.trade=null,t.riskRewardRatio=null,t):((i<75||!c||a===null||a<N||_<H)&&(t.signal="NEUTRAL",t.trade=null,t.riskRewardRatio=null),t)}}if(e){const w=x.ultraMode.minRR;return t.signal==="NEUTRAL"||t.confidence==="LOW"?(t.trade=null,t.riskRewardRatio=null,t):((i<85||!c||a===null||a<w)&&(t.signal="NEUTRAL",t.trade=null,t.riskRewardRatio=null),t)}else{const w=x.normalMode.minRR;return t.signal==="NEUTRAL"||t.confidence==="LOW"?(t.trade=null,t.riskRewardRatio=null,t):((i<75||!c||a===null||a<w)&&(t.signal="NEUTRAL",t.trade=null,t.riskRewardRatio=null),t)}}function dN(n){return n.summary.toLowerCase().includes("bitcoin")||n.summary.toLowerCase().includes("btc")?"BTC":n.summary.toLowerCase().includes("ethereum")||n.summary.toLowerCase().includes("eth")?"ETH":n.summary.toLowerCase().includes("eurusd")||n.summary.toLowerCase().includes("forex")?"EURUSD":n.summary.toLowerCase().includes("gold")||n.summary.toLowerCase().includes("commodity")?"GOLD":n.summary.toLowerCase().includes("stock")||n.summary.toLowerCase().includes("aapl")?"AAPL":"BTC"}function fN(n,e,t,i,r,a,c){const h=e?2.2:1.8,m=a.getAssetProfile(t),p=a.calculateVolatilityMetrics([],i),y=a.analyzeTimePatterns(r,t),T=c.getHistoricalPerformance(t,i),x=a.calculateDynamicRR(h,p,m,T,y,n.overallConfidenceScore,!1),C=a.calculateDynamicRR(h+.4,p,m,T,y,n.overallConfidenceScore,!0);return{normalMode:{minRR:x.finalRecommendation.minRR,optimalRR:x.finalRecommendation.optimalRR,maxRR:x.finalRecommendation.maxRR},ultraMode:{minRR:C.finalRecommendation.minRR,optimalRR:C.finalRecommendation.optimalRR,maxRR:C.finalRecommendation.maxRR}}}const Xa=class Xa{constructor(e={}){this.activeAnalyses=new Map,this.eventListeners=new Map,this.config={...Xa.DEFAULT_CONFIG,...e}}async*startProgressiveAnalysis(e,t,i,r,a,c,h){const m=this.generateAnalysisId(),p=Date.now(),y={analysisId:m,isActive:!0,currentPhase:"OVERVIEW",phases:{overview:{status:"PENDING",confidence:0},detailed:{status:"PENDING",confidence:0},verification:{status:"PENDING",confidence:0}},overallProgress:0,estimatedTotalTime:this.estimateAnalysisTime(e,c)};this.activeAnalyses.set(m,y);try{if(yield*this.executeOverviewPhase(m,e,t,i,r,a,c,h),h.aborted||(yield*this.executeDetailedPhase(m,e,t,i,r,a,c,h),h.aborted))return;yield*this.executeVerificationPhase(m,e,t,i,r,a,c,h);const T=this.activeAnalyses.get(m);T&&(T.isActive=!1,T.actualTotalTime=Date.now()-p,T.overallProgress=100),yield{type:"ANALYSIS_COMPLETE",phase:"VERIFICATION",progress:100,confidence:this.config.confidenceThresholds.verification,timestamp:Date.now(),metadata:{processingTime:Date.now()-p,dataSize:JSON.stringify({prompt:t,images:i}).length,cacheHit:!1}}}catch(T){yield{type:"PHASE_ERROR",phase:y.currentPhase,progress:y.overallProgress,confidence:0,timestamp:Date.now(),metadata:{processingTime:Date.now()-p,dataSize:0,cacheHit:!1,errorDetails:T instanceof Error?T.message:String(T)}}}finally{this.activeAnalyses.delete(m)}}async*executeOverviewPhase(e,t,i,r,a,c,h,m){const p=this.activeAnalyses.get(e);if(!p)return;const y=Date.now();p.currentPhase="OVERVIEW",p.phases.overview.status="IN_PROGRESS",p.phases.overview.startTime=y,yield{type:"PHASE_START",phase:"OVERVIEW",progress:0,confidence:0,timestamp:y,metadata:{processingTime:0,dataSize:JSON.stringify({prompt:i,images:r}).length,cacheHit:!1}};try{const T=this.buildPhaseCacheKey(e,"OVERVIEW",r,i),x=this.getCachedPhaseResult(T,"OVERVIEW");if(x){p.phases.overview.result=x,p.phases.overview.confidence=this.config.confidenceThresholds.overview,p.phases.overview.status="COMPLETED",p.phases.overview.endTime=Date.now(),p.overallProgress=33,yield{type:"PHASE_COMPLETE",phase:"OVERVIEW",data:x,progress:33,confidence:this.config.confidenceThresholds.overview,timestamp:Date.now(),metadata:{processingTime:Date.now()-y,dataSize:JSON.stringify(x).length,cacheHit:!0}};return}const C=this.generateOverviewPrompt(i,t),_=await this.runQuickAnalysis(t,C,r,a,c,!1,m);if(m.aborted)return;const w=this.processOverviewResult(_);p.phases.overview.result=w,p.phases.overview.confidence=this.config.confidenceThresholds.overview,p.phases.overview.status="COMPLETED",p.phases.overview.endTime=Date.now(),p.overallProgress=33,this.config.cachePhasesIndependently&&this.cachePhaseResult(T,w,"OVERVIEW"),yield{type:"PHASE_COMPLETE",phase:"OVERVIEW",data:w,progress:33,confidence:this.config.confidenceThresholds.overview,timestamp:Date.now(),metadata:{processingTime:Date.now()-y,dataSize:JSON.stringify(w).length,cacheHit:!1}}}catch(T){throw p.phases.overview.status="ERROR",T}}async*executeDetailedPhase(e,t,i,r,a,c,h,m){const p=this.activeAnalyses.get(e);if(!p)return;const y=Date.now();p.currentPhase="DETAILED",p.phases.detailed.status="IN_PROGRESS",p.phases.detailed.startTime=y,yield{type:"PHASE_START",phase:"DETAILED",progress:33,confidence:this.config.confidenceThresholds.overview,timestamp:y,metadata:{processingTime:0,dataSize:JSON.stringify({prompt:i,images:r}).length,cacheHit:!1}};try{const T=this.buildPhaseCacheKey(e,"DETAILED",r,i),x=this.getCachedPhaseResult(T,"DETAILED");if(x){p.phases.detailed.result=x,p.phases.detailed.confidence=this.config.confidenceThresholds.detailed,p.phases.detailed.status="COMPLETED",p.phases.detailed.endTime=Date.now(),p.overallProgress=66,yield{type:"PHASE_COMPLETE",phase:"DETAILED",data:x,progress:66,confidence:this.config.confidenceThresholds.detailed,timestamp:Date.now(),metadata:{processingTime:Date.now()-y,dataSize:JSON.stringify(x).length,cacheHit:!0}};return}const C=this.generateDetailedPrompt(i,t,p.phases.overview.result),_=await this.runDetailedAnalysis(t,C,r,a,c,h,m);if(m.aborted)return;const w=this.processDetailedResult(_,p.phases.overview.result);p.phases.detailed.result=w,p.phases.detailed.confidence=this.config.confidenceThresholds.detailed,p.phases.detailed.status="COMPLETED",p.phases.detailed.endTime=Date.now(),p.overallProgress=66,this.config.cachePhasesIndependently&&this.cachePhaseResult(T,w,"DETAILED"),yield{type:"PHASE_COMPLETE",phase:"DETAILED",data:w,progress:66,confidence:this.config.confidenceThresholds.detailed,timestamp:Date.now(),metadata:{processingTime:Date.now()-y,dataSize:JSON.stringify(w).length,cacheHit:!1}}}catch(T){throw p.phases.detailed.status="ERROR",T}}async*executeVerificationPhase(e,t,i,r,a,c,h,m){const p=this.activeAnalyses.get(e);if(!p)return;const y=Date.now();p.currentPhase="VERIFICATION",p.phases.verification.status="IN_PROGRESS",p.phases.verification.startTime=y,yield{type:"PHASE_START",phase:"VERIFICATION",progress:66,confidence:this.config.confidenceThresholds.detailed,timestamp:y,metadata:{processingTime:0,dataSize:JSON.stringify({prompt:i,images:r}).length,cacheHit:!1}};try{const T=this.buildPhaseCacheKey(e,"VERIFICATION",r,i),x=this.getCachedPhaseResult(T,"VERIFICATION");if(x){p.phases.verification.result=x,p.phases.verification.confidence=this.config.confidenceThresholds.verification,p.phases.verification.status="COMPLETED",p.phases.verification.endTime=Date.now(),p.overallProgress=100,yield{type:"PHASE_COMPLETE",phase:"VERIFICATION",data:x,progress:100,confidence:this.config.confidenceThresholds.verification,timestamp:Date.now(),metadata:{processingTime:Date.now()-y,dataSize:JSON.stringify(x).length,cacheHit:!0}};return}const C=this.generateVerificationPrompt(i,t,p.phases.overview.result,p.phases.detailed.result),_=await this.runFullAnalysis(t,C,r,a,c,h,m);if(m.aborted)return;const w=Is(_,h);p.phases.verification.result=w,p.phases.verification.confidence=this.config.confidenceThresholds.verification,p.phases.verification.status="COMPLETED",p.phases.verification.endTime=Date.now(),p.overallProgress=100,this.config.cachePhasesIndependently&&this.cachePhaseResult(T,w,"VERIFICATION"),yield{type:"PHASE_COMPLETE",phase:"VERIFICATION",data:w,progress:100,confidence:this.config.confidenceThresholds.verification,timestamp:Date.now(),metadata:{processingTime:Date.now()-y,dataSize:JSON.stringify(w).length,cacheHit:!1}}}catch(T){throw p.phases.verification.status="ERROR",T}}generateOverviewPrompt(e,t){return`
**QUICK OVERVIEW ANALYSIS (Phase 1/3)**

You are providing a RAPID initial assessment with ~30% confidence. Focus on:
- Immediate visual patterns and obvious signals
- Basic trend direction and momentum
- Key support/resistance levels
- Simple risk assessment

Keep analysis concise and focus on the most apparent technical indicators.
Time limit: 15 seconds maximum.

Original request: ${e}
`}generateDetailedPrompt(e,t,i){return`
**DETAILED ANALYSIS (Phase 2/3)**

Building on the initial overview with ~70% confidence. Focus on:
- Comprehensive technical indicator analysis
- Multiple timeframe correlation
- Advanced pattern recognition
- Detailed risk/reward calculations
- Market structure analysis

${i?`Previous overview found: ${i.summary||"Basic analysis completed"}`:"No previous overview available"}

Expand and refine the analysis with deeper technical insights.
Time limit: 45 seconds maximum.

Original request: ${e}
`}generateVerificationPrompt(e,t,i,r){return`
**FINAL VERIFICATION (Phase 3/3)**

Final verification with ~95% confidence. Focus on:
- Cross-validation of previous phases
- Error checking and consistency verification
- Final confidence assessment
- Risk management optimization
- Complete trade setup verification

Previous analysis summary:
${`
Overview phase: ${(i==null?void 0:i.summary)||"Not available"}
Detailed phase: ${(r==null?void 0:r.summary)||"Not available"}
`}

Provide the most accurate and verified analysis possible.
Time limit: 30 seconds maximum.

Original request: ${e}
`}async runQuickAnalysis(e,t,i,r,a,c,h){let m="",p;switch(e){case"MULTI_TIMEFRAME":if(!r)throw new Error("Timeframe images required for multi-timeframe analysis");p=xv(a,t,r,h,c);break;case"SMC":p=Ev(a,t,i,h,c);break;case"ADVANCED_PATTERN":p=Cv(a,t,i,h,c);break;default:p=Fu(a,t,i,h,c)}for await(const T of p){if(h.aborted)break;m+=T}const y=this.sanitizeJsonResponse(m);return JSON.parse(y)}async runDetailedAnalysis(e,t,i,r,a,c,h){return this.runQuickAnalysis(e,t,i,r,a,c,h)}async runFullAnalysis(e,t,i,r,a,c,h){return this.runQuickAnalysis(e,t,i,r,a,c,h)}processOverviewResult(e){return{summary:e.summary,signal:e.signal,confidence:"LOW",overallConfidenceScore:Math.min(e.overallConfidenceScore||0,this.config.confidenceThresholds.overview),thinkingProcess:this.truncateThinkingProcess(e.thinkingProcess,500),timeframe:e.timeframe}}processDetailedResult(e,t){return{...e,confidence:"HIGH",overallConfidenceScore:Math.min(e.overallConfidenceScore||0,this.config.confidenceThresholds.detailed),thinkingProcess:this.truncateThinkingProcess(e.thinkingProcess,1500),previousPhaseInsights:t==null?void 0:t.summary}}buildPhaseCacheKey(e,t,i,r){const a=i.map(h=>h.hash||"").filter(Boolean),c=btoa(r).slice(0,16);return`progressive_${t.toLowerCase()}_${c}_${a.join("_")}`}getCachedPhaseResult(e,t){if(!this.config.cachePhasesIndependently)return null;try{return Ut.get(e,`progressive_${t.toLowerCase()}`)}catch(i){return console.warn("Failed to get cached phase result:",i),null}}cachePhaseResult(e,t,i){if(this.config.cachePhasesIndependently)try{const r=i==="OVERVIEW"?18e5:i==="DETAILED"?36e5:864e5;Ut.set(e,t,`progressive_${i.toLowerCase()}`,{ttl:r,priority:i==="VERIFICATION"?"HIGH":"MEDIUM",tags:["progressive",i.toLowerCase()]})}catch(r){console.warn("Failed to cache phase result:",r)}}generateAnalysisId(){return`prog_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}estimateAnalysisTime(e,t){return(e==="STANDARD"?6e4:9e4)*(t?1.5:1)}truncateThinkingProcess(e,t){return e.length<=t?e:e.substring(0,t)+`

[Analysis continues in next phase...]`}sanitizeJsonResponse(e){const t=e.indexOf("{"),i=e.lastIndexOf("}");if(t===-1||i===-1||t>=i)throw new Error("No valid JSON found in response");return e.substring(t,i+1)}getAnalysisState(e){return this.activeAnalyses.get(e)||null}getActiveAnalyses(){return Array.from(this.activeAnalyses.values())}cancelAnalysis(e){const t=this.activeAnalyses.get(e);return t?(t.isActive=!1,this.activeAnalyses.delete(e),!0):!1}updateConfig(e){this.config={...this.config,...e}}getConfig(){return{...this.config}}clearPhaseCache(e){const t=e?`progressive_${e.toLowerCase()}`:"progressive";return Ut.clearNamespace(t)}};Xa.DEFAULT_CONFIG={enableProgressive:!0,phaseTimeouts:{overview:15e3,detailed:45e3,verification:3e4},confidenceThresholds:{overview:30,detailed:70,verification:95},allowPhaseSkipping:!0,enablePhasePreview:!0,cachePhasesIndependently:!0};let Ju=Xa;const hN=new Ju,Zg=n=>{let e;const t=new Set,i=(p,y)=>{const T=typeof p=="function"?p(e):p;if(!Object.is(T,e)){const x=e;e=y??(typeof T!="object"||T===null)?T:Object.assign({},e,T),t.forEach(C=>C(e,x))}},r=()=>e,h={setState:i,getState:r,getInitialState:()=>m,subscribe:p=>(t.add(p),()=>t.delete(p))},m=e=n(i,r,h);return h},mN=n=>n?Zg(n):Zg,pN=n=>n;function gN(n,e=pN){const t=Ps.useSyncExternalStore(n.subscribe,Ps.useCallback(()=>e(n.getState()),[n,e]),Ps.useCallback(()=>e(n.getInitialState()),[n,e]));return Ps.useDebugValue(t),t}const ey=n=>{const e=mN(n),t=i=>gN(e,i);return Object.assign(t,e),t},Av=n=>n?ey(n):ey,yN="modulepreload",vN=function(n){return"/"+n},ty={},hr=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let c=function(p){return Promise.all(p.map(y=>Promise.resolve(y).then(T=>({status:"fulfilled",value:T}),T=>({status:"rejected",reason:T}))))};document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),m=(h==null?void 0:h.nonce)||(h==null?void 0:h.getAttribute("nonce"));r=c(t.map(p=>{if(p=vN(p),p in ty)return;ty[p]=!0;const y=p.endsWith(".css"),T=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${T}`))return;const x=document.createElement("link");if(x.rel=y?"stylesheet":yN,y||(x.as="script"),x.crossOrigin="",x.href=p,m&&x.setAttribute("nonce",m),document.head.appendChild(x),y)return new Promise((C,_)=>{x.addEventListener("load",C),x.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${p}`)))})}))}function a(c){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=c,window.dispatchEvent(h),!h.defaultPrevented)throw c}return r.then(c=>{for(const h of c||[])h.status==="rejected"&&a(h.reason);return e().catch(a)})},TN=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>hr(async()=>{const{default:i}=await Promise.resolve().then(()=>Js);return{default:i}},void 0).then(({default:i})=>i(...t)):e=fetch,(...t)=>e(...t)};class Sd extends Error{constructor(e,t="FunctionsError",i){super(e),this.name=t,this.context=i}}class SN extends Sd{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class ny extends Sd{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class iy extends Sd{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var ju;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(ju||(ju={}));var xN=function(n,e,t,i){function r(a){return a instanceof t?a:new t(function(c){c(a)})}return new(t||(t=Promise))(function(a,c){function h(y){try{p(i.next(y))}catch(T){c(T)}}function m(y){try{p(i.throw(y))}catch(T){c(T)}}function p(y){y.done?a(y.value):r(y.value).then(h,m)}p((i=i.apply(n,e||[])).next())})};class EN{constructor(e,{headers:t={},customFetch:i,region:r=ju.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=TN(i)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var i;return xN(this,void 0,void 0,function*(){try{const{headers:r,method:a,body:c}=t;let h={},{region:m}=t;m||(m=this.region);const p=new URL(`${this.url}/${e}`);m&&m!=="any"&&(h["x-region"]=m,p.searchParams.set("forceFunctionRegion",m));let y;c&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&(typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",y=c):typeof c=="string"?(h["Content-Type"]="text/plain",y=c):typeof FormData<"u"&&c instanceof FormData?y=c:(h["Content-Type"]="application/json",y=JSON.stringify(c)));const T=yield this.fetch(p.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),r),body:y}).catch(w=>{throw new SN(w)}),x=T.headers.get("x-relay-error");if(x&&x==="true")throw new ny(T);if(!T.ok)throw new iy(T);let C=((i=T.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),_;return C==="application/json"?_=yield T.json():C==="application/octet-stream"?_=yield T.blob():C==="text/event-stream"?_=T:C==="multipart/form-data"?_=yield T.formData():_=yield T.text(),{data:_,error:null,response:T}}catch(r){return{data:null,error:r,response:r instanceof iy||r instanceof ny?r.context:void 0}}})}}var ut={},Ss={},xs={},Es={},Cs={},As={},CN=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Gs=CN();const AN=Gs.fetch,_v=Gs.fetch.bind(Gs),wv=Gs.Headers,_N=Gs.Request,wN=Gs.Response,Js=Object.freeze(Object.defineProperty({__proto__:null,Headers:wv,Request:_N,Response:wN,default:_v,fetch:AN},Symbol.toStringTag,{value:"Module"})),bN=gS(Js);var Ia={},sy;function bv(){if(sy)return Ia;sy=1,Object.defineProperty(Ia,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Ia.default=n,Ia}var oy;function Rv(){if(oy)return As;oy=1;var n=As&&As.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(As,"__esModule",{value:!0});const e=n(bN),t=n(bv());class i{constructor(a){this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=a.headers,this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=a.shouldThrowOnError,this.signal=a.signal,this.isMaybeSingle=a.isMaybeSingle,a.fetch?this.fetch=a.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,c){return this.headers=Object.assign({},this.headers),this.headers[a]=c,this}then(a,c){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const h=this.fetch;let m=h(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async p=>{var y,T,x;let C=null,_=null,w=null,N=p.status,H=p.statusText;if(p.ok){if(this.method!=="HEAD"){const Y=await p.text();Y===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?_=Y:_=JSON.parse(Y))}const I=(y=this.headers.Prefer)===null||y===void 0?void 0:y.match(/count=(exact|planned|estimated)/),Q=(T=p.headers.get("content-range"))===null||T===void 0?void 0:T.split("/");I&&Q&&Q.length>1&&(w=parseInt(Q[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(_)&&(_.length>1?(C={code:"PGRST116",details:`Results contain ${_.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},_=null,w=null,N=406,H="Not Acceptable"):_.length===1?_=_[0]:_=null)}else{const I=await p.text();try{C=JSON.parse(I),Array.isArray(C)&&p.status===404&&(_=[],C=null,N=200,H="OK")}catch{p.status===404&&I===""?(N=204,H="No Content"):C={message:I}}if(C&&this.isMaybeSingle&&(!((x=C==null?void 0:C.details)===null||x===void 0)&&x.includes("0 rows"))&&(C=null,N=200,H="OK"),C&&this.shouldThrowOnError)throw new t.default(C)}return{error:C,data:_,count:w,status:N,statusText:H}});return this.shouldThrowOnError||(m=m.catch(p=>{var y,T,x;return{error:{message:`${(y=p==null?void 0:p.name)!==null&&y!==void 0?y:"FetchError"}: ${p==null?void 0:p.message}`,details:`${(T=p==null?void 0:p.stack)!==null&&T!==void 0?T:""}`,hint:"",code:`${(x=p==null?void 0:p.code)!==null&&x!==void 0?x:""}`},data:null,count:null,status:0,statusText:""}})),m.then(a,c)}returns(){return this}overrideTypes(){return this}}return As.default=i,As}var ry;function Mv(){if(ry)return Cs;ry=1;var n=Cs&&Cs.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Cs,"__esModule",{value:!0});const e=n(Rv());class t extends e.default{select(r){let a=!1;const c=(r??"*").split("").map(h=>/\s/.test(h)&&!a?"":(h==='"'&&(a=!a),h)).join("");return this.url.searchParams.set("select",c),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(r,{ascending:a=!0,nullsFirst:c,foreignTable:h,referencedTable:m=h}={}){const p=m?`${m}.order`:"order",y=this.url.searchParams.get(p);return this.url.searchParams.set(p,`${y?`${y},`:""}${r}.${a?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:a,referencedTable:c=a}={}){const h=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(h,`${r}`),this}range(r,a,{foreignTable:c,referencedTable:h=c}={}){const m=typeof h>"u"?"offset":`${h}.offset`,p=typeof h>"u"?"limit":`${h}.limit`;return this.url.searchParams.set(m,`${r}`),this.url.searchParams.set(p,`${a-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:r=!1,verbose:a=!1,settings:c=!1,buffers:h=!1,wal:m=!1,format:p="text"}={}){var y;const T=[r?"analyze":null,a?"verbose":null,c?"settings":null,h?"buffers":null,m?"wal":null].filter(Boolean).join("|"),x=(y=this.headers.Accept)!==null&&y!==void 0?y:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${p}; for="${x}"; options=${T};`,p==="json"?this:this}rollback(){var r;return((r=this.headers.Prefer)!==null&&r!==void 0?r:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return Cs.default=t,Cs}var ay;function xd(){if(ay)return Es;ay=1;var n=Es&&Es.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Es,"__esModule",{value:!0});const e=n(Mv());class t extends e.default{eq(r,a){return this.url.searchParams.append(r,`eq.${a}`),this}neq(r,a){return this.url.searchParams.append(r,`neq.${a}`),this}gt(r,a){return this.url.searchParams.append(r,`gt.${a}`),this}gte(r,a){return this.url.searchParams.append(r,`gte.${a}`),this}lt(r,a){return this.url.searchParams.append(r,`lt.${a}`),this}lte(r,a){return this.url.searchParams.append(r,`lte.${a}`),this}like(r,a){return this.url.searchParams.append(r,`like.${a}`),this}likeAllOf(r,a){return this.url.searchParams.append(r,`like(all).{${a.join(",")}}`),this}likeAnyOf(r,a){return this.url.searchParams.append(r,`like(any).{${a.join(",")}}`),this}ilike(r,a){return this.url.searchParams.append(r,`ilike.${a}`),this}ilikeAllOf(r,a){return this.url.searchParams.append(r,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(r,a){return this.url.searchParams.append(r,`ilike(any).{${a.join(",")}}`),this}is(r,a){return this.url.searchParams.append(r,`is.${a}`),this}in(r,a){const c=Array.from(new Set(a)).map(h=>typeof h=="string"&&new RegExp("[,()]").test(h)?`"${h}"`:`${h}`).join(",");return this.url.searchParams.append(r,`in.(${c})`),this}contains(r,a){return typeof a=="string"?this.url.searchParams.append(r,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(r,`cs.{${a.join(",")}}`):this.url.searchParams.append(r,`cs.${JSON.stringify(a)}`),this}containedBy(r,a){return typeof a=="string"?this.url.searchParams.append(r,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(r,`cd.{${a.join(",")}}`):this.url.searchParams.append(r,`cd.${JSON.stringify(a)}`),this}rangeGt(r,a){return this.url.searchParams.append(r,`sr.${a}`),this}rangeGte(r,a){return this.url.searchParams.append(r,`nxl.${a}`),this}rangeLt(r,a){return this.url.searchParams.append(r,`sl.${a}`),this}rangeLte(r,a){return this.url.searchParams.append(r,`nxr.${a}`),this}rangeAdjacent(r,a){return this.url.searchParams.append(r,`adj.${a}`),this}overlaps(r,a){return typeof a=="string"?this.url.searchParams.append(r,`ov.${a}`):this.url.searchParams.append(r,`ov.{${a.join(",")}}`),this}textSearch(r,a,{config:c,type:h}={}){let m="";h==="plain"?m="pl":h==="phrase"?m="ph":h==="websearch"&&(m="w");const p=c===void 0?"":`(${c})`;return this.url.searchParams.append(r,`${m}fts${p}.${a}`),this}match(r){return Object.entries(r).forEach(([a,c])=>{this.url.searchParams.append(a,`eq.${c}`)}),this}not(r,a,c){return this.url.searchParams.append(r,`not.${a}.${c}`),this}or(r,{foreignTable:a,referencedTable:c=a}={}){const h=c?`${c}.or`:"or";return this.url.searchParams.append(h,`(${r})`),this}filter(r,a,c){return this.url.searchParams.append(r,`${a}.${c}`),this}}return Es.default=t,Es}var ly;function Nv(){if(ly)return xs;ly=1;var n=xs&&xs.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(xs,"__esModule",{value:!0});const e=n(xd());class t{constructor(r,{headers:a={},schema:c,fetch:h}){this.url=r,this.headers=a,this.schema=c,this.fetch=h}select(r,{head:a=!1,count:c}={}){const h=a?"HEAD":"GET";let m=!1;const p=(r??"*").split("").map(y=>/\s/.test(y)&&!m?"":(y==='"'&&(m=!m),y)).join("");return this.url.searchParams.set("select",p),c&&(this.headers.Prefer=`count=${c}`),new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(r,{count:a,defaultToNull:c=!0}={}){const h="POST",m=[];if(this.headers.Prefer&&m.push(this.headers.Prefer),a&&m.push(`count=${a}`),c||m.push("missing=default"),this.headers.Prefer=m.join(","),Array.isArray(r)){const p=r.reduce((y,T)=>y.concat(Object.keys(T)),[]);if(p.length>0){const y=[...new Set(p)].map(T=>`"${T}"`);this.url.searchParams.set("columns",y.join(","))}}return new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:this.fetch,allowEmpty:!1})}upsert(r,{onConflict:a,ignoreDuplicates:c=!1,count:h,defaultToNull:m=!0}={}){const p="POST",y=[`resolution=${c?"ignore":"merge"}-duplicates`];if(a!==void 0&&this.url.searchParams.set("on_conflict",a),this.headers.Prefer&&y.push(this.headers.Prefer),h&&y.push(`count=${h}`),m||y.push("missing=default"),this.headers.Prefer=y.join(","),Array.isArray(r)){const T=r.reduce((x,C)=>x.concat(Object.keys(C)),[]);if(T.length>0){const x=[...new Set(T)].map(C=>`"${C}"`);this.url.searchParams.set("columns",x.join(","))}}return new e.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:this.fetch,allowEmpty:!1})}update(r,{count:a}={}){const c="PATCH",h=[];return this.headers.Prefer&&h.push(this.headers.Prefer),a&&h.push(`count=${a}`),this.headers.Prefer=h.join(","),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:this.fetch,allowEmpty:!1})}delete({count:r}={}){const a="DELETE",c=[];return r&&c.push(`count=${r}`),this.headers.Prefer&&c.unshift(this.headers.Prefer),this.headers.Prefer=c.join(","),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return xs.default=t,xs}var Qo={},Zo={},cy;function RN(){return cy||(cy=1,Object.defineProperty(Zo,"__esModule",{value:!0}),Zo.version=void 0,Zo.version="0.0.0-automated"),Zo}var uy;function MN(){if(uy)return Qo;uy=1,Object.defineProperty(Qo,"__esModule",{value:!0}),Qo.DEFAULT_HEADERS=void 0;const n=RN();return Qo.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${n.version}`},Qo}var dy;function NN(){if(dy)return Ss;dy=1;var n=Ss&&Ss.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Ss,"__esModule",{value:!0});const e=n(Nv()),t=n(xd()),i=MN();class r{constructor(c,{headers:h={},schema:m,fetch:p}={}){this.url=c,this.headers=Object.assign(Object.assign({},i.DEFAULT_HEADERS),h),this.schemaName=m,this.fetch=p}from(c){const h=new URL(`${this.url}/${c}`);return new e.default(h,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(c){return new r(this.url,{headers:this.headers,schema:c,fetch:this.fetch})}rpc(c,h={},{head:m=!1,get:p=!1,count:y}={}){let T;const x=new URL(`${this.url}/rpc/${c}`);let C;m||p?(T=m?"HEAD":"GET",Object.entries(h).filter(([w,N])=>N!==void 0).map(([w,N])=>[w,Array.isArray(N)?`{${N.join(",")}}`:`${N}`]).forEach(([w,N])=>{x.searchParams.append(w,N)})):(T="POST",C=h);const _=Object.assign({},this.headers);return y&&(_.Prefer=`count=${y}`),new t.default({method:T,url:x,headers:_,schema:this.schemaName,body:C,fetch:this.fetch,allowEmpty:!1})}}return Ss.default=r,Ss}var fy;function kN(){if(fy)return ut;fy=1;var n=ut&&ut.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(ut,"__esModule",{value:!0}),ut.PostgrestError=ut.PostgrestBuilder=ut.PostgrestTransformBuilder=ut.PostgrestFilterBuilder=ut.PostgrestQueryBuilder=ut.PostgrestClient=void 0;const e=n(NN());ut.PostgrestClient=e.default;const t=n(Nv());ut.PostgrestQueryBuilder=t.default;const i=n(xd());ut.PostgrestFilterBuilder=i.default;const r=n(Mv());ut.PostgrestTransformBuilder=r.default;const a=n(Rv());ut.PostgrestBuilder=a.default;const c=n(bv());return ut.PostgrestError=c.default,ut.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:i.default,PostgrestTransformBuilder:r.default,PostgrestBuilder:a.default,PostgrestError:c.default},ut}var IN=kN();const DN=od(IN),{PostgrestClient:LN,PostgrestQueryBuilder:FI,PostgrestFilterBuilder:YI,PostgrestTransformBuilder:JI,PostgrestBuilder:jI,PostgrestError:KI}=DN;class PN{static dynamicRequire(e){try{return typeof process<"u"&&process.versions&&process.versions.node&&typeof require<"u"?require(e):null}catch{return null}}static detectEnvironment(){var e,t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const i=parseInt(process.versions.node.split(".")[0]);if(i>=22)try{if(typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};const r=this.dynamicRequire("undici");if(r&&r.WebSocket)return{type:"native",constructor:r.WebSocket};throw new Error("undici not available")}catch{return{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:'Install the "ws" package or check your Node.js installation.'}}try{const r=this.dynamicRequire("ws");if(r)return{type:"ws",constructor:(t=r.WebSocket)!==null&&t!==void 0?t:r};throw new Error("ws package not available")}catch{return{type:"unsupported",error:`Node.js ${i} detected without WebSocket support.`,workaround:'Install the "ws" package: npm install ws'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const i=this.getWebSocketConstructor();return new i(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const UN="2.15.0",ON=`realtime-js/${UN}`,BN="1.0.0",Ku=1e4,HN=1e3,VN=100;var or;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(or||(or={}));var st;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(st||(st={}));var Qt;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(Qt||(Qt={}));var Wu;(function(n){n.websocket="websocket"})(Wu||(Wu={}));var Ai;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Ai||(Ai={}));class GN{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),i=new TextDecoder;return this._decodeBroadcast(e,t,i)}_decodeBroadcast(e,t,i){const r=t.getUint8(1),a=t.getUint8(2);let c=this.HEADER_LENGTH+2;const h=i.decode(e.slice(c,c+r));c=c+r;const m=i.decode(e.slice(c,c+a));c=c+a;const p=JSON.parse(i.decode(e.slice(c,e.byteLength)));return{ref:null,topic:h,event:m,payload:p}}}class kv{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ye;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Ye||(Ye={}));const hy=(n,e,t={})=>{var i;const r=(i=t.skipTypes)!==null&&i!==void 0?i:[];return Object.keys(e).reduce((a,c)=>(a[c]=qN(c,n,e,r),a),{})},qN=(n,e,t,i)=>{const r=e.find(h=>h.name===n),a=r==null?void 0:r.type,c=t[n];return a&&!i.includes(a)?Iv(a,c):Xu(c)},Iv=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return YN(e,t)}switch(n){case Ye.bool:return zN(e);case Ye.float4:case Ye.float8:case Ye.int2:case Ye.int4:case Ye.int8:case Ye.numeric:case Ye.oid:return $N(e);case Ye.json:case Ye.jsonb:return FN(e);case Ye.timestamp:return JN(e);case Ye.abstime:case Ye.date:case Ye.daterange:case Ye.int4range:case Ye.int8range:case Ye.money:case Ye.reltime:case Ye.text:case Ye.time:case Ye.timestamptz:case Ye.timetz:case Ye.tsrange:case Ye.tstzrange:return Xu(e);default:return Xu(e)}},Xu=n=>n,zN=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},$N=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},FN=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},YN=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,i=n[t];if(n[0]==="{"&&i==="}"){let a;const c=n.slice(1,t);try{a=JSON.parse("["+c+"]")}catch{a=c?c.split(","):[]}return a.map(h=>Iv(e,h))}return n},JN=n=>typeof n=="string"?n.replace(" ","T"):n,Dv=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class Cu{constructor(e,t,i={},r=Ku){this.channel=e,this.event=t,this.payload=i,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var i;return this._hasReceived(e)&&t((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(i=>i.status===e).forEach(i=>i.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var my;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(my||(my={}));class rr{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},r=>{const{onJoin:a,onLeave:c,onSync:h}=this.caller;this.joinRef=this.channel._joinRef(),this.state=rr.syncState(this.state,r,a,c),this.pendingDiffs.forEach(m=>{this.state=rr.syncDiff(this.state,m,a,c)}),this.pendingDiffs=[],h()}),this.channel._on(i.diff,{},r=>{const{onJoin:a,onLeave:c,onSync:h}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=rr.syncDiff(this.state,r,a,c),h())}),this.onJoin((r,a,c)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:a,newPresences:c})}),this.onLeave((r,a,c)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:a,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,i,r){const a=this.cloneDeep(e),c=this.transformState(t),h={},m={};return this.map(a,(p,y)=>{c[p]||(m[p]=y)}),this.map(c,(p,y)=>{const T=a[p];if(T){const x=y.map(N=>N.presence_ref),C=T.map(N=>N.presence_ref),_=y.filter(N=>C.indexOf(N.presence_ref)<0),w=T.filter(N=>x.indexOf(N.presence_ref)<0);_.length>0&&(h[p]=_),w.length>0&&(m[p]=w)}else h[p]=y}),this.syncDiff(a,{joins:h,leaves:m},i,r)}static syncDiff(e,t,i,r){const{joins:a,leaves:c}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return i||(i=()=>{}),r||(r=()=>{}),this.map(a,(h,m)=>{var p;const y=(p=e[h])!==null&&p!==void 0?p:[];if(e[h]=this.cloneDeep(m),y.length>0){const T=e[h].map(C=>C.presence_ref),x=y.filter(C=>T.indexOf(C.presence_ref)<0);e[h].unshift(...x)}i(h,y,m)}),this.map(c,(h,m)=>{let p=e[h];if(!p)return;const y=m.map(T=>T.presence_ref);p=p.filter(T=>y.indexOf(T.presence_ref)<0),e[h]=p,r(h,p,m),p.length===0&&delete e[h]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(i=>t(i,e[i]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,i)=>{const r=e[i];return"metas"in r?t[i]=r.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):t[i]=r,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var py;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(py||(py={}));var ar;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(ar||(ar={}));var An;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(An||(An={}));class Ed{constructor(e,t={config:{}},i){this.topic=e,this.params=t,this.socket=i,this.bindings={},this.state=st.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Cu(this,Qt.join,this.params,this.timeout),this.rejoinTimer=new kv(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=st.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(r=>r.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=st.closed,this.socket._remove(this)}),this._onError(r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=st.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=st.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=st.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Qt.reply,{},(r,a)=>{this._trigger(this._replyEventName(a),r)}),this.presence=new rr(this),this.broadcastEndpointURL=Dv(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var i,r;if(this.socket.isConnected()||this.socket.connect(),this.state==st.closed){const{config:{broadcast:a,presence:c,private:h}}=this.params,m=(r=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(x=>x.filter))!==null&&r!==void 0?r:[],p=!!this.bindings[ar.PRESENCE]&&this.bindings[ar.PRESENCE].length>0,y={},T={broadcast:a,presence:Object.assign(Object.assign({},c),{enabled:p}),postgres_changes:m,private:h};this.socket.accessTokenValue&&(y.access_token=this.socket.accessTokenValue),this._onError(x=>e==null?void 0:e(An.CHANNEL_ERROR,x)),this._onClose(()=>e==null?void 0:e(An.CLOSED)),this.updateJoinPayload(Object.assign({config:T},y)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:x})=>{var C;if(this.socket.setAuth(),x===void 0){e==null||e(An.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,w=(C=_==null?void 0:_.length)!==null&&C!==void 0?C:0,N=[];for(let H=0;H<w;H++){const K=_[H],{filter:{event:I,schema:Q,table:Y,filter:oe}}=K,ce=x&&x[H];if(ce&&ce.event===I&&ce.schema===Q&&ce.table===Y&&ce.filter===oe)N.push(Object.assign(Object.assign({},K),{id:ce.id}));else{this.unsubscribe(),this.state=st.errored,e==null||e(An.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=N,e&&e(An.SUBSCRIBED);return}}).receive("error",x=>{this.state=st.errored,e==null||e(An.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(x).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(An.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,i){return this.state===st.joined&&e===ar.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,i)}async send(e,t={}){var i,r;if(!this._canPush()&&e.type==="broadcast"){const{event:a,payload:c}=e,m={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:c,private:this.private}]})};try{const p=await this._fetchWithTimeout(this.broadcastEndpointURL,m,(i=t.timeout)!==null&&i!==void 0?i:this.timeout);return await((r=p.body)===null||r===void 0?void 0:r.cancel()),p.ok?"ok":"error"}catch(p){return p.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var c,h,m;const p=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((m=(h=(c=this.params)===null||c===void 0?void 0:c.config)===null||h===void 0?void 0:h.broadcast)===null||m===void 0)&&m.ack)&&a("ok"),p.receive("ok",()=>a("ok")),p.receive("error",()=>a("error")),p.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=st.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Qt.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(r=>{i=new Cu(this,Qt.leave,{},e),i.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i==null||i.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=st.closed,this.bindings={}}async _fetchWithTimeout(e,t,i){const r=new AbortController,a=setTimeout(()=>r.abort(),i),c=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(a),c}_push(e,t,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Cu(this,e,t,i);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>VN){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,i){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,i){var r,a;const c=e.toLocaleLowerCase(),{close:h,error:m,leave:p,join:y}=Qt;if(i&&[h,m,p,y].indexOf(c)>=0&&i!==this._joinRef())return;let x=this._onMessage(c,t,i);if(t&&!x)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(C=>{var _,w,N;return((_=C.filter)===null||_===void 0?void 0:_.event)==="*"||((N=(w=C.filter)===null||w===void 0?void 0:w.event)===null||N===void 0?void 0:N.toLocaleLowerCase())===c}).map(C=>C.callback(x,i)):(a=this.bindings[c])===null||a===void 0||a.filter(C=>{var _,w,N,H,K,I;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in C){const Q=C.id,Y=(_=C.filter)===null||_===void 0?void 0:_.event;return Q&&((w=t.ids)===null||w===void 0?void 0:w.includes(Q))&&(Y==="*"||(Y==null?void 0:Y.toLocaleLowerCase())===((N=t.data)===null||N===void 0?void 0:N.type.toLocaleLowerCase()))}else{const Q=(K=(H=C==null?void 0:C.filter)===null||H===void 0?void 0:H.event)===null||K===void 0?void 0:K.toLocaleLowerCase();return Q==="*"||Q===((I=t==null?void 0:t.event)===null||I===void 0?void 0:I.toLocaleLowerCase())}else return C.type.toLocaleLowerCase()===c}).map(C=>{if(typeof x=="object"&&"ids"in x){const _=x.data,{schema:w,table:N,commit_timestamp:H,type:K,errors:I}=_;x=Object.assign(Object.assign({},{schema:w,table:N,commit_timestamp:H,eventType:K,new:{},old:{},errors:I}),this._getPayloadRecords(_))}C.callback(x,i)})}_isClosed(){return this.state===st.closed}_isJoined(){return this.state===st.joined}_isJoining(){return this.state===st.joining}_isLeaving(){return this.state===st.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,i){const r=e.toLocaleLowerCase(),a={type:r,filter:t,callback:i};return this.bindings[r]?this.bindings[r].push(a):this.bindings[r]=[a],this}_off(e,t){const i=e.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(r=>{var a;return!(((a=r.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===i&&Ed.isEqual(r.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(e[i]!==t[i])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Qt.close,{},e)}_onError(e){this._on(Qt.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=st.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=hy(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=hy(e.columns,e.old_record)),t}}const gy=()=>{},Da={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},jN=[1e3,2e3,5e3,1e4],KN=1e4,WN=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class XN{constructor(e,t){var i;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Ku,this.transport=null,this.heartbeatIntervalMs=Da.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=gy,this.ref=0,this.reconnectTimer=null,this.logger=gy,this.conn=null,this.sendBuffer=[],this.serializer=new GN,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=r=>{let a;return r?a=r:typeof fetch>"u"?a=(...c)=>hr(async()=>{const{default:h}=await Promise.resolve().then(()=>Js);return{default:h}},void 0).then(({default:h})=>h(...c)).catch(h=>{throw new Error(`Failed to load @supabase/node-fetch: ${h.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):a=fetch,(...c)=>a(...c)},!(!((i=t==null?void 0:t.params)===null||i===void 0)&&i.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${Wu.websocket}`,this.httpEndpoint=Dv(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=PN.createWebSocket(this.endpointURL())}catch(e){throw this._setConnectionState("disconnected"),new Error(`WebSocket not available: ${e.message}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:BN}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,i){this.logger(e,t,i)}connectionState(){switch(this.conn&&this.conn.readyState){case or.connecting:return Ai.Connecting;case or.open:return Ai.Open;case or.closing:return Ai.Closing;default:return Ai.Closed}}isConnected(){return this.connectionState()===Ai.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const i=`realtime:${e}`,r=this.getChannels().find(a=>a.topic===i);if(r)return r;{const a=new Ed(`realtime:${e}`,t,this);return this.channels.push(a),a}}push(e){const{topic:t,event:i,payload:r,ref:a}=e,c=()=>{this.encode(e,h=>{var m;(m=this.conn)===null||m===void 0||m.send(h)})};this.log("push",`${t} ${i} (${a})`,r),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(HN,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Da.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(i=>i.topic===e&&(i._isJoined()||i._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{t.topic==="phoenix"&&t.event==="phx_reply"&&this.heartbeatCallback(t.payload.status==="ok"?"ok":"error"),t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:i,event:r,payload:a,ref:c}=t,h=c?`(${c})`:"",m=a.status||"";this.log("receive",`${m} ${i} ${r} ${h}`.trim(),a),this.channels.filter(p=>p._isMember(i)).forEach(p=>p._trigger(r,a,c)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Qt.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const i=e.match(/\?/)?"&":"?",r=new URLSearchParams(t);return`${e}${i}${r}`}_workerObjectUrl(e){let t;if(e)t=e;else{const i=new Blob([WN],{type:"application/javascript"});t=URL.createObjectURL(i)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(i=>{const r={access_token:t,version:ON};t&&i.updateJoinPayload(r),i.joinedOnce&&i._isJoined()&&i._push(Qt.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(i=>{try{i(t)}catch(r){this.log("error",`error in ${e} callback`,r)}})}catch(i){this.log("error",`error triggering ${e} callbacks`,i)}}_setupReconnectionTimer(){this.reconnectTimer=new kv(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Da.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,i,r,a,c,h,m,p;if(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(i=e==null?void 0:e.timeout)!==null&&i!==void 0?i:Ku,this.heartbeatIntervalMs=(r=e==null?void 0:e.heartbeatIntervalMs)!==null&&r!==void 0?r:Da.HEARTBEAT_INTERVAL,this.worker=(a=e==null?void 0:e.worker)!==null&&a!==void 0?a:!1,this.accessToken=(c=e==null?void 0:e.accessToken)!==null&&c!==void 0?c:null,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(h=e==null?void 0:e.reconnectAfterMs)!==null&&h!==void 0?h:y=>jN[y-1]||KN,this.encode=(m=e==null?void 0:e.encode)!==null&&m!==void 0?m:(y,T)=>T(JSON.stringify(y)),this.decode=(p=e==null?void 0:e.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class Cd extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function ft(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class QN extends Cd{constructor(e,t,i){super(e),this.name="StorageApiError",this.status=t,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Qu extends Cd{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var ZN=function(n,e,t,i){function r(a){return a instanceof t?a:new t(function(c){c(a)})}return new(t||(t=Promise))(function(a,c){function h(y){try{p(i.next(y))}catch(T){c(T)}}function m(y){try{p(i.throw(y))}catch(T){c(T)}}function p(y){y.done?a(y.value):r(y.value).then(h,m)}p((i=i.apply(n,e||[])).next())})};const Lv=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>hr(async()=>{const{default:i}=await Promise.resolve().then(()=>Js);return{default:i}},void 0).then(({default:i})=>i(...t)):e=fetch,(...t)=>e(...t)},ek=()=>ZN(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield hr(()=>Promise.resolve().then(()=>Js),void 0)).Response:Response}),Zu=n=>{if(Array.isArray(n))return n.map(t=>Zu(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,i])=>{const r=t.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[r]=Zu(i)}),e},tk=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)};var Ii=function(n,e,t,i){function r(a){return a instanceof t?a:new t(function(c){c(a)})}return new(t||(t=Promise))(function(a,c){function h(y){try{p(i.next(y))}catch(T){c(T)}}function m(y){try{p(i.throw(y))}catch(T){c(T)}}function p(y){y.done?a(y.value):r(y.value).then(h,m)}p((i=i.apply(n,e||[])).next())})};const Au=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),nk=(n,e,t)=>Ii(void 0,void 0,void 0,function*(){const i=yield ek();n instanceof i&&!(t!=null&&t.noResolveJson)?n.json().then(r=>{const a=n.status||500,c=(r==null?void 0:r.statusCode)||a+"";e(new QN(Au(r),a,c))}).catch(r=>{e(new Qu(Au(r),r))}):e(new Qu(Au(n),n))}),ik=(n,e,t,i)=>{const r={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"||!i?r:(tk(i)?(r.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(i)):r.body=i,Object.assign(Object.assign({},r),t))};function mr(n,e,t,i,r,a){return Ii(this,void 0,void 0,function*(){return new Promise((c,h)=>{n(t,ik(e,i,r,a)).then(m=>{if(!m.ok)throw m;return i!=null&&i.noResolveJson?m:m.json()}).then(m=>c(m)).catch(m=>nk(m,h,i))})})}function ja(n,e,t,i){return Ii(this,void 0,void 0,function*(){return mr(n,"GET",e,t,i)})}function _n(n,e,t,i,r){return Ii(this,void 0,void 0,function*(){return mr(n,"POST",e,i,r,t)})}function ed(n,e,t,i,r){return Ii(this,void 0,void 0,function*(){return mr(n,"PUT",e,i,r,t)})}function sk(n,e,t,i){return Ii(this,void 0,void 0,function*(){return mr(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),i)})}function Pv(n,e,t,i,r){return Ii(this,void 0,void 0,function*(){return mr(n,"DELETE",e,i,r,t)})}var wt=function(n,e,t,i){function r(a){return a instanceof t?a:new t(function(c){c(a)})}return new(t||(t=Promise))(function(a,c){function h(y){try{p(i.next(y))}catch(T){c(T)}}function m(y){try{p(i.throw(y))}catch(T){c(T)}}function p(y){y.done?a(y.value):r(y.value).then(h,m)}p((i=i.apply(n,e||[])).next())})};const ok={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},yy={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class rk{constructor(e,t={},i,r){this.url=e,this.headers=t,this.bucketId=i,this.fetch=Lv(r)}uploadOrUpdate(e,t,i,r){return wt(this,void 0,void 0,function*(){try{let a;const c=Object.assign(Object.assign({},yy),r);let h=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(c.upsert)});const m=c.metadata;typeof Blob<"u"&&i instanceof Blob?(a=new FormData,a.append("cacheControl",c.cacheControl),m&&a.append("metadata",this.encodeMetadata(m)),a.append("",i)):typeof FormData<"u"&&i instanceof FormData?(a=i,a.append("cacheControl",c.cacheControl),m&&a.append("metadata",this.encodeMetadata(m))):(a=i,h["cache-control"]=`max-age=${c.cacheControl}`,h["content-type"]=c.contentType,m&&(h["x-metadata"]=this.toBase64(this.encodeMetadata(m)))),r!=null&&r.headers&&(h=Object.assign(Object.assign({},h),r.headers));const p=this._removeEmptyFolders(t),y=this._getFinalPath(p),T=yield(e=="PUT"?ed:_n)(this.fetch,`${this.url}/object/${y}`,a,Object.assign({headers:h},c!=null&&c.duplex?{duplex:c.duplex}:{}));return{data:{path:p,id:T.Id,fullPath:T.Key},error:null}}catch(a){if(ft(a))return{data:null,error:a};throw a}})}upload(e,t,i){return wt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,i)})}uploadToSignedUrl(e,t,i,r){return wt(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),c=this._getFinalPath(a),h=new URL(this.url+`/object/upload/sign/${c}`);h.searchParams.set("token",t);try{let m;const p=Object.assign({upsert:yy.upsert},r),y=Object.assign(Object.assign({},this.headers),{"x-upsert":String(p.upsert)});typeof Blob<"u"&&i instanceof Blob?(m=new FormData,m.append("cacheControl",p.cacheControl),m.append("",i)):typeof FormData<"u"&&i instanceof FormData?(m=i,m.append("cacheControl",p.cacheControl)):(m=i,y["cache-control"]=`max-age=${p.cacheControl}`,y["content-type"]=p.contentType);const T=yield ed(this.fetch,h.toString(),m,{headers:y});return{data:{path:a,fullPath:T.Key},error:null}}catch(m){if(ft(m))return{data:null,error:m};throw m}})}createSignedUploadUrl(e,t){return wt(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e);const r=Object.assign({},this.headers);t!=null&&t.upsert&&(r["x-upsert"]="true");const a=yield _n(this.fetch,`${this.url}/object/upload/sign/${i}`,{},{headers:r}),c=new URL(this.url+a.url),h=c.searchParams.get("token");if(!h)throw new Cd("No token returned by API");return{data:{signedUrl:c.toString(),path:e,token:h},error:null}}catch(i){if(ft(i))return{data:null,error:i};throw i}})}update(e,t,i){return wt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,i)})}move(e,t,i){return wt(this,void 0,void 0,function*(){try{return{data:yield _n(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(ft(r))return{data:null,error:r};throw r}})}copy(e,t,i){return wt(this,void 0,void 0,function*(){try{return{data:{path:(yield _n(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(ft(r))return{data:null,error:r};throw r}})}createSignedUrl(e,t,i){return wt(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),a=yield _n(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},i!=null&&i.transform?{transform:i.transform}:{}),{headers:this.headers});const c=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${c}`)},{data:a,error:null}}catch(r){if(ft(r))return{data:null,error:r};throw r}})}createSignedUrls(e,t,i){return wt(this,void 0,void 0,function*(){try{const r=yield _n(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),a=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return{data:r.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${a}`):null})),error:null}}catch(r){if(ft(r))return{data:null,error:r};throw r}})}download(e,t){return wt(this,void 0,void 0,function*(){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),c=a?`?${a}`:"";try{const h=this._getFinalPath(e);return{data:yield(yield ja(this.fetch,`${this.url}/${r}/${h}${c}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(h){if(ft(h))return{data:null,error:h};throw h}})}info(e){return wt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const i=yield ja(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Zu(i),error:null}}catch(i){if(ft(i))return{data:null,error:i};throw i}})}exists(e){return wt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield sk(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(i){if(ft(i)&&i instanceof Qu){const r=i.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:i}}throw i}})}getPublicUrl(e,t){const i=this._getFinalPath(e),r=[],a=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&r.push(a);const h=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",m=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});m!==""&&r.push(m);let p=r.join("&");return p!==""&&(p=`?${p}`),{data:{publicUrl:encodeURI(`${this.url}/${h}/public/${i}${p}`)}}}remove(e){return wt(this,void 0,void 0,function*(){try{return{data:yield Pv(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(ft(t))return{data:null,error:t};throw t}})}list(e,t,i){return wt(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},ok),t),{prefix:e||""});return{data:yield _n(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},i),error:null}}catch(r){if(ft(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const ak="2.10.4",lk={"X-Client-Info":`storage-js/${ak}`};var _s=function(n,e,t,i){function r(a){return a instanceof t?a:new t(function(c){c(a)})}return new(t||(t=Promise))(function(a,c){function h(y){try{p(i.next(y))}catch(T){c(T)}}function m(y){try{p(i.throw(y))}catch(T){c(T)}}function p(y){y.done?a(y.value):r(y.value).then(h,m)}p((i=i.apply(n,e||[])).next())})};class ck{constructor(e,t={},i,r){const a=new URL(e);r!=null&&r.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href,this.headers=Object.assign(Object.assign({},lk),t),this.fetch=Lv(i)}listBuckets(){return _s(this,void 0,void 0,function*(){try{return{data:yield ja(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(ft(e))return{data:null,error:e};throw e}})}getBucket(e){return _s(this,void 0,void 0,function*(){try{return{data:yield ja(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(ft(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return _s(this,void 0,void 0,function*(){try{return{data:yield _n(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(ft(i))return{data:null,error:i};throw i}})}updateBucket(e,t){return _s(this,void 0,void 0,function*(){try{return{data:yield ed(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(ft(i))return{data:null,error:i};throw i}})}emptyBucket(e){return _s(this,void 0,void 0,function*(){try{return{data:yield _n(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(ft(t))return{data:null,error:t};throw t}})}deleteBucket(e){return _s(this,void 0,void 0,function*(){try{return{data:yield Pv(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(ft(t))return{data:null,error:t};throw t}})}}class uk extends ck{constructor(e,t={},i,r){super(e,t,i,r)}from(e){return new rk(this.url,this.headers,e,this.fetch)}}const dk="2.54.0";let tr="";typeof Deno<"u"?tr="deno":typeof document<"u"?tr="web":typeof navigator<"u"&&navigator.product==="ReactNative"?tr="react-native":tr="node";const fk={"X-Client-Info":`supabase-js-${tr}/${dk}`},hk={headers:fk},mk={schema:"public"},pk={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},gk={};var yk=function(n,e,t,i){function r(a){return a instanceof t?a:new t(function(c){c(a)})}return new(t||(t=Promise))(function(a,c){function h(y){try{p(i.next(y))}catch(T){c(T)}}function m(y){try{p(i.throw(y))}catch(T){c(T)}}function p(y){y.done?a(y.value):r(y.value).then(h,m)}p((i=i.apply(n,e||[])).next())})};const vk=n=>{let e;return n?e=n:typeof fetch>"u"?e=_v:e=fetch,(...t)=>e(...t)},Tk=()=>typeof Headers>"u"?wv:Headers,Sk=(n,e,t)=>{const i=vk(t),r=Tk();return(a,c)=>yk(void 0,void 0,void 0,function*(){var h;const m=(h=yield e())!==null&&h!==void 0?h:n;let p=new r(c==null?void 0:c.headers);return p.has("apikey")||p.set("apikey",n),p.has("Authorization")||p.set("Authorization",`Bearer ${m}`),i(a,Object.assign(Object.assign({},c),{headers:p}))})};var xk=function(n,e,t,i){function r(a){return a instanceof t?a:new t(function(c){c(a)})}return new(t||(t=Promise))(function(a,c){function h(y){try{p(i.next(y))}catch(T){c(T)}}function m(y){try{p(i.throw(y))}catch(T){c(T)}}function p(y){y.done?a(y.value):r(y.value).then(h,m)}p((i=i.apply(n,e||[])).next())})};function Ek(n){return n.endsWith("/")?n:n+"/"}function Ck(n,e){var t,i;const{db:r,auth:a,realtime:c,global:h}=n,{db:m,auth:p,realtime:y,global:T}=e,x={db:Object.assign(Object.assign({},m),r),auth:Object.assign(Object.assign({},p),a),realtime:Object.assign(Object.assign({},y),c),storage:{},global:Object.assign(Object.assign(Object.assign({},T),h),{headers:Object.assign(Object.assign({},(t=T==null?void 0:T.headers)!==null&&t!==void 0?t:{}),(i=h==null?void 0:h.headers)!==null&&i!==void 0?i:{})}),accessToken:()=>xk(this,void 0,void 0,function*(){return""})};return n.accessToken?x.accessToken=n.accessToken:delete x.accessToken,x}const Uv="2.71.1",Ds=30*1e3,td=3,_u=td*Ds,Ak="http://localhost:9999",_k="supabase.auth.token",wk={"X-Client-Info":`gotrue-js/${Uv}`},nd="X-Supabase-Api-Version",Ov={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},bk=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Rk=600*1e3;class Ad extends Error{constructor(e,t,i){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=i}}function Ee(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class Mk extends Ad{constructor(e,t,i){super(e,t,i),this.name="AuthApiError",this.status=t,this.code=i}}function Nk(n){return Ee(n)&&n.name==="AuthApiError"}class Bv extends Ad{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class ti extends Ad{constructor(e,t,i,r){super(e,i,r),this.name=t,this.status=i}}class Zn extends ti{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function kk(n){return Ee(n)&&n.name==="AuthSessionMissingError"}class La extends ti{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Pa extends ti{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ua extends ti{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Ik(n){return Ee(n)&&n.name==="AuthImplicitGrantRedirectError"}class vy extends ti{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class id extends ti{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function wu(n){return Ee(n)&&n.name==="AuthRetryableFetchError"}class Ty extends ti{constructor(e,t,i){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=i}}class sd extends ti{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ka="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Sy=` 	
\r=`.split(""),Dk=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<Sy.length;e+=1)n[Sy[e].charCodeAt(0)]=-2;for(let e=0;e<Ka.length;e+=1)n[Ka[e].charCodeAt(0)]=e;return n})();function xy(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t(Ka[i]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t(Ka[i]),e.queuedBits-=6}}function Hv(n,e,t){const i=Dk[n];if(i>-1)for(e.queue=e.queue<<6|i,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function Ey(n){const e=[],t=c=>{e.push(String.fromCodePoint(c))},i={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},a=c=>{Uk(c,i,t)};for(let c=0;c<n.length;c+=1)Hv(n.charCodeAt(c),r,a);return e.join("")}function Lk(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function Pk(n,e){for(let t=0;t<n.length;t+=1){let i=n.charCodeAt(t);if(i>55295&&i<=56319){const r=(i-55296)*1024&65535;i=(n.charCodeAt(t+1)-56320&65535|r)+65536,t+=1}Lk(i,e)}}function Uk(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let i=1;i<6;i+=1)if((n>>7-i&1)===0){e.utf8seq=i;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Ok(n){const e=[],t={queue:0,queuedBits:0},i=r=>{e.push(r)};for(let r=0;r<n.length;r+=1)Hv(n.charCodeAt(r),t,i);return new Uint8Array(e)}function Bk(n){const e=[];return Pk(n,t=>e.push(t)),new Uint8Array(e)}function Hk(n){const e=[],t={queue:0,queuedBits:0},i=r=>{e.push(r)};return n.forEach(r=>xy(r,t,i)),xy(null,t,i),e.join("")}function Vk(n){return Math.round(Date.now()/1e3)+n}function Gk(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const Xt=()=>typeof window<"u"&&typeof document<"u",xi={tested:!1,writable:!1},Vv=()=>{if(!Xt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(xi.tested)return xi.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),xi.tested=!0,xi.writable=!0}catch{xi.tested=!0,xi.writable=!1}return xi.writable};function qk(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((r,a)=>{e[a]=r})}catch{}return t.searchParams.forEach((i,r)=>{e[r]=i}),e}const Gv=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>hr(async()=>{const{default:i}=await Promise.resolve().then(()=>Js);return{default:i}},void 0).then(({default:i})=>i(...t)):e=fetch,(...t)=>e(...t)},zk=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Ls=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},Ei=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Qn=async(n,e)=>{await n.removeItem(e)};class il{constructor(){this.promise=new il.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}il.promiseConstructor=Promise;function bu(n){const e=n.split(".");if(e.length!==3)throw new sd("Invalid JWT structure");for(let i=0;i<e.length;i++)if(!bk.test(e[i]))throw new sd("JWT not in base64url format");return{header:JSON.parse(Ey(e[0])),payload:JSON.parse(Ey(e[1])),signature:Ok(e[2]),raw:{header:e[0],payload:e[1]}}}async function $k(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function Fk(n,e){return new Promise((i,r)=>{(async()=>{for(let a=0;a<1/0;a++)try{const c=await n(a);if(!e(a,null,c)){i(c);return}}catch(c){if(!e(a,c)){r(c);return}}})()})}function Yk(n){return("0"+n.toString(16)).substr(-2)}function Jk(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=t.length;let r="";for(let a=0;a<56;a++)r+=t.charAt(Math.floor(Math.random()*i));return r}return crypto.getRandomValues(e),Array.from(e,Yk).join("")}async function jk(n){const t=new TextEncoder().encode(n),i=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(i);return Array.from(r).map(a=>String.fromCharCode(a)).join("")}async function Kk(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await jk(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ws(n,e,t=!1){const i=Jk();let r=i;t&&(r+="/PASSWORD_RECOVERY"),await Ls(n,`${e}-code-verifier`,r);const a=await Kk(i);return[a,i===a?"plain":"s256"]}const Wk=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Xk(n){const e=n.headers.get(nd);if(!e||!e.match(Wk))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Qk(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function Zk(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const eI=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function bs(n){if(!eI.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Ru(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const i=t.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Cy(n){return JSON.parse(JSON.stringify(n))}var tI=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t};const Ci=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),nI=[502,503,504];async function Ay(n){var e;if(!zk(n))throw new id(Ci(n),0);if(nI.includes(n.status))throw new id(Ci(n),n.status);let t;try{t=await n.json()}catch(a){throw new Bv(Ci(a),a)}let i;const r=Xk(n);if(r&&r.getTime()>=Ov["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?i=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(i=t.error_code),i){if(i==="weak_password")throw new Ty(Ci(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(i==="session_not_found")throw new Zn}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((a,c)=>a&&typeof c=="string",!0))throw new Ty(Ci(t),n.status,t.weak_password.reasons);throw new Mk(Ci(t),n.status||500,i)}const iI=(n,e,t,i)=>{const r={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(i),Object.assign(Object.assign({},r),t))};async function Me(n,e,t,i){var r;const a=Object.assign({},i==null?void 0:i.headers);a[nd]||(a[nd]=Ov["2024-01-01"].name),i!=null&&i.jwt&&(a.Authorization=`Bearer ${i.jwt}`);const c=(r=i==null?void 0:i.query)!==null&&r!==void 0?r:{};i!=null&&i.redirectTo&&(c.redirect_to=i.redirectTo);const h=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",m=await sI(n,e,t+h,{headers:a,noResolveJson:i==null?void 0:i.noResolveJson},{},i==null?void 0:i.body);return i!=null&&i.xform?i==null?void 0:i.xform(m):{data:Object.assign({},m),error:null}}async function sI(n,e,t,i,r,a){const c=iI(e,i,r,a);let h;try{h=await n(t,Object.assign({},c))}catch(m){throw console.error(m),new id(Ci(m),0)}if(h.ok||await Ay(h),i!=null&&i.noResolveJson)return h;try{return await h.json()}catch(m){await Ay(m)}}function Cn(n){var e;let t=null;lI(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=Vk(n.expires_in)));const i=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:i},error:null}}function _y(n){const e=Cn(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,i)=>t&&typeof i=="string",!0)&&(e.data.weak_password=n.weak_password),e}function ei(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function oI(n){return{data:n,error:null}}function rI(n){const{action_link:e,email_otp:t,hashed_token:i,redirect_to:r,verification_type:a}=n,c=tI(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),h={action_link:e,email_otp:t,hashed_token:i,redirect_to:r,verification_type:a},m=Object.assign({},c);return{data:{properties:h,user:m},error:null}}function aI(n){return n}function lI(n){return n.access_token&&n.refresh_token&&n.expires_in}const Mu=["global","local","others"];var cI=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t};class uI{constructor({url:e="",headers:t={},fetch:i}){this.url=e,this.headers=t,this.fetch=Gv(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=Mu[0]){if(Mu.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Mu.join(", ")}`);try{return await Me(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(i){if(Ee(i))return{data:null,error:i};throw i}}async inviteUserByEmail(e,t={}){try{return await Me(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:ei})}catch(i){if(Ee(i))return{data:{user:null},error:i};throw i}}async generateLink(e){try{const{options:t}=e,i=cI(e,["options"]),r=Object.assign(Object.assign({},i),t);return"newEmail"in i&&(r.new_email=i==null?void 0:i.newEmail,delete r.newEmail),await Me(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:rI,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(Ee(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Me(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ei})}catch(t){if(Ee(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,i,r,a,c,h,m;try{const p={nextPage:null,lastPage:0,total:0},y=await Me(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:"",per_page:(a=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:""},xform:aI});if(y.error)throw y.error;const T=await y.json(),x=(c=y.headers.get("x-total-count"))!==null&&c!==void 0?c:0,C=(m=(h=y.headers.get("link"))===null||h===void 0?void 0:h.split(","))!==null&&m!==void 0?m:[];return C.length>0&&(C.forEach(_=>{const w=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),N=JSON.parse(_.split(";")[1].split("=")[1]);p[`${N}Page`]=w}),p.total=parseInt(x)),{data:Object.assign(Object.assign({},T),p),error:null}}catch(p){if(Ee(p))return{data:{users:[]},error:p};throw p}}async getUserById(e){bs(e);try{return await Me(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ei})}catch(t){if(Ee(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){bs(e);try{return await Me(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:ei})}catch(i){if(Ee(i))return{data:{user:null},error:i};throw i}}async deleteUser(e,t=!1){bs(e);try{return await Me(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:ei})}catch(i){if(Ee(i))return{data:{user:null},error:i};throw i}}async _listFactors(e){bs(e.userId);try{const{data:t,error:i}=await Me(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:t,error:i}}catch(t){if(Ee(t))return{data:null,error:t};throw t}}async _deleteFactor(e){bs(e.userId),bs(e.id);try{return{data:await Me(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Ee(t))return{data:null,error:t};throw t}}}function wy(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function dI(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Rs={debug:!!(globalThis&&Vv()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class qv extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class fI extends qv{}async function hI(n,e,t){Rs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const i=new globalThis.AbortController;return e>0&&setTimeout(()=>{i.abort(),Rs.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async r=>{if(r){Rs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,r.name);try{return await t()}finally{Rs.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,r.name)}}else{if(e===0)throw Rs.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new fI(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Rs.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}dI();const mI={url:Ak,storageKey:_k,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:wk,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function by(n,e,t){return await t()}const Ms={};class cr{constructor(e){var t,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=cr.nextInstanceID,cr.nextInstanceID+=1,this.instanceID>0&&Xt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},mI),e);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new uI({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=Gv(r.fetch),this.lock=r.lock||by,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:Xt()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=hI:this.lock=by,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(r.storage?this.storage=r.storage:Vv()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=wy(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=wy(this.memoryStorage)),Xt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=Ms[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Ms[this.storageKey]=Object.assign(Object.assign({},Ms[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Ms[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Ms[this.storageKey]=Object.assign(Object.assign({},Ms[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Uv}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=qk(window.location.href);let i="none";if(this._isImplicitGrantCallback(t)?i="implicit":await this._isPKCECallback(t)&&(i="pkce"),Xt()&&this.detectSessionInUrl&&i!=="none"){const{data:r,error:a}=await this._getSessionFromURL(t,i);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),Ik(a)){const m=(e=a.details)===null||e===void 0?void 0:e.code;if(m==="identity_already_exists"||m==="identity_not_found"||m==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:c,redirectType:h}=r;return this._debug("#_initialize()","detected session in URL",c,"redirect type",h),await this._saveSession(c),setTimeout(async()=>{h==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Ee(t)?{error:t}:{error:new Bv("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,i,r;try{const a=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.captchaToken}},xform:Cn}),{data:c,error:h}=a;if(h||!c)return{data:{user:null,session:null},error:h};const m=c.session,p=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",m)),{data:{user:p,session:m},error:null}}catch(a){if(Ee(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var t,i,r;try{let a;if("email"in e){const{email:y,password:T,options:x}=e;let C=null,_=null;this.flowType==="pkce"&&([C,_]=await ws(this.storage,this.storageKey)),a=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:x==null?void 0:x.emailRedirectTo,body:{email:y,password:T,data:(t=x==null?void 0:x.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:x==null?void 0:x.captchaToken},code_challenge:C,code_challenge_method:_},xform:Cn})}else if("phone"in e){const{phone:y,password:T,options:x}=e;a=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:y,password:T,data:(i=x==null?void 0:x.data)!==null&&i!==void 0?i:{},channel:(r=x==null?void 0:x.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:x==null?void 0:x.captchaToken}},xform:Cn})}else throw new Pa("You must provide either an email or phone number and a password");const{data:c,error:h}=a;if(h||!c)return{data:{user:null,session:null},error:h};const m=c.session,p=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",m)),{data:{user:p,session:m},error:null}}catch(a){if(Ee(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:a,password:c,options:h}=e;t=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:c,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:_y})}else if("phone"in e){const{phone:a,password:c,options:h}=e;t=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:c,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:_y})}else throw new Pa("You must provide either an email or phone number and a password");const{data:i,error:r}=t;return r?{data:{user:null,session:null},error:r}:!i||!i.session||!i.user?{data:{user:null,session:null},error:new La}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:r})}catch(t){if(Ee(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,i,r,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(i=e.options)===null||i===void 0?void 0:i.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,i,r,a,c,h,m,p,y,T,x,C;let _,w;if("message"in e)_=e.message,w=e.signature;else{const{chain:N,wallet:H,statement:K,options:I}=e;let Q;if(Xt())if(typeof H=="object")Q=H;else{const oe=window;if("solana"in oe&&typeof oe.solana=="object"&&("signIn"in oe.solana&&typeof oe.solana.signIn=="function"||"signMessage"in oe.solana&&typeof oe.solana.signMessage=="function"))Q=oe.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof H!="object"||!(I!=null&&I.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");Q=H}const Y=new URL((t=I==null?void 0:I.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in Q&&Q.signIn){const oe=await Q.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},I==null?void 0:I.signInWithSolana),{version:"1",domain:Y.host,uri:Y.href}),K?{statement:K}:null));let ce;if(Array.isArray(oe)&&oe[0]&&typeof oe[0]=="object")ce=oe[0];else if(oe&&typeof oe=="object"&&"signedMessage"in oe&&"signature"in oe)ce=oe;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in ce&&"signature"in ce&&(typeof ce.signedMessage=="string"||ce.signedMessage instanceof Uint8Array)&&ce.signature instanceof Uint8Array)_=typeof ce.signedMessage=="string"?ce.signedMessage:new TextDecoder().decode(ce.signedMessage),w=ce.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in Q)||typeof Q.signMessage!="function"||!("publicKey"in Q)||typeof Q!="object"||!Q.publicKey||!("toBase58"in Q.publicKey)||typeof Q.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");_=[`${Y.host} wants you to sign in with your Solana account:`,Q.publicKey.toBase58(),...K?["",K,""]:[""],"Version: 1",`URI: ${Y.href}`,`Issued At: ${(r=(i=I==null?void 0:I.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((a=I==null?void 0:I.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${I.signInWithSolana.notBefore}`]:[],...!((c=I==null?void 0:I.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${I.signInWithSolana.expirationTime}`]:[],...!((h=I==null?void 0:I.signInWithSolana)===null||h===void 0)&&h.chainId?[`Chain ID: ${I.signInWithSolana.chainId}`]:[],...!((m=I==null?void 0:I.signInWithSolana)===null||m===void 0)&&m.nonce?[`Nonce: ${I.signInWithSolana.nonce}`]:[],...!((p=I==null?void 0:I.signInWithSolana)===null||p===void 0)&&p.requestId?[`Request ID: ${I.signInWithSolana.requestId}`]:[],...!((T=(y=I==null?void 0:I.signInWithSolana)===null||y===void 0?void 0:y.resources)===null||T===void 0)&&T.length?["Resources",...I.signInWithSolana.resources.map(ce=>`- ${ce}`)]:[]].join(`
`);const oe=await Q.signMessage(new TextEncoder().encode(_),"utf8");if(!oe||!(oe instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=oe}}try{const{data:N,error:H}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:_,signature:Hk(w)},!((x=e.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(C=e.options)===null||C===void 0?void 0:C.captchaToken}}:null),xform:Cn});if(H)throw H;return!N||!N.session||!N.user?{data:{user:null,session:null},error:new La}:(N.session&&(await this._saveSession(N.session),await this._notifyAllSubscribers("SIGNED_IN",N.session)),{data:Object.assign({},N),error:H})}catch(N){if(Ee(N))return{data:{user:null,session:null},error:N};throw N}}async _exchangeCodeForSession(e){const t=await Ei(this.storage,`${this.storageKey}-code-verifier`),[i,r]=(t??"").split("/");try{const{data:a,error:c}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:i},xform:Cn});if(await Qn(this.storage,`${this.storageKey}-code-verifier`),c)throw c;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new La}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:r??null}),error:c})}catch(a){if(Ee(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:t,provider:i,token:r,access_token:a,nonce:c}=e,h=await Me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:r,access_token:a,nonce:c,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:Cn}),{data:m,error:p}=h;return p?{data:{user:null,session:null},error:p}:!m||!m.session||!m.user?{data:{user:null,session:null},error:new La}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),{data:m,error:p})}catch(t){if(Ee(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,i,r,a,c;try{if("email"in e){const{email:h,options:m}=e;let p=null,y=null;this.flowType==="pkce"&&([p,y]=await ws(this.storage,this.storageKey));const{error:T}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:h,data:(t=m==null?void 0:m.data)!==null&&t!==void 0?t:{},create_user:(i=m==null?void 0:m.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},code_challenge:p,code_challenge_method:y},redirectTo:m==null?void 0:m.emailRedirectTo});return{data:{user:null,session:null},error:T}}if("phone"in e){const{phone:h,options:m}=e,{data:p,error:y}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:h,data:(r=m==null?void 0:m.data)!==null&&r!==void 0?r:{},create_user:(a=m==null?void 0:m.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},channel:(c=m==null?void 0:m.channel)!==null&&c!==void 0?c:"sms"}});return{data:{user:null,session:null,messageId:p==null?void 0:p.message_id},error:y}}throw new Pa("You must provide either an email or phone number.")}catch(h){if(Ee(h))return{data:{user:null,session:null},error:h};throw h}}async verifyOtp(e){var t,i;try{let r,a;"options"in e&&(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo,a=(i=e.options)===null||i===void 0?void 0:i.captchaToken);const{data:c,error:h}=await Me(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:r,xform:Cn});if(h)throw h;if(!c)throw new Error("An error occurred on token verification.");const m=c.session,p=c.user;return m!=null&&m.access_token&&(await this._saveSession(m),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",m)),{data:{user:p,session:m},error:null}}catch(r){if(Ee(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var t,i,r;try{let a=null,c=null;return this.flowType==="pkce"&&([a,c]=await ws(this.storage,this.storageKey)),await Me(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&i!==void 0?i:void 0}),!((r=e==null?void 0:e.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:c}),headers:this.headers,xform:oI})}catch(a){if(Ee(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:i}=e;if(i)throw i;if(!t)throw new Zn;const{error:r}=await Me(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}})}catch(e){if(Ee(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:i,type:r,options:a}=e,{error:c}=await Me(this.fetch,"POST",t,{headers:this.headers,body:{email:i,type:r,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:c}}else if("phone"in e){const{phone:i,type:r,options:a}=e,{data:c,error:h}=await Me(this.fetch,"POST",t,{headers:this.headers,body:{phone:i,type:r,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:h}}throw new Pa("You must provide either an email or phone number and a type")}catch(t){if(Ee(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await i,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=t();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Ei(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const i=e.expires_at?e.expires_at*1e3-Date.now()<_u:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",e.expires_at),!i){if(this.userStorage){const c=await Ei(this.userStorage,this.storageKey+"-user");c!=null&&c.user?e.user=c.user:e.user=Ru()}if(this.storage.isServer&&e.user){let c=this.suppressGetSessionWarning;e=new Proxy(e,{get:(m,p,y)=>(!c&&p==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),c=!0,this.suppressGetSessionWarning=!0),Reflect.get(m,p,y))})}return{data:{session:e},error:null}}const{session:r,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ei}):await this._useSession(async t=>{var i,r,a;const{data:c,error:h}=t;if(h)throw h;return!(!((i=c.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Zn}:await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(r=c.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0,xform:ei})})}catch(t){if(Ee(t))return kk(t)&&(await this._removeSession(),await Qn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async i=>{const{data:r,error:a}=i;if(a)throw a;if(!r.session)throw new Zn;const c=r.session;let h=null,m=null;this.flowType==="pkce"&&e.email!=null&&([h,m]=await ws(this.storage,this.storageKey));const{data:p,error:y}=await Me(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:h,code_challenge_method:m}),jwt:c.access_token,xform:ei});if(y)throw y;return c.user=p.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}})}catch(i){if(Ee(i))return{data:{user:null},error:i};throw i}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Zn;const t=Date.now()/1e3;let i=t,r=!0,a=null;const{payload:c}=bu(e.access_token);if(c.exp&&(i=c.exp,r=i<=t),r){const{session:h,error:m}=await this._callRefreshToken(e.refresh_token);if(m)return{data:{user:null,session:null},error:m};if(!h)return{data:{user:null,session:null},error:null};a=h}else{const{data:h,error:m}=await this._getUser(e.access_token);if(m)throw m;a={access_token:e.access_token,refresh_token:e.refresh_token,user:h.user,token_type:"bearer",expires_in:i-t,expires_at:i},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(t){if(Ee(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var i;if(!e){const{data:c,error:h}=t;if(h)throw h;e=(i=c.session)!==null&&i!==void 0?i:void 0}if(!(e!=null&&e.refresh_token))throw new Zn;const{session:r,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(Ee(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Xt())throw new Ua("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ua(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new vy("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ua("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new vy("No code detected.");const{data:K,error:I}=await this._exchangeCodeForSession(e.code);if(I)throw I;const Q=new URL(window.location.href);return Q.searchParams.delete("code"),window.history.replaceState(window.history.state,"",Q.toString()),{data:{session:K.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:r,access_token:a,refresh_token:c,expires_in:h,expires_at:m,token_type:p}=e;if(!a||!h||!c||!p)throw new Ua("No session defined in URL");const y=Math.round(Date.now()/1e3),T=parseInt(h);let x=y+T;m&&(x=parseInt(m));const C=x-y;C*1e3<=Ds&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${C}s, should have been closer to ${T}s`);const _=x-T;y-_>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",_,x,y):y-_<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",_,x,y);const{data:w,error:N}=await this._getUser(a);if(N)throw N;const H={provider_token:i,provider_refresh_token:r,access_token:a,expires_in:T,expires_at:x,refresh_token:c,token_type:p,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:H,redirectType:e.type},error:null}}catch(i){if(Ee(i))return{data:{session:null,redirectType:null},error:i};throw i}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Ei(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var i;const{data:r,error:a}=t;if(a)return{error:a};const c=(i=r.session)===null||i===void 0?void 0:i.access_token;if(c){const{error:h}=await this.admin.signOut(c,e);if(h&&!(Nk(h)&&(h.status===404||h.status===401||h.status===403)))return{error:h}}return e!=="others"&&(await this._removeSession(),await Qn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=Gk(),i={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,i),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:i}}}async _emitInitialSession(e){return await this._useSession(async t=>{var i,r;try{const{data:{session:a},error:c}=t;if(c)throw c;await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,t={}){let i=null,r=null;this.flowType==="pkce"&&([i,r]=await ws(this.storage,this.storageKey,!0));try{return await Me(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:i,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(Ee(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:t,error:i}=await this.getUser();if(i)throw i;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(Ee(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:i,error:r}=await this._useSession(async a=>{var c,h,m,p,y;const{data:T,error:x}=a;if(x)throw x;const C=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(c=e.options)===null||c===void 0?void 0:c.redirectTo,scopes:(h=e.options)===null||h===void 0?void 0:h.scopes,queryParams:(m=e.options)===null||m===void 0?void 0:m.queryParams,skipBrowserRedirect:!0});return await Me(this.fetch,"GET",C,{headers:this.headers,jwt:(y=(p=T.session)===null||p===void 0?void 0:p.access_token)!==null&&y!==void 0?y:void 0})});if(r)throw r;return Xt()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(i==null?void 0:i.url),{data:{provider:e.provider,url:i==null?void 0:i.url},error:null}}catch(i){if(Ee(i))return{data:{provider:e.provider,url:null},error:i};throw i}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var i,r;const{data:a,error:c}=t;if(c)throw c;return await Me(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&r!==void 0?r:void 0})})}catch(t){if(Ee(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const i=Date.now();return await Fk(async r=>(r>0&&await $k(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await Me(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Cn})),(r,a)=>{const c=200*Math.pow(2,r);return a&&wu(a)&&Date.now()+c-i<Ds})}catch(i){if(this._debug(t,"error",i),Ee(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const i=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",i),Xt()&&!t.skipBrowserRedirect&&window.location.assign(i),{data:{provider:e,url:i},error:null}}async _recoverAndRefresh(){var e,t;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const r=await Ei(this.storage,this.storageKey);if(r&&this.userStorage){let c=await Ei(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:r.user},await Ls(this.userStorage,this.storageKey+"-user",c)),r.user=(e=c==null?void 0:c.user)!==null&&e!==void 0?e:Ru()}else if(r&&!r.user&&!r.user){const c=await Ei(this.storage,this.storageKey+"-user");c&&(c!=null&&c.user)?(r.user=c.user,await Qn(this.storage,this.storageKey+"-user"),await Ls(this.storage,this.storageKey,r)):r.user=Ru()}if(this._debug(i,"session from storage",r),!this._isValidSession(r)){this._debug(i,"session is not valid"),r!==null&&await this._removeSession();return}const a=((t=r.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<_u;if(this._debug(i,`session has${a?"":" not"} expired with margin of ${_u}s`),a){if(this.autoRefreshToken&&r.refresh_token){const{error:c}=await this._callRefreshToken(r.refresh_token);c&&(console.error(c),wu(c)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:h}=await this._getUser(r.access_token);!h&&(c!=null&&c.user)?(r.user=c.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(i,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(i,"error",r),console.error(r);return}finally{this._debug(i,"end")}}async _callRefreshToken(e){var t,i;if(!e)throw new Zn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new il;const{data:a,error:c}=await this._refreshAccessToken(e);if(c)throw c;if(!a.session)throw new Zn;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const h={session:a.session,error:null};return this.refreshingDeferred.resolve(h),h}catch(a){if(this._debug(r,"error",a),Ee(a)){const c={session:null,error:a};return wu(a)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(c),c}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(a),a}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,i=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],c=Array.from(this.stateChangeEmitters.values()).map(async h=>{try{await h.callback(e,t)}catch(m){a.push(m)}});if(await Promise.all(c),a.length>0){for(let h=0;h<a.length;h+=1)console.error(a[h]);throw a[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),i=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&t.user&&await Ls(this.userStorage,this.storageKey+"-user",{user:t.user});const r=Object.assign({},t);delete r.user;const a=Cy(r);await Ls(this.storage,this.storageKey,a)}else{const r=Cy(t);await Ls(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),await Qn(this.storage,this.storageKey),await Qn(this.storage,this.storageKey+"-code-verifier"),await Qn(this.storage,this.storageKey+"-user"),this.userStorage&&await Qn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Xt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ds);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:i}}=t;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((i.expires_at*1e3-e)/Ds);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${Ds}ms, refresh threshold is ${td} ticks`),r<=td&&await this._callRefreshToken(i.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof qv)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Xt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,i){const r=[`provider=${encodeURIComponent(t)}`];if(i!=null&&i.redirectTo&&r.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i!=null&&i.scopes&&r.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[a,c]=await ws(this.storage,this.storageKey),h=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(c)}`});r.push(h.toString())}if(i!=null&&i.queryParams){const a=new URLSearchParams(i.queryParams);r.push(a.toString())}return i!=null&&i.skipBrowserRedirect&&r.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var i;const{data:r,error:a}=t;return a?{data:null,error:a}:await Me(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token})})}catch(t){if(Ee(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var i,r;const{data:a,error:c}=t;if(c)return{data:null,error:c};const h=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:m,error:p}=await Me(this.fetch,"POST",`${this.url}/factors`,{body:h,headers:this.headers,jwt:(i=a==null?void 0:a.session)===null||i===void 0?void 0:i.access_token});return p?{data:null,error:p}:(e.factorType==="totp"&&(!((r=m==null?void 0:m.totp)===null||r===void 0)&&r.qr_code)&&(m.totp.qr_code=`data:image/svg+xml;utf-8,${m.totp.qr_code}`),{data:m,error:null})})}catch(t){if(Ee(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var i;const{data:r,error:a}=t;if(a)return{data:null,error:a};const{data:c,error:h}=await Me(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token});return h?{data:null,error:h}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),{data:c,error:h})})}catch(t){if(Ee(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var i;const{data:r,error:a}=t;return a?{data:null,error:a}:await Me(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token})})}catch(t){if(Ee(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:i}=await this._challenge({factorId:e.factorId});return i?{data:null,error:i}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const i=(e==null?void 0:e.factors)||[],r=i.filter(c=>c.factor_type==="totp"&&c.status==="verified"),a=i.filter(c=>c.factor_type==="phone"&&c.status==="verified");return{data:{all:i,totp:r,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,i;const{data:{session:r},error:a}=e;if(a)return{data:null,error:a};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:c}=bu(r.access_token);let h=null;c.aal&&(h=c.aal);let m=h;((i=(t=r.user.factors)===null||t===void 0?void 0:t.filter(T=>T.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(m="aal2");const y=c.amr||[];return{data:{currentLevel:h,nextLevel:m,currentAuthenticationMethods:y},error:null}}))}async fetchJwk(e,t={keys:[]}){let i=t.keys.find(h=>h.kid===e);if(i)return i;const r=Date.now();if(i=this.jwks.keys.find(h=>h.kid===e),i&&this.jwks_cached_at+Rk>r)return i;const{data:a,error:c}=await Me(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=r,i=a.keys.find(h=>h.kid===e),!i)?null:i}async getClaims(e,t={}){try{let i=e;if(!i){const{data:C,error:_}=await this.getSession();if(_||!C.session)return{data:null,error:_};i=C.session.access_token}const{header:r,payload:a,signature:c,raw:{header:h,payload:m}}=bu(i);t!=null&&t.allowExpired||Qk(a.exp);const p=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!p){const{error:C}=await this.getUser(i);if(C)throw C;return{data:{claims:a,header:r,signature:c},error:null}}const y=Zk(r.alg),T=await crypto.subtle.importKey("jwk",p,y,!0,["verify"]);if(!await crypto.subtle.verify(y,T,c,Bk(`${h}.${m}`)))throw new sd("Invalid JWT signature");return{data:{claims:a,header:r,signature:c},error:null}}catch(i){if(Ee(i))return{data:null,error:i};throw i}}}cr.nextInstanceID=0;const pI=cr;class gI extends pI{constructor(e){super(e)}}var yI=function(n,e,t,i){function r(a){return a instanceof t?a:new t(function(c){c(a)})}return new(t||(t=Promise))(function(a,c){function h(y){try{p(i.next(y))}catch(T){c(T)}}function m(y){try{p(i.throw(y))}catch(T){c(T)}}function p(y){y.done?a(y.value):r(y.value).then(h,m)}p((i=i.apply(n,e||[])).next())})};class vI{constructor(e,t,i){var r,a,c;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const h=Ek(e),m=new URL(h);this.realtimeUrl=new URL("realtime/v1",m),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",m),this.storageUrl=new URL("storage/v1",m),this.functionsUrl=new URL("functions/v1",m);const p=`sb-${m.hostname.split(".")[0]}-auth-token`,y={db:mk,realtime:gk,auth:Object.assign(Object.assign({},pk),{storageKey:p}),global:hk},T=Ck(i??{},y);this.storageKey=(r=T.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(a=T.global.headers)!==null&&a!==void 0?a:{},T.accessToken?(this.accessToken=T.accessToken,this.auth=new Proxy({},{get:(x,C)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(C)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=T.auth)!==null&&c!==void 0?c:{},this.headers,T.global.fetch),this.fetch=Sk(t,this._getAccessToken.bind(this),T.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},T.realtime)),this.rest=new LN(new URL("rest/v1",m).href,{headers:this.headers,schema:T.db.schema,fetch:this.fetch}),this.storage=new uk(this.storageUrl.href,this.headers,this.fetch,i==null?void 0:i.storage),T.accessToken||this._listenForAuthEvents()}get functions(){return new EN(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},i={}){return this.rest.rpc(e,t,i)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return yI(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:i}=yield this.auth.getSession();return(t=(e=i.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:i,storage:r,storageKey:a,flowType:c,lock:h,debug:m},p,y){const T={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new gI({url:this.authUrl.href,headers:Object.assign(Object.assign({},T),p),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:i,storage:r,flowType:c,lock:h,debug:m,fetch:y,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new XN(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,i)=>{this._handleTokenChanged(t,"CLIENT",i==null?void 0:i.access_token)})}_handleTokenChanged(e,t,i){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==i?this.changedAccessToken=i:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const TI=(n,e,t)=>new vI(n,e,t);function SI(){if(typeof window<"u"||typeof process>"u")return!1;const n=process.version;if(n==null)return!1;const e=n.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}SI()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const xI="https://pxmubamvtgwafzfjpkdx.supabase.co",EI="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB4bXViYW12dGd3YWZ6Zmpwa2R4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ1MjMxMDQsImV4cCI6MjA3MDA5OTEwNH0.Jmv_IxT2ct0zsu5ohrzh7rvMc3CYnXZs2teOEV2MFxI",ot=TI(xI,EI);function Ha(n){const e=typeof n=="object"&&n!==null?n.message:String(n);return typeof e=="string"&&/Failed to fetch|NetworkError|TypeError: Failed to fetch/i.test(e)}async function Ry(n,e=3){for(let t=1;t<=e;t++)try{return await n()}catch(i){if(t===e||!Ha(i))throw i;const r=Math.pow(2,t-1)*1e3;await new Promise(a=>setTimeout(a,r))}throw new Error("Max retries exceeded")}const Ns={theme:"dark",default_ultra_mode:!1},CI=async n=>{const e={user_id:n,theme:Ns.theme},{error:t}=await ot.from("user_preferences").upsert(e,{onConflict:"user_id",ignoreDuplicates:!0});if(t){if(Ha(t))return{...Ns};console.warn("Error attempting to create default preferences:",t)}let i=ot.from("user_preferences").select("theme, default_ultra_mode").eq("user_id",n).maybeSingle(),{data:r,error:a}=await Ry(()=>i);if(a&&a.code==="42703"){const c=await Ry(()=>ot.from("user_preferences").select("theme").eq("user_id",n).maybeSingle());return c.error?Ha(c.error)?{...Ns}:(console.error("Error fetching preferences:",c.error),{...Ns}):{theme:c.data.theme==="light"?"light":"dark",default_ultra_mode:!1}}return a?(Ha(a)||console.error("Error fetching preferences:",a),{...Ns}):r?{theme:r.theme==="light"?"light":"dark",default_ultra_mode:r.default_ultra_mode??!1}:(console.log("No user preferences found, returning defaults"),{...Ns})},AI=async(n,e)=>{const t={user_id:n};typeof e.theme<"u"&&(t.theme=e.theme),typeof e.default_ultra_mode<"u"&&(t.default_ultra_mode=e.default_ultra_mode);let{error:i}=await ot.from("user_preferences").upsert(t,{onConflict:"user_id"});if(i&&i.code==="42703"&&"default_ultra_mode"in t){const r={user_id:n,...typeof t.theme<"u"?{theme:t.theme}:{}},a=await ot.from("user_preferences").upsert(r,{onConflict:"user_id"});if(a.error)throw console.error("Error updating preferences:",a.error),a.error;return}if(i)throw console.error("Error updating preferences:",i),i},_I=async n=>{const{data:e,error:t}=await ot.from("sessions").select("*").eq("user_id",n).order("updated_at",{ascending:!1});return t?(console.error("Error fetching sessions:",t),[]):e.map(r=>({...r,messages:r.messages}))},wI=async(n,e)=>{const{data:t,error:i}=await ot.from("sessions").insert([{user_id:n,title:e.title,messages:e.messages}]).select().single();if(i)throw console.error("Error creating session:",i),i;return{...t,messages:t.messages}},My=async(n,e)=>{const t={...e,...e.messages&&{messages:e.messages}},{error:i}=await ot.from("sessions").update(t).eq("id",n);if(i)throw console.error("Error updating session:",i),i},bI=async n=>{const{data:e,error:t}=await ot.from("sessions").delete().eq("id",n).select();if(t)throw console.error("Error deleting session:",t),t;if(!e||e.length===0){const i=new Error("Session not found or permission denied.");throw console.error(i.message,`ID: ${n}`),i}},RI=async n=>{const{error:e}=await ot.from("sessions").delete().eq("user_id",n);if(e)throw console.error("Error deleting all user sessions:",e),e},MI=async(n,e)=>{const i=`${n}/${Date.now()}.jpg`,{error:r}=await ot.storage.from("avatars").upload(i,e,{contentType:"image/jpeg",upsert:!0});if(r)throw console.error("Error uploading avatar:",r),r;const{data:a}=ot.storage.from("avatars").getPublicUrl(i);return a.publicUrl},dt=Av((n,e)=>({sessions:[],activeSession:null,activeSessionId:null,isLoading:!0,user:null,setSessions:t=>n({sessions:t}),setActiveSessionId:t=>n({activeSessionId:t}),loadSessions:async t=>{n({isLoading:!0,user:t});try{const i=await _I(t.id);n({sessions:i}),i.length>0?n({activeSessionId:i[0].id}):await e().newSession()}catch(i){console.error("Error loading user sessions:",i),n({sessions:[],activeSessionId:null})}finally{n({isLoading:!1})}},newSession:async()=>{const t=e().user;if(t)try{const i=await wI(t.id,{title:"New Analysis",messages:[]});n(r=>({sessions:[i,...r.sessions],activeSessionId:i.id}))}catch(i){console.error("Error creating new session:",i)}},selectSession:t=>{n({activeSessionId:t})},updateSession:async(t,i)=>{n(r=>({sessions:r.sessions.map(a=>a.id===t?{...a,...i}:a)}));try{await My(t,i)}catch(r){console.error("Error updating session:",r)}},updateSessionTitle:async(t,i)=>{n(r=>({sessions:r.sessions.map(a=>a.id===t?{...a,title:i}:a)}));try{await My(t,{title:i})}catch(r){console.error("Error renaming session:",r)}},deleteSession:async t=>{if(!e().user)return;const r=e().sessions,a=e().activeSessionId;n(c=>{const h=c.sessions.filter(p=>p.id!==t);let m=c.activeSessionId;return c.activeSessionId===t&&(m=h.length>0?h[0].id:null),{sessions:h,activeSessionId:m}});try{await bI(t),e().sessions.length===0&&await e().newSession()}catch(c){console.error("Error deleting session:",c),n({sessions:r,activeSessionId:a})}},clearAllUserSessions:async()=>{const t=e().user;if(t)try{await RI(t.id),n({sessions:[],activeSessionId:null}),await e().newSession()}catch(i){console.error("Error clearing all sessions:",i)}}}));dt.subscribe(n=>{const e=n.sessions.find(t=>t.id===n.activeSessionId)||null;n.activeSession=e});const NI=({children:n,user:e})=>{const{loadSessions:t,user:i}=dt();return le.useEffect(()=>{e&&e.id!==(i==null?void 0:i.id)&&t(e)},[e,i,t]),S.jsx(S.Fragment,{children:n})},kI=["Analyze the trend and key levels for this BTC/USD 4H chart.","Is there a bullish or bearish pattern forming here?","Based on the indicators, what's a potential trade setup?"],II=({text:n,onClick:e})=>S.jsx("button",{onClick:e,className:"w-full text-left p-3 bg-input-bg rounded-lg hover:bg-border-color transition-colors text-sm text-text-secondary",children:n}),DI=({onExampleClick:n})=>S.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center max-w-lg mx-auto",children:[S.jsx("div",{className:"w-16 h-16 bg-accent-blue rounded-full mb-4 flex items-center justify-center",children:S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-8 h-8 text-white",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456Z"})})}),S.jsx("h2",{className:"text-2xl font-semibold text-text-primary",children:"Wizz AI Analyzer"}),S.jsx("p",{className:"text-text-secondary mt-2 mb-8",children:"Upload a crypto chart image and ask a question to begin. Or, try one of these examples:"}),S.jsx("div",{className:"w-full space-y-3",children:kI.map(e=>S.jsx(II,{text:e,onClick:()=>n(e)},e))})]}),zv="wizz_cache_v1";function LI(n){try{const e=`${zv}:${n}`,t=localStorage.getItem(e);return t?JSON.parse(t):null}catch{return null}}function ks(n,e){try{const t=`${zv}:${n}`;localStorage.setItem(t,JSON.stringify(e))}catch{}}function er(n){const e=(n??"").trim(),t=e.match(/^```(?:json)?\s*([\s\S]*?)```\s*$/i),i=t?t[1].trim():e,r=i.indexOf("{"),a=i.lastIndexOf("}");return r!==-1&&a!==-1&&a>r?i.slice(r,a+1):i}const PI=({defaultUltraMode:n})=>{const{activeSession:e,updateSession:t,updateSessionTitle:i}=dt(),[r,a]=le.useState(!1),[c,h]=le.useState({key:0,text:""}),[m,p]=le.useState(n),[y,T]=le.useState(null),[x,C]=le.useState(!0),_=le.useRef(null),w=le.useRef(null),N=le.useRef(new Sv);le.useEffect(()=>{var se;(se=_.current)==null||se.scrollTo(0,_.current.scrollHeight)},[e==null?void 0:e.messages]);const H=le.useCallback(async(se,F)=>{if(F)try{const ie=P=>{const X=45e3+Math.random()*2e4,ae=100,ye=[],R=[],q=P.toLowerCase().includes("bull")||P.toLowerCase().includes("up")?.002:0,te=P.toLowerCase().includes("bear")||P.toLowerCase().includes("down")?-.002:0,ne=P.toLowerCase().includes("volatile")||P.toLowerCase().includes("extreme")?2:1;let U=X;for(let G=0;G<ae;G++){const z=.015*ne+Math.random()*.01,Z=q+te,j=(Math.random()-.5)*z+Z;U=U*(1+j),ye.push(U);const ee=1e6,Se=.5+Math.random()*1.5,re=Math.abs(j)*5;R.push(ee*Se*(1+re))}return{prices:ye,volumes:R}},{prices:de,volumes:ue}=ie(se),fe=await N.current.detectMarketRegime(de,ue,"1H");T(fe)}catch(ie){console.warn("Failed to update market regime:",ie)}},[]),K=le.useCallback(()=>{w.current&&(w.current.abort(),w.current=null),a(!1)},[]),I=le.useCallback(se=>{h({key:Date.now(),text:se})},[]),Q=le.useCallback(async(se,F)=>{var te,ne;if(!e||!se&&(!F||F.length===0))return;const ie=(F||[]).map(U=>U.hash).filter(Boolean),de="p2",ue=m?"gemini-2.5-pro":"gemini-2.5-flash",fe=ie.length>0?vs({imageHashes:ie,promptVersion:de,modelVersion:ue,ultra:m}):"";if(ie.length>0){const U=Ut.getCachedAnalysis(ie,de,ue,m);if(U){const z={id:`msg_${Date.now()+1}`,role:"assistant",content:U,thinkingText:U.thinkingProcess,rawResponse:JSON.stringify(U)},Z=[...e.messages,{id:`msg_${Date.now()}`,role:"user",content:se,...F&&F.length>0&&{images:F.map(j=>`data:${j.mimeType};base64,${j.data}`)},...ie.length>0&&{imageHashes:ie}}];t(e.id,{messages:[...Z,z]});return}}w.current=new AbortController,a(!0);const P={id:`msg_${Date.now()}`,role:"user",content:se,...F&&F.length>0&&{images:F.map(U=>`data:${U.mimeType};base64,${U.data}`)},...ie.length>0&&{imageHashes:ie}},X=`msg_${Date.now()+1}`,ae={id:X,role:"assistant",content:""},ye=[...e.messages,P];t(e.id,{messages:ye});const R=[...ye,ae];t(e.id,{messages:R});let q="";try{const U=Fu(e.messages,se,F,w.current.signal,m);for await(const Se of U){if((te=w.current)!=null&&te.signal.aborted)break;q+=Se}const G=dt.getState().sessions.find(Se=>Se.id===e.id);if(!G)return;const z=G.messages.findIndex(Se=>Se.id===X);if(z===-1)return;const Z=[...G.messages];if((ne=w.current)!=null&&ne.signal.aborted){Z[z].content="Response stopped by user.",t(e.id,{messages:Z});return}let j,ee="";if(F&&F.length>0)try{const Se=JSON.parse(er(q));if(Se.error)j=`Error: ${Se.error}`;else{const re=Is(Se,m);j=re,ee=re.thinkingProcess,H(se,!0),ie.length>0&&(Ut.cacheAnalysis(ie,de,ue,m,"STANDARD",re),ks(fe,{signal:re.signal,confidence:(re.overallConfidenceScore??50)/100,raw:JSON.stringify(re),modelVersion:ue,promptVersion:de,imageHashes:ie,ultra:m,timestamp:Date.now()}))}}catch(Se){console.error("Failed to parse JSON response:",Se,"Raw response:",q),j="Error: The analysis result was not in the correct format. Please try again.",q&&(j+=`

Raw output:
${q}`)}else j=q;if(Z[z].content=j,Z[z].thinkingText=ee,Z[z].rawResponse=q,e.title==="New Analysis"){const Se=typeof j=="object"&&"summary"in j?j.summary.substring(0,40)+"...":se.substring(0,40)+"...";i(e.id,Se)}t(e.id,{messages:Z})}catch(U){console.error("Error during analysis stream:",U);const G=dt.getState().sessions.find(Z=>Z.id===e.id);if(!G)return;const z=G.messages.findIndex(Z=>Z.id===X);if(z!==-1){const Z=[...G.messages];Z[z].content="An unexpected error occurred. Please try again.",t(e.id,{messages:Z})}}finally{a(!1),w.current=null}},[e,t,i,m]),Y=le.useCallback(async(se,F)=>{var te,ne,U;if(!e||!se&&(!F||F.length===0))return;const ie=F.map(G=>G.imageData.hash).filter(Boolean),de="mtf_p1",ue=m?"gemini-2.5-pro":"gemini-2.5-flash",fe=ie.length>0?vs({imageHashes:ie,promptVersion:de,modelVersion:ue,ultra:m}):"";if(ie.length>0){const G=Ut.getCachedAnalysis(ie,de,ue,m);if(G){const Z={id:`msg_${Date.now()+1}`,role:"assistant",content:G,thinkingText:G.thinkingProcess,rawResponse:JSON.stringify(G)},j=[...e.messages,{id:`msg_${Date.now()}`,role:"user",content:se,timeframeImages:F,imageHashes:ie}];t(e.id,{messages:[...j,Z]});return}}w.current=new AbortController,a(!0);const P={id:`msg_${Date.now()}`,role:"user",content:se,timeframeImages:F,...ie.length>0&&{imageHashes:ie}},X=`msg_${Date.now()+1}`,ae={id:X,role:"assistant",content:""},ye=[...e.messages,P];t(e.id,{messages:ye});const R=[...ye,ae];t(e.id,{messages:R});let q="";try{const G=xv(e.messages,se,F,w.current.signal,m);for await(const re of G){if((te=w.current)!=null&&te.signal.aborted)break;q+=re}const z=dt.getState().sessions.find(re=>re.id===e.id);if(!z)return;const Z=z.messages.findIndex(re=>re.id===X);if(Z===-1)return;const j=[...z.messages];if((ne=w.current)!=null&&ne.signal.aborted){j[Z].content="Multi-timeframe analysis stopped by user.",t(e.id,{messages:j});return}let ee,Se="";if(F&&F.length>0)try{const re=JSON.parse(er(q));if(re.error)ee=`Error: ${re.error}`;else{const Ne=Is(re,m);ee=Ne,Se=Ne.thinkingProcess,ie.length>0&&(Ut.cacheAnalysis(ie,de,ue,m,"MULTI_TIMEFRAME",Ne),ks(fe,{signal:Ne.signal,confidence:(Ne.overallConfidenceScore??50)/100,raw:JSON.stringify(Ne),modelVersion:ue,promptVersion:de,ultra:m}))}}catch(re){console.error("Failed to parse multi-timeframe JSON response:",re),ee=`Unable to parse the multi-timeframe analysis response. Raw response: ${q.substring(0,500)}...`}else ee=q;if(j[Z]={...j[Z],content:ee,...Se&&{thinkingText:Se},rawResponse:q},t(e.id,{messages:j}),z.messages.length===2&&typeof ee=="object"&&"summary"in ee){const re=((U=ee.summary)==null?void 0:U.substring(0,50))+(ee.summary&&ee.summary.length>50?"...":"")||"Multi-Timeframe Analysis";i(e.id,re)}else z.messages.length===2&&i(e.id,"Multi-Timeframe Chat")}catch(G){console.error("Error in multi-timeframe analysis:",G);const z=dt.getState().sessions.find(Z=>Z.id===e.id);if(z){const Z=z.messages.findIndex(j=>j.id===X);if(Z!==-1){const j=[...z.messages];j[Z].content="Sorry, I encountered an error during multi-timeframe analysis. Please try again.",t(e.id,{messages:j})}}}finally{a(!1),w.current=null}},[e,t,i,m]),oe=le.useCallback(async(se,F)=>{var te,ne,U;if(!e||!se&&(!F||F.length===0))return;const ie=(F||[]).map(G=>G.hash).filter(Boolean),de="smc_p1",ue="gemini-2.5-pro",fe=ie.length>0?vs({imageHashes:ie,promptVersion:de,modelVersion:ue,ultra:m}):"";if(ie.length>0){const G=Ut.getCachedAnalysis(ie,de,ue,m);if(G){const Z={id:`msg_${Date.now()+1}`,role:"assistant",content:G,thinkingText:G.thinkingProcess,rawResponse:JSON.stringify(G)},j=[...e.messages,{id:`msg_${Date.now()}`,role:"user",content:se,...F&&F.length>0&&{images:F.map(ee=>`data:${ee.mimeType};base64,${ee.data}`)},...ie.length>0&&{imageHashes:ie}}];t(e.id,{messages:[...j,Z]});return}}w.current=new AbortController,a(!0);const P={id:`msg_${Date.now()}`,role:"user",content:se,...F&&F.length>0&&{images:F.map(G=>`data:${G.mimeType};base64,${G.data}`)},...ie.length>0&&{imageHashes:ie}},X=`msg_${Date.now()+1}`,ae={id:X,role:"assistant",content:""},ye=[...e.messages,P];t(e.id,{messages:ye});const R=[...ye,ae];t(e.id,{messages:R});let q="";try{const G=Ev(e.messages,se,F,w.current.signal,m);for await(const re of G){if((te=w.current)!=null&&te.signal.aborted)break;q+=re}const z=dt.getState().sessions.find(re=>re.id===e.id);if(!z)return;const Z=z.messages.findIndex(re=>re.id===X);if(Z===-1)return;const j=[...z.messages];if((ne=w.current)!=null&&ne.signal.aborted){j[Z].content="SMC analysis stopped by user.",t(e.id,{messages:j});return}let ee,Se="";if(F&&F.length>0)try{const re=JSON.parse(er(q));if(re.error)ee=`Error: ${re.error}`;else{const Ne=Is(re,m);ee=Ne,Se=Ne.thinkingProcess,H(se,!0),ie.length>0&&(Ut.cacheAnalysis(ie,de,ue,m,"SMC",Ne),ks(fe,{signal:Ne.signal,confidence:(Ne.overallConfidenceScore??50)/100,raw:JSON.stringify(Ne),modelVersion:ue,promptVersion:de,ultra:m}))}}catch(re){console.error("Failed to parse SMC JSON response:",re),ee=`Unable to parse the SMC analysis response. Raw response: ${q.substring(0,500)}...`}else ee=q;if(j[Z]={...j[Z],content:ee,...Se&&{thinkingText:Se},rawResponse:q},t(e.id,{messages:j}),z.messages.length===2&&typeof ee=="object"&&"summary"in ee){const re=((U=ee.summary)==null?void 0:U.substring(0,50))+(ee.summary&&ee.summary.length>50?"...":"")||"SMC Analysis";i(e.id,re)}else z.messages.length===2&&i(e.id,"SMC Chat")}catch(G){console.error("Error in SMC analysis:",G);const z=dt.getState().sessions.find(Z=>Z.id===e.id);if(z){const Z=z.messages.findIndex(j=>j.id===X);if(Z!==-1){const j=[...z.messages];j[Z].content="Sorry, I encountered an error during SMC analysis. Please try again.",t(e.id,{messages:j})}}}finally{a(!1),w.current=null}},[e,t,i,m]),ce=le.useCallback(async(se,F)=>{var te,ne,U;if(!e||!se&&(!F||F.length===0))return;const ie=(F||[]).map(G=>G.hash).filter(Boolean),de="pattern_p1",ue="gemini-2.5-pro",fe=ie.length>0?vs({imageHashes:ie,promptVersion:de,modelVersion:ue,ultra:m}):"";if(ie.length>0){const G=Ut.getCachedAnalysis(ie,de,ue,m);if(G){const Z={id:`msg_${Date.now()+1}`,role:"assistant",content:G,thinkingText:G.thinkingProcess,rawResponse:JSON.stringify(G)},j=[...e.messages,{id:`msg_${Date.now()}`,role:"user",content:se,...F&&F.length>0&&{images:F.map(ee=>`data:${ee.mimeType};base64,${ee.data}`)},...ie.length>0&&{imageHashes:ie}}];t(e.id,{messages:[...j,Z]});return}}w.current=new AbortController,a(!0);const P={id:`msg_${Date.now()}`,role:"user",content:se,...F&&F.length>0&&{images:F.map(G=>`data:${G.mimeType};base64,${G.data}`)},...ie.length>0&&{imageHashes:ie}},X=`msg_${Date.now()+1}`,ae={id:X,role:"assistant",content:""},ye=[...e.messages,P];t(e.id,{messages:ye});const R=[...ye,ae];t(e.id,{messages:R});let q="";try{const G=Cv(e.messages,se,F,w.current.signal,m);for await(const re of G){if((te=w.current)!=null&&te.signal.aborted)break;q+=re}const z=dt.getState().sessions.find(re=>re.id===e.id);if(!z)return;const Z=z.messages.findIndex(re=>re.id===X);if(Z===-1)return;const j=[...z.messages];if((ne=w.current)!=null&&ne.signal.aborted){j[Z].content="Advanced Pattern analysis stopped by user.",t(e.id,{messages:j});return}let ee,Se="";if(F&&F.length>0)try{const re=JSON.parse(er(q));if(re.error)ee=`Error: ${re.error}`;else{const Ne=Is(re,m);ee=Ne,Se=Ne.thinkingProcess,ie.length>0&&(Ut.cacheAnalysis(ie,de,ue,m,"ADVANCED_PATTERN",Ne),ks(fe,{signal:Ne.signal,confidence:(Ne.overallConfidenceScore??50)/100,raw:JSON.stringify(Ne),modelVersion:ue,promptVersion:de,ultra:m}))}}catch(re){console.error("Failed to parse Advanced Pattern JSON response:",re),ee=`Unable to parse the Advanced Pattern analysis response. Raw response: ${q.substring(0,500)}...`}else ee=q;if(j[Z]={...j[Z],content:ee,...Se&&{thinkingText:Se},rawResponse:q},t(e.id,{messages:j}),z.messages.length===2&&typeof ee=="object"&&"summary"in ee){const re=((U=ee.summary)==null?void 0:U.substring(0,50))+(ee.summary&&ee.summary.length>50?"...":"")||"Pattern Analysis";i(e.id,re)}else z.messages.length===2&&i(e.id,"Pattern Chat")}catch(G){console.error("Error in Advanced Pattern analysis:",G);const z=dt.getState().sessions.find(Z=>Z.id===e.id);if(z){const Z=z.messages.findIndex(j=>j.id===X);if(Z!==-1){const j=[...z.messages];j[Z].content="Sorry, I encountered an error during Advanced Pattern analysis. Please try again.",t(e.id,{messages:j})}}}finally{a(!1),w.current=null}},[e,t,i,m]),Ae=le.useCallback(async(se,F,ie)=>{var q,te,ne;if(!e||!se&&(!F||F.length===0))return;const de=(F||[]).map(U=>U.hash).filter(Boolean),ue="progressive_p1",fe=m?"gemini-2.5-pro":"gemini-2.5-flash",P=de.length>0?vs({imageHashes:de,promptVersion:ue,modelVersion:fe,ultra:m}):"";if(de.length>0){const U=Ut.getCachedAnalysis(de,ue,fe,m);if(U){const z={id:`msg_${Date.now()+1}`,role:"assistant",content:U,thinkingText:U.thinkingProcess,rawResponse:JSON.stringify(U)},Z=[...e.messages,{id:`msg_${Date.now()}`,role:"user",content:se,...F&&F.length>0&&{images:F.map(j=>`data:${j.mimeType};base64,${j.data}`)},...de.length>0&&{imageHashes:de}}];t(e.id,{messages:[...Z,z]});return}}w.current=new AbortController,a(!0);const X={id:`msg_${Date.now()}`,role:"user",content:se,...F&&F.length>0&&{images:F.map(U=>`data:${U.mimeType};base64,${U.data}`)},...de.length>0&&{imageHashes:de}},ae=`msg_${Date.now()+1}`,ye={id:ae,role:"assistant",content:"",thinkingText:""},R=[...e.messages,X,ye];t(e.id,{messages:R});try{const U=hN.startProgressiveAnalysis(ie,se,F,null,e.messages,m,w.current.signal);let G="",z="",Z="INITIALIZING";for await(const ee of U){if((q=w.current)!=null&&q.signal.aborted)break;const Se=dt.getState().sessions.find(ni=>ni.id===e.id);if(!Se)break;const re=Se.messages.findIndex(ni=>ni.id===ae);if(re===-1)break;const Ne=[...Se.messages];switch(ee.type){case"PHASE_START":Z=ee.phase,z=`Starting ${ee.phase.toLowerCase()} analysis...`;break;case"PHASE_COMPLETE":ee.data&&(G=ee.data,z=ee.data.thinkingProcess||`Completed ${ee.phase.toLowerCase()} analysis (${ee.confidence}% confidence)`);break;case"ANALYSIS_COMPLETE":ee.data&&(G=ee.data,z=ee.data.thinkingProcess||"Progressive analysis completed");break;case"PHASE_ERROR":z=`Error in ${ee.phase.toLowerCase()} phase: ${((te=ee.metadata)==null?void 0:te.errorDetails)||"Unknown error"}`;break}Ne[re]={...Ne[re],content:G,thinkingText:z},t(e.id,{messages:Ne})}de.length>0&&typeof G=="object"&&"summary"in G&&(Ut.cacheAnalysis(de,ue,fe,m,ie,G),ks(P,{signal:G.signal,confidence:(G.overallConfidenceScore??50)/100,raw:JSON.stringify(G),modelVersion:fe,promptVersion:ue,ultra:m}));const j=dt.getState().sessions.find(ee=>ee.id===e.id);if(j&&j.messages.length===2&&typeof G=="object"&&"summary"in G){const ee=((ne=G.summary)==null?void 0:ne.substring(0,50))+(G.summary&&G.summary.length>50?"...":"")||"Progressive Analysis";i(e.id,ee)}else j&&j.messages.length===2&&i(e.id,"Progressive Chat")}catch(U){console.error("Error in progressive analysis:",U);const G=dt.getState().sessions.find(z=>z.id===e.id);if(G){const z=G.messages.findIndex(Z=>Z.id===ae);if(z!==-1){const Z=[...G.messages];Z[z].content="Sorry, I encountered an error during progressive analysis. Please try again.",t(e.id,{messages:Z})}}}finally{a(!1),w.current=null}},[e,t,i,m]),pe=le.useCallback(async()=>{var ne,U;if(!e||r)return;const se=e.messages.map(G=>G.role).lastIndexOf("assistant");if(se===-1||se===0)return;const F=e.messages[se-1],ie=e.messages[se];if(F.role!=="user")return;const de=e.messages.slice(0,se-1),ue=typeof F.content=="string"?F.content:"";let fe=[];const P=[];Array.isArray(F.images)&&F.images.length>0?P.push(...F.images):F.image&&P.push(F.image);for(const G of P){const z=G.split(";base64,");if(z.length===2){const Z=z[0].split(":")[1],j=z[1];fe.push({mimeType:Z,data:j})}}const X=F.imageHashes,ae="p2",ye=m?"gemini-2.5-pro":"gemini-2.5-flash",R=X&&X.length>0?vs({imageHashes:X,promptVersion:ae,modelVersion:ye,ultra:m}):"";if(R){const G=LI(R);if(G){const z=dt.getState().sessions.find(Se=>Se.id===e.id);if(!z)return;const Z=z.messages.findIndex(Se=>Se.id===ie.id);if(Z===-1)return;const j=[...z.messages],ee=JSON.parse(G.raw);j[Z].content=ee,j[Z].thinkingText=ee.thinkingProcess,j[Z].rawResponse=G.raw,t(e.id,{messages:j});return}}w.current=new AbortController,a(!0);const q=e.messages.map(G=>G.id===ie.id?{...G,content:"",thinkingText:"",rawResponse:""}:G);t(e.id,{messages:q});let te="";try{const G=Fu(de,ue,fe,w.current.signal,m);for await(const re of G){if((ne=w.current)!=null&&ne.signal.aborted)break;te+=re}const z=dt.getState().sessions.find(re=>re.id===e.id);if(!z)return;const Z=z.messages.findIndex(re=>re.id===ie.id);if(Z===-1)return;const j=[...z.messages];if((U=w.current)!=null&&U.signal.aborted){j[Z].content="Response stopped by user.",t(e.id,{messages:j});return}let ee,Se="";if(fe&&fe.length>0)try{const re=JSON.parse(er(te));if(re.error)ee=`Error: ${re.error}`;else{const Ne=Is(re,m);ee=Ne,Se=Ne.thinkingProcess,X&&X.length>0&&ks(R,{signal:Ne.signal,confidence:(Ne.overallConfidenceScore??50)/100,raw:JSON.stringify(Ne),modelVersion:ye,promptVersion:ae,imageHashes:X,ultra:m,timestamp:Date.now()})}}catch(re){console.error("Failed to parse JSON response:",re,"Raw response:",te),ee="Error: The analysis result was not in the correct format. Please try again.",te&&(ee+=`

Raw output:
${te}`)}else ee=te;j[Z].content=ee,j[Z].thinkingText=Se,j[Z].rawResponse=te,t(e.id,{messages:j})}catch(G){console.error("Error during analysis stream:",G);const z=dt.getState().sessions.find(j=>j.id===e.id);if(!z)return;const Z=z.messages.findIndex(j=>j.id===ie.id);if(Z!==-1){const j=[...z.messages];j[Z].content="An unexpected error occurred. Please try again.",t(e.id,{messages:j})}}finally{a(!1),w.current=null}},[e,t,r,m]);return e?S.jsxs("div",{className:"flex flex-1 bg-chat-bg overflow-hidden",children:[S.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[S.jsx("div",{ref:_,className:"flex-1 overflow-y-auto p-6 space-y-6 scroll-smooth",children:e.messages.length===0?S.jsx(DI,{onExampleClick:I}):e.messages.map((se,F)=>S.jsx(Ox,{message:se,isLastMessage:F===e.messages.length-1,isLoading:r&&F===e.messages.length-1&&se.role==="assistant",onRegenerate:pe},se.id))}),S.jsx("div",{className:"px-6 pb-4 bg-chat-bg",children:S.jsx(jS,{onSendMessage:Q,onSendMultiTimeframeMessage:Y,onSendSMCMessage:oe,onSendAdvancedPatternMessage:ce,onSendProgressiveMessage:Ae,isLoading:r,onStopGeneration:K,initialPrompt:c.text,isUltraMode:m,onToggleUltraMode:()=>p(se=>!se)},c.key)})]}),x&&S.jsx("div",{className:"w-80 border-l border-gray-700 bg-gray-800/30 overflow-y-auto",children:S.jsxs("div",{className:"p-4",children:[S.jsxs("div",{className:"flex items-center justify-between mb-4",children:[S.jsx("h2",{className:"text-lg font-semibold text-white",children:"Market Analysis"}),S.jsx("button",{onClick:()=>C(!1),className:"text-gray-400 hover:text-white transition-colors","aria-label":"Hide regime display",children:S.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),S.jsx(Bx,{regimeContext:y})]})}),!x&&S.jsx("button",{onClick:()=>C(!0),className:"fixed top-4 right-4 bg-blue-600 hover:bg-blue-700 text-white p-2 rounded-lg shadow-lg transition-colors z-10","aria-label":"Show market regime",children:S.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})})]}):null},UI=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})}),OI=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),BI=({isOpen:n,onClose:e,onClearAllData:t,user:i,preferences:r,onUpdatePreferences:a,onUpdateProfile:c})=>{var Ae,pe,se,F,ie;const h=le.useRef(null),[m,p]=le.useState(((Ae=i.user_metadata)==null?void 0:Ae.name)||((pe=i.user_metadata)==null?void 0:pe.full_name)||""),[y,T]=le.useState(((se=i.user_metadata)==null?void 0:se.avatar_url)||""),[x,C]=le.useState(null),[_,w]=le.useState(null),[N,H]=le.useState(!1),[K,I]=le.useState(null);le.useEffect(()=>{var ue,fe,P;const de=X=>{X.key==="Escape"&&e()};return n&&(p(((ue=i.user_metadata)==null?void 0:ue.name)||((fe=i.user_metadata)==null?void 0:fe.full_name)||""),T(((P=i.user_metadata)==null?void 0:P.avatar_url)||""),C(null),w(null),I(null),document.addEventListener("keydown",de)),()=>document.removeEventListener("keydown",de)},[n,e,i]);const Q=de=>{var P;const ue=(P=de.target.files)==null?void 0:P[0];if(!ue||!ue.type.startsWith("image/"))return;C(ue);const fe=new FileReader;fe.onloadend=()=>w(fe.result),fe.readAsDataURL(ue)},Y=(de,ue=256)=>{const fe=document.createElement("canvas");fe.width=ue,fe.height=ue;const P=fe.getContext("2d"),X=Math.min(de.naturalWidth,de.naturalHeight),ae=(de.naturalWidth-X)/2,ye=(de.naturalHeight-X)/2;return P.drawImage(de,ae,ye,X,X,0,0,ue,ue),fe},oe=async de=>{de.preventDefault(),H(!0),I(null);try{let ue=y;if(x){const fe=new Image,P=await new Promise((ye,R)=>{fe.onload=()=>{const q=Y(fe,256);ye(q.toDataURL("image/jpeg",.9))},fe.onerror=R,fe.src=_||""}),X=await(await fetch(P)).blob(),ae=await MI(i.id,X);ue=ae,T(ae)}await c({name:m,avatar_url:ue}),I({type:"success",text:"Profile saved successfully!"})}catch{I({type:"error",text:"Failed to save profile. Please try again."})}finally{H(!1),setTimeout(()=>I(null),3e3)}},ce=de=>{a({default_ultra_mode:de.target.checked})};return n?S.jsx("div",{role:"dialog","aria-modal":"true","aria-labelledby":"settings-title",className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 transition-opacity",onClick:e,children:S.jsxs("div",{ref:h,className:"bg-sidebar-bg rounded-lg shadow-2xl w-full max-w-md m-4 border border-border-color",onClick:de=>de.stopPropagation(),children:[S.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border-color",children:[S.jsx("h2",{id:"settings-title",className:"text-lg font-semibold text-text-primary",children:"Settings"}),S.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-input-bg","aria-label":"Close settings",children:S.jsx(OI,{className:"h-6 w-6 text-text-secondary"})})]}),S.jsxs("div",{className:"p-6 space-y-8 max-h-[70vh] overflow-y-auto",children:[S.jsxs("form",{onSubmit:oe,children:[S.jsx("h3",{className:"font-medium text-text-primary mb-3",children:"Profile"}),S.jsxs("div",{className:"space-y-4",children:[S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Avatar"}),S.jsxs("div",{className:"flex items-center gap-4",children:[S.jsx("div",{className:"h-16 w-16 rounded-full bg-border-color overflow-hidden flex items-center justify-center",children:_?S.jsx("img",{src:_,alt:"New avatar preview",className:"h-16 w-16 object-cover"}):y?S.jsx("img",{src:y,alt:"Avatar",className:"h-16 w-16 object-cover"}):S.jsx("span",{className:"text-text-primary",children:(ie=(((F=i.user_metadata)==null?void 0:F.name)||i.email||"?")[0])==null?void 0:ie.toUpperCase()})}),S.jsxs("div",{children:[S.jsx("input",{type:"file",accept:"image/*",onChange:Q}),S.jsx("p",{className:"text-xs text-text-secondary",children:"Upload an image, it will be auto-cropped to a square."})]})]})]}),S.jsxs("div",{children:[S.jsx("label",{htmlFor:"display-name",className:"block text-sm font-medium text-text-secondary mb-1",children:"Display Name"}),S.jsx("input",{id:"display-name",type:"text",value:m,onChange:de=>p(de.target.value),className:"w-full px-3 py-2 bg-input-bg border border-border-color rounded-md focus:outline-none focus:ring-2 focus:ring-accent-blue text-sm",placeholder:"Your Name"})]}),S.jsxs("div",{children:[S.jsx("label",{htmlFor:"avatar-url",className:"block text-sm font-medium text-text-secondary mb-1",children:"Avatar URL"}),S.jsx("input",{id:"avatar-url",type:"url",value:y,onChange:de=>T(de.target.value),className:"w-full px-3 py-2 bg-input-bg border border-border-color rounded-md focus:outline-none focus:ring-2 focus:ring-accent-blue text-sm",placeholder:"https://example.com/avatar.png"})]}),S.jsxs("div",{className:"flex items-center justify-end gap-3",children:[K&&S.jsx("span",{className:`text-sm ${K.type==="success"?"text-accent-green":"text-accent-red"}`,children:K.text}),S.jsx("button",{type:"submit",disabled:N,className:"px-4 py-2 text-sm font-medium text-white bg-accent-blue hover:bg-blue-700 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent-blue focus:ring-offset-sidebar-bg disabled:bg-gray-500",children:N?"Saving...":"Save Profile"})]})]})]}),S.jsx("div",{className:"border-t border-border-color"}),S.jsxs("div",{children:[S.jsx("h3",{className:"font-medium text-text-primary mb-3",children:"Preferences"}),S.jsxs("div",{className:"flex items-center justify-between bg-input-bg-50 p-3 rounded-lg",children:[S.jsxs("div",{children:[S.jsx("label",{htmlFor:"ultra-default",className:"font-medium text-text-primary text-sm",children:"Set Ultra Mode as default"}),S.jsx("p",{className:"text-xs text-text-secondary",children:"Start new analyses with Ultra Mode enabled (includes SMC & Advanced Patterns)."})]}),S.jsxs("label",{htmlFor:"ultra-default-toggle",className:"relative inline-flex items-center cursor-pointer",children:[S.jsx("input",{type:"checkbox",id:"ultra-default-toggle",className:"sr-only peer",checked:r.default_ultra_mode,onChange:ce}),S.jsx("div",{className:"w-11 h-6 bg-border-color peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-offset-2 peer-focus:ring-accent-blue peer-focus:ring-offset-sidebar-bg rounded-full peer peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent-blue"})]})]})]}),S.jsx("div",{className:"border-t border-border-color"}),S.jsxs("div",{children:[S.jsx("h3",{className:"font-medium text-text-primary mb-2",children:"Manage Data"}),S.jsx("p",{className:"text-sm text-text-secondary mb-3",children:"This will permanently delete all your chat sessions from your account across all devices. This action cannot be undone."}),S.jsx("button",{onClick:t,className:"w-full px-4 py-2 text-sm font-medium text-white bg-accent-red hover:bg-red-700 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent-red focus:ring-offset-sidebar-bg",children:"Clear All My Chat History"})]})]}),S.jsx("div",{className:"px-4 py-3 bg-chat-bg border-t border-border-color rounded-b-lg text-right",children:S.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-text-primary bg-input-bg border border-border-color rounded-md hover:bg-border-color transition-colors",children:"Done"})})]})}):null},wi=Av((n,e)=>({user:null,loading:!0,_setUser:t=>n({user:t}),_setLoading:t=>n({loading:t}),signInWithGoogle:async()=>{const{error:t}=await ot.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.origin}});t&&console.error("Error logging in with Google:",t)},signOut:async()=>{const{error:t}=await ot.auth.signOut();t&&console.error("Error logging out:",t)},signInWithEmail:async t=>{const{data:i,error:r}=await ot.auth.signInWithPassword({email:t.email,password:t.password});return{error:r}},signUpWithEmail:async t=>{const{data:i,error:r}=await ot.auth.signUp({email:t.email,password:t.password,options:{emailRedirectTo:window.location.origin}});return{error:r}},updateUserMetadata:async t=>{const i=Object.fromEntries(Object.entries(t).filter(([c,h])=>h!=null));if(Object.keys(i).length===0)return{error:null};const{data:r,error:a}=await ot.auth.updateUser({data:i});return r.user&&n({user:r.user}),{error:a}}}));ot.auth.getSession().then(({data:{session:n}})=>{wi.getState()._setUser((n==null?void 0:n.user)??null),wi.getState()._setLoading(!1)}),ot.auth.onAuthStateChange((n,e)=>{wi.getState()._setUser((e==null?void 0:e.user)??null)});const HI=n=>S.jsx("svg",{viewBox:"0 0 48 48",...n,children:S.jsxs("g",{children:[S.jsx("path",{fill:"#EA4335",d:"M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"}),S.jsx("path",{fill:"#4285F4",d:"M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"}),S.jsx("path",{fill:"#FBBC05",d:"M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"}),S.jsx("path",{fill:"#34A853",d:"M24 48c6.48 0 11.93-2.13 15.89-5.82l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"}),S.jsx("path",{fill:"none",d:"M0 0h48v48H0z"})]})}),VI=({onGoogleLogin:n,onEmailLogin:e,onEmailSignUp:t})=>{const[i,r]=le.useState("signin"),[a,c]=le.useState(""),[h,m]=le.useState(""),[p,y]=le.useState(!1),[T,x]=le.useState(null),[C,_]=le.useState(null),w=async H=>{H.preventDefault(),y(!0),x(null),_(null);const K={email:a,password:h};let I;i==="signin"?I=await e(K):(I=await t(K),I.error||(_("Check your email for the confirmation link!"),m(""))),I.error&&x(I.error.message),y(!1)},N=()=>{r(i==="signin"?"signup":"signin"),x(null),_(null),c(""),m("")};return S.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen w-full bg-brand-bg text-text-primary p-4",children:S.jsxs("div",{className:"max-w-sm w-full text-center bg-sidebar-bg border border-border-color rounded-lg shadow-xl p-6 md:p-8",children:[S.jsx("div",{className:"flex justify-center mb-6",children:S.jsx("div",{className:"w-20 h-20 bg-accent-blue rounded-full flex items-center justify-center",children:S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-10 h-10 text-white",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456Z"})})})}),S.jsx("h1",{className:"text-3xl font-bold text-text-primary",children:i==="signin"?"Sign In to Wizz":"Create an Account"}),S.jsx("p",{className:"text-md text-text-secondary mt-2",children:"Your AI Crypto Chart Analyzer."}),S.jsxs("form",{onSubmit:w,className:"mt-8 space-y-4 text-left",children:[S.jsx("input",{type:"email",placeholder:"Email address",value:a,onChange:H=>c(H.target.value),required:!0,className:"w-full px-4 py-2 bg-input-bg border border-border-color rounded-md focus:outline-none focus:ring-2 focus:ring-accent-blue","aria-label":"Email address"}),S.jsx("input",{type:"password",placeholder:"Password",value:h,onChange:H=>m(H.target.value),required:!0,minLength:6,className:"w-full px-4 py-2 bg-input-bg border border-border-color rounded-md focus:outline-none focus:ring-2 focus:ring-accent-blue","aria-label":"Password"}),S.jsx("button",{type:"submit",disabled:p,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-accent-blue hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent-blue disabled:bg-gray-500 disabled:cursor-not-allowed",children:p?S.jsx("div",{className:"h-5 w-5 border-2 border-t-transparent border-white rounded-full animate-spin"}):i==="signin"?"Sign In":"Sign Up"}),T&&S.jsx("p",{className:"text-sm text-accent-red mt-2 text-center",children:T}),C&&S.jsx("p",{className:"text-sm text-accent-green mt-2 text-center",children:C})]}),S.jsxs("div",{className:"my-6 flex items-center",children:[S.jsx("div",{className:"border-t border-border-color flex-grow"}),S.jsx("span",{className:"mx-4 text-sm text-text-secondary flex-shrink-0",children:"OR"}),S.jsx("div",{className:"border-t border-border-color flex-grow"})]}),S.jsxs("button",{onClick:n,className:"flex items-center justify-center gap-3 w-full px-6 py-2.5 font-semibold text-text-primary bg-input-bg border border-border-color rounded-lg shadow-sm hover:bg-border-color focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent-blue focus:ring-offset-brand-bg transition-colors",children:[S.jsx(HI,{className:"h-5 w-5"}),S.jsx("span",{children:"Sign In with Google"})]}),S.jsxs("p",{className:"mt-8 text-sm text-center text-text-secondary",children:[i==="signin"?"Don't have an account?":"Already have an account?",S.jsx("button",{onClick:N,className:"font-medium text-accent-blue hover:underline ml-1 focus:outline-none",children:i==="signin"?"Sign up":"Sign in"})]})]})})},GI=()=>{const{user:n}=wi(),{activeSession:e,sessions:t,isLoading:i,clearAllUserSessions:r,updateSessionTitle:a,deleteSession:c,selectSession:h,newSession:m}=dt(),[p,y]=le.useState(!0),[T,x]=le.useState(!1),[C,_]=le.useState({theme:"dark",default_ultra_mode:!1});le.useEffect(()=>{const I=window.document.documentElement;I.classList.remove("light","dark"),I.classList.add(C.theme)},[C.theme]),le.useEffect(()=>{n?CI(n.id).then(_):_({theme:"dark",default_ultra_mode:!1})},[n]);const w=le.useCallback(async I=>{if(!n)return;const Q={...C,...I};_(Q);try{await AI(n.id,Q)}catch(Y){console.error("Failed to update preferences:",Y),_(C)}},[C,n]),N=le.useCallback(async I=>{const{updateUserMetadata:Q}=wi.getState(),{error:Y}=await Q(I);if(Y)throw console.error("Failed to update profile",Y),Y},[]),H=le.useCallback(async()=>{window.confirm("Are you sure you want to clear all chat history for your account? This action cannot be undone.")&&(await r(),x(!1))},[r]),K=async()=>{if(window.confirm("Are you sure you want to log out?")){const{signOut:I}=wi.getState();await I()}};return S.jsxs(S.Fragment,{children:[S.jsxs("div",{className:"flex h-screen w-full bg-brand-bg text-text-primary font-sans",children:[S.jsx(BS,{isOpen:p,sessions:t,activeSessionId:(e==null?void 0:e.id)??null,onNewSession:m,onSelectSession:h,onDeleteSession:c,onRenameSession:a,onToggle:()=>y(!p),user:n,theme:C.theme,onToggleTheme:()=>w({theme:C.theme==="light"?"dark":"light"}),onOpenSettings:()=>x(!0),onLogout:K}),S.jsxs("main",{className:"flex flex-1 flex-col transition-all duration-300 ease-in-out",children:[S.jsxs("div",{className:"flex items-center p-2 border-b border-border-color bg-sidebar-bg h-14",children:[S.jsx("button",{onClick:()=>y(!p),className:"p-2 rounded-md hover:bg-input-bg focus:outline-none focus:ring-2 focus:ring-accent-blue","aria-label":"Toggle sidebar",children:S.jsx(UI,{className:"h-6 w-6 text-text-secondary"})}),S.jsx("h1",{className:"text-lg font-semibold ml-4",children:(e==null?void 0:e.title)||"Wizz"})]}),e?S.jsx(PI,{defaultUltraMode:C.default_ultra_mode},e.id):S.jsx("div",{className:"flex-1 flex items-center justify-center",children:i?S.jsx("div",{className:"h-6 w-6 border-2 border-t-transparent border-accent-blue rounded-full animate-spin"}):S.jsx("p",{className:"text-text-secondary",children:"Select an analysis or start a new one."})})]})]}),T&&S.jsx(BI,{isOpen:T,onClose:()=>x(!1),onClearAllData:H,user:n,preferences:C,onUpdatePreferences:w,onUpdateProfile:N})]})},qI=()=>{const{user:n,loading:e,signInWithGoogle:t,signOut:i,signInWithEmail:r,signUpWithEmail:a}=wi();return e?S.jsx("div",{className:"flex items-center justify-center h-screen bg-brand-bg",children:S.jsx("div",{className:"h-8 w-8 border-4 border-t-transparent border-accent-blue rounded-full animate-spin"})}):n?S.jsx(NI,{user:n,children:S.jsx(GI,{})}):S.jsx(VI,{onGoogleLogin:t,onEmailLogin:r,onEmailSignUp:a})},$v=document.getElementById("root");if(!$v)throw new Error("Could not find root element to mount to");const zI=bS.createRoot($v);zI.render(S.jsx(Ps.StrictMode,{children:S.jsx(qI,{})}));
