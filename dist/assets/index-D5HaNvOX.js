var sS=Object.defineProperty;var ap=n=>{throw TypeError(n)};var oS=(n,e,t)=>e in n?sS(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Be=(n,e,t)=>oS(n,typeof e!="symbol"?e+"":e,t),rS=(n,e,t)=>e.has(n)||ap("Cannot "+t);var lp=(n,e,t)=>e.has(n)?ap("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t);var Ho=(n,e,t)=>(rS(n,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}})();function Wc(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function aS(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var r=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:function(){return n[i]}})}),t}var lc={exports:{}},Oo={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var up;function lS(){if(up)return Oo;up=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,r,a){var u=null;if(a!==void 0&&(u=""+a),r.key!==void 0&&(u=""+r.key),"key"in r){a={};for(var h in r)h!=="key"&&(a[h]=r[h])}else a=r;return r=a.ref,{$$typeof:n,type:i,key:u,ref:r!==void 0?r:null,props:a}}return Oo.Fragment=e,Oo.jsx=t,Oo.jsxs=t,Oo}var cp;function uS(){return cp||(cp=1,lc.exports=lS()),lc.exports}var S=uS(),uc={exports:{}},ye={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fp;function cS(){if(fp)return ye;fp=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),u=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),T=Symbol.iterator;function x(w){return w===null||typeof w!="object"?null:(w=T&&w[T]||w["@@iterator"],typeof w=="function"?w:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,R={};function k(w,V,Y){this.props=w,this.context=V,this.refs=R,this.updater=Y||C}k.prototype.isReactComponent={},k.prototype.setState=function(w,V){if(typeof w!="object"&&typeof w!="function"&&w!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,w,V,"setState")},k.prototype.forceUpdate=function(w){this.updater.enqueueForceUpdate(this,w,"forceUpdate")};function B(){}B.prototype=k.prototype;function F(w,V,Y){this.props=w,this.context=V,this.refs=R,this.updater=Y||C}var N=F.prototype=new B;N.constructor=F,A(N,k.prototype),N.isPureReactComponent=!0;var q=Array.isArray,O={H:null,A:null,T:null,S:null,V:null},K=Object.prototype.hasOwnProperty;function Q(w,V,Y,X,Z,he){return Y=he.ref,{$$typeof:n,type:w,key:V,ref:Y!==void 0?Y:null,props:he}}function de(w,V){return Q(w.type,V,void 0,void 0,void 0,w.props)}function ne(w){return typeof w=="object"&&w!==null&&w.$$typeof===n}function ue(w){var V={"=":"=0",":":"=2"};return"$"+w.replace(/[=:]/g,function(Y){return V[Y]})}var ae=/\/+/g;function pe(w,V){return typeof w=="object"&&w!==null&&w.key!=null?ue(""+w.key):V.toString(36)}function xe(){}function ve(w){switch(w.status){case"fulfilled":return w.value;case"rejected":throw w.reason;default:switch(typeof w.status=="string"?w.then(xe,xe):(w.status="pending",w.then(function(V){w.status==="pending"&&(w.status="fulfilled",w.value=V)},function(V){w.status==="pending"&&(w.status="rejected",w.reason=V)})),w.status){case"fulfilled":return w.value;case"rejected":throw w.reason}}throw w}function W(w,V,Y,X,Z){var he=typeof w;(he==="undefined"||he==="boolean")&&(w=null);var me=!1;if(w===null)me=!0;else switch(he){case"bigint":case"string":case"number":me=!0;break;case"object":switch(w.$$typeof){case n:case e:me=!0;break;case y:return me=w._init,W(me(w._payload),V,Y,X,Z)}}if(me)return Z=Z(w),me=X===""?"."+pe(w,0):X,q(Z)?(Y="",me!=null&&(Y=me.replace(ae,"$&/")+"/"),W(Z,V,Y,"",function(_n){return _n})):Z!=null&&(ne(Z)&&(Z=de(Z,Y+(Z.key==null||w&&w.key===Z.key?"":(""+Z.key).replace(ae,"$&/")+"/")+me)),V.push(Z)),1;me=0;var xt=X===""?".":X+":";if(q(w))for(var Ge=0;Ge<w.length;Ge++)X=w[Ge],he=xt+pe(X,Ge),me+=W(X,V,Y,he,Z);else if(Ge=x(w),typeof Ge=="function")for(w=Ge.call(w),Ge=0;!(X=w.next()).done;)X=X.value,he=xt+pe(X,Ge++),me+=W(X,V,Y,he,Z);else if(he==="object"){if(typeof w.then=="function")return W(ve(w),V,Y,X,Z);throw V=String(w),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(w).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.")}return me}function U(w,V,Y){if(w==null)return w;var X=[],Z=0;return W(w,X,"","",function(he){return V.call(Y,he,Z++)}),X}function J(w){if(w._status===-1){var V=w._result;V=V(),V.then(function(Y){(w._status===0||w._status===-1)&&(w._status=1,w._result=Y)},function(Y){(w._status===0||w._status===-1)&&(w._status=2,w._result=Y)}),w._status===-1&&(w._status=0,w._result=V)}if(w._status===1)return w._result.default;throw w._result}var j=typeof reportError=="function"?reportError:function(w){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var V=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof w=="object"&&w!==null&&typeof w.message=="string"?String(w.message):String(w),error:w});if(!window.dispatchEvent(V))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",w);return}console.error(w)};function se(){}return ye.Children={map:U,forEach:function(w,V,Y){U(w,function(){V.apply(this,arguments)},Y)},count:function(w){var V=0;return U(w,function(){V++}),V},toArray:function(w){return U(w,function(V){return V})||[]},only:function(w){if(!ne(w))throw Error("React.Children.only expected to receive a single React element child.");return w}},ye.Component=k,ye.Fragment=t,ye.Profiler=r,ye.PureComponent=F,ye.StrictMode=i,ye.Suspense=m,ye.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,ye.__COMPILER_RUNTIME={__proto__:null,c:function(w){return O.H.useMemoCache(w)}},ye.cache=function(w){return function(){return w.apply(null,arguments)}},ye.cloneElement=function(w,V,Y){if(w==null)throw Error("The argument must be a React element, but you passed "+w+".");var X=A({},w.props),Z=w.key,he=void 0;if(V!=null)for(me in V.ref!==void 0&&(he=void 0),V.key!==void 0&&(Z=""+V.key),V)!K.call(V,me)||me==="key"||me==="__self"||me==="__source"||me==="ref"&&V.ref===void 0||(X[me]=V[me]);var me=arguments.length-2;if(me===1)X.children=Y;else if(1<me){for(var xt=Array(me),Ge=0;Ge<me;Ge++)xt[Ge]=arguments[Ge+2];X.children=xt}return Q(w.type,Z,void 0,void 0,he,X)},ye.createContext=function(w){return w={$$typeof:u,_currentValue:w,_currentValue2:w,_threadCount:0,Provider:null,Consumer:null},w.Provider=w,w.Consumer={$$typeof:a,_context:w},w},ye.createElement=function(w,V,Y){var X,Z={},he=null;if(V!=null)for(X in V.key!==void 0&&(he=""+V.key),V)K.call(V,X)&&X!=="key"&&X!=="__self"&&X!=="__source"&&(Z[X]=V[X]);var me=arguments.length-2;if(me===1)Z.children=Y;else if(1<me){for(var xt=Array(me),Ge=0;Ge<me;Ge++)xt[Ge]=arguments[Ge+2];Z.children=xt}if(w&&w.defaultProps)for(X in me=w.defaultProps,me)Z[X]===void 0&&(Z[X]=me[X]);return Q(w,he,void 0,void 0,null,Z)},ye.createRef=function(){return{current:null}},ye.forwardRef=function(w){return{$$typeof:h,render:w}},ye.isValidElement=ne,ye.lazy=function(w){return{$$typeof:y,_payload:{_status:-1,_result:w},_init:J}},ye.memo=function(w,V){return{$$typeof:p,type:w,compare:V===void 0?null:V}},ye.startTransition=function(w){var V=O.T,Y={};O.T=Y;try{var X=w(),Z=O.S;Z!==null&&Z(Y,X),typeof X=="object"&&X!==null&&typeof X.then=="function"&&X.then(se,j)}catch(he){j(he)}finally{O.T=V}},ye.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},ye.use=function(w){return O.H.use(w)},ye.useActionState=function(w,V,Y){return O.H.useActionState(w,V,Y)},ye.useCallback=function(w,V){return O.H.useCallback(w,V)},ye.useContext=function(w){return O.H.useContext(w)},ye.useDebugValue=function(){},ye.useDeferredValue=function(w,V){return O.H.useDeferredValue(w,V)},ye.useEffect=function(w,V,Y){var X=O.H;if(typeof Y=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return X.useEffect(w,V)},ye.useId=function(){return O.H.useId()},ye.useImperativeHandle=function(w,V,Y){return O.H.useImperativeHandle(w,V,Y)},ye.useInsertionEffect=function(w,V){return O.H.useInsertionEffect(w,V)},ye.useLayoutEffect=function(w,V){return O.H.useLayoutEffect(w,V)},ye.useMemo=function(w,V){return O.H.useMemo(w,V)},ye.useOptimistic=function(w,V){return O.H.useOptimistic(w,V)},ye.useReducer=function(w,V,Y){return O.H.useReducer(w,V,Y)},ye.useRef=function(w){return O.H.useRef(w)},ye.useState=function(w){return O.H.useState(w)},ye.useSyncExternalStore=function(w,V,Y){return O.H.useSyncExternalStore(w,V,Y)},ye.useTransition=function(){return O.H.useTransition()},ye.version="19.1.1",ye}var dp;function Qc(){return dp||(dp=1,uc.exports=cS()),uc.exports}var ee=Qc();const ws=Wc(ee);var cc={exports:{}},Bo={},fc={exports:{}},dc={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hp;function fS(){return hp||(hp=1,function(n){function e(U,J){var j=U.length;U.push(J);e:for(;0<j;){var se=j-1>>>1,w=U[se];if(0<r(w,J))U[se]=J,U[j]=w,j=se;else break e}}function t(U){return U.length===0?null:U[0]}function i(U){if(U.length===0)return null;var J=U[0],j=U.pop();if(j!==J){U[0]=j;e:for(var se=0,w=U.length,V=w>>>1;se<V;){var Y=2*(se+1)-1,X=U[Y],Z=Y+1,he=U[Z];if(0>r(X,j))Z<w&&0>r(he,X)?(U[se]=he,U[Z]=j,se=Z):(U[se]=X,U[Y]=j,se=Y);else if(Z<w&&0>r(he,j))U[se]=he,U[Z]=j,se=Z;else break e}}return J}function r(U,J){var j=U.sortIndex-J.sortIndex;return j!==0?j:U.id-J.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var u=Date,h=u.now();n.unstable_now=function(){return u.now()-h}}var m=[],p=[],y=1,T=null,x=3,C=!1,A=!1,R=!1,k=!1,B=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function q(U){for(var J=t(p);J!==null;){if(J.callback===null)i(p);else if(J.startTime<=U)i(p),J.sortIndex=J.expirationTime,e(m,J);else break;J=t(p)}}function O(U){if(R=!1,q(U),!A)if(t(m)!==null)A=!0,K||(K=!0,pe());else{var J=t(p);J!==null&&W(O,J.startTime-U)}}var K=!1,Q=-1,de=5,ne=-1;function ue(){return k?!0:!(n.unstable_now()-ne<de)}function ae(){if(k=!1,K){var U=n.unstable_now();ne=U;var J=!0;try{e:{A=!1,R&&(R=!1,F(Q),Q=-1),C=!0;var j=x;try{t:{for(q(U),T=t(m);T!==null&&!(T.expirationTime>U&&ue());){var se=T.callback;if(typeof se=="function"){T.callback=null,x=T.priorityLevel;var w=se(T.expirationTime<=U);if(U=n.unstable_now(),typeof w=="function"){T.callback=w,q(U),J=!0;break t}T===t(m)&&i(m),q(U)}else i(m);T=t(m)}if(T!==null)J=!0;else{var V=t(p);V!==null&&W(O,V.startTime-U),J=!1}}break e}finally{T=null,x=j,C=!1}J=void 0}}finally{J?pe():K=!1}}}var pe;if(typeof N=="function")pe=function(){N(ae)};else if(typeof MessageChannel<"u"){var xe=new MessageChannel,ve=xe.port2;xe.port1.onmessage=ae,pe=function(){ve.postMessage(null)}}else pe=function(){B(ae,0)};function W(U,J){Q=B(function(){U(n.unstable_now())},J)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(U){U.callback=null},n.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):de=0<U?Math.floor(1e3/U):5},n.unstable_getCurrentPriorityLevel=function(){return x},n.unstable_next=function(U){switch(x){case 1:case 2:case 3:var J=3;break;default:J=x}var j=x;x=J;try{return U()}finally{x=j}},n.unstable_requestPaint=function(){k=!0},n.unstable_runWithPriority=function(U,J){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var j=x;x=U;try{return J()}finally{x=j}},n.unstable_scheduleCallback=function(U,J,j){var se=n.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?se+j:se):j=se,U){case 1:var w=-1;break;case 2:w=250;break;case 5:w=1073741823;break;case 4:w=1e4;break;default:w=5e3}return w=j+w,U={id:y++,callback:J,priorityLevel:U,startTime:j,expirationTime:w,sortIndex:-1},j>se?(U.sortIndex=j,e(p,U),t(m)===null&&U===t(p)&&(R?(F(Q),Q=-1):R=!0,W(O,j-se))):(U.sortIndex=w,e(m,U),A||C||(A=!0,K||(K=!0,pe()))),U},n.unstable_shouldYield=ue,n.unstable_wrapCallback=function(U){var J=x;return function(){var j=x;x=J;try{return U.apply(this,arguments)}finally{x=j}}}}(dc)),dc}var mp;function dS(){return mp||(mp=1,fc.exports=fS()),fc.exports}var hc={exports:{}},dt={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pp;function hS(){if(pp)return dt;pp=1;var n=Qc();function e(m){var p="https://react.dev/errors/"+m;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)p+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+m+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function a(m,p,y){var T=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:T==null?null:""+T,children:m,containerInfo:p,implementation:y}}var u=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(m,p){if(m==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return dt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,dt.createPortal=function(m,p){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return a(m,p,null,y)},dt.flushSync=function(m){var p=u.T,y=i.p;try{if(u.T=null,i.p=2,m)return m()}finally{u.T=p,i.p=y,i.d.f()}},dt.preconnect=function(m,p){typeof m=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,i.d.C(m,p))},dt.prefetchDNS=function(m){typeof m=="string"&&i.d.D(m)},dt.preinit=function(m,p){if(typeof m=="string"&&p&&typeof p.as=="string"){var y=p.as,T=h(y,p.crossOrigin),x=typeof p.integrity=="string"?p.integrity:void 0,C=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;y==="style"?i.d.S(m,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:T,integrity:x,fetchPriority:C}):y==="script"&&i.d.X(m,{crossOrigin:T,integrity:x,fetchPriority:C,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},dt.preinitModule=function(m,p){if(typeof m=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var y=h(p.as,p.crossOrigin);i.d.M(m,{crossOrigin:y,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&i.d.M(m)},dt.preload=function(m,p){if(typeof m=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var y=p.as,T=h(y,p.crossOrigin);i.d.L(m,y,{crossOrigin:T,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},dt.preloadModule=function(m,p){if(typeof m=="string")if(p){var y=h(p.as,p.crossOrigin);i.d.m(m,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:y,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else i.d.m(m)},dt.requestFormReset=function(m){i.d.r(m)},dt.unstable_batchedUpdates=function(m,p){return m(p)},dt.useFormState=function(m,p,y){return u.H.useFormState(m,p,y)},dt.useFormStatus=function(){return u.H.useHostTransitionStatus()},dt.version="19.1.1",dt}var gp;function mS(){if(gp)return hc.exports;gp=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),hc.exports=hS(),hc.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yp;function pS(){if(yp)return Bo;yp=1;var n=dS(),e=Qc(),t=mS();function i(s){var o="https://react.dev/errors/"+s;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)o+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function a(s){var o=s,l=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(l=o.return),s=o.return;while(s)}return o.tag===3?l:null}function u(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function h(s){if(a(s)!==s)throw Error(i(188))}function m(s){var o=s.alternate;if(!o){if(o=a(s),o===null)throw Error(i(188));return o!==s?null:s}for(var l=s,d=o;;){var g=l.return;if(g===null)break;var v=g.alternate;if(v===null){if(d=g.return,d!==null){l=d;continue}break}if(g.child===v.child){for(v=g.child;v;){if(v===l)return h(g),s;if(v===d)return h(g),o;v=v.sibling}throw Error(i(188))}if(l.return!==d.return)l=g,d=v;else{for(var _=!1,E=g.child;E;){if(E===l){_=!0,l=g,d=v;break}if(E===d){_=!0,d=g,l=v;break}E=E.sibling}if(!_){for(E=v.child;E;){if(E===l){_=!0,l=v,d=g;break}if(E===d){_=!0,d=v,l=g;break}E=E.sibling}if(!_)throw Error(i(189))}}if(l.alternate!==d)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?s:o}function p(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s;for(s=s.child;s!==null;){if(o=p(s),o!==null)return o;s=s.sibling}return null}var y=Object.assign,T=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),C=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),B=Symbol.for("react.provider"),F=Symbol.for("react.consumer"),N=Symbol.for("react.context"),q=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),K=Symbol.for("react.suspense_list"),Q=Symbol.for("react.memo"),de=Symbol.for("react.lazy"),ne=Symbol.for("react.activity"),ue=Symbol.for("react.memo_cache_sentinel"),ae=Symbol.iterator;function pe(s){return s===null||typeof s!="object"?null:(s=ae&&s[ae]||s["@@iterator"],typeof s=="function"?s:null)}var xe=Symbol.for("react.client.reference");function ve(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===xe?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case A:return"Fragment";case k:return"Profiler";case R:return"StrictMode";case O:return"Suspense";case K:return"SuspenseList";case ne:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case C:return"Portal";case N:return(s.displayName||"Context")+".Provider";case F:return(s._context.displayName||"Context")+".Consumer";case q:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case Q:return o=s.displayName||null,o!==null?o:ve(s.type)||"Memo";case de:o=s._payload,s=s._init;try{return ve(s(o))}catch{}}return null}var W=Array.isArray,U=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,j={pending:!1,data:null,method:null,action:null},se=[],w=-1;function V(s){return{current:s}}function Y(s){0>w||(s.current=se[w],se[w]=null,w--)}function X(s,o){w++,se[w]=s.current,s.current=o}var Z=V(null),he=V(null),me=V(null),xt=V(null);function Ge(s,o){switch(X(me,o),X(he,s),X(Z,null),o.nodeType){case 9:case 11:s=(s=o.documentElement)&&(s=s.namespaceURI)?Lm(s):0;break;default:if(s=o.tagName,o=o.namespaceURI)o=Lm(o),s=Pm(o,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}Y(Z),X(Z,s)}function _n(){Y(Z),Y(he),Y(me)}function Ja(s){s.memoizedState!==null&&X(xt,s);var o=Z.current,l=Pm(o,s.type);o!==l&&(X(he,s),X(Z,l))}function or(s){he.current===s&&(Y(Z),Y(he)),xt.current===s&&(Y(xt),Io._currentValue=j)}var ja=Object.prototype.hasOwnProperty,Ka=n.unstable_scheduleCallback,Wa=n.unstable_cancelCallback,Pv=n.unstable_shouldYield,Hv=n.unstable_requestPaint,Jt=n.unstable_now,Ov=n.unstable_getCurrentPriorityLevel,pf=n.unstable_ImmediatePriority,gf=n.unstable_UserBlockingPriority,rr=n.unstable_NormalPriority,Bv=n.unstable_LowPriority,yf=n.unstable_IdlePriority,Vv=n.log,qv=n.unstable_setDisableYieldValue,Bs=null,_t=null;function Cn(s){if(typeof Vv=="function"&&qv(s),_t&&typeof _t.setStrictMode=="function")try{_t.setStrictMode(Bs,s)}catch{}}var Ct=Math.clz32?Math.clz32:$v,Gv=Math.log,zv=Math.LN2;function $v(s){return s>>>=0,s===0?32:31-(Gv(s)/zv|0)|0}var ar=256,lr=4194304;function Xn(s){var o=s&42;if(o!==0)return o;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function ur(s,o,l){var d=s.pendingLanes;if(d===0)return 0;var g=0,v=s.suspendedLanes,_=s.pingedLanes;s=s.warmLanes;var E=d&134217727;return E!==0?(d=E&~v,d!==0?g=Xn(d):(_&=E,_!==0?g=Xn(_):l||(l=E&~s,l!==0&&(g=Xn(l))))):(E=d&~v,E!==0?g=Xn(E):_!==0?g=Xn(_):l||(l=d&~s,l!==0&&(g=Xn(l)))),g===0?0:o!==0&&o!==g&&(o&v)===0&&(v=g&-g,l=o&-o,v>=l||v===32&&(l&4194048)!==0)?o:g}function Vs(s,o){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&o)===0}function Fv(s,o){switch(s){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vf(){var s=ar;return ar<<=1,(ar&4194048)===0&&(ar=256),s}function Tf(){var s=lr;return lr<<=1,(lr&62914560)===0&&(lr=4194304),s}function Qa(s){for(var o=[],l=0;31>l;l++)o.push(s);return o}function qs(s,o){s.pendingLanes|=o,o!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Yv(s,o,l,d,g,v){var _=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var E=s.entanglements,b=s.expirationTimes,L=s.hiddenUpdates;for(l=_&~l;0<l;){var G=31-Ct(l),$=1<<G;E[G]=0,b[G]=-1;var P=L[G];if(P!==null)for(L[G]=null,G=0;G<P.length;G++){var H=P[G];H!==null&&(H.lane&=-536870913)}l&=~$}d!==0&&Sf(s,d,0),v!==0&&g===0&&s.tag!==0&&(s.suspendedLanes|=v&~(_&~o))}function Sf(s,o,l){s.pendingLanes|=o,s.suspendedLanes&=~o;var d=31-Ct(o);s.entangledLanes|=o,s.entanglements[d]=s.entanglements[d]|1073741824|l&4194090}function xf(s,o){var l=s.entangledLanes|=o;for(s=s.entanglements;l;){var d=31-Ct(l),g=1<<d;g&o|s[d]&o&&(s[d]|=o),l&=~g}}function Xa(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Za(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function _f(){var s=J.p;return s!==0?s:(s=window.event,s===void 0?32:tp(s.type))}function Jv(s,o){var l=J.p;try{return J.p=s,o()}finally{J.p=l}}var En=Math.random().toString(36).slice(2),ct="__reactFiber$"+En,pt="__reactProps$"+En,Ri="__reactContainer$"+En,el="__reactEvents$"+En,jv="__reactListeners$"+En,Kv="__reactHandles$"+En,Cf="__reactResources$"+En,Gs="__reactMarker$"+En;function tl(s){delete s[ct],delete s[pt],delete s[el],delete s[jv],delete s[Kv]}function Mi(s){var o=s[ct];if(o)return o;for(var l=s.parentNode;l;){if(o=l[Ri]||l[ct]){if(l=o.alternate,o.child!==null||l!==null&&l.child!==null)for(s=Vm(s);s!==null;){if(l=s[ct])return l;s=Vm(s)}return o}s=l,l=s.parentNode}return null}function Ni(s){if(s=s[ct]||s[Ri]){var o=s.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return s}return null}function zs(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s.stateNode;throw Error(i(33))}function ki(s){var o=s[Cf];return o||(o=s[Cf]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function tt(s){s[Gs]=!0}var Ef=new Set,Af={};function Zn(s,o){Ii(s,o),Ii(s+"Capture",o)}function Ii(s,o){for(Af[s]=o,s=0;s<o.length;s++)Ef.add(o[s])}var Wv=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),wf={},bf={};function Qv(s){return ja.call(bf,s)?!0:ja.call(wf,s)?!1:Wv.test(s)?bf[s]=!0:(wf[s]=!0,!1)}function cr(s,o,l){if(Qv(o))if(l===null)s.removeAttribute(o);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(o);return;case"boolean":var d=o.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){s.removeAttribute(o);return}}s.setAttribute(o,""+l)}}function fr(s,o,l){if(l===null)s.removeAttribute(o);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttribute(o,""+l)}}function tn(s,o,l,d){if(d===null)s.removeAttribute(l);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(o,l,""+d)}}var nl,Rf;function Di(s){if(nl===void 0)try{throw Error()}catch(l){var o=l.stack.trim().match(/\n( *(at )?)/);nl=o&&o[1]||"",Rf=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+nl+s+Rf}var il=!1;function sl(s,o){if(!s||il)return"";il=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(o){var $=function(){throw Error()};if(Object.defineProperty($.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct($,[])}catch(H){var P=H}Reflect.construct(s,[],$)}else{try{$.call()}catch(H){P=H}s.call($.prototype)}}else{try{throw Error()}catch(H){P=H}($=s())&&typeof $.catch=="function"&&$.catch(function(){})}}catch(H){if(H&&P&&typeof H.stack=="string")return[H.stack,P.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=d.DetermineComponentFrameRoot(),_=v[0],E=v[1];if(_&&E){var b=_.split(`
`),L=E.split(`
`);for(g=d=0;d<b.length&&!b[d].includes("DetermineComponentFrameRoot");)d++;for(;g<L.length&&!L[g].includes("DetermineComponentFrameRoot");)g++;if(d===b.length||g===L.length)for(d=b.length-1,g=L.length-1;1<=d&&0<=g&&b[d]!==L[g];)g--;for(;1<=d&&0<=g;d--,g--)if(b[d]!==L[g]){if(d!==1||g!==1)do if(d--,g--,0>g||b[d]!==L[g]){var G=`
`+b[d].replace(" at new "," at ");return s.displayName&&G.includes("<anonymous>")&&(G=G.replace("<anonymous>",s.displayName)),G}while(1<=d&&0<=g);break}}}finally{il=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?Di(l):""}function Xv(s){switch(s.tag){case 26:case 27:case 5:return Di(s.type);case 16:return Di("Lazy");case 13:return Di("Suspense");case 19:return Di("SuspenseList");case 0:case 15:return sl(s.type,!1);case 11:return sl(s.type.render,!1);case 1:return sl(s.type,!0);case 31:return Di("Activity");default:return""}}function Mf(s){try{var o="";do o+=Xv(s),s=s.return;while(s);return o}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function It(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Nf(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Zv(s){var o=Nf(s)?"checked":"value",l=Object.getOwnPropertyDescriptor(s.constructor.prototype,o),d=""+s[o];if(!s.hasOwnProperty(o)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var g=l.get,v=l.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return g.call(this)},set:function(_){d=""+_,v.call(this,_)}}),Object.defineProperty(s,o,{enumerable:l.enumerable}),{getValue:function(){return d},setValue:function(_){d=""+_},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function dr(s){s._valueTracker||(s._valueTracker=Zv(s))}function kf(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var l=o.getValue(),d="";return s&&(d=Nf(s)?s.checked?"true":"false":s.value),s=d,s!==l?(o.setValue(s),!0):!1}function hr(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var e0=/[\n"\\]/g;function Dt(s){return s.replace(e0,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function ol(s,o,l,d,g,v,_,E){s.name="",_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"?s.type=_:s.removeAttribute("type"),o!=null?_==="number"?(o===0&&s.value===""||s.value!=o)&&(s.value=""+It(o)):s.value!==""+It(o)&&(s.value=""+It(o)):_!=="submit"&&_!=="reset"||s.removeAttribute("value"),o!=null?rl(s,_,It(o)):l!=null?rl(s,_,It(l)):d!=null&&s.removeAttribute("value"),g==null&&v!=null&&(s.defaultChecked=!!v),g!=null&&(s.checked=g&&typeof g!="function"&&typeof g!="symbol"),E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?s.name=""+It(E):s.removeAttribute("name")}function If(s,o,l,d,g,v,_,E){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(s.type=v),o!=null||l!=null){if(!(v!=="submit"&&v!=="reset"||o!=null))return;l=l!=null?""+It(l):"",o=o!=null?""+It(o):l,E||o===s.value||(s.value=o),s.defaultValue=o}d=d??g,d=typeof d!="function"&&typeof d!="symbol"&&!!d,s.checked=E?s.checked:!!d,s.defaultChecked=!!d,_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(s.name=_)}function rl(s,o,l){o==="number"&&hr(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function Ui(s,o,l,d){if(s=s.options,o){o={};for(var g=0;g<l.length;g++)o["$"+l[g]]=!0;for(l=0;l<s.length;l++)g=o.hasOwnProperty("$"+s[l].value),s[l].selected!==g&&(s[l].selected=g),g&&d&&(s[l].defaultSelected=!0)}else{for(l=""+It(l),o=null,g=0;g<s.length;g++){if(s[g].value===l){s[g].selected=!0,d&&(s[g].defaultSelected=!0);return}o!==null||s[g].disabled||(o=s[g])}o!==null&&(o.selected=!0)}}function Df(s,o,l){if(o!=null&&(o=""+It(o),o!==s.value&&(s.value=o),l==null)){s.defaultValue!==o&&(s.defaultValue=o);return}s.defaultValue=l!=null?""+It(l):""}function Uf(s,o,l,d){if(o==null){if(d!=null){if(l!=null)throw Error(i(92));if(W(d)){if(1<d.length)throw Error(i(93));d=d[0]}l=d}l==null&&(l=""),o=l}l=It(o),s.defaultValue=l,d=s.textContent,d===l&&d!==""&&d!==null&&(s.value=d)}function Li(s,o){if(o){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=o;return}}s.textContent=o}var t0=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Lf(s,o,l){var d=o.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?d?s.setProperty(o,""):o==="float"?s.cssFloat="":s[o]="":d?s.setProperty(o,l):typeof l!="number"||l===0||t0.has(o)?o==="float"?s.cssFloat=l:s[o]=(""+l).trim():s[o]=l+"px"}function Pf(s,o,l){if(o!=null&&typeof o!="object")throw Error(i(62));if(s=s.style,l!=null){for(var d in l)!l.hasOwnProperty(d)||o!=null&&o.hasOwnProperty(d)||(d.indexOf("--")===0?s.setProperty(d,""):d==="float"?s.cssFloat="":s[d]="");for(var g in o)d=o[g],o.hasOwnProperty(g)&&l[g]!==d&&Lf(s,g,d)}else for(var v in o)o.hasOwnProperty(v)&&Lf(s,v,o[v])}function al(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var n0=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),i0=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function mr(s){return i0.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var ll=null;function ul(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Pi=null,Hi=null;function Hf(s){var o=Ni(s);if(o&&(s=o.stateNode)){var l=s[pt]||null;e:switch(s=o.stateNode,o.type){case"input":if(ol(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),o=l.name,l.type==="radio"&&o!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Dt(""+o)+'"][type="radio"]'),o=0;o<l.length;o++){var d=l[o];if(d!==s&&d.form===s.form){var g=d[pt]||null;if(!g)throw Error(i(90));ol(d,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(o=0;o<l.length;o++)d=l[o],d.form===s.form&&kf(d)}break e;case"textarea":Df(s,l.value,l.defaultValue);break e;case"select":o=l.value,o!=null&&Ui(s,!!l.multiple,o,!1)}}}var cl=!1;function Of(s,o,l){if(cl)return s(o,l);cl=!0;try{var d=s(o);return d}finally{if(cl=!1,(Pi!==null||Hi!==null)&&(Zr(),Pi&&(o=Pi,s=Hi,Hi=Pi=null,Hf(o),s)))for(o=0;o<s.length;o++)Hf(s[o])}}function $s(s,o){var l=s.stateNode;if(l===null)return null;var d=l[pt]||null;if(d===null)return null;l=d[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(s=s.type,d=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!d;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(i(231,o,typeof l));return l}var nn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),fl=!1;if(nn)try{var Fs={};Object.defineProperty(Fs,"passive",{get:function(){fl=!0}}),window.addEventListener("test",Fs,Fs),window.removeEventListener("test",Fs,Fs)}catch{fl=!1}var An=null,dl=null,pr=null;function Bf(){if(pr)return pr;var s,o=dl,l=o.length,d,g="value"in An?An.value:An.textContent,v=g.length;for(s=0;s<l&&o[s]===g[s];s++);var _=l-s;for(d=1;d<=_&&o[l-d]===g[v-d];d++);return pr=g.slice(s,1<d?1-d:void 0)}function gr(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function yr(){return!0}function Vf(){return!1}function gt(s){function o(l,d,g,v,_){this._reactName=l,this._targetInst=g,this.type=d,this.nativeEvent=v,this.target=_,this.currentTarget=null;for(var E in s)s.hasOwnProperty(E)&&(l=s[E],this[E]=l?l(v):v[E]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?yr:Vf,this.isPropagationStopped=Vf,this}return y(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=yr)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=yr)},persist:function(){},isPersistent:yr}),o}var ei={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vr=gt(ei),Ys=y({},ei,{view:0,detail:0}),s0=gt(Ys),hl,ml,Js,Tr=y({},Ys,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gl,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Js&&(Js&&s.type==="mousemove"?(hl=s.screenX-Js.screenX,ml=s.screenY-Js.screenY):ml=hl=0,Js=s),hl)},movementY:function(s){return"movementY"in s?s.movementY:ml}}),qf=gt(Tr),o0=y({},Tr,{dataTransfer:0}),r0=gt(o0),a0=y({},Ys,{relatedTarget:0}),pl=gt(a0),l0=y({},ei,{animationName:0,elapsedTime:0,pseudoElement:0}),u0=gt(l0),c0=y({},ei,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),f0=gt(c0),d0=y({},ei,{data:0}),Gf=gt(d0),h0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},m0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},p0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function g0(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=p0[s])?!!o[s]:!1}function gl(){return g0}var y0=y({},Ys,{key:function(s){if(s.key){var o=h0[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=gr(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?m0[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gl,charCode:function(s){return s.type==="keypress"?gr(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?gr(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),v0=gt(y0),T0=y({},Tr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zf=gt(T0),S0=y({},Ys,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gl}),x0=gt(S0),_0=y({},ei,{propertyName:0,elapsedTime:0,pseudoElement:0}),C0=gt(_0),E0=y({},Tr,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),A0=gt(E0),w0=y({},ei,{newState:0,oldState:0}),b0=gt(w0),R0=[9,13,27,32],yl=nn&&"CompositionEvent"in window,js=null;nn&&"documentMode"in document&&(js=document.documentMode);var M0=nn&&"TextEvent"in window&&!js,$f=nn&&(!yl||js&&8<js&&11>=js),Ff=" ",Yf=!1;function Jf(s,o){switch(s){case"keyup":return R0.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jf(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Oi=!1;function N0(s,o){switch(s){case"compositionend":return jf(o);case"keypress":return o.which!==32?null:(Yf=!0,Ff);case"textInput":return s=o.data,s===Ff&&Yf?null:s;default:return null}}function k0(s,o){if(Oi)return s==="compositionend"||!yl&&Jf(s,o)?(s=Bf(),pr=dl=An=null,Oi=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return $f&&o.locale!=="ko"?null:o.data;default:return null}}var I0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kf(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!I0[s.type]:o==="textarea"}function Wf(s,o,l,d){Pi?Hi?Hi.push(d):Hi=[d]:Pi=d,o=oa(o,"onChange"),0<o.length&&(l=new vr("onChange","change",null,l,d),s.push({event:l,listeners:o}))}var Ks=null,Ws=null;function D0(s){Nm(s,0)}function Sr(s){var o=zs(s);if(kf(o))return s}function Qf(s,o){if(s==="change")return o}var Xf=!1;if(nn){var vl;if(nn){var Tl="oninput"in document;if(!Tl){var Zf=document.createElement("div");Zf.setAttribute("oninput","return;"),Tl=typeof Zf.oninput=="function"}vl=Tl}else vl=!1;Xf=vl&&(!document.documentMode||9<document.documentMode)}function ed(){Ks&&(Ks.detachEvent("onpropertychange",td),Ws=Ks=null)}function td(s){if(s.propertyName==="value"&&Sr(Ws)){var o=[];Wf(o,Ws,s,ul(s)),Of(D0,o)}}function U0(s,o,l){s==="focusin"?(ed(),Ks=o,Ws=l,Ks.attachEvent("onpropertychange",td)):s==="focusout"&&ed()}function L0(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Sr(Ws)}function P0(s,o){if(s==="click")return Sr(o)}function H0(s,o){if(s==="input"||s==="change")return Sr(o)}function O0(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var Et=typeof Object.is=="function"?Object.is:O0;function Qs(s,o){if(Et(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var l=Object.keys(s),d=Object.keys(o);if(l.length!==d.length)return!1;for(d=0;d<l.length;d++){var g=l[d];if(!ja.call(o,g)||!Et(s[g],o[g]))return!1}return!0}function nd(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function id(s,o){var l=nd(s);s=0;for(var d;l;){if(l.nodeType===3){if(d=s+l.textContent.length,s<=o&&d>=o)return{node:l,offset:o-s};s=d}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=nd(l)}}function sd(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?sd(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function od(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var o=hr(s.document);o instanceof s.HTMLIFrameElement;){try{var l=typeof o.contentWindow.location.href=="string"}catch{l=!1}if(l)s=o.contentWindow;else break;o=hr(s.document)}return o}function Sl(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}var B0=nn&&"documentMode"in document&&11>=document.documentMode,Bi=null,xl=null,Xs=null,_l=!1;function rd(s,o,l){var d=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;_l||Bi==null||Bi!==hr(d)||(d=Bi,"selectionStart"in d&&Sl(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Xs&&Qs(Xs,d)||(Xs=d,d=oa(xl,"onSelect"),0<d.length&&(o=new vr("onSelect","select",null,o,l),s.push({event:o,listeners:d}),o.target=Bi)))}function ti(s,o){var l={};return l[s.toLowerCase()]=o.toLowerCase(),l["Webkit"+s]="webkit"+o,l["Moz"+s]="moz"+o,l}var Vi={animationend:ti("Animation","AnimationEnd"),animationiteration:ti("Animation","AnimationIteration"),animationstart:ti("Animation","AnimationStart"),transitionrun:ti("Transition","TransitionRun"),transitionstart:ti("Transition","TransitionStart"),transitioncancel:ti("Transition","TransitionCancel"),transitionend:ti("Transition","TransitionEnd")},Cl={},ad={};nn&&(ad=document.createElement("div").style,"AnimationEvent"in window||(delete Vi.animationend.animation,delete Vi.animationiteration.animation,delete Vi.animationstart.animation),"TransitionEvent"in window||delete Vi.transitionend.transition);function ni(s){if(Cl[s])return Cl[s];if(!Vi[s])return s;var o=Vi[s],l;for(l in o)if(o.hasOwnProperty(l)&&l in ad)return Cl[s]=o[l];return s}var ld=ni("animationend"),ud=ni("animationiteration"),cd=ni("animationstart"),V0=ni("transitionrun"),q0=ni("transitionstart"),G0=ni("transitioncancel"),fd=ni("transitionend"),dd=new Map,El="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");El.push("scrollEnd");function Gt(s,o){dd.set(s,o),Zn(o,[s])}var hd=new WeakMap;function Ut(s,o){if(typeof s=="object"&&s!==null){var l=hd.get(s);return l!==void 0?l:(o={value:s,source:o,stack:Mf(o)},hd.set(s,o),o)}return{value:s,source:o,stack:Mf(o)}}var Lt=[],qi=0,Al=0;function xr(){for(var s=qi,o=Al=qi=0;o<s;){var l=Lt[o];Lt[o++]=null;var d=Lt[o];Lt[o++]=null;var g=Lt[o];Lt[o++]=null;var v=Lt[o];if(Lt[o++]=null,d!==null&&g!==null){var _=d.pending;_===null?g.next=g:(g.next=_.next,_.next=g),d.pending=g}v!==0&&md(l,g,v)}}function _r(s,o,l,d){Lt[qi++]=s,Lt[qi++]=o,Lt[qi++]=l,Lt[qi++]=d,Al|=d,s.lanes|=d,s=s.alternate,s!==null&&(s.lanes|=d)}function wl(s,o,l,d){return _r(s,o,l,d),Cr(s)}function Gi(s,o){return _r(s,null,null,o),Cr(s)}function md(s,o,l){s.lanes|=l;var d=s.alternate;d!==null&&(d.lanes|=l);for(var g=!1,v=s.return;v!==null;)v.childLanes|=l,d=v.alternate,d!==null&&(d.childLanes|=l),v.tag===22&&(s=v.stateNode,s===null||s._visibility&1||(g=!0)),s=v,v=v.return;return s.tag===3?(v=s.stateNode,g&&o!==null&&(g=31-Ct(l),s=v.hiddenUpdates,d=s[g],d===null?s[g]=[o]:d.push(o),o.lane=l|536870912),v):null}function Cr(s){if(50<Eo)throw Eo=0,Iu=null,Error(i(185));for(var o=s.return;o!==null;)s=o,o=s.return;return s.tag===3?s.stateNode:null}var zi={};function z0(s,o,l,d){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function At(s,o,l,d){return new z0(s,o,l,d)}function bl(s){return s=s.prototype,!(!s||!s.isReactComponent)}function sn(s,o){var l=s.alternate;return l===null?(l=At(s.tag,o,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=o,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,o=s.dependencies,l.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function pd(s,o){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=o,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,o=l.dependencies,s.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),s}function Er(s,o,l,d,g,v){var _=0;if(d=s,typeof s=="function")bl(s)&&(_=1);else if(typeof s=="string")_=FT(s,l,Z.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case ne:return s=At(31,l,o,g),s.elementType=ne,s.lanes=v,s;case A:return ii(l.children,g,v,o);case R:_=8,g|=24;break;case k:return s=At(12,l,o,g|2),s.elementType=k,s.lanes=v,s;case O:return s=At(13,l,o,g),s.elementType=O,s.lanes=v,s;case K:return s=At(19,l,o,g),s.elementType=K,s.lanes=v,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case B:case N:_=10;break e;case F:_=9;break e;case q:_=11;break e;case Q:_=14;break e;case de:_=16,d=null;break e}_=29,l=Error(i(130,s===null?"null":typeof s,"")),d=null}return o=At(_,l,o,g),o.elementType=s,o.type=d,o.lanes=v,o}function ii(s,o,l,d){return s=At(7,s,d,o),s.lanes=l,s}function Rl(s,o,l){return s=At(6,s,null,o),s.lanes=l,s}function Ml(s,o,l){return o=At(4,s.children!==null?s.children:[],s.key,o),o.lanes=l,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}var $i=[],Fi=0,Ar=null,wr=0,Pt=[],Ht=0,si=null,on=1,rn="";function oi(s,o){$i[Fi++]=wr,$i[Fi++]=Ar,Ar=s,wr=o}function gd(s,o,l){Pt[Ht++]=on,Pt[Ht++]=rn,Pt[Ht++]=si,si=s;var d=on;s=rn;var g=32-Ct(d)-1;d&=~(1<<g),l+=1;var v=32-Ct(o)+g;if(30<v){var _=g-g%5;v=(d&(1<<_)-1).toString(32),d>>=_,g-=_,on=1<<32-Ct(o)+g|l<<g|d,rn=v+s}else on=1<<v|l<<g|d,rn=s}function Nl(s){s.return!==null&&(oi(s,1),gd(s,1,0))}function kl(s){for(;s===Ar;)Ar=$i[--Fi],$i[Fi]=null,wr=$i[--Fi],$i[Fi]=null;for(;s===si;)si=Pt[--Ht],Pt[Ht]=null,rn=Pt[--Ht],Pt[Ht]=null,on=Pt[--Ht],Pt[Ht]=null}var mt=null,Fe=null,Re=!1,ri=null,jt=!1,Il=Error(i(519));function ai(s){var o=Error(i(418,""));throw to(Ut(o,s)),Il}function yd(s){var o=s.stateNode,l=s.type,d=s.memoizedProps;switch(o[ct]=s,o[pt]=d,l){case"dialog":Ce("cancel",o),Ce("close",o);break;case"iframe":case"object":case"embed":Ce("load",o);break;case"video":case"audio":for(l=0;l<wo.length;l++)Ce(wo[l],o);break;case"source":Ce("error",o);break;case"img":case"image":case"link":Ce("error",o),Ce("load",o);break;case"details":Ce("toggle",o);break;case"input":Ce("invalid",o),If(o,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0),dr(o);break;case"select":Ce("invalid",o);break;case"textarea":Ce("invalid",o),Uf(o,d.value,d.defaultValue,d.children),dr(o)}l=d.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||o.textContent===""+l||d.suppressHydrationWarning===!0||Um(o.textContent,l)?(d.popover!=null&&(Ce("beforetoggle",o),Ce("toggle",o)),d.onScroll!=null&&Ce("scroll",o),d.onScrollEnd!=null&&Ce("scrollend",o),d.onClick!=null&&(o.onclick=ra),o=!0):o=!1,o||ai(s)}function vd(s){for(mt=s.return;mt;)switch(mt.tag){case 5:case 13:jt=!1;return;case 27:case 3:jt=!0;return;default:mt=mt.return}}function Zs(s){if(s!==mt)return!1;if(!Re)return vd(s),Re=!0,!1;var o=s.tag,l;if((l=o!==3&&o!==27)&&((l=o===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||ju(s.type,s.memoizedProps)),l=!l),l&&Fe&&ai(s),vd(s),o===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));e:{for(s=s.nextSibling,o=0;s;){if(s.nodeType===8)if(l=s.data,l==="/$"){if(o===0){Fe=$t(s.nextSibling);break e}o--}else l!=="$"&&l!=="$!"&&l!=="$?"||o++;s=s.nextSibling}Fe=null}}else o===27?(o=Fe,qn(s.type)?(s=Xu,Xu=null,Fe=s):Fe=o):Fe=mt?$t(s.stateNode.nextSibling):null;return!0}function eo(){Fe=mt=null,Re=!1}function Td(){var s=ri;return s!==null&&(Tt===null?Tt=s:Tt.push.apply(Tt,s),ri=null),s}function to(s){ri===null?ri=[s]:ri.push(s)}var Dl=V(null),li=null,an=null;function wn(s,o,l){X(Dl,o._currentValue),o._currentValue=l}function ln(s){s._currentValue=Dl.current,Y(Dl)}function Ul(s,o,l){for(;s!==null;){var d=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,d!==null&&(d.childLanes|=o)):d!==null&&(d.childLanes&o)!==o&&(d.childLanes|=o),s===l)break;s=s.return}}function Ll(s,o,l,d){var g=s.child;for(g!==null&&(g.return=s);g!==null;){var v=g.dependencies;if(v!==null){var _=g.child;v=v.firstContext;e:for(;v!==null;){var E=v;v=g;for(var b=0;b<o.length;b++)if(E.context===o[b]){v.lanes|=l,E=v.alternate,E!==null&&(E.lanes|=l),Ul(v.return,l,s),d||(_=null);break e}v=E.next}}else if(g.tag===18){if(_=g.return,_===null)throw Error(i(341));_.lanes|=l,v=_.alternate,v!==null&&(v.lanes|=l),Ul(_,l,s),_=null}else _=g.child;if(_!==null)_.return=g;else for(_=g;_!==null;){if(_===s){_=null;break}if(g=_.sibling,g!==null){g.return=_.return,_=g;break}_=_.return}g=_}}function no(s,o,l,d){s=null;for(var g=o,v=!1;g!==null;){if(!v){if((g.flags&524288)!==0)v=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var _=g.alternate;if(_===null)throw Error(i(387));if(_=_.memoizedProps,_!==null){var E=g.type;Et(g.pendingProps.value,_.value)||(s!==null?s.push(E):s=[E])}}else if(g===xt.current){if(_=g.alternate,_===null)throw Error(i(387));_.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(s!==null?s.push(Io):s=[Io])}g=g.return}s!==null&&Ll(o,s,l,d),o.flags|=262144}function br(s){for(s=s.firstContext;s!==null;){if(!Et(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function ui(s){li=s,an=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function ft(s){return Sd(li,s)}function Rr(s,o){return li===null&&ui(s),Sd(s,o)}function Sd(s,o){var l=o._currentValue;if(o={context:o,memoizedValue:l,next:null},an===null){if(s===null)throw Error(i(308));an=o,s.dependencies={lanes:0,firstContext:o},s.flags|=524288}else an=an.next=o;return l}var $0=typeof AbortController<"u"?AbortController:function(){var s=[],o=this.signal={aborted:!1,addEventListener:function(l,d){s.push(d)}};this.abort=function(){o.aborted=!0,s.forEach(function(l){return l()})}},F0=n.unstable_scheduleCallback,Y0=n.unstable_NormalPriority,Qe={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Pl(){return{controller:new $0,data:new Map,refCount:0}}function io(s){s.refCount--,s.refCount===0&&F0(Y0,function(){s.controller.abort()})}var so=null,Hl=0,Yi=0,Ji=null;function J0(s,o){if(so===null){var l=so=[];Hl=0,Yi=Bu(),Ji={status:"pending",value:void 0,then:function(d){l.push(d)}}}return Hl++,o.then(xd,xd),o}function xd(){if(--Hl===0&&so!==null){Ji!==null&&(Ji.status="fulfilled");var s=so;so=null,Yi=0,Ji=null;for(var o=0;o<s.length;o++)(0,s[o])()}}function j0(s,o){var l=[],d={status:"pending",value:null,reason:null,then:function(g){l.push(g)}};return s.then(function(){d.status="fulfilled",d.value=o;for(var g=0;g<l.length;g++)(0,l[g])(o)},function(g){for(d.status="rejected",d.reason=g,g=0;g<l.length;g++)(0,l[g])(void 0)}),d}var _d=U.S;U.S=function(s,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&J0(s,o),_d!==null&&_d(s,o)};var ci=V(null);function Ol(){var s=ci.current;return s!==null?s:Oe.pooledCache}function Mr(s,o){o===null?X(ci,ci.current):X(ci,o.pool)}function Cd(){var s=Ol();return s===null?null:{parent:Qe._currentValue,pool:s}}var oo=Error(i(460)),Ed=Error(i(474)),Nr=Error(i(542)),Bl={then:function(){}};function Ad(s){return s=s.status,s==="fulfilled"||s==="rejected"}function kr(){}function wd(s,o,l){switch(l=s[l],l===void 0?s.push(o):l!==o&&(o.then(kr,kr),o=l),o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,Rd(s),s;default:if(typeof o.status=="string")o.then(kr,kr);else{if(s=Oe,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=o,s.status="pending",s.then(function(d){if(o.status==="pending"){var g=o;g.status="fulfilled",g.value=d}},function(d){if(o.status==="pending"){var g=o;g.status="rejected",g.reason=d}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,Rd(s),s}throw ro=o,oo}}var ro=null;function bd(){if(ro===null)throw Error(i(459));var s=ro;return ro=null,s}function Rd(s){if(s===oo||s===Nr)throw Error(i(483))}var bn=!1;function Vl(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ql(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Rn(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Mn(s,o,l){var d=s.updateQueue;if(d===null)return null;if(d=d.shared,(Ne&2)!==0){var g=d.pending;return g===null?o.next=o:(o.next=g.next,g.next=o),d.pending=o,o=Cr(s),md(s,null,l),o}return _r(s,d,o,l),Cr(s)}function ao(s,o,l){if(o=o.updateQueue,o!==null&&(o=o.shared,(l&4194048)!==0)){var d=o.lanes;d&=s.pendingLanes,l|=d,o.lanes=l,xf(s,l)}}function Gl(s,o){var l=s.updateQueue,d=s.alternate;if(d!==null&&(d=d.updateQueue,l===d)){var g=null,v=null;if(l=l.firstBaseUpdate,l!==null){do{var _={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};v===null?g=v=_:v=v.next=_,l=l.next}while(l!==null);v===null?g=v=o:v=v.next=o}else g=v=o;l={baseState:d.baseState,firstBaseUpdate:g,lastBaseUpdate:v,shared:d.shared,callbacks:d.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=o:s.next=o,l.lastBaseUpdate=o}var zl=!1;function lo(){if(zl){var s=Ji;if(s!==null)throw s}}function uo(s,o,l,d){zl=!1;var g=s.updateQueue;bn=!1;var v=g.firstBaseUpdate,_=g.lastBaseUpdate,E=g.shared.pending;if(E!==null){g.shared.pending=null;var b=E,L=b.next;b.next=null,_===null?v=L:_.next=L,_=b;var G=s.alternate;G!==null&&(G=G.updateQueue,E=G.lastBaseUpdate,E!==_&&(E===null?G.firstBaseUpdate=L:E.next=L,G.lastBaseUpdate=b))}if(v!==null){var $=g.baseState;_=0,G=L=b=null,E=v;do{var P=E.lane&-536870913,H=P!==E.lane;if(H?(Ae&P)===P:(d&P)===P){P!==0&&P===Yi&&(zl=!0),G!==null&&(G=G.next={lane:0,tag:E.tag,payload:E.payload,callback:null,next:null});e:{var fe=s,le=E;P=o;var Le=l;switch(le.tag){case 1:if(fe=le.payload,typeof fe=="function"){$=fe.call(Le,$,P);break e}$=fe;break e;case 3:fe.flags=fe.flags&-65537|128;case 0:if(fe=le.payload,P=typeof fe=="function"?fe.call(Le,$,P):fe,P==null)break e;$=y({},$,P);break e;case 2:bn=!0}}P=E.callback,P!==null&&(s.flags|=64,H&&(s.flags|=8192),H=g.callbacks,H===null?g.callbacks=[P]:H.push(P))}else H={lane:P,tag:E.tag,payload:E.payload,callback:E.callback,next:null},G===null?(L=G=H,b=$):G=G.next=H,_|=P;if(E=E.next,E===null){if(E=g.shared.pending,E===null)break;H=E,E=H.next,H.next=null,g.lastBaseUpdate=H,g.shared.pending=null}}while(!0);G===null&&(b=$),g.baseState=b,g.firstBaseUpdate=L,g.lastBaseUpdate=G,v===null&&(g.shared.lanes=0),Hn|=_,s.lanes=_,s.memoizedState=$}}function Md(s,o){if(typeof s!="function")throw Error(i(191,s));s.call(o)}function Nd(s,o){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)Md(l[s],o)}var ji=V(null),Ir=V(0);function kd(s,o){s=pn,X(Ir,s),X(ji,o),pn=s|o.baseLanes}function $l(){X(Ir,pn),X(ji,ji.current)}function Fl(){pn=Ir.current,Y(ji),Y(Ir)}var Nn=0,Te=null,De=null,Ke=null,Dr=!1,Ki=!1,fi=!1,Ur=0,co=0,Wi=null,K0=0;function Je(){throw Error(i(321))}function Yl(s,o){if(o===null)return!1;for(var l=0;l<o.length&&l<s.length;l++)if(!Et(s[l],o[l]))return!1;return!0}function Jl(s,o,l,d,g,v){return Nn=v,Te=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,U.H=s===null||s.memoizedState===null?mh:ph,fi=!1,v=l(d,g),fi=!1,Ki&&(v=Dd(o,l,d,g)),Id(s),v}function Id(s){U.H=Vr;var o=De!==null&&De.next!==null;if(Nn=0,Ke=De=Te=null,Dr=!1,co=0,Wi=null,o)throw Error(i(300));s===null||nt||(s=s.dependencies,s!==null&&br(s)&&(nt=!0))}function Dd(s,o,l,d){Te=s;var g=0;do{if(Ki&&(Wi=null),co=0,Ki=!1,25<=g)throw Error(i(301));if(g+=1,Ke=De=null,s.updateQueue!=null){var v=s.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}U.H=nT,v=o(l,d)}while(Ki);return v}function W0(){var s=U.H,o=s.useState()[0];return o=typeof o.then=="function"?fo(o):o,s=s.useState()[0],(De!==null?De.memoizedState:null)!==s&&(Te.flags|=1024),o}function jl(){var s=Ur!==0;return Ur=0,s}function Kl(s,o,l){o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~l}function Wl(s){if(Dr){for(s=s.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}Dr=!1}Nn=0,Ke=De=Te=null,Ki=!1,co=Ur=0,Wi=null}function yt(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ke===null?Te.memoizedState=Ke=s:Ke=Ke.next=s,Ke}function We(){if(De===null){var s=Te.alternate;s=s!==null?s.memoizedState:null}else s=De.next;var o=Ke===null?Te.memoizedState:Ke.next;if(o!==null)Ke=o,De=s;else{if(s===null)throw Te.alternate===null?Error(i(467)):Error(i(310));De=s,s={memoizedState:De.memoizedState,baseState:De.baseState,baseQueue:De.baseQueue,queue:De.queue,next:null},Ke===null?Te.memoizedState=Ke=s:Ke=Ke.next=s}return Ke}function Ql(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function fo(s){var o=co;return co+=1,Wi===null&&(Wi=[]),s=wd(Wi,s,o),o=Te,(Ke===null?o.memoizedState:Ke.next)===null&&(o=o.alternate,U.H=o===null||o.memoizedState===null?mh:ph),s}function Lr(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return fo(s);if(s.$$typeof===N)return ft(s)}throw Error(i(438,String(s)))}function Xl(s){var o=null,l=Te.updateQueue;if(l!==null&&(o=l.memoCache),o==null){var d=Te.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(o={data:d.data.map(function(g){return g.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),l===null&&(l=Ql(),Te.updateQueue=l),l.memoCache=o,l=o.data[o.index],l===void 0)for(l=o.data[o.index]=Array(s),d=0;d<s;d++)l[d]=ue;return o.index++,l}function un(s,o){return typeof o=="function"?o(s):o}function Pr(s){var o=We();return Zl(o,De,s)}function Zl(s,o,l){var d=s.queue;if(d===null)throw Error(i(311));d.lastRenderedReducer=l;var g=s.baseQueue,v=d.pending;if(v!==null){if(g!==null){var _=g.next;g.next=v.next,v.next=_}o.baseQueue=g=v,d.pending=null}if(v=s.baseState,g===null)s.memoizedState=v;else{o=g.next;var E=_=null,b=null,L=o,G=!1;do{var $=L.lane&-536870913;if($!==L.lane?(Ae&$)===$:(Nn&$)===$){var P=L.revertLane;if(P===0)b!==null&&(b=b.next={lane:0,revertLane:0,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null}),$===Yi&&(G=!0);else if((Nn&P)===P){L=L.next,P===Yi&&(G=!0);continue}else $={lane:0,revertLane:L.revertLane,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null},b===null?(E=b=$,_=v):b=b.next=$,Te.lanes|=P,Hn|=P;$=L.action,fi&&l(v,$),v=L.hasEagerState?L.eagerState:l(v,$)}else P={lane:$,revertLane:L.revertLane,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null},b===null?(E=b=P,_=v):b=b.next=P,Te.lanes|=$,Hn|=$;L=L.next}while(L!==null&&L!==o);if(b===null?_=v:b.next=E,!Et(v,s.memoizedState)&&(nt=!0,G&&(l=Ji,l!==null)))throw l;s.memoizedState=v,s.baseState=_,s.baseQueue=b,d.lastRenderedState=v}return g===null&&(d.lanes=0),[s.memoizedState,d.dispatch]}function eu(s){var o=We(),l=o.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=s;var d=l.dispatch,g=l.pending,v=o.memoizedState;if(g!==null){l.pending=null;var _=g=g.next;do v=s(v,_.action),_=_.next;while(_!==g);Et(v,o.memoizedState)||(nt=!0),o.memoizedState=v,o.baseQueue===null&&(o.baseState=v),l.lastRenderedState=v}return[v,d]}function Ud(s,o,l){var d=Te,g=We(),v=Re;if(v){if(l===void 0)throw Error(i(407));l=l()}else l=o();var _=!Et((De||g).memoizedState,l);_&&(g.memoizedState=l,nt=!0),g=g.queue;var E=Hd.bind(null,d,g,s);if(ho(2048,8,E,[s]),g.getSnapshot!==o||_||Ke!==null&&Ke.memoizedState.tag&1){if(d.flags|=2048,Qi(9,Hr(),Pd.bind(null,d,g,l,o),null),Oe===null)throw Error(i(349));v||(Nn&124)!==0||Ld(d,o,l)}return l}function Ld(s,o,l){s.flags|=16384,s={getSnapshot:o,value:l},o=Te.updateQueue,o===null?(o=Ql(),Te.updateQueue=o,o.stores=[s]):(l=o.stores,l===null?o.stores=[s]:l.push(s))}function Pd(s,o,l,d){o.value=l,o.getSnapshot=d,Od(o)&&Bd(s)}function Hd(s,o,l){return l(function(){Od(o)&&Bd(s)})}function Od(s){var o=s.getSnapshot;s=s.value;try{var l=o();return!Et(s,l)}catch{return!0}}function Bd(s){var o=Gi(s,2);o!==null&&Nt(o,s,2)}function tu(s){var o=yt();if(typeof s=="function"){var l=s;if(s=l(),fi){Cn(!0);try{l()}finally{Cn(!1)}}}return o.memoizedState=o.baseState=s,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:un,lastRenderedState:s},o}function Vd(s,o,l,d){return s.baseState=l,Zl(s,De,typeof d=="function"?d:un)}function Q0(s,o,l,d,g){if(Br(s))throw Error(i(485));if(s=o.action,s!==null){var v={payload:g,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(_){v.listeners.push(_)}};U.T!==null?l(!0):v.isTransition=!1,d(v),l=o.pending,l===null?(v.next=o.pending=v,qd(o,v)):(v.next=l.next,o.pending=l.next=v)}}function qd(s,o){var l=o.action,d=o.payload,g=s.state;if(o.isTransition){var v=U.T,_={};U.T=_;try{var E=l(g,d),b=U.S;b!==null&&b(_,E),Gd(s,o,E)}catch(L){nu(s,o,L)}finally{U.T=v}}else try{v=l(g,d),Gd(s,o,v)}catch(L){nu(s,o,L)}}function Gd(s,o,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(d){zd(s,o,d)},function(d){return nu(s,o,d)}):zd(s,o,l)}function zd(s,o,l){o.status="fulfilled",o.value=l,$d(o),s.state=l,o=s.pending,o!==null&&(l=o.next,l===o?s.pending=null:(l=l.next,o.next=l,qd(s,l)))}function nu(s,o,l){var d=s.pending;if(s.pending=null,d!==null){d=d.next;do o.status="rejected",o.reason=l,$d(o),o=o.next;while(o!==d)}s.action=null}function $d(s){s=s.listeners;for(var o=0;o<s.length;o++)(0,s[o])()}function Fd(s,o){return o}function Yd(s,o){if(Re){var l=Oe.formState;if(l!==null){e:{var d=Te;if(Re){if(Fe){t:{for(var g=Fe,v=jt;g.nodeType!==8;){if(!v){g=null;break t}if(g=$t(g.nextSibling),g===null){g=null;break t}}v=g.data,g=v==="F!"||v==="F"?g:null}if(g){Fe=$t(g.nextSibling),d=g.data==="F!";break e}}ai(d)}d=!1}d&&(o=l[0])}}return l=yt(),l.memoizedState=l.baseState=o,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fd,lastRenderedState:o},l.queue=d,l=fh.bind(null,Te,d),d.dispatch=l,d=tu(!1),v=au.bind(null,Te,!1,d.queue),d=yt(),g={state:o,dispatch:null,action:s,pending:null},d.queue=g,l=Q0.bind(null,Te,g,v,l),g.dispatch=l,d.memoizedState=s,[o,l,!1]}function Jd(s){var o=We();return jd(o,De,s)}function jd(s,o,l){if(o=Zl(s,o,Fd)[0],s=Pr(un)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var d=fo(o)}catch(_){throw _===oo?Nr:_}else d=o;o=We();var g=o.queue,v=g.dispatch;return l!==o.memoizedState&&(Te.flags|=2048,Qi(9,Hr(),X0.bind(null,g,l),null)),[d,v,s]}function X0(s,o){s.action=o}function Kd(s){var o=We(),l=De;if(l!==null)return jd(o,l,s);We(),o=o.memoizedState,l=We();var d=l.queue.dispatch;return l.memoizedState=s,[o,d,!1]}function Qi(s,o,l,d){return s={tag:s,create:l,deps:d,inst:o,next:null},o=Te.updateQueue,o===null&&(o=Ql(),Te.updateQueue=o),l=o.lastEffect,l===null?o.lastEffect=s.next=s:(d=l.next,l.next=s,s.next=d,o.lastEffect=s),s}function Hr(){return{destroy:void 0,resource:void 0}}function Wd(){return We().memoizedState}function Or(s,o,l,d){var g=yt();d=d===void 0?null:d,Te.flags|=s,g.memoizedState=Qi(1|o,Hr(),l,d)}function ho(s,o,l,d){var g=We();d=d===void 0?null:d;var v=g.memoizedState.inst;De!==null&&d!==null&&Yl(d,De.memoizedState.deps)?g.memoizedState=Qi(o,v,l,d):(Te.flags|=s,g.memoizedState=Qi(1|o,v,l,d))}function Qd(s,o){Or(8390656,8,s,o)}function Xd(s,o){ho(2048,8,s,o)}function Zd(s,o){return ho(4,2,s,o)}function eh(s,o){return ho(4,4,s,o)}function th(s,o){if(typeof o=="function"){s=s();var l=o(s);return function(){typeof l=="function"?l():o(null)}}if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function nh(s,o,l){l=l!=null?l.concat([s]):null,ho(4,4,th.bind(null,o,s),l)}function iu(){}function ih(s,o){var l=We();o=o===void 0?null:o;var d=l.memoizedState;return o!==null&&Yl(o,d[1])?d[0]:(l.memoizedState=[s,o],s)}function sh(s,o){var l=We();o=o===void 0?null:o;var d=l.memoizedState;if(o!==null&&Yl(o,d[1]))return d[0];if(d=s(),fi){Cn(!0);try{s()}finally{Cn(!1)}}return l.memoizedState=[d,o],d}function su(s,o,l){return l===void 0||(Nn&1073741824)!==0?s.memoizedState=o:(s.memoizedState=l,s=am(),Te.lanes|=s,Hn|=s,l)}function oh(s,o,l,d){return Et(l,o)?l:ji.current!==null?(s=su(s,l,d),Et(s,o)||(nt=!0),s):(Nn&42)===0?(nt=!0,s.memoizedState=l):(s=am(),Te.lanes|=s,Hn|=s,o)}function rh(s,o,l,d,g){var v=J.p;J.p=v!==0&&8>v?v:8;var _=U.T,E={};U.T=E,au(s,!1,o,l);try{var b=g(),L=U.S;if(L!==null&&L(E,b),b!==null&&typeof b=="object"&&typeof b.then=="function"){var G=j0(b,d);mo(s,o,G,Mt(s))}else mo(s,o,d,Mt(s))}catch($){mo(s,o,{then:function(){},status:"rejected",reason:$},Mt())}finally{J.p=v,U.T=_}}function Z0(){}function ou(s,o,l,d){if(s.tag!==5)throw Error(i(476));var g=ah(s).queue;rh(s,g,o,j,l===null?Z0:function(){return lh(s),l(d)})}function ah(s){var o=s.memoizedState;if(o!==null)return o;o={memoizedState:j,baseState:j,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:un,lastRenderedState:j},next:null};var l={};return o.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:un,lastRenderedState:l},next:null},s.memoizedState=o,s=s.alternate,s!==null&&(s.memoizedState=o),o}function lh(s){var o=ah(s).next.queue;mo(s,o,{},Mt())}function ru(){return ft(Io)}function uh(){return We().memoizedState}function ch(){return We().memoizedState}function eT(s){for(var o=s.return;o!==null;){switch(o.tag){case 24:case 3:var l=Mt();s=Rn(l);var d=Mn(o,s,l);d!==null&&(Nt(d,o,l),ao(d,o,l)),o={cache:Pl()},s.payload=o;return}o=o.return}}function tT(s,o,l){var d=Mt();l={lane:d,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},Br(s)?dh(o,l):(l=wl(s,o,l,d),l!==null&&(Nt(l,s,d),hh(l,o,d)))}function fh(s,o,l){var d=Mt();mo(s,o,l,d)}function mo(s,o,l,d){var g={lane:d,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(Br(s))dh(o,g);else{var v=s.alternate;if(s.lanes===0&&(v===null||v.lanes===0)&&(v=o.lastRenderedReducer,v!==null))try{var _=o.lastRenderedState,E=v(_,l);if(g.hasEagerState=!0,g.eagerState=E,Et(E,_))return _r(s,o,g,0),Oe===null&&xr(),!1}catch{}finally{}if(l=wl(s,o,g,d),l!==null)return Nt(l,s,d),hh(l,o,d),!0}return!1}function au(s,o,l,d){if(d={lane:2,revertLane:Bu(),action:d,hasEagerState:!1,eagerState:null,next:null},Br(s)){if(o)throw Error(i(479))}else o=wl(s,l,d,2),o!==null&&Nt(o,s,2)}function Br(s){var o=s.alternate;return s===Te||o!==null&&o===Te}function dh(s,o){Ki=Dr=!0;var l=s.pending;l===null?o.next=o:(o.next=l.next,l.next=o),s.pending=o}function hh(s,o,l){if((l&4194048)!==0){var d=o.lanes;d&=s.pendingLanes,l|=d,o.lanes=l,xf(s,l)}}var Vr={readContext:ft,use:Lr,useCallback:Je,useContext:Je,useEffect:Je,useImperativeHandle:Je,useLayoutEffect:Je,useInsertionEffect:Je,useMemo:Je,useReducer:Je,useRef:Je,useState:Je,useDebugValue:Je,useDeferredValue:Je,useTransition:Je,useSyncExternalStore:Je,useId:Je,useHostTransitionStatus:Je,useFormState:Je,useActionState:Je,useOptimistic:Je,useMemoCache:Je,useCacheRefresh:Je},mh={readContext:ft,use:Lr,useCallback:function(s,o){return yt().memoizedState=[s,o===void 0?null:o],s},useContext:ft,useEffect:Qd,useImperativeHandle:function(s,o,l){l=l!=null?l.concat([s]):null,Or(4194308,4,th.bind(null,o,s),l)},useLayoutEffect:function(s,o){return Or(4194308,4,s,o)},useInsertionEffect:function(s,o){Or(4,2,s,o)},useMemo:function(s,o){var l=yt();o=o===void 0?null:o;var d=s();if(fi){Cn(!0);try{s()}finally{Cn(!1)}}return l.memoizedState=[d,o],d},useReducer:function(s,o,l){var d=yt();if(l!==void 0){var g=l(o);if(fi){Cn(!0);try{l(o)}finally{Cn(!1)}}}else g=o;return d.memoizedState=d.baseState=g,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:g},d.queue=s,s=s.dispatch=tT.bind(null,Te,s),[d.memoizedState,s]},useRef:function(s){var o=yt();return s={current:s},o.memoizedState=s},useState:function(s){s=tu(s);var o=s.queue,l=fh.bind(null,Te,o);return o.dispatch=l,[s.memoizedState,l]},useDebugValue:iu,useDeferredValue:function(s,o){var l=yt();return su(l,s,o)},useTransition:function(){var s=tu(!1);return s=rh.bind(null,Te,s.queue,!0,!1),yt().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,o,l){var d=Te,g=yt();if(Re){if(l===void 0)throw Error(i(407));l=l()}else{if(l=o(),Oe===null)throw Error(i(349));(Ae&124)!==0||Ld(d,o,l)}g.memoizedState=l;var v={value:l,getSnapshot:o};return g.queue=v,Qd(Hd.bind(null,d,v,s),[s]),d.flags|=2048,Qi(9,Hr(),Pd.bind(null,d,v,l,o),null),l},useId:function(){var s=yt(),o=Oe.identifierPrefix;if(Re){var l=rn,d=on;l=(d&~(1<<32-Ct(d)-1)).toString(32)+l,o=""+o+"R"+l,l=Ur++,0<l&&(o+="H"+l.toString(32)),o+=""}else l=K0++,o=""+o+"r"+l.toString(32)+"";return s.memoizedState=o},useHostTransitionStatus:ru,useFormState:Yd,useActionState:Yd,useOptimistic:function(s){var o=yt();o.memoizedState=o.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=l,o=au.bind(null,Te,!0,l),l.dispatch=o,[s,o]},useMemoCache:Xl,useCacheRefresh:function(){return yt().memoizedState=eT.bind(null,Te)}},ph={readContext:ft,use:Lr,useCallback:ih,useContext:ft,useEffect:Xd,useImperativeHandle:nh,useInsertionEffect:Zd,useLayoutEffect:eh,useMemo:sh,useReducer:Pr,useRef:Wd,useState:function(){return Pr(un)},useDebugValue:iu,useDeferredValue:function(s,o){var l=We();return oh(l,De.memoizedState,s,o)},useTransition:function(){var s=Pr(un)[0],o=We().memoizedState;return[typeof s=="boolean"?s:fo(s),o]},useSyncExternalStore:Ud,useId:uh,useHostTransitionStatus:ru,useFormState:Jd,useActionState:Jd,useOptimistic:function(s,o){var l=We();return Vd(l,De,s,o)},useMemoCache:Xl,useCacheRefresh:ch},nT={readContext:ft,use:Lr,useCallback:ih,useContext:ft,useEffect:Xd,useImperativeHandle:nh,useInsertionEffect:Zd,useLayoutEffect:eh,useMemo:sh,useReducer:eu,useRef:Wd,useState:function(){return eu(un)},useDebugValue:iu,useDeferredValue:function(s,o){var l=We();return De===null?su(l,s,o):oh(l,De.memoizedState,s,o)},useTransition:function(){var s=eu(un)[0],o=We().memoizedState;return[typeof s=="boolean"?s:fo(s),o]},useSyncExternalStore:Ud,useId:uh,useHostTransitionStatus:ru,useFormState:Kd,useActionState:Kd,useOptimistic:function(s,o){var l=We();return De!==null?Vd(l,De,s,o):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:Xl,useCacheRefresh:ch},Xi=null,po=0;function qr(s){var o=po;return po+=1,Xi===null&&(Xi=[]),wd(Xi,s,o)}function go(s,o){o=o.props.ref,s.ref=o!==void 0?o:null}function Gr(s,o){throw o.$$typeof===T?Error(i(525)):(s=Object.prototype.toString.call(o),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s)))}function gh(s){var o=s._init;return o(s._payload)}function yh(s){function o(I,M){if(s){var D=I.deletions;D===null?(I.deletions=[M],I.flags|=16):D.push(M)}}function l(I,M){if(!s)return null;for(;M!==null;)o(I,M),M=M.sibling;return null}function d(I){for(var M=new Map;I!==null;)I.key!==null?M.set(I.key,I):M.set(I.index,I),I=I.sibling;return M}function g(I,M){return I=sn(I,M),I.index=0,I.sibling=null,I}function v(I,M,D){return I.index=D,s?(D=I.alternate,D!==null?(D=D.index,D<M?(I.flags|=67108866,M):D):(I.flags|=67108866,M)):(I.flags|=1048576,M)}function _(I){return s&&I.alternate===null&&(I.flags|=67108866),I}function E(I,M,D,z){return M===null||M.tag!==6?(M=Rl(D,I.mode,z),M.return=I,M):(M=g(M,D),M.return=I,M)}function b(I,M,D,z){var te=D.type;return te===A?G(I,M,D.props.children,z,D.key):M!==null&&(M.elementType===te||typeof te=="object"&&te!==null&&te.$$typeof===de&&gh(te)===M.type)?(M=g(M,D.props),go(M,D),M.return=I,M):(M=Er(D.type,D.key,D.props,null,I.mode,z),go(M,D),M.return=I,M)}function L(I,M,D,z){return M===null||M.tag!==4||M.stateNode.containerInfo!==D.containerInfo||M.stateNode.implementation!==D.implementation?(M=Ml(D,I.mode,z),M.return=I,M):(M=g(M,D.children||[]),M.return=I,M)}function G(I,M,D,z,te){return M===null||M.tag!==7?(M=ii(D,I.mode,z,te),M.return=I,M):(M=g(M,D),M.return=I,M)}function $(I,M,D){if(typeof M=="string"&&M!==""||typeof M=="number"||typeof M=="bigint")return M=Rl(""+M,I.mode,D),M.return=I,M;if(typeof M=="object"&&M!==null){switch(M.$$typeof){case x:return D=Er(M.type,M.key,M.props,null,I.mode,D),go(D,M),D.return=I,D;case C:return M=Ml(M,I.mode,D),M.return=I,M;case de:var z=M._init;return M=z(M._payload),$(I,M,D)}if(W(M)||pe(M))return M=ii(M,I.mode,D,null),M.return=I,M;if(typeof M.then=="function")return $(I,qr(M),D);if(M.$$typeof===N)return $(I,Rr(I,M),D);Gr(I,M)}return null}function P(I,M,D,z){var te=M!==null?M.key:null;if(typeof D=="string"&&D!==""||typeof D=="number"||typeof D=="bigint")return te!==null?null:E(I,M,""+D,z);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case x:return D.key===te?b(I,M,D,z):null;case C:return D.key===te?L(I,M,D,z):null;case de:return te=D._init,D=te(D._payload),P(I,M,D,z)}if(W(D)||pe(D))return te!==null?null:G(I,M,D,z,null);if(typeof D.then=="function")return P(I,M,qr(D),z);if(D.$$typeof===N)return P(I,M,Rr(I,D),z);Gr(I,D)}return null}function H(I,M,D,z,te){if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return I=I.get(D)||null,E(M,I,""+z,te);if(typeof z=="object"&&z!==null){switch(z.$$typeof){case x:return I=I.get(z.key===null?D:z.key)||null,b(M,I,z,te);case C:return I=I.get(z.key===null?D:z.key)||null,L(M,I,z,te);case de:var Se=z._init;return z=Se(z._payload),H(I,M,D,z,te)}if(W(z)||pe(z))return I=I.get(D)||null,G(M,I,z,te,null);if(typeof z.then=="function")return H(I,M,D,qr(z),te);if(z.$$typeof===N)return H(I,M,D,Rr(M,z),te);Gr(M,z)}return null}function fe(I,M,D,z){for(var te=null,Se=null,oe=M,ce=M=0,st=null;oe!==null&&ce<D.length;ce++){oe.index>ce?(st=oe,oe=null):st=oe.sibling;var be=P(I,oe,D[ce],z);if(be===null){oe===null&&(oe=st);break}s&&oe&&be.alternate===null&&o(I,oe),M=v(be,M,ce),Se===null?te=be:Se.sibling=be,Se=be,oe=st}if(ce===D.length)return l(I,oe),Re&&oi(I,ce),te;if(oe===null){for(;ce<D.length;ce++)oe=$(I,D[ce],z),oe!==null&&(M=v(oe,M,ce),Se===null?te=oe:Se.sibling=oe,Se=oe);return Re&&oi(I,ce),te}for(oe=d(oe);ce<D.length;ce++)st=H(oe,I,ce,D[ce],z),st!==null&&(s&&st.alternate!==null&&oe.delete(st.key===null?ce:st.key),M=v(st,M,ce),Se===null?te=st:Se.sibling=st,Se=st);return s&&oe.forEach(function(Yn){return o(I,Yn)}),Re&&oi(I,ce),te}function le(I,M,D,z){if(D==null)throw Error(i(151));for(var te=null,Se=null,oe=M,ce=M=0,st=null,be=D.next();oe!==null&&!be.done;ce++,be=D.next()){oe.index>ce?(st=oe,oe=null):st=oe.sibling;var Yn=P(I,oe,be.value,z);if(Yn===null){oe===null&&(oe=st);break}s&&oe&&Yn.alternate===null&&o(I,oe),M=v(Yn,M,ce),Se===null?te=Yn:Se.sibling=Yn,Se=Yn,oe=st}if(be.done)return l(I,oe),Re&&oi(I,ce),te;if(oe===null){for(;!be.done;ce++,be=D.next())be=$(I,be.value,z),be!==null&&(M=v(be,M,ce),Se===null?te=be:Se.sibling=be,Se=be);return Re&&oi(I,ce),te}for(oe=d(oe);!be.done;ce++,be=D.next())be=H(oe,I,ce,be.value,z),be!==null&&(s&&be.alternate!==null&&oe.delete(be.key===null?ce:be.key),M=v(be,M,ce),Se===null?te=be:Se.sibling=be,Se=be);return s&&oe.forEach(function(iS){return o(I,iS)}),Re&&oi(I,ce),te}function Le(I,M,D,z){if(typeof D=="object"&&D!==null&&D.type===A&&D.key===null&&(D=D.props.children),typeof D=="object"&&D!==null){switch(D.$$typeof){case x:e:{for(var te=D.key;M!==null;){if(M.key===te){if(te=D.type,te===A){if(M.tag===7){l(I,M.sibling),z=g(M,D.props.children),z.return=I,I=z;break e}}else if(M.elementType===te||typeof te=="object"&&te!==null&&te.$$typeof===de&&gh(te)===M.type){l(I,M.sibling),z=g(M,D.props),go(z,D),z.return=I,I=z;break e}l(I,M);break}else o(I,M);M=M.sibling}D.type===A?(z=ii(D.props.children,I.mode,z,D.key),z.return=I,I=z):(z=Er(D.type,D.key,D.props,null,I.mode,z),go(z,D),z.return=I,I=z)}return _(I);case C:e:{for(te=D.key;M!==null;){if(M.key===te)if(M.tag===4&&M.stateNode.containerInfo===D.containerInfo&&M.stateNode.implementation===D.implementation){l(I,M.sibling),z=g(M,D.children||[]),z.return=I,I=z;break e}else{l(I,M);break}else o(I,M);M=M.sibling}z=Ml(D,I.mode,z),z.return=I,I=z}return _(I);case de:return te=D._init,D=te(D._payload),Le(I,M,D,z)}if(W(D))return fe(I,M,D,z);if(pe(D)){if(te=pe(D),typeof te!="function")throw Error(i(150));return D=te.call(D),le(I,M,D,z)}if(typeof D.then=="function")return Le(I,M,qr(D),z);if(D.$$typeof===N)return Le(I,M,Rr(I,D),z);Gr(I,D)}return typeof D=="string"&&D!==""||typeof D=="number"||typeof D=="bigint"?(D=""+D,M!==null&&M.tag===6?(l(I,M.sibling),z=g(M,D),z.return=I,I=z):(l(I,M),z=Rl(D,I.mode,z),z.return=I,I=z),_(I)):l(I,M)}return function(I,M,D,z){try{po=0;var te=Le(I,M,D,z);return Xi=null,te}catch(oe){if(oe===oo||oe===Nr)throw oe;var Se=At(29,oe,null,I.mode);return Se.lanes=z,Se.return=I,Se}finally{}}}var Zi=yh(!0),vh=yh(!1),Ot=V(null),Kt=null;function kn(s){var o=s.alternate;X(Xe,Xe.current&1),X(Ot,s),Kt===null&&(o===null||ji.current!==null||o.memoizedState!==null)&&(Kt=s)}function Th(s){if(s.tag===22){if(X(Xe,Xe.current),X(Ot,s),Kt===null){var o=s.alternate;o!==null&&o.memoizedState!==null&&(Kt=s)}}else In()}function In(){X(Xe,Xe.current),X(Ot,Ot.current)}function cn(s){Y(Ot),Kt===s&&(Kt=null),Y(Xe)}var Xe=V(0);function zr(s){for(var o=s;o!==null;){if(o.tag===13){var l=o.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||Qu(l)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function lu(s,o,l,d){o=s.memoizedState,l=l(d,o),l=l==null?o:y({},o,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var uu={enqueueSetState:function(s,o,l){s=s._reactInternals;var d=Mt(),g=Rn(d);g.payload=o,l!=null&&(g.callback=l),o=Mn(s,g,d),o!==null&&(Nt(o,s,d),ao(o,s,d))},enqueueReplaceState:function(s,o,l){s=s._reactInternals;var d=Mt(),g=Rn(d);g.tag=1,g.payload=o,l!=null&&(g.callback=l),o=Mn(s,g,d),o!==null&&(Nt(o,s,d),ao(o,s,d))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var l=Mt(),d=Rn(l);d.tag=2,o!=null&&(d.callback=o),o=Mn(s,d,l),o!==null&&(Nt(o,s,l),ao(o,s,l))}};function Sh(s,o,l,d,g,v,_){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(d,v,_):o.prototype&&o.prototype.isPureReactComponent?!Qs(l,d)||!Qs(g,v):!0}function xh(s,o,l,d){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(l,d),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(l,d),o.state!==s&&uu.enqueueReplaceState(o,o.state,null)}function di(s,o){var l=o;if("ref"in o){l={};for(var d in o)d!=="ref"&&(l[d]=o[d])}if(s=s.defaultProps){l===o&&(l=y({},l));for(var g in s)l[g]===void 0&&(l[g]=s[g])}return l}var $r=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function _h(s){$r(s)}function Ch(s){console.error(s)}function Eh(s){$r(s)}function Fr(s,o){try{var l=s.onUncaughtError;l(o.value,{componentStack:o.stack})}catch(d){setTimeout(function(){throw d})}}function Ah(s,o,l){try{var d=s.onCaughtError;d(l.value,{componentStack:l.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function cu(s,o,l){return l=Rn(l),l.tag=3,l.payload={element:null},l.callback=function(){Fr(s,o)},l}function wh(s){return s=Rn(s),s.tag=3,s}function bh(s,o,l,d){var g=l.type.getDerivedStateFromError;if(typeof g=="function"){var v=d.value;s.payload=function(){return g(v)},s.callback=function(){Ah(o,l,d)}}var _=l.stateNode;_!==null&&typeof _.componentDidCatch=="function"&&(s.callback=function(){Ah(o,l,d),typeof g!="function"&&(On===null?On=new Set([this]):On.add(this));var E=d.stack;this.componentDidCatch(d.value,{componentStack:E!==null?E:""})})}function iT(s,o,l,d,g){if(l.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(o=l.alternate,o!==null&&no(o,l,g,!0),l=Ot.current,l!==null){switch(l.tag){case 13:return Kt===null?Uu():l.alternate===null&&Ye===0&&(Ye=3),l.flags&=-257,l.flags|=65536,l.lanes=g,d===Bl?l.flags|=16384:(o=l.updateQueue,o===null?l.updateQueue=new Set([d]):o.add(d),Pu(s,d,g)),!1;case 22:return l.flags|=65536,d===Bl?l.flags|=16384:(o=l.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([d])},l.updateQueue=o):(l=o.retryQueue,l===null?o.retryQueue=new Set([d]):l.add(d)),Pu(s,d,g)),!1}throw Error(i(435,l.tag))}return Pu(s,d,g),Uu(),!1}if(Re)return o=Ot.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=g,d!==Il&&(s=Error(i(422),{cause:d}),to(Ut(s,l)))):(d!==Il&&(o=Error(i(423),{cause:d}),to(Ut(o,l))),s=s.current.alternate,s.flags|=65536,g&=-g,s.lanes|=g,d=Ut(d,l),g=cu(s.stateNode,d,g),Gl(s,g),Ye!==4&&(Ye=2)),!1;var v=Error(i(520),{cause:d});if(v=Ut(v,l),Co===null?Co=[v]:Co.push(v),Ye!==4&&(Ye=2),o===null)return!0;d=Ut(d,l),l=o;do{switch(l.tag){case 3:return l.flags|=65536,s=g&-g,l.lanes|=s,s=cu(l.stateNode,d,s),Gl(l,s),!1;case 1:if(o=l.type,v=l.stateNode,(l.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(On===null||!On.has(v))))return l.flags|=65536,g&=-g,l.lanes|=g,g=wh(g),bh(g,s,l,d),Gl(l,g),!1}l=l.return}while(l!==null);return!1}var Rh=Error(i(461)),nt=!1;function at(s,o,l,d){o.child=s===null?vh(o,null,l,d):Zi(o,s.child,l,d)}function Mh(s,o,l,d,g){l=l.render;var v=o.ref;if("ref"in d){var _={};for(var E in d)E!=="ref"&&(_[E]=d[E])}else _=d;return ui(o),d=Jl(s,o,l,_,v,g),E=jl(),s!==null&&!nt?(Kl(s,o,g),fn(s,o,g)):(Re&&E&&Nl(o),o.flags|=1,at(s,o,d,g),o.child)}function Nh(s,o,l,d,g){if(s===null){var v=l.type;return typeof v=="function"&&!bl(v)&&v.defaultProps===void 0&&l.compare===null?(o.tag=15,o.type=v,kh(s,o,v,d,g)):(s=Er(l.type,null,d,o,o.mode,g),s.ref=o.ref,s.return=o,o.child=s)}if(v=s.child,!vu(s,g)){var _=v.memoizedProps;if(l=l.compare,l=l!==null?l:Qs,l(_,d)&&s.ref===o.ref)return fn(s,o,g)}return o.flags|=1,s=sn(v,d),s.ref=o.ref,s.return=o,o.child=s}function kh(s,o,l,d,g){if(s!==null){var v=s.memoizedProps;if(Qs(v,d)&&s.ref===o.ref)if(nt=!1,o.pendingProps=d=v,vu(s,g))(s.flags&131072)!==0&&(nt=!0);else return o.lanes=s.lanes,fn(s,o,g)}return fu(s,o,l,d,g)}function Ih(s,o,l){var d=o.pendingProps,g=d.children,v=s!==null?s.memoizedState:null;if(d.mode==="hidden"){if((o.flags&128)!==0){if(d=v!==null?v.baseLanes|l:l,s!==null){for(g=o.child=s.child,v=0;g!==null;)v=v|g.lanes|g.childLanes,g=g.sibling;o.childLanes=v&~d}else o.childLanes=0,o.child=null;return Dh(s,o,d,l)}if((l&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},s!==null&&Mr(o,v!==null?v.cachePool:null),v!==null?kd(o,v):$l(),Th(o);else return o.lanes=o.childLanes=536870912,Dh(s,o,v!==null?v.baseLanes|l:l,l)}else v!==null?(Mr(o,v.cachePool),kd(o,v),In(),o.memoizedState=null):(s!==null&&Mr(o,null),$l(),In());return at(s,o,g,l),o.child}function Dh(s,o,l,d){var g=Ol();return g=g===null?null:{parent:Qe._currentValue,pool:g},o.memoizedState={baseLanes:l,cachePool:g},s!==null&&Mr(o,null),$l(),Th(o),s!==null&&no(s,o,d,!0),null}function Yr(s,o){var l=o.ref;if(l===null)s!==null&&s.ref!==null&&(o.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(s===null||s.ref!==l)&&(o.flags|=4194816)}}function fu(s,o,l,d,g){return ui(o),l=Jl(s,o,l,d,void 0,g),d=jl(),s!==null&&!nt?(Kl(s,o,g),fn(s,o,g)):(Re&&d&&Nl(o),o.flags|=1,at(s,o,l,g),o.child)}function Uh(s,o,l,d,g,v){return ui(o),o.updateQueue=null,l=Dd(o,d,l,g),Id(s),d=jl(),s!==null&&!nt?(Kl(s,o,v),fn(s,o,v)):(Re&&d&&Nl(o),o.flags|=1,at(s,o,l,v),o.child)}function Lh(s,o,l,d,g){if(ui(o),o.stateNode===null){var v=zi,_=l.contextType;typeof _=="object"&&_!==null&&(v=ft(_)),v=new l(d,v),o.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=uu,o.stateNode=v,v._reactInternals=o,v=o.stateNode,v.props=d,v.state=o.memoizedState,v.refs={},Vl(o),_=l.contextType,v.context=typeof _=="object"&&_!==null?ft(_):zi,v.state=o.memoizedState,_=l.getDerivedStateFromProps,typeof _=="function"&&(lu(o,l,_,d),v.state=o.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(_=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),_!==v.state&&uu.enqueueReplaceState(v,v.state,null),uo(o,d,v,g),lo(),v.state=o.memoizedState),typeof v.componentDidMount=="function"&&(o.flags|=4194308),d=!0}else if(s===null){v=o.stateNode;var E=o.memoizedProps,b=di(l,E);v.props=b;var L=v.context,G=l.contextType;_=zi,typeof G=="object"&&G!==null&&(_=ft(G));var $=l.getDerivedStateFromProps;G=typeof $=="function"||typeof v.getSnapshotBeforeUpdate=="function",E=o.pendingProps!==E,G||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(E||L!==_)&&xh(o,v,d,_),bn=!1;var P=o.memoizedState;v.state=P,uo(o,d,v,g),lo(),L=o.memoizedState,E||P!==L||bn?(typeof $=="function"&&(lu(o,l,$,d),L=o.memoizedState),(b=bn||Sh(o,l,b,d,P,L,_))?(G||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(o.flags|=4194308)):(typeof v.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=d,o.memoizedState=L),v.props=d,v.state=L,v.context=_,d=b):(typeof v.componentDidMount=="function"&&(o.flags|=4194308),d=!1)}else{v=o.stateNode,ql(s,o),_=o.memoizedProps,G=di(l,_),v.props=G,$=o.pendingProps,P=v.context,L=l.contextType,b=zi,typeof L=="object"&&L!==null&&(b=ft(L)),E=l.getDerivedStateFromProps,(L=typeof E=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(_!==$||P!==b)&&xh(o,v,d,b),bn=!1,P=o.memoizedState,v.state=P,uo(o,d,v,g),lo();var H=o.memoizedState;_!==$||P!==H||bn||s!==null&&s.dependencies!==null&&br(s.dependencies)?(typeof E=="function"&&(lu(o,l,E,d),H=o.memoizedState),(G=bn||Sh(o,l,G,d,P,H,b)||s!==null&&s.dependencies!==null&&br(s.dependencies))?(L||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(d,H,b),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(d,H,b)),typeof v.componentDidUpdate=="function"&&(o.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof v.componentDidUpdate!="function"||_===s.memoizedProps&&P===s.memoizedState||(o.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||_===s.memoizedProps&&P===s.memoizedState||(o.flags|=1024),o.memoizedProps=d,o.memoizedState=H),v.props=d,v.state=H,v.context=b,d=G):(typeof v.componentDidUpdate!="function"||_===s.memoizedProps&&P===s.memoizedState||(o.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||_===s.memoizedProps&&P===s.memoizedState||(o.flags|=1024),d=!1)}return v=d,Yr(s,o),d=(o.flags&128)!==0,v||d?(v=o.stateNode,l=d&&typeof l.getDerivedStateFromError!="function"?null:v.render(),o.flags|=1,s!==null&&d?(o.child=Zi(o,s.child,null,g),o.child=Zi(o,null,l,g)):at(s,o,l,g),o.memoizedState=v.state,s=o.child):s=fn(s,o,g),s}function Ph(s,o,l,d){return eo(),o.flags|=256,at(s,o,l,d),o.child}var du={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function hu(s){return{baseLanes:s,cachePool:Cd()}}function mu(s,o,l){return s=s!==null?s.childLanes&~l:0,o&&(s|=Bt),s}function Hh(s,o,l){var d=o.pendingProps,g=!1,v=(o.flags&128)!==0,_;if((_=v)||(_=s!==null&&s.memoizedState===null?!1:(Xe.current&2)!==0),_&&(g=!0,o.flags&=-129),_=(o.flags&32)!==0,o.flags&=-33,s===null){if(Re){if(g?kn(o):In(),Re){var E=Fe,b;if(b=E){e:{for(b=E,E=jt;b.nodeType!==8;){if(!E){E=null;break e}if(b=$t(b.nextSibling),b===null){E=null;break e}}E=b}E!==null?(o.memoizedState={dehydrated:E,treeContext:si!==null?{id:on,overflow:rn}:null,retryLane:536870912,hydrationErrors:null},b=At(18,null,null,0),b.stateNode=E,b.return=o,o.child=b,mt=o,Fe=null,b=!0):b=!1}b||ai(o)}if(E=o.memoizedState,E!==null&&(E=E.dehydrated,E!==null))return Qu(E)?o.lanes=32:o.lanes=536870912,null;cn(o)}return E=d.children,d=d.fallback,g?(In(),g=o.mode,E=Jr({mode:"hidden",children:E},g),d=ii(d,g,l,null),E.return=o,d.return=o,E.sibling=d,o.child=E,g=o.child,g.memoizedState=hu(l),g.childLanes=mu(s,_,l),o.memoizedState=du,d):(kn(o),pu(o,E))}if(b=s.memoizedState,b!==null&&(E=b.dehydrated,E!==null)){if(v)o.flags&256?(kn(o),o.flags&=-257,o=gu(s,o,l)):o.memoizedState!==null?(In(),o.child=s.child,o.flags|=128,o=null):(In(),g=d.fallback,E=o.mode,d=Jr({mode:"visible",children:d.children},E),g=ii(g,E,l,null),g.flags|=2,d.return=o,g.return=o,d.sibling=g,o.child=d,Zi(o,s.child,null,l),d=o.child,d.memoizedState=hu(l),d.childLanes=mu(s,_,l),o.memoizedState=du,o=g);else if(kn(o),Qu(E)){if(_=E.nextSibling&&E.nextSibling.dataset,_)var L=_.dgst;_=L,d=Error(i(419)),d.stack="",d.digest=_,to({value:d,source:null,stack:null}),o=gu(s,o,l)}else if(nt||no(s,o,l,!1),_=(l&s.childLanes)!==0,nt||_){if(_=Oe,_!==null&&(d=l&-l,d=(d&42)!==0?1:Xa(d),d=(d&(_.suspendedLanes|l))!==0?0:d,d!==0&&d!==b.retryLane))throw b.retryLane=d,Gi(s,d),Nt(_,s,d),Rh;E.data==="$?"||Uu(),o=gu(s,o,l)}else E.data==="$?"?(o.flags|=192,o.child=s.child,o=null):(s=b.treeContext,Fe=$t(E.nextSibling),mt=o,Re=!0,ri=null,jt=!1,s!==null&&(Pt[Ht++]=on,Pt[Ht++]=rn,Pt[Ht++]=si,on=s.id,rn=s.overflow,si=o),o=pu(o,d.children),o.flags|=4096);return o}return g?(In(),g=d.fallback,E=o.mode,b=s.child,L=b.sibling,d=sn(b,{mode:"hidden",children:d.children}),d.subtreeFlags=b.subtreeFlags&65011712,L!==null?g=sn(L,g):(g=ii(g,E,l,null),g.flags|=2),g.return=o,d.return=o,d.sibling=g,o.child=d,d=g,g=o.child,E=s.child.memoizedState,E===null?E=hu(l):(b=E.cachePool,b!==null?(L=Qe._currentValue,b=b.parent!==L?{parent:L,pool:L}:b):b=Cd(),E={baseLanes:E.baseLanes|l,cachePool:b}),g.memoizedState=E,g.childLanes=mu(s,_,l),o.memoizedState=du,d):(kn(o),l=s.child,s=l.sibling,l=sn(l,{mode:"visible",children:d.children}),l.return=o,l.sibling=null,s!==null&&(_=o.deletions,_===null?(o.deletions=[s],o.flags|=16):_.push(s)),o.child=l,o.memoizedState=null,l)}function pu(s,o){return o=Jr({mode:"visible",children:o},s.mode),o.return=s,s.child=o}function Jr(s,o){return s=At(22,s,null,o),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function gu(s,o,l){return Zi(o,s.child,null,l),s=pu(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function Oh(s,o,l){s.lanes|=o;var d=s.alternate;d!==null&&(d.lanes|=o),Ul(s.return,o,l)}function yu(s,o,l,d,g){var v=s.memoizedState;v===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:d,tail:l,tailMode:g}:(v.isBackwards=o,v.rendering=null,v.renderingStartTime=0,v.last=d,v.tail=l,v.tailMode=g)}function Bh(s,o,l){var d=o.pendingProps,g=d.revealOrder,v=d.tail;if(at(s,o,d.children,l),d=Xe.current,(d&2)!==0)d=d&1|2,o.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Oh(s,l,o);else if(s.tag===19)Oh(s,l,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}d&=1}switch(X(Xe,d),g){case"forwards":for(l=o.child,g=null;l!==null;)s=l.alternate,s!==null&&zr(s)===null&&(g=l),l=l.sibling;l=g,l===null?(g=o.child,o.child=null):(g=l.sibling,l.sibling=null),yu(o,!1,g,l,v);break;case"backwards":for(l=null,g=o.child,o.child=null;g!==null;){if(s=g.alternate,s!==null&&zr(s)===null){o.child=g;break}s=g.sibling,g.sibling=l,l=g,g=s}yu(o,!0,l,null,v);break;case"together":yu(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function fn(s,o,l){if(s!==null&&(o.dependencies=s.dependencies),Hn|=o.lanes,(l&o.childLanes)===0)if(s!==null){if(no(s,o,l,!1),(l&o.childLanes)===0)return null}else return null;if(s!==null&&o.child!==s.child)throw Error(i(153));if(o.child!==null){for(s=o.child,l=sn(s,s.pendingProps),o.child=l,l.return=o;s.sibling!==null;)s=s.sibling,l=l.sibling=sn(s,s.pendingProps),l.return=o;l.sibling=null}return o.child}function vu(s,o){return(s.lanes&o)!==0?!0:(s=s.dependencies,!!(s!==null&&br(s)))}function sT(s,o,l){switch(o.tag){case 3:Ge(o,o.stateNode.containerInfo),wn(o,Qe,s.memoizedState.cache),eo();break;case 27:case 5:Ja(o);break;case 4:Ge(o,o.stateNode.containerInfo);break;case 10:wn(o,o.type,o.memoizedProps.value);break;case 13:var d=o.memoizedState;if(d!==null)return d.dehydrated!==null?(kn(o),o.flags|=128,null):(l&o.child.childLanes)!==0?Hh(s,o,l):(kn(o),s=fn(s,o,l),s!==null?s.sibling:null);kn(o);break;case 19:var g=(s.flags&128)!==0;if(d=(l&o.childLanes)!==0,d||(no(s,o,l,!1),d=(l&o.childLanes)!==0),g){if(d)return Bh(s,o,l);o.flags|=128}if(g=o.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),X(Xe,Xe.current),d)break;return null;case 22:case 23:return o.lanes=0,Ih(s,o,l);case 24:wn(o,Qe,s.memoizedState.cache)}return fn(s,o,l)}function Vh(s,o,l){if(s!==null)if(s.memoizedProps!==o.pendingProps)nt=!0;else{if(!vu(s,l)&&(o.flags&128)===0)return nt=!1,sT(s,o,l);nt=(s.flags&131072)!==0}else nt=!1,Re&&(o.flags&1048576)!==0&&gd(o,wr,o.index);switch(o.lanes=0,o.tag){case 16:e:{s=o.pendingProps;var d=o.elementType,g=d._init;if(d=g(d._payload),o.type=d,typeof d=="function")bl(d)?(s=di(d,s),o.tag=1,o=Lh(null,o,d,s,l)):(o.tag=0,o=fu(null,o,d,s,l));else{if(d!=null){if(g=d.$$typeof,g===q){o.tag=11,o=Mh(null,o,d,s,l);break e}else if(g===Q){o.tag=14,o=Nh(null,o,d,s,l);break e}}throw o=ve(d)||d,Error(i(306,o,""))}}return o;case 0:return fu(s,o,o.type,o.pendingProps,l);case 1:return d=o.type,g=di(d,o.pendingProps),Lh(s,o,d,g,l);case 3:e:{if(Ge(o,o.stateNode.containerInfo),s===null)throw Error(i(387));d=o.pendingProps;var v=o.memoizedState;g=v.element,ql(s,o),uo(o,d,null,l);var _=o.memoizedState;if(d=_.cache,wn(o,Qe,d),d!==v.cache&&Ll(o,[Qe],l,!0),lo(),d=_.element,v.isDehydrated)if(v={element:d,isDehydrated:!1,cache:_.cache},o.updateQueue.baseState=v,o.memoizedState=v,o.flags&256){o=Ph(s,o,d,l);break e}else if(d!==g){g=Ut(Error(i(424)),o),to(g),o=Ph(s,o,d,l);break e}else{switch(s=o.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Fe=$t(s.firstChild),mt=o,Re=!0,ri=null,jt=!0,l=vh(o,null,d,l),o.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(eo(),d===g){o=fn(s,o,l);break e}at(s,o,d,l)}o=o.child}return o;case 26:return Yr(s,o),s===null?(l=$m(o.type,null,o.pendingProps,null))?o.memoizedState=l:Re||(l=o.type,s=o.pendingProps,d=aa(me.current).createElement(l),d[ct]=o,d[pt]=s,ut(d,l,s),tt(d),o.stateNode=d):o.memoizedState=$m(o.type,s.memoizedProps,o.pendingProps,s.memoizedState),null;case 27:return Ja(o),s===null&&Re&&(d=o.stateNode=qm(o.type,o.pendingProps,me.current),mt=o,jt=!0,g=Fe,qn(o.type)?(Xu=g,Fe=$t(d.firstChild)):Fe=g),at(s,o,o.pendingProps.children,l),Yr(s,o),s===null&&(o.flags|=4194304),o.child;case 5:return s===null&&Re&&((g=d=Fe)&&(d=IT(d,o.type,o.pendingProps,jt),d!==null?(o.stateNode=d,mt=o,Fe=$t(d.firstChild),jt=!1,g=!0):g=!1),g||ai(o)),Ja(o),g=o.type,v=o.pendingProps,_=s!==null?s.memoizedProps:null,d=v.children,ju(g,v)?d=null:_!==null&&ju(g,_)&&(o.flags|=32),o.memoizedState!==null&&(g=Jl(s,o,W0,null,null,l),Io._currentValue=g),Yr(s,o),at(s,o,d,l),o.child;case 6:return s===null&&Re&&((s=l=Fe)&&(l=DT(l,o.pendingProps,jt),l!==null?(o.stateNode=l,mt=o,Fe=null,s=!0):s=!1),s||ai(o)),null;case 13:return Hh(s,o,l);case 4:return Ge(o,o.stateNode.containerInfo),d=o.pendingProps,s===null?o.child=Zi(o,null,d,l):at(s,o,d,l),o.child;case 11:return Mh(s,o,o.type,o.pendingProps,l);case 7:return at(s,o,o.pendingProps,l),o.child;case 8:return at(s,o,o.pendingProps.children,l),o.child;case 12:return at(s,o,o.pendingProps.children,l),o.child;case 10:return d=o.pendingProps,wn(o,o.type,d.value),at(s,o,d.children,l),o.child;case 9:return g=o.type._context,d=o.pendingProps.children,ui(o),g=ft(g),d=d(g),o.flags|=1,at(s,o,d,l),o.child;case 14:return Nh(s,o,o.type,o.pendingProps,l);case 15:return kh(s,o,o.type,o.pendingProps,l);case 19:return Bh(s,o,l);case 31:return d=o.pendingProps,l=o.mode,d={mode:d.mode,children:d.children},s===null?(l=Jr(d,l),l.ref=o.ref,o.child=l,l.return=o,o=l):(l=sn(s.child,d),l.ref=o.ref,o.child=l,l.return=o,o=l),o;case 22:return Ih(s,o,l);case 24:return ui(o),d=ft(Qe),s===null?(g=Ol(),g===null&&(g=Oe,v=Pl(),g.pooledCache=v,v.refCount++,v!==null&&(g.pooledCacheLanes|=l),g=v),o.memoizedState={parent:d,cache:g},Vl(o),wn(o,Qe,g)):((s.lanes&l)!==0&&(ql(s,o),uo(o,null,null,l),lo()),g=s.memoizedState,v=o.memoizedState,g.parent!==d?(g={parent:d,cache:d},o.memoizedState=g,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=g),wn(o,Qe,d)):(d=v.cache,wn(o,Qe,d),d!==g.cache&&Ll(o,[Qe],l,!0))),at(s,o,o.pendingProps.children,l),o.child;case 29:throw o.pendingProps}throw Error(i(156,o.tag))}function dn(s){s.flags|=4}function qh(s,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Km(o)){if(o=Ot.current,o!==null&&((Ae&4194048)===Ae?Kt!==null:(Ae&62914560)!==Ae&&(Ae&536870912)===0||o!==Kt))throw ro=Bl,Ed;s.flags|=8192}}function jr(s,o){o!==null&&(s.flags|=4),s.flags&16384&&(o=s.tag!==22?Tf():536870912,s.lanes|=o,is|=o)}function yo(s,o){if(!Re)switch(s.tailMode){case"hidden":o=s.tail;for(var l=null;o!==null;)o.alternate!==null&&(l=o),o=o.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:d.sibling=null}}function $e(s){var o=s.alternate!==null&&s.alternate.child===s.child,l=0,d=0;if(o)for(var g=s.child;g!==null;)l|=g.lanes|g.childLanes,d|=g.subtreeFlags&65011712,d|=g.flags&65011712,g.return=s,g=g.sibling;else for(g=s.child;g!==null;)l|=g.lanes|g.childLanes,d|=g.subtreeFlags,d|=g.flags,g.return=s,g=g.sibling;return s.subtreeFlags|=d,s.childLanes=l,o}function oT(s,o,l){var d=o.pendingProps;switch(kl(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $e(o),null;case 1:return $e(o),null;case 3:return l=o.stateNode,d=null,s!==null&&(d=s.memoizedState.cache),o.memoizedState.cache!==d&&(o.flags|=2048),ln(Qe),_n(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(Zs(o)?dn(o):s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Td())),$e(o),null;case 26:return l=o.memoizedState,s===null?(dn(o),l!==null?($e(o),qh(o,l)):($e(o),o.flags&=-16777217)):l?l!==s.memoizedState?(dn(o),$e(o),qh(o,l)):($e(o),o.flags&=-16777217):(s.memoizedProps!==d&&dn(o),$e(o),o.flags&=-16777217),null;case 27:or(o),l=me.current;var g=o.type;if(s!==null&&o.stateNode!=null)s.memoizedProps!==d&&dn(o);else{if(!d){if(o.stateNode===null)throw Error(i(166));return $e(o),null}s=Z.current,Zs(o)?yd(o):(s=qm(g,d,l),o.stateNode=s,dn(o))}return $e(o),null;case 5:if(or(o),l=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==d&&dn(o);else{if(!d){if(o.stateNode===null)throw Error(i(166));return $e(o),null}if(s=Z.current,Zs(o))yd(o);else{switch(g=aa(me.current),s){case 1:s=g.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:s=g.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":s=g.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":s=g.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":s=g.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof d.is=="string"?g.createElement("select",{is:d.is}):g.createElement("select"),d.multiple?s.multiple=!0:d.size&&(s.size=d.size);break;default:s=typeof d.is=="string"?g.createElement(l,{is:d.is}):g.createElement(l)}}s[ct]=o,s[pt]=d;e:for(g=o.child;g!==null;){if(g.tag===5||g.tag===6)s.appendChild(g.stateNode);else if(g.tag!==4&&g.tag!==27&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===o)break e;for(;g.sibling===null;){if(g.return===null||g.return===o)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}o.stateNode=s;e:switch(ut(s,l,d),l){case"button":case"input":case"select":case"textarea":s=!!d.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&dn(o)}}return $e(o),o.flags&=-16777217,null;case 6:if(s&&o.stateNode!=null)s.memoizedProps!==d&&dn(o);else{if(typeof d!="string"&&o.stateNode===null)throw Error(i(166));if(s=me.current,Zs(o)){if(s=o.stateNode,l=o.memoizedProps,d=null,g=mt,g!==null)switch(g.tag){case 27:case 5:d=g.memoizedProps}s[ct]=o,s=!!(s.nodeValue===l||d!==null&&d.suppressHydrationWarning===!0||Um(s.nodeValue,l)),s||ai(o)}else s=aa(s).createTextNode(d),s[ct]=o,o.stateNode=s}return $e(o),null;case 13:if(d=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(g=Zs(o),d!==null&&d.dehydrated!==null){if(s===null){if(!g)throw Error(i(318));if(g=o.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(i(317));g[ct]=o}else eo(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;$e(o),g=!1}else g=Td(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=g),g=!0;if(!g)return o.flags&256?(cn(o),o):(cn(o),null)}if(cn(o),(o.flags&128)!==0)return o.lanes=l,o;if(l=d!==null,s=s!==null&&s.memoizedState!==null,l){d=o.child,g=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(g=d.alternate.memoizedState.cachePool.pool);var v=null;d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(v=d.memoizedState.cachePool.pool),v!==g&&(d.flags|=2048)}return l!==s&&l&&(o.child.flags|=8192),jr(o,o.updateQueue),$e(o),null;case 4:return _n(),s===null&&zu(o.stateNode.containerInfo),$e(o),null;case 10:return ln(o.type),$e(o),null;case 19:if(Y(Xe),g=o.memoizedState,g===null)return $e(o),null;if(d=(o.flags&128)!==0,v=g.rendering,v===null)if(d)yo(g,!1);else{if(Ye!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(v=zr(s),v!==null){for(o.flags|=128,yo(g,!1),s=v.updateQueue,o.updateQueue=s,jr(o,s),o.subtreeFlags=0,s=l,l=o.child;l!==null;)pd(l,s),l=l.sibling;return X(Xe,Xe.current&1|2),o.child}s=s.sibling}g.tail!==null&&Jt()>Qr&&(o.flags|=128,d=!0,yo(g,!1),o.lanes=4194304)}else{if(!d)if(s=zr(v),s!==null){if(o.flags|=128,d=!0,s=s.updateQueue,o.updateQueue=s,jr(o,s),yo(g,!0),g.tail===null&&g.tailMode==="hidden"&&!v.alternate&&!Re)return $e(o),null}else 2*Jt()-g.renderingStartTime>Qr&&l!==536870912&&(o.flags|=128,d=!0,yo(g,!1),o.lanes=4194304);g.isBackwards?(v.sibling=o.child,o.child=v):(s=g.last,s!==null?s.sibling=v:o.child=v,g.last=v)}return g.tail!==null?(o=g.tail,g.rendering=o,g.tail=o.sibling,g.renderingStartTime=Jt(),o.sibling=null,s=Xe.current,X(Xe,d?s&1|2:s&1),o):($e(o),null);case 22:case 23:return cn(o),Fl(),d=o.memoizedState!==null,s!==null?s.memoizedState!==null!==d&&(o.flags|=8192):d&&(o.flags|=8192),d?(l&536870912)!==0&&(o.flags&128)===0&&($e(o),o.subtreeFlags&6&&(o.flags|=8192)):$e(o),l=o.updateQueue,l!==null&&jr(o,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),d=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(d=o.memoizedState.cachePool.pool),d!==l&&(o.flags|=2048),s!==null&&Y(ci),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),o.memoizedState.cache!==l&&(o.flags|=2048),ln(Qe),$e(o),null;case 25:return null;case 30:return null}throw Error(i(156,o.tag))}function rT(s,o){switch(kl(o),o.tag){case 1:return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return ln(Qe),_n(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 26:case 27:case 5:return or(o),null;case 13:if(cn(o),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(i(340));eo()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return Y(Xe),null;case 4:return _n(),null;case 10:return ln(o.type),null;case 22:case 23:return cn(o),Fl(),s!==null&&Y(ci),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 24:return ln(Qe),null;case 25:return null;default:return null}}function Gh(s,o){switch(kl(o),o.tag){case 3:ln(Qe),_n();break;case 26:case 27:case 5:or(o);break;case 4:_n();break;case 13:cn(o);break;case 19:Y(Xe);break;case 10:ln(o.type);break;case 22:case 23:cn(o),Fl(),s!==null&&Y(ci);break;case 24:ln(Qe)}}function vo(s,o){try{var l=o.updateQueue,d=l!==null?l.lastEffect:null;if(d!==null){var g=d.next;l=g;do{if((l.tag&s)===s){d=void 0;var v=l.create,_=l.inst;d=v(),_.destroy=d}l=l.next}while(l!==g)}}catch(E){He(o,o.return,E)}}function Dn(s,o,l){try{var d=o.updateQueue,g=d!==null?d.lastEffect:null;if(g!==null){var v=g.next;d=v;do{if((d.tag&s)===s){var _=d.inst,E=_.destroy;if(E!==void 0){_.destroy=void 0,g=o;var b=l,L=E;try{L()}catch(G){He(g,b,G)}}}d=d.next}while(d!==v)}}catch(G){He(o,o.return,G)}}function zh(s){var o=s.updateQueue;if(o!==null){var l=s.stateNode;try{Nd(o,l)}catch(d){He(s,s.return,d)}}}function $h(s,o,l){l.props=di(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(d){He(s,o,d)}}function To(s,o){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var d=s.stateNode;break;case 30:d=s.stateNode;break;default:d=s.stateNode}typeof l=="function"?s.refCleanup=l(d):l.current=d}}catch(g){He(s,o,g)}}function Wt(s,o){var l=s.ref,d=s.refCleanup;if(l!==null)if(typeof d=="function")try{d()}catch(g){He(s,o,g)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(g){He(s,o,g)}else l.current=null}function Fh(s){var o=s.type,l=s.memoizedProps,d=s.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":l.autoFocus&&d.focus();break e;case"img":l.src?d.src=l.src:l.srcSet&&(d.srcset=l.srcSet)}}catch(g){He(s,s.return,g)}}function Tu(s,o,l){try{var d=s.stateNode;bT(d,s.type,l,o),d[pt]=o}catch(g){He(s,s.return,g)}}function Yh(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&qn(s.type)||s.tag===4}function Su(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Yh(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&qn(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function xu(s,o,l){var d=s.tag;if(d===5||d===6)s=s.stateNode,o?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,o):(o=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,o.appendChild(s),l=l._reactRootContainer,l!=null||o.onclick!==null||(o.onclick=ra));else if(d!==4&&(d===27&&qn(s.type)&&(l=s.stateNode,o=null),s=s.child,s!==null))for(xu(s,o,l),s=s.sibling;s!==null;)xu(s,o,l),s=s.sibling}function Kr(s,o,l){var d=s.tag;if(d===5||d===6)s=s.stateNode,o?l.insertBefore(s,o):l.appendChild(s);else if(d!==4&&(d===27&&qn(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(Kr(s,o,l),s=s.sibling;s!==null;)Kr(s,o,l),s=s.sibling}function Jh(s){var o=s.stateNode,l=s.memoizedProps;try{for(var d=s.type,g=o.attributes;g.length;)o.removeAttributeNode(g[0]);ut(o,d,l),o[ct]=s,o[pt]=l}catch(v){He(s,s.return,v)}}var hn=!1,je=!1,_u=!1,jh=typeof WeakSet=="function"?WeakSet:Set,it=null;function aT(s,o){if(s=s.containerInfo,Yu=ha,s=od(s),Sl(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var d=l.getSelection&&l.getSelection();if(d&&d.rangeCount!==0){l=d.anchorNode;var g=d.anchorOffset,v=d.focusNode;d=d.focusOffset;try{l.nodeType,v.nodeType}catch{l=null;break e}var _=0,E=-1,b=-1,L=0,G=0,$=s,P=null;t:for(;;){for(var H;$!==l||g!==0&&$.nodeType!==3||(E=_+g),$!==v||d!==0&&$.nodeType!==3||(b=_+d),$.nodeType===3&&(_+=$.nodeValue.length),(H=$.firstChild)!==null;)P=$,$=H;for(;;){if($===s)break t;if(P===l&&++L===g&&(E=_),P===v&&++G===d&&(b=_),(H=$.nextSibling)!==null)break;$=P,P=$.parentNode}$=H}l=E===-1||b===-1?null:{start:E,end:b}}else l=null}l=l||{start:0,end:0}}else l=null;for(Ju={focusedElem:s,selectionRange:l},ha=!1,it=o;it!==null;)if(o=it,s=o.child,(o.subtreeFlags&1024)!==0&&s!==null)s.return=o,it=s;else for(;it!==null;){switch(o=it,v=o.alternate,s=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&v!==null){s=void 0,l=o,g=v.memoizedProps,v=v.memoizedState,d=l.stateNode;try{var fe=di(l.type,g,l.elementType===l.type);s=d.getSnapshotBeforeUpdate(fe,v),d.__reactInternalSnapshotBeforeUpdate=s}catch(le){He(l,l.return,le)}}break;case 3:if((s&1024)!==0){if(s=o.stateNode.containerInfo,l=s.nodeType,l===9)Wu(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Wu(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=o.sibling,s!==null){s.return=o.return,it=s;break}it=o.return}}function Kh(s,o,l){var d=l.flags;switch(l.tag){case 0:case 11:case 15:Un(s,l),d&4&&vo(5,l);break;case 1:if(Un(s,l),d&4)if(s=l.stateNode,o===null)try{s.componentDidMount()}catch(_){He(l,l.return,_)}else{var g=di(l.type,o.memoizedProps);o=o.memoizedState;try{s.componentDidUpdate(g,o,s.__reactInternalSnapshotBeforeUpdate)}catch(_){He(l,l.return,_)}}d&64&&zh(l),d&512&&To(l,l.return);break;case 3:if(Un(s,l),d&64&&(s=l.updateQueue,s!==null)){if(o=null,l.child!==null)switch(l.child.tag){case 27:case 5:o=l.child.stateNode;break;case 1:o=l.child.stateNode}try{Nd(s,o)}catch(_){He(l,l.return,_)}}break;case 27:o===null&&d&4&&Jh(l);case 26:case 5:Un(s,l),o===null&&d&4&&Fh(l),d&512&&To(l,l.return);break;case 12:Un(s,l);break;case 13:Un(s,l),d&4&&Xh(s,l),d&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=gT.bind(null,l),UT(s,l))));break;case 22:if(d=l.memoizedState!==null||hn,!d){o=o!==null&&o.memoizedState!==null||je,g=hn;var v=je;hn=d,(je=o)&&!v?Ln(s,l,(l.subtreeFlags&8772)!==0):Un(s,l),hn=g,je=v}break;case 30:break;default:Un(s,l)}}function Wh(s){var o=s.alternate;o!==null&&(s.alternate=null,Wh(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&tl(o)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var ze=null,vt=!1;function mn(s,o,l){for(l=l.child;l!==null;)Qh(s,o,l),l=l.sibling}function Qh(s,o,l){if(_t&&typeof _t.onCommitFiberUnmount=="function")try{_t.onCommitFiberUnmount(Bs,l)}catch{}switch(l.tag){case 26:je||Wt(l,o),mn(s,o,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:je||Wt(l,o);var d=ze,g=vt;qn(l.type)&&(ze=l.stateNode,vt=!1),mn(s,o,l),Ro(l.stateNode),ze=d,vt=g;break;case 5:je||Wt(l,o);case 6:if(d=ze,g=vt,ze=null,mn(s,o,l),ze=d,vt=g,ze!==null)if(vt)try{(ze.nodeType===9?ze.body:ze.nodeName==="HTML"?ze.ownerDocument.body:ze).removeChild(l.stateNode)}catch(v){He(l,o,v)}else try{ze.removeChild(l.stateNode)}catch(v){He(l,o,v)}break;case 18:ze!==null&&(vt?(s=ze,Bm(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),Po(s)):Bm(ze,l.stateNode));break;case 4:d=ze,g=vt,ze=l.stateNode.containerInfo,vt=!0,mn(s,o,l),ze=d,vt=g;break;case 0:case 11:case 14:case 15:je||Dn(2,l,o),je||Dn(4,l,o),mn(s,o,l);break;case 1:je||(Wt(l,o),d=l.stateNode,typeof d.componentWillUnmount=="function"&&$h(l,o,d)),mn(s,o,l);break;case 21:mn(s,o,l);break;case 22:je=(d=je)||l.memoizedState!==null,mn(s,o,l),je=d;break;default:mn(s,o,l)}}function Xh(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Po(s)}catch(l){He(o,o.return,l)}}function lT(s){switch(s.tag){case 13:case 19:var o=s.stateNode;return o===null&&(o=s.stateNode=new jh),o;case 22:return s=s.stateNode,o=s._retryCache,o===null&&(o=s._retryCache=new jh),o;default:throw Error(i(435,s.tag))}}function Cu(s,o){var l=lT(s);o.forEach(function(d){var g=yT.bind(null,s,d);l.has(d)||(l.add(d),d.then(g,g))})}function wt(s,o){var l=o.deletions;if(l!==null)for(var d=0;d<l.length;d++){var g=l[d],v=s,_=o,E=_;e:for(;E!==null;){switch(E.tag){case 27:if(qn(E.type)){ze=E.stateNode,vt=!1;break e}break;case 5:ze=E.stateNode,vt=!1;break e;case 3:case 4:ze=E.stateNode.containerInfo,vt=!0;break e}E=E.return}if(ze===null)throw Error(i(160));Qh(v,_,g),ze=null,vt=!1,v=g.alternate,v!==null&&(v.return=null),g.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)Zh(o,s),o=o.sibling}var zt=null;function Zh(s,o){var l=s.alternate,d=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:wt(o,s),bt(s),d&4&&(Dn(3,s,s.return),vo(3,s),Dn(5,s,s.return));break;case 1:wt(o,s),bt(s),d&512&&(je||l===null||Wt(l,l.return)),d&64&&hn&&(s=s.updateQueue,s!==null&&(d=s.callbacks,d!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?d:l.concat(d))));break;case 26:var g=zt;if(wt(o,s),bt(s),d&512&&(je||l===null||Wt(l,l.return)),d&4){var v=l!==null?l.memoizedState:null;if(d=s.memoizedState,l===null)if(d===null)if(s.stateNode===null){e:{d=s.type,l=s.memoizedProps,g=g.ownerDocument||g;t:switch(d){case"title":v=g.getElementsByTagName("title")[0],(!v||v[Gs]||v[ct]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=g.createElement(d),g.head.insertBefore(v,g.querySelector("head > title"))),ut(v,d,l),v[ct]=s,tt(v),d=v;break e;case"link":var _=Jm("link","href",g).get(d+(l.href||""));if(_){for(var E=0;E<_.length;E++)if(v=_[E],v.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&v.getAttribute("rel")===(l.rel==null?null:l.rel)&&v.getAttribute("title")===(l.title==null?null:l.title)&&v.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){_.splice(E,1);break t}}v=g.createElement(d),ut(v,d,l),g.head.appendChild(v);break;case"meta":if(_=Jm("meta","content",g).get(d+(l.content||""))){for(E=0;E<_.length;E++)if(v=_[E],v.getAttribute("content")===(l.content==null?null:""+l.content)&&v.getAttribute("name")===(l.name==null?null:l.name)&&v.getAttribute("property")===(l.property==null?null:l.property)&&v.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&v.getAttribute("charset")===(l.charSet==null?null:l.charSet)){_.splice(E,1);break t}}v=g.createElement(d),ut(v,d,l),g.head.appendChild(v);break;default:throw Error(i(468,d))}v[ct]=s,tt(v),d=v}s.stateNode=d}else jm(g,s.type,s.stateNode);else s.stateNode=Ym(g,d,s.memoizedProps);else v!==d?(v===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):v.count--,d===null?jm(g,s.type,s.stateNode):Ym(g,d,s.memoizedProps)):d===null&&s.stateNode!==null&&Tu(s,s.memoizedProps,l.memoizedProps)}break;case 27:wt(o,s),bt(s),d&512&&(je||l===null||Wt(l,l.return)),l!==null&&d&4&&Tu(s,s.memoizedProps,l.memoizedProps);break;case 5:if(wt(o,s),bt(s),d&512&&(je||l===null||Wt(l,l.return)),s.flags&32){g=s.stateNode;try{Li(g,"")}catch(H){He(s,s.return,H)}}d&4&&s.stateNode!=null&&(g=s.memoizedProps,Tu(s,g,l!==null?l.memoizedProps:g)),d&1024&&(_u=!0);break;case 6:if(wt(o,s),bt(s),d&4){if(s.stateNode===null)throw Error(i(162));d=s.memoizedProps,l=s.stateNode;try{l.nodeValue=d}catch(H){He(s,s.return,H)}}break;case 3:if(ca=null,g=zt,zt=la(o.containerInfo),wt(o,s),zt=g,bt(s),d&4&&l!==null&&l.memoizedState.isDehydrated)try{Po(o.containerInfo)}catch(H){He(s,s.return,H)}_u&&(_u=!1,em(s));break;case 4:d=zt,zt=la(s.stateNode.containerInfo),wt(o,s),bt(s),zt=d;break;case 12:wt(o,s),bt(s);break;case 13:wt(o,s),bt(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Mu=Jt()),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,Cu(s,d)));break;case 22:g=s.memoizedState!==null;var b=l!==null&&l.memoizedState!==null,L=hn,G=je;if(hn=L||g,je=G||b,wt(o,s),je=G,hn=L,bt(s),d&8192)e:for(o=s.stateNode,o._visibility=g?o._visibility&-2:o._visibility|1,g&&(l===null||b||hn||je||hi(s)),l=null,o=s;;){if(o.tag===5||o.tag===26){if(l===null){b=l=o;try{if(v=b.stateNode,g)_=v.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none";else{E=b.stateNode;var $=b.memoizedProps.style,P=$!=null&&$.hasOwnProperty("display")?$.display:null;E.style.display=P==null||typeof P=="boolean"?"":(""+P).trim()}}catch(H){He(b,b.return,H)}}}else if(o.tag===6){if(l===null){b=o;try{b.stateNode.nodeValue=g?"":b.memoizedProps}catch(H){He(b,b.return,H)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===s)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break e;for(;o.sibling===null;){if(o.return===null||o.return===s)break e;l===o&&(l=null),o=o.return}l===o&&(l=null),o.sibling.return=o.return,o=o.sibling}d&4&&(d=s.updateQueue,d!==null&&(l=d.retryQueue,l!==null&&(d.retryQueue=null,Cu(s,l))));break;case 19:wt(o,s),bt(s),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,Cu(s,d)));break;case 30:break;case 21:break;default:wt(o,s),bt(s)}}function bt(s){var o=s.flags;if(o&2){try{for(var l,d=s.return;d!==null;){if(Yh(d)){l=d;break}d=d.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var g=l.stateNode,v=Su(s);Kr(s,v,g);break;case 5:var _=l.stateNode;l.flags&32&&(Li(_,""),l.flags&=-33);var E=Su(s);Kr(s,E,_);break;case 3:case 4:var b=l.stateNode.containerInfo,L=Su(s);xu(s,L,b);break;default:throw Error(i(161))}}catch(G){He(s,s.return,G)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function em(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var o=s;em(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),s=s.sibling}}function Un(s,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)Kh(s,o.alternate,o),o=o.sibling}function hi(s){for(s=s.child;s!==null;){var o=s;switch(o.tag){case 0:case 11:case 14:case 15:Dn(4,o,o.return),hi(o);break;case 1:Wt(o,o.return);var l=o.stateNode;typeof l.componentWillUnmount=="function"&&$h(o,o.return,l),hi(o);break;case 27:Ro(o.stateNode);case 26:case 5:Wt(o,o.return),hi(o);break;case 22:o.memoizedState===null&&hi(o);break;case 30:hi(o);break;default:hi(o)}s=s.sibling}}function Ln(s,o,l){for(l=l&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var d=o.alternate,g=s,v=o,_=v.flags;switch(v.tag){case 0:case 11:case 15:Ln(g,v,l),vo(4,v);break;case 1:if(Ln(g,v,l),d=v,g=d.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(L){He(d,d.return,L)}if(d=v,g=d.updateQueue,g!==null){var E=d.stateNode;try{var b=g.shared.hiddenCallbacks;if(b!==null)for(g.shared.hiddenCallbacks=null,g=0;g<b.length;g++)Md(b[g],E)}catch(L){He(d,d.return,L)}}l&&_&64&&zh(v),To(v,v.return);break;case 27:Jh(v);case 26:case 5:Ln(g,v,l),l&&d===null&&_&4&&Fh(v),To(v,v.return);break;case 12:Ln(g,v,l);break;case 13:Ln(g,v,l),l&&_&4&&Xh(g,v);break;case 22:v.memoizedState===null&&Ln(g,v,l),To(v,v.return);break;case 30:break;default:Ln(g,v,l)}o=o.sibling}}function Eu(s,o){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(s=o.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&io(l))}function Au(s,o){s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&io(s))}function Qt(s,o,l,d){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)tm(s,o,l,d),o=o.sibling}function tm(s,o,l,d){var g=o.flags;switch(o.tag){case 0:case 11:case 15:Qt(s,o,l,d),g&2048&&vo(9,o);break;case 1:Qt(s,o,l,d);break;case 3:Qt(s,o,l,d),g&2048&&(s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&io(s)));break;case 12:if(g&2048){Qt(s,o,l,d),s=o.stateNode;try{var v=o.memoizedProps,_=v.id,E=v.onPostCommit;typeof E=="function"&&E(_,o.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(b){He(o,o.return,b)}}else Qt(s,o,l,d);break;case 13:Qt(s,o,l,d);break;case 23:break;case 22:v=o.stateNode,_=o.alternate,o.memoizedState!==null?v._visibility&2?Qt(s,o,l,d):So(s,o):v._visibility&2?Qt(s,o,l,d):(v._visibility|=2,es(s,o,l,d,(o.subtreeFlags&10256)!==0)),g&2048&&Eu(_,o);break;case 24:Qt(s,o,l,d),g&2048&&Au(o.alternate,o);break;default:Qt(s,o,l,d)}}function es(s,o,l,d,g){for(g=g&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var v=s,_=o,E=l,b=d,L=_.flags;switch(_.tag){case 0:case 11:case 15:es(v,_,E,b,g),vo(8,_);break;case 23:break;case 22:var G=_.stateNode;_.memoizedState!==null?G._visibility&2?es(v,_,E,b,g):So(v,_):(G._visibility|=2,es(v,_,E,b,g)),g&&L&2048&&Eu(_.alternate,_);break;case 24:es(v,_,E,b,g),g&&L&2048&&Au(_.alternate,_);break;default:es(v,_,E,b,g)}o=o.sibling}}function So(s,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var l=s,d=o,g=d.flags;switch(d.tag){case 22:So(l,d),g&2048&&Eu(d.alternate,d);break;case 24:So(l,d),g&2048&&Au(d.alternate,d);break;default:So(l,d)}o=o.sibling}}var xo=8192;function ts(s){if(s.subtreeFlags&xo)for(s=s.child;s!==null;)nm(s),s=s.sibling}function nm(s){switch(s.tag){case 26:ts(s),s.flags&xo&&s.memoizedState!==null&&JT(zt,s.memoizedState,s.memoizedProps);break;case 5:ts(s);break;case 3:case 4:var o=zt;zt=la(s.stateNode.containerInfo),ts(s),zt=o;break;case 22:s.memoizedState===null&&(o=s.alternate,o!==null&&o.memoizedState!==null?(o=xo,xo=16777216,ts(s),xo=o):ts(s));break;default:ts(s)}}function im(s){var o=s.alternate;if(o!==null&&(s=o.child,s!==null)){o.child=null;do o=s.sibling,s.sibling=null,s=o;while(s!==null)}}function _o(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var l=0;l<o.length;l++){var d=o[l];it=d,om(d,s)}im(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)sm(s),s=s.sibling}function sm(s){switch(s.tag){case 0:case 11:case 15:_o(s),s.flags&2048&&Dn(9,s,s.return);break;case 3:_o(s);break;case 12:_o(s);break;case 22:var o=s.stateNode;s.memoizedState!==null&&o._visibility&2&&(s.return===null||s.return.tag!==13)?(o._visibility&=-3,Wr(s)):_o(s);break;default:_o(s)}}function Wr(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var l=0;l<o.length;l++){var d=o[l];it=d,om(d,s)}im(s)}for(s=s.child;s!==null;){switch(o=s,o.tag){case 0:case 11:case 15:Dn(8,o,o.return),Wr(o);break;case 22:l=o.stateNode,l._visibility&2&&(l._visibility&=-3,Wr(o));break;default:Wr(o)}s=s.sibling}}function om(s,o){for(;it!==null;){var l=it;switch(l.tag){case 0:case 11:case 15:Dn(8,l,o);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var d=l.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:io(l.memoizedState.cache)}if(d=l.child,d!==null)d.return=l,it=d;else e:for(l=s;it!==null;){d=it;var g=d.sibling,v=d.return;if(Wh(d),d===l){it=null;break e}if(g!==null){g.return=v,it=g;break e}it=v}}}var uT={getCacheForType:function(s){var o=ft(Qe),l=o.data.get(s);return l===void 0&&(l=s(),o.data.set(s,l)),l}},cT=typeof WeakMap=="function"?WeakMap:Map,Ne=0,Oe=null,_e=null,Ae=0,ke=0,Rt=null,Pn=!1,ns=!1,wu=!1,pn=0,Ye=0,Hn=0,mi=0,bu=0,Bt=0,is=0,Co=null,Tt=null,Ru=!1,Mu=0,Qr=1/0,Xr=null,On=null,lt=0,Bn=null,ss=null,os=0,Nu=0,ku=null,rm=null,Eo=0,Iu=null;function Mt(){if((Ne&2)!==0&&Ae!==0)return Ae&-Ae;if(U.T!==null){var s=Yi;return s!==0?s:Bu()}return _f()}function am(){Bt===0&&(Bt=(Ae&536870912)===0||Re?vf():536870912);var s=Ot.current;return s!==null&&(s.flags|=32),Bt}function Nt(s,o,l){(s===Oe&&(ke===2||ke===9)||s.cancelPendingCommit!==null)&&(rs(s,0),Vn(s,Ae,Bt,!1)),qs(s,l),((Ne&2)===0||s!==Oe)&&(s===Oe&&((Ne&2)===0&&(mi|=l),Ye===4&&Vn(s,Ae,Bt,!1)),Xt(s))}function lm(s,o,l){if((Ne&6)!==0)throw Error(i(327));var d=!l&&(o&124)===0&&(o&s.expiredLanes)===0||Vs(s,o),g=d?hT(s,o):Lu(s,o,!0),v=d;do{if(g===0){ns&&!d&&Vn(s,o,0,!1);break}else{if(l=s.current.alternate,v&&!fT(l)){g=Lu(s,o,!1),v=!1;continue}if(g===2){if(v=o,s.errorRecoveryDisabledLanes&v)var _=0;else _=s.pendingLanes&-536870913,_=_!==0?_:_&536870912?536870912:0;if(_!==0){o=_;e:{var E=s;g=Co;var b=E.current.memoizedState.isDehydrated;if(b&&(rs(E,_).flags|=256),_=Lu(E,_,!1),_!==2){if(wu&&!b){E.errorRecoveryDisabledLanes|=v,mi|=v,g=4;break e}v=Tt,Tt=g,v!==null&&(Tt===null?Tt=v:Tt.push.apply(Tt,v))}g=_}if(v=!1,g!==2)continue}}if(g===1){rs(s,0),Vn(s,o,0,!0);break}e:{switch(d=s,v=g,v){case 0:case 1:throw Error(i(345));case 4:if((o&4194048)!==o)break;case 6:Vn(d,o,Bt,!Pn);break e;case 2:Tt=null;break;case 3:case 5:break;default:throw Error(i(329))}if((o&62914560)===o&&(g=Mu+300-Jt(),10<g)){if(Vn(d,o,Bt,!Pn),ur(d,0,!0)!==0)break e;d.timeoutHandle=Hm(um.bind(null,d,l,Tt,Xr,Ru,o,Bt,mi,is,Pn,v,2,-0,0),g);break e}um(d,l,Tt,Xr,Ru,o,Bt,mi,is,Pn,v,0,-0,0)}}break}while(!0);Xt(s)}function um(s,o,l,d,g,v,_,E,b,L,G,$,P,H){if(s.timeoutHandle=-1,$=o.subtreeFlags,($&8192||($&16785408)===16785408)&&(ko={stylesheets:null,count:0,unsuspend:YT},nm(o),$=jT(),$!==null)){s.cancelPendingCommit=$(gm.bind(null,s,o,v,l,d,g,_,E,b,G,1,P,H)),Vn(s,v,_,!L);return}gm(s,o,v,l,d,g,_,E,b)}function fT(s){for(var o=s;;){var l=o.tag;if((l===0||l===11||l===15)&&o.flags&16384&&(l=o.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var d=0;d<l.length;d++){var g=l[d],v=g.getSnapshot;g=g.value;try{if(!Et(v(),g))return!1}catch{return!1}}if(l=o.child,o.subtreeFlags&16384&&l!==null)l.return=o,o=l;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Vn(s,o,l,d){o&=~bu,o&=~mi,s.suspendedLanes|=o,s.pingedLanes&=~o,d&&(s.warmLanes|=o),d=s.expirationTimes;for(var g=o;0<g;){var v=31-Ct(g),_=1<<v;d[v]=-1,g&=~_}l!==0&&Sf(s,l,o)}function Zr(){return(Ne&6)===0?(Ao(0),!1):!0}function Du(){if(_e!==null){if(ke===0)var s=_e.return;else s=_e,an=li=null,Wl(s),Xi=null,po=0,s=_e;for(;s!==null;)Gh(s.alternate,s),s=s.return;_e=null}}function rs(s,o){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,MT(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),Du(),Oe=s,_e=l=sn(s.current,null),Ae=o,ke=0,Rt=null,Pn=!1,ns=Vs(s,o),wu=!1,is=Bt=bu=mi=Hn=Ye=0,Tt=Co=null,Ru=!1,(o&8)!==0&&(o|=o&32);var d=s.entangledLanes;if(d!==0)for(s=s.entanglements,d&=o;0<d;){var g=31-Ct(d),v=1<<g;o|=s[g],d&=~v}return pn=o,xr(),l}function cm(s,o){Te=null,U.H=Vr,o===oo||o===Nr?(o=bd(),ke=3):o===Ed?(o=bd(),ke=4):ke=o===Rh?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Rt=o,_e===null&&(Ye=1,Fr(s,Ut(o,s.current)))}function fm(){var s=U.H;return U.H=Vr,s===null?Vr:s}function dm(){var s=U.A;return U.A=uT,s}function Uu(){Ye=4,Pn||(Ae&4194048)!==Ae&&Ot.current!==null||(ns=!0),(Hn&134217727)===0&&(mi&134217727)===0||Oe===null||Vn(Oe,Ae,Bt,!1)}function Lu(s,o,l){var d=Ne;Ne|=2;var g=fm(),v=dm();(Oe!==s||Ae!==o)&&(Xr=null,rs(s,o)),o=!1;var _=Ye;e:do try{if(ke!==0&&_e!==null){var E=_e,b=Rt;switch(ke){case 8:Du(),_=6;break e;case 3:case 2:case 9:case 6:Ot.current===null&&(o=!0);var L=ke;if(ke=0,Rt=null,as(s,E,b,L),l&&ns){_=0;break e}break;default:L=ke,ke=0,Rt=null,as(s,E,b,L)}}dT(),_=Ye;break}catch(G){cm(s,G)}while(!0);return o&&s.shellSuspendCounter++,an=li=null,Ne=d,U.H=g,U.A=v,_e===null&&(Oe=null,Ae=0,xr()),_}function dT(){for(;_e!==null;)hm(_e)}function hT(s,o){var l=Ne;Ne|=2;var d=fm(),g=dm();Oe!==s||Ae!==o?(Xr=null,Qr=Jt()+500,rs(s,o)):ns=Vs(s,o);e:do try{if(ke!==0&&_e!==null){o=_e;var v=Rt;t:switch(ke){case 1:ke=0,Rt=null,as(s,o,v,1);break;case 2:case 9:if(Ad(v)){ke=0,Rt=null,mm(o);break}o=function(){ke!==2&&ke!==9||Oe!==s||(ke=7),Xt(s)},v.then(o,o);break e;case 3:ke=7;break e;case 4:ke=5;break e;case 7:Ad(v)?(ke=0,Rt=null,mm(o)):(ke=0,Rt=null,as(s,o,v,7));break;case 5:var _=null;switch(_e.tag){case 26:_=_e.memoizedState;case 5:case 27:var E=_e;if(!_||Km(_)){ke=0,Rt=null;var b=E.sibling;if(b!==null)_e=b;else{var L=E.return;L!==null?(_e=L,ea(L)):_e=null}break t}}ke=0,Rt=null,as(s,o,v,5);break;case 6:ke=0,Rt=null,as(s,o,v,6);break;case 8:Du(),Ye=6;break e;default:throw Error(i(462))}}mT();break}catch(G){cm(s,G)}while(!0);return an=li=null,U.H=d,U.A=g,Ne=l,_e!==null?0:(Oe=null,Ae=0,xr(),Ye)}function mT(){for(;_e!==null&&!Pv();)hm(_e)}function hm(s){var o=Vh(s.alternate,s,pn);s.memoizedProps=s.pendingProps,o===null?ea(s):_e=o}function mm(s){var o=s,l=o.alternate;switch(o.tag){case 15:case 0:o=Uh(l,o,o.pendingProps,o.type,void 0,Ae);break;case 11:o=Uh(l,o,o.pendingProps,o.type.render,o.ref,Ae);break;case 5:Wl(o);default:Gh(l,o),o=_e=pd(o,pn),o=Vh(l,o,pn)}s.memoizedProps=s.pendingProps,o===null?ea(s):_e=o}function as(s,o,l,d){an=li=null,Wl(o),Xi=null,po=0;var g=o.return;try{if(iT(s,g,o,l,Ae)){Ye=1,Fr(s,Ut(l,s.current)),_e=null;return}}catch(v){if(g!==null)throw _e=g,v;Ye=1,Fr(s,Ut(l,s.current)),_e=null;return}o.flags&32768?(Re||d===1?s=!0:ns||(Ae&536870912)!==0?s=!1:(Pn=s=!0,(d===2||d===9||d===3||d===6)&&(d=Ot.current,d!==null&&d.tag===13&&(d.flags|=16384))),pm(o,s)):ea(o)}function ea(s){var o=s;do{if((o.flags&32768)!==0){pm(o,Pn);return}s=o.return;var l=oT(o.alternate,o,pn);if(l!==null){_e=l;return}if(o=o.sibling,o!==null){_e=o;return}_e=o=s}while(o!==null);Ye===0&&(Ye=5)}function pm(s,o){do{var l=rT(s.alternate,s);if(l!==null){l.flags&=32767,_e=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!o&&(s=s.sibling,s!==null)){_e=s;return}_e=s=l}while(s!==null);Ye=6,_e=null}function gm(s,o,l,d,g,v,_,E,b){s.cancelPendingCommit=null;do ta();while(lt!==0);if((Ne&6)!==0)throw Error(i(327));if(o!==null){if(o===s.current)throw Error(i(177));if(v=o.lanes|o.childLanes,v|=Al,Yv(s,l,v,_,E,b),s===Oe&&(_e=Oe=null,Ae=0),ss=o,Bn=s,os=l,Nu=v,ku=g,rm=d,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,vT(rr,function(){return xm(),null})):(s.callbackNode=null,s.callbackPriority=0),d=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||d){d=U.T,U.T=null,g=J.p,J.p=2,_=Ne,Ne|=4;try{aT(s,o,l)}finally{Ne=_,J.p=g,U.T=d}}lt=1,ym(),vm(),Tm()}}function ym(){if(lt===1){lt=0;var s=Bn,o=ss,l=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||l){l=U.T,U.T=null;var d=J.p;J.p=2;var g=Ne;Ne|=4;try{Zh(o,s);var v=Ju,_=od(s.containerInfo),E=v.focusedElem,b=v.selectionRange;if(_!==E&&E&&E.ownerDocument&&sd(E.ownerDocument.documentElement,E)){if(b!==null&&Sl(E)){var L=b.start,G=b.end;if(G===void 0&&(G=L),"selectionStart"in E)E.selectionStart=L,E.selectionEnd=Math.min(G,E.value.length);else{var $=E.ownerDocument||document,P=$&&$.defaultView||window;if(P.getSelection){var H=P.getSelection(),fe=E.textContent.length,le=Math.min(b.start,fe),Le=b.end===void 0?le:Math.min(b.end,fe);!H.extend&&le>Le&&(_=Le,Le=le,le=_);var I=id(E,le),M=id(E,Le);if(I&&M&&(H.rangeCount!==1||H.anchorNode!==I.node||H.anchorOffset!==I.offset||H.focusNode!==M.node||H.focusOffset!==M.offset)){var D=$.createRange();D.setStart(I.node,I.offset),H.removeAllRanges(),le>Le?(H.addRange(D),H.extend(M.node,M.offset)):(D.setEnd(M.node,M.offset),H.addRange(D))}}}}for($=[],H=E;H=H.parentNode;)H.nodeType===1&&$.push({element:H,left:H.scrollLeft,top:H.scrollTop});for(typeof E.focus=="function"&&E.focus(),E=0;E<$.length;E++){var z=$[E];z.element.scrollLeft=z.left,z.element.scrollTop=z.top}}ha=!!Yu,Ju=Yu=null}finally{Ne=g,J.p=d,U.T=l}}s.current=o,lt=2}}function vm(){if(lt===2){lt=0;var s=Bn,o=ss,l=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||l){l=U.T,U.T=null;var d=J.p;J.p=2;var g=Ne;Ne|=4;try{Kh(s,o.alternate,o)}finally{Ne=g,J.p=d,U.T=l}}lt=3}}function Tm(){if(lt===4||lt===3){lt=0,Hv();var s=Bn,o=ss,l=os,d=rm;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?lt=5:(lt=0,ss=Bn=null,Sm(s,s.pendingLanes));var g=s.pendingLanes;if(g===0&&(On=null),Za(l),o=o.stateNode,_t&&typeof _t.onCommitFiberRoot=="function")try{_t.onCommitFiberRoot(Bs,o,void 0,(o.current.flags&128)===128)}catch{}if(d!==null){o=U.T,g=J.p,J.p=2,U.T=null;try{for(var v=s.onRecoverableError,_=0;_<d.length;_++){var E=d[_];v(E.value,{componentStack:E.stack})}}finally{U.T=o,J.p=g}}(os&3)!==0&&ta(),Xt(s),g=s.pendingLanes,(l&4194090)!==0&&(g&42)!==0?s===Iu?Eo++:(Eo=0,Iu=s):Eo=0,Ao(0)}}function Sm(s,o){(s.pooledCacheLanes&=o)===0&&(o=s.pooledCache,o!=null&&(s.pooledCache=null,io(o)))}function ta(s){return ym(),vm(),Tm(),xm()}function xm(){if(lt!==5)return!1;var s=Bn,o=Nu;Nu=0;var l=Za(os),d=U.T,g=J.p;try{J.p=32>l?32:l,U.T=null,l=ku,ku=null;var v=Bn,_=os;if(lt=0,ss=Bn=null,os=0,(Ne&6)!==0)throw Error(i(331));var E=Ne;if(Ne|=4,sm(v.current),tm(v,v.current,_,l),Ne=E,Ao(0,!1),_t&&typeof _t.onPostCommitFiberRoot=="function")try{_t.onPostCommitFiberRoot(Bs,v)}catch{}return!0}finally{J.p=g,U.T=d,Sm(s,o)}}function _m(s,o,l){o=Ut(l,o),o=cu(s.stateNode,o,2),s=Mn(s,o,2),s!==null&&(qs(s,2),Xt(s))}function He(s,o,l){if(s.tag===3)_m(s,s,l);else for(;o!==null;){if(o.tag===3){_m(o,s,l);break}else if(o.tag===1){var d=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(On===null||!On.has(d))){s=Ut(l,s),l=wh(2),d=Mn(o,l,2),d!==null&&(bh(l,d,o,s),qs(d,2),Xt(d));break}}o=o.return}}function Pu(s,o,l){var d=s.pingCache;if(d===null){d=s.pingCache=new cT;var g=new Set;d.set(o,g)}else g=d.get(o),g===void 0&&(g=new Set,d.set(o,g));g.has(l)||(wu=!0,g.add(l),s=pT.bind(null,s,o,l),o.then(s,s))}function pT(s,o,l){var d=s.pingCache;d!==null&&d.delete(o),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,Oe===s&&(Ae&l)===l&&(Ye===4||Ye===3&&(Ae&62914560)===Ae&&300>Jt()-Mu?(Ne&2)===0&&rs(s,0):bu|=l,is===Ae&&(is=0)),Xt(s)}function Cm(s,o){o===0&&(o=Tf()),s=Gi(s,o),s!==null&&(qs(s,o),Xt(s))}function gT(s){var o=s.memoizedState,l=0;o!==null&&(l=o.retryLane),Cm(s,l)}function yT(s,o){var l=0;switch(s.tag){case 13:var d=s.stateNode,g=s.memoizedState;g!==null&&(l=g.retryLane);break;case 19:d=s.stateNode;break;case 22:d=s.stateNode._retryCache;break;default:throw Error(i(314))}d!==null&&d.delete(o),Cm(s,l)}function vT(s,o){return Ka(s,o)}var na=null,ls=null,Hu=!1,ia=!1,Ou=!1,pi=0;function Xt(s){s!==ls&&s.next===null&&(ls===null?na=ls=s:ls=ls.next=s),ia=!0,Hu||(Hu=!0,ST())}function Ao(s,o){if(!Ou&&ia){Ou=!0;do for(var l=!1,d=na;d!==null;){if(s!==0){var g=d.pendingLanes;if(g===0)var v=0;else{var _=d.suspendedLanes,E=d.pingedLanes;v=(1<<31-Ct(42|s)+1)-1,v&=g&~(_&~E),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(l=!0,bm(d,v))}else v=Ae,v=ur(d,d===Oe?v:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(v&3)===0||Vs(d,v)||(l=!0,bm(d,v));d=d.next}while(l);Ou=!1}}function TT(){Em()}function Em(){ia=Hu=!1;var s=0;pi!==0&&(RT()&&(s=pi),pi=0);for(var o=Jt(),l=null,d=na;d!==null;){var g=d.next,v=Am(d,o);v===0?(d.next=null,l===null?na=g:l.next=g,g===null&&(ls=l)):(l=d,(s!==0||(v&3)!==0)&&(ia=!0)),d=g}Ao(s)}function Am(s,o){for(var l=s.suspendedLanes,d=s.pingedLanes,g=s.expirationTimes,v=s.pendingLanes&-62914561;0<v;){var _=31-Ct(v),E=1<<_,b=g[_];b===-1?((E&l)===0||(E&d)!==0)&&(g[_]=Fv(E,o)):b<=o&&(s.expiredLanes|=E),v&=~E}if(o=Oe,l=Ae,l=ur(s,s===o?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),d=s.callbackNode,l===0||s===o&&(ke===2||ke===9)||s.cancelPendingCommit!==null)return d!==null&&d!==null&&Wa(d),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||Vs(s,l)){if(o=l&-l,o===s.callbackPriority)return o;switch(d!==null&&Wa(d),Za(l)){case 2:case 8:l=gf;break;case 32:l=rr;break;case 268435456:l=yf;break;default:l=rr}return d=wm.bind(null,s),l=Ka(l,d),s.callbackPriority=o,s.callbackNode=l,o}return d!==null&&d!==null&&Wa(d),s.callbackPriority=2,s.callbackNode=null,2}function wm(s,o){if(lt!==0&&lt!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(ta()&&s.callbackNode!==l)return null;var d=Ae;return d=ur(s,s===Oe?d:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),d===0?null:(lm(s,d,o),Am(s,Jt()),s.callbackNode!=null&&s.callbackNode===l?wm.bind(null,s):null)}function bm(s,o){if(ta())return null;lm(s,o,!0)}function ST(){NT(function(){(Ne&6)!==0?Ka(pf,TT):Em()})}function Bu(){return pi===0&&(pi=vf()),pi}function Rm(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:mr(""+s)}function Mm(s,o){var l=o.ownerDocument.createElement("input");return l.name=o.name,l.value=o.value,s.id&&l.setAttribute("form",s.id),o.parentNode.insertBefore(l,o),s=new FormData(s),l.parentNode.removeChild(l),s}function xT(s,o,l,d,g){if(o==="submit"&&l&&l.stateNode===g){var v=Rm((g[pt]||null).action),_=d.submitter;_&&(o=(o=_[pt]||null)?Rm(o.formAction):_.getAttribute("formAction"),o!==null&&(v=o,_=null));var E=new vr("action","action",null,d,g);s.push({event:E,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(pi!==0){var b=_?Mm(g,_):new FormData(g);ou(l,{pending:!0,data:b,method:g.method,action:v},null,b)}}else typeof v=="function"&&(E.preventDefault(),b=_?Mm(g,_):new FormData(g),ou(l,{pending:!0,data:b,method:g.method,action:v},v,b))},currentTarget:g}]})}}for(var Vu=0;Vu<El.length;Vu++){var qu=El[Vu],_T=qu.toLowerCase(),CT=qu[0].toUpperCase()+qu.slice(1);Gt(_T,"on"+CT)}Gt(ld,"onAnimationEnd"),Gt(ud,"onAnimationIteration"),Gt(cd,"onAnimationStart"),Gt("dblclick","onDoubleClick"),Gt("focusin","onFocus"),Gt("focusout","onBlur"),Gt(V0,"onTransitionRun"),Gt(q0,"onTransitionStart"),Gt(G0,"onTransitionCancel"),Gt(fd,"onTransitionEnd"),Ii("onMouseEnter",["mouseout","mouseover"]),Ii("onMouseLeave",["mouseout","mouseover"]),Ii("onPointerEnter",["pointerout","pointerover"]),Ii("onPointerLeave",["pointerout","pointerover"]),Zn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Zn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Zn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Zn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Zn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Zn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ET=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(wo));function Nm(s,o){o=(o&4)!==0;for(var l=0;l<s.length;l++){var d=s[l],g=d.event;d=d.listeners;e:{var v=void 0;if(o)for(var _=d.length-1;0<=_;_--){var E=d[_],b=E.instance,L=E.currentTarget;if(E=E.listener,b!==v&&g.isPropagationStopped())break e;v=E,g.currentTarget=L;try{v(g)}catch(G){$r(G)}g.currentTarget=null,v=b}else for(_=0;_<d.length;_++){if(E=d[_],b=E.instance,L=E.currentTarget,E=E.listener,b!==v&&g.isPropagationStopped())break e;v=E,g.currentTarget=L;try{v(g)}catch(G){$r(G)}g.currentTarget=null,v=b}}}}function Ce(s,o){var l=o[el];l===void 0&&(l=o[el]=new Set);var d=s+"__bubble";l.has(d)||(km(o,s,2,!1),l.add(d))}function Gu(s,o,l){var d=0;o&&(d|=4),km(l,s,d,o)}var sa="_reactListening"+Math.random().toString(36).slice(2);function zu(s){if(!s[sa]){s[sa]=!0,Ef.forEach(function(l){l!=="selectionchange"&&(ET.has(l)||Gu(l,!1,s),Gu(l,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[sa]||(o[sa]=!0,Gu("selectionchange",!1,o))}}function km(s,o,l,d){switch(tp(o)){case 2:var g=QT;break;case 8:g=XT;break;default:g=ic}l=g.bind(null,o,l,s),g=void 0,!fl||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(g=!0),d?g!==void 0?s.addEventListener(o,l,{capture:!0,passive:g}):s.addEventListener(o,l,!0):g!==void 0?s.addEventListener(o,l,{passive:g}):s.addEventListener(o,l,!1)}function $u(s,o,l,d,g){var v=d;if((o&1)===0&&(o&2)===0&&d!==null)e:for(;;){if(d===null)return;var _=d.tag;if(_===3||_===4){var E=d.stateNode.containerInfo;if(E===g)break;if(_===4)for(_=d.return;_!==null;){var b=_.tag;if((b===3||b===4)&&_.stateNode.containerInfo===g)return;_=_.return}for(;E!==null;){if(_=Mi(E),_===null)return;if(b=_.tag,b===5||b===6||b===26||b===27){d=v=_;continue e}E=E.parentNode}}d=d.return}Of(function(){var L=v,G=ul(l),$=[];e:{var P=dd.get(s);if(P!==void 0){var H=vr,fe=s;switch(s){case"keypress":if(gr(l)===0)break e;case"keydown":case"keyup":H=v0;break;case"focusin":fe="focus",H=pl;break;case"focusout":fe="blur",H=pl;break;case"beforeblur":case"afterblur":H=pl;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":H=qf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":H=r0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":H=x0;break;case ld:case ud:case cd:H=u0;break;case fd:H=C0;break;case"scroll":case"scrollend":H=s0;break;case"wheel":H=A0;break;case"copy":case"cut":case"paste":H=f0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":H=zf;break;case"toggle":case"beforetoggle":H=b0}var le=(o&4)!==0,Le=!le&&(s==="scroll"||s==="scrollend"),I=le?P!==null?P+"Capture":null:P;le=[];for(var M=L,D;M!==null;){var z=M;if(D=z.stateNode,z=z.tag,z!==5&&z!==26&&z!==27||D===null||I===null||(z=$s(M,I),z!=null&&le.push(bo(M,z,D))),Le)break;M=M.return}0<le.length&&(P=new H(P,fe,null,l,G),$.push({event:P,listeners:le}))}}if((o&7)===0){e:{if(P=s==="mouseover"||s==="pointerover",H=s==="mouseout"||s==="pointerout",P&&l!==ll&&(fe=l.relatedTarget||l.fromElement)&&(Mi(fe)||fe[Ri]))break e;if((H||P)&&(P=G.window===G?G:(P=G.ownerDocument)?P.defaultView||P.parentWindow:window,H?(fe=l.relatedTarget||l.toElement,H=L,fe=fe?Mi(fe):null,fe!==null&&(Le=a(fe),le=fe.tag,fe!==Le||le!==5&&le!==27&&le!==6)&&(fe=null)):(H=null,fe=L),H!==fe)){if(le=qf,z="onMouseLeave",I="onMouseEnter",M="mouse",(s==="pointerout"||s==="pointerover")&&(le=zf,z="onPointerLeave",I="onPointerEnter",M="pointer"),Le=H==null?P:zs(H),D=fe==null?P:zs(fe),P=new le(z,M+"leave",H,l,G),P.target=Le,P.relatedTarget=D,z=null,Mi(G)===L&&(le=new le(I,M+"enter",fe,l,G),le.target=D,le.relatedTarget=Le,z=le),Le=z,H&&fe)t:{for(le=H,I=fe,M=0,D=le;D;D=us(D))M++;for(D=0,z=I;z;z=us(z))D++;for(;0<M-D;)le=us(le),M--;for(;0<D-M;)I=us(I),D--;for(;M--;){if(le===I||I!==null&&le===I.alternate)break t;le=us(le),I=us(I)}le=null}else le=null;H!==null&&Im($,P,H,le,!1),fe!==null&&Le!==null&&Im($,Le,fe,le,!0)}}e:{if(P=L?zs(L):window,H=P.nodeName&&P.nodeName.toLowerCase(),H==="select"||H==="input"&&P.type==="file")var te=Qf;else if(Kf(P))if(Xf)te=H0;else{te=L0;var Se=U0}else H=P.nodeName,!H||H.toLowerCase()!=="input"||P.type!=="checkbox"&&P.type!=="radio"?L&&al(L.elementType)&&(te=Qf):te=P0;if(te&&(te=te(s,L))){Wf($,te,l,G);break e}Se&&Se(s,P,L),s==="focusout"&&L&&P.type==="number"&&L.memoizedProps.value!=null&&rl(P,"number",P.value)}switch(Se=L?zs(L):window,s){case"focusin":(Kf(Se)||Se.contentEditable==="true")&&(Bi=Se,xl=L,Xs=null);break;case"focusout":Xs=xl=Bi=null;break;case"mousedown":_l=!0;break;case"contextmenu":case"mouseup":case"dragend":_l=!1,rd($,l,G);break;case"selectionchange":if(B0)break;case"keydown":case"keyup":rd($,l,G)}var oe;if(yl)e:{switch(s){case"compositionstart":var ce="onCompositionStart";break e;case"compositionend":ce="onCompositionEnd";break e;case"compositionupdate":ce="onCompositionUpdate";break e}ce=void 0}else Oi?Jf(s,l)&&(ce="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(ce="onCompositionStart");ce&&($f&&l.locale!=="ko"&&(Oi||ce!=="onCompositionStart"?ce==="onCompositionEnd"&&Oi&&(oe=Bf()):(An=G,dl="value"in An?An.value:An.textContent,Oi=!0)),Se=oa(L,ce),0<Se.length&&(ce=new Gf(ce,s,null,l,G),$.push({event:ce,listeners:Se}),oe?ce.data=oe:(oe=jf(l),oe!==null&&(ce.data=oe)))),(oe=M0?N0(s,l):k0(s,l))&&(ce=oa(L,"onBeforeInput"),0<ce.length&&(Se=new Gf("onBeforeInput","beforeinput",null,l,G),$.push({event:Se,listeners:ce}),Se.data=oe)),xT($,s,L,l,G)}Nm($,o)})}function bo(s,o,l){return{instance:s,listener:o,currentTarget:l}}function oa(s,o){for(var l=o+"Capture",d=[];s!==null;){var g=s,v=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||v===null||(g=$s(s,l),g!=null&&d.unshift(bo(s,g,v)),g=$s(s,o),g!=null&&d.push(bo(s,g,v))),s.tag===3)return d;s=s.return}return[]}function us(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Im(s,o,l,d,g){for(var v=o._reactName,_=[];l!==null&&l!==d;){var E=l,b=E.alternate,L=E.stateNode;if(E=E.tag,b!==null&&b===d)break;E!==5&&E!==26&&E!==27||L===null||(b=L,g?(L=$s(l,v),L!=null&&_.unshift(bo(l,L,b))):g||(L=$s(l,v),L!=null&&_.push(bo(l,L,b)))),l=l.return}_.length!==0&&s.push({event:o,listeners:_})}var AT=/\r\n?/g,wT=/\u0000|\uFFFD/g;function Dm(s){return(typeof s=="string"?s:""+s).replace(AT,`
`).replace(wT,"")}function Um(s,o){return o=Dm(o),Dm(s)===o}function ra(){}function Ue(s,o,l,d,g,v){switch(l){case"children":typeof d=="string"?o==="body"||o==="textarea"&&d===""||Li(s,d):(typeof d=="number"||typeof d=="bigint")&&o!=="body"&&Li(s,""+d);break;case"className":fr(s,"class",d);break;case"tabIndex":fr(s,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":fr(s,l,d);break;case"style":Pf(s,d,v);break;case"data":if(o!=="object"){fr(s,"data",d);break}case"src":case"href":if(d===""&&(o!=="a"||l!=="href")){s.removeAttribute(l);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){s.removeAttribute(l);break}d=mr(""+d),s.setAttribute(l,d);break;case"action":case"formAction":if(typeof d=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(l==="formAction"?(o!=="input"&&Ue(s,o,"name",g.name,g,null),Ue(s,o,"formEncType",g.formEncType,g,null),Ue(s,o,"formMethod",g.formMethod,g,null),Ue(s,o,"formTarget",g.formTarget,g,null)):(Ue(s,o,"encType",g.encType,g,null),Ue(s,o,"method",g.method,g,null),Ue(s,o,"target",g.target,g,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){s.removeAttribute(l);break}d=mr(""+d),s.setAttribute(l,d);break;case"onClick":d!=null&&(s.onclick=ra);break;case"onScroll":d!=null&&Ce("scroll",s);break;case"onScrollEnd":d!=null&&Ce("scrollend",s);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(i(61));if(l=d.__html,l!=null){if(g.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"multiple":s.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":s.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){s.removeAttribute("xlink:href");break}l=mr(""+d),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(l,""+d):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":d===!0?s.setAttribute(l,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(l,d):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?s.setAttribute(l,d):s.removeAttribute(l);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?s.removeAttribute(l):s.setAttribute(l,d);break;case"popover":Ce("beforetoggle",s),Ce("toggle",s),cr(s,"popover",d);break;case"xlinkActuate":tn(s,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":tn(s,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":tn(s,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":tn(s,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":tn(s,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":tn(s,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":tn(s,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":tn(s,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":tn(s,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":cr(s,"is",d);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=n0.get(l)||l,cr(s,l,d))}}function Fu(s,o,l,d,g,v){switch(l){case"style":Pf(s,d,v);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(i(61));if(l=d.__html,l!=null){if(g.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"children":typeof d=="string"?Li(s,d):(typeof d=="number"||typeof d=="bigint")&&Li(s,""+d);break;case"onScroll":d!=null&&Ce("scroll",s);break;case"onScrollEnd":d!=null&&Ce("scrollend",s);break;case"onClick":d!=null&&(s.onclick=ra);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Af.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(g=l.endsWith("Capture"),o=l.slice(2,g?l.length-7:void 0),v=s[pt]||null,v=v!=null?v[l]:null,typeof v=="function"&&s.removeEventListener(o,v,g),typeof d=="function")){typeof v!="function"&&v!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(o,d,g);break e}l in s?s[l]=d:d===!0?s.setAttribute(l,""):cr(s,l,d)}}}function ut(s,o,l){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ce("error",s),Ce("load",s);var d=!1,g=!1,v;for(v in l)if(l.hasOwnProperty(v)){var _=l[v];if(_!=null)switch(v){case"src":d=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:Ue(s,o,v,_,l,null)}}g&&Ue(s,o,"srcSet",l.srcSet,l,null),d&&Ue(s,o,"src",l.src,l,null);return;case"input":Ce("invalid",s);var E=v=_=g=null,b=null,L=null;for(d in l)if(l.hasOwnProperty(d)){var G=l[d];if(G!=null)switch(d){case"name":g=G;break;case"type":_=G;break;case"checked":b=G;break;case"defaultChecked":L=G;break;case"value":v=G;break;case"defaultValue":E=G;break;case"children":case"dangerouslySetInnerHTML":if(G!=null)throw Error(i(137,o));break;default:Ue(s,o,d,G,l,null)}}If(s,v,E,b,L,_,g,!1),dr(s);return;case"select":Ce("invalid",s),d=_=v=null;for(g in l)if(l.hasOwnProperty(g)&&(E=l[g],E!=null))switch(g){case"value":v=E;break;case"defaultValue":_=E;break;case"multiple":d=E;default:Ue(s,o,g,E,l,null)}o=v,l=_,s.multiple=!!d,o!=null?Ui(s,!!d,o,!1):l!=null&&Ui(s,!!d,l,!0);return;case"textarea":Ce("invalid",s),v=g=d=null;for(_ in l)if(l.hasOwnProperty(_)&&(E=l[_],E!=null))switch(_){case"value":d=E;break;case"defaultValue":g=E;break;case"children":v=E;break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(i(91));break;default:Ue(s,o,_,E,l,null)}Uf(s,d,g,v),dr(s);return;case"option":for(b in l)if(l.hasOwnProperty(b)&&(d=l[b],d!=null))switch(b){case"selected":s.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:Ue(s,o,b,d,l,null)}return;case"dialog":Ce("beforetoggle",s),Ce("toggle",s),Ce("cancel",s),Ce("close",s);break;case"iframe":case"object":Ce("load",s);break;case"video":case"audio":for(d=0;d<wo.length;d++)Ce(wo[d],s);break;case"image":Ce("error",s),Ce("load",s);break;case"details":Ce("toggle",s);break;case"embed":case"source":case"link":Ce("error",s),Ce("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(L in l)if(l.hasOwnProperty(L)&&(d=l[L],d!=null))switch(L){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:Ue(s,o,L,d,l,null)}return;default:if(al(o)){for(G in l)l.hasOwnProperty(G)&&(d=l[G],d!==void 0&&Fu(s,o,G,d,l,void 0));return}}for(E in l)l.hasOwnProperty(E)&&(d=l[E],d!=null&&Ue(s,o,E,d,l,null))}function bT(s,o,l,d){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,v=null,_=null,E=null,b=null,L=null,G=null;for(H in l){var $=l[H];if(l.hasOwnProperty(H)&&$!=null)switch(H){case"checked":break;case"value":break;case"defaultValue":b=$;default:d.hasOwnProperty(H)||Ue(s,o,H,null,d,$)}}for(var P in d){var H=d[P];if($=l[P],d.hasOwnProperty(P)&&(H!=null||$!=null))switch(P){case"type":v=H;break;case"name":g=H;break;case"checked":L=H;break;case"defaultChecked":G=H;break;case"value":_=H;break;case"defaultValue":E=H;break;case"children":case"dangerouslySetInnerHTML":if(H!=null)throw Error(i(137,o));break;default:H!==$&&Ue(s,o,P,H,d,$)}}ol(s,_,E,b,L,G,v,g);return;case"select":H=_=E=P=null;for(v in l)if(b=l[v],l.hasOwnProperty(v)&&b!=null)switch(v){case"value":break;case"multiple":H=b;default:d.hasOwnProperty(v)||Ue(s,o,v,null,d,b)}for(g in d)if(v=d[g],b=l[g],d.hasOwnProperty(g)&&(v!=null||b!=null))switch(g){case"value":P=v;break;case"defaultValue":E=v;break;case"multiple":_=v;default:v!==b&&Ue(s,o,g,v,d,b)}o=E,l=_,d=H,P!=null?Ui(s,!!l,P,!1):!!d!=!!l&&(o!=null?Ui(s,!!l,o,!0):Ui(s,!!l,l?[]:"",!1));return;case"textarea":H=P=null;for(E in l)if(g=l[E],l.hasOwnProperty(E)&&g!=null&&!d.hasOwnProperty(E))switch(E){case"value":break;case"children":break;default:Ue(s,o,E,null,d,g)}for(_ in d)if(g=d[_],v=l[_],d.hasOwnProperty(_)&&(g!=null||v!=null))switch(_){case"value":P=g;break;case"defaultValue":H=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(i(91));break;default:g!==v&&Ue(s,o,_,g,d,v)}Df(s,P,H);return;case"option":for(var fe in l)if(P=l[fe],l.hasOwnProperty(fe)&&P!=null&&!d.hasOwnProperty(fe))switch(fe){case"selected":s.selected=!1;break;default:Ue(s,o,fe,null,d,P)}for(b in d)if(P=d[b],H=l[b],d.hasOwnProperty(b)&&P!==H&&(P!=null||H!=null))switch(b){case"selected":s.selected=P&&typeof P!="function"&&typeof P!="symbol";break;default:Ue(s,o,b,P,d,H)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var le in l)P=l[le],l.hasOwnProperty(le)&&P!=null&&!d.hasOwnProperty(le)&&Ue(s,o,le,null,d,P);for(L in d)if(P=d[L],H=l[L],d.hasOwnProperty(L)&&P!==H&&(P!=null||H!=null))switch(L){case"children":case"dangerouslySetInnerHTML":if(P!=null)throw Error(i(137,o));break;default:Ue(s,o,L,P,d,H)}return;default:if(al(o)){for(var Le in l)P=l[Le],l.hasOwnProperty(Le)&&P!==void 0&&!d.hasOwnProperty(Le)&&Fu(s,o,Le,void 0,d,P);for(G in d)P=d[G],H=l[G],!d.hasOwnProperty(G)||P===H||P===void 0&&H===void 0||Fu(s,o,G,P,d,H);return}}for(var I in l)P=l[I],l.hasOwnProperty(I)&&P!=null&&!d.hasOwnProperty(I)&&Ue(s,o,I,null,d,P);for($ in d)P=d[$],H=l[$],!d.hasOwnProperty($)||P===H||P==null&&H==null||Ue(s,o,$,P,d,H)}var Yu=null,Ju=null;function aa(s){return s.nodeType===9?s:s.ownerDocument}function Lm(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Pm(s,o){if(s===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&o==="foreignObject"?0:s}function ju(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Ku=null;function RT(){var s=window.event;return s&&s.type==="popstate"?s===Ku?!1:(Ku=s,!0):(Ku=null,!1)}var Hm=typeof setTimeout=="function"?setTimeout:void 0,MT=typeof clearTimeout=="function"?clearTimeout:void 0,Om=typeof Promise=="function"?Promise:void 0,NT=typeof queueMicrotask=="function"?queueMicrotask:typeof Om<"u"?function(s){return Om.resolve(null).then(s).catch(kT)}:Hm;function kT(s){setTimeout(function(){throw s})}function qn(s){return s==="head"}function Bm(s,o){var l=o,d=0,g=0;do{var v=l.nextSibling;if(s.removeChild(l),v&&v.nodeType===8)if(l=v.data,l==="/$"){if(0<d&&8>d){l=d;var _=s.ownerDocument;if(l&1&&Ro(_.documentElement),l&2&&Ro(_.body),l&4)for(l=_.head,Ro(l),_=l.firstChild;_;){var E=_.nextSibling,b=_.nodeName;_[Gs]||b==="SCRIPT"||b==="STYLE"||b==="LINK"&&_.rel.toLowerCase()==="stylesheet"||l.removeChild(_),_=E}}if(g===0){s.removeChild(v),Po(o);return}g--}else l==="$"||l==="$?"||l==="$!"?g++:d=l.charCodeAt(0)-48;else d=0;l=v}while(l);Po(o)}function Wu(s){var o=s.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var l=o;switch(o=o.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Wu(l),tl(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function IT(s,o,l,d){for(;s.nodeType===1;){var g=l;if(s.nodeName.toLowerCase()!==o.toLowerCase()){if(!d&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(d){if(!s[Gs])switch(o){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(v=s.getAttribute("rel"),v==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(v!==g.rel||s.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||s.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||s.getAttribute("title")!==(g.title==null?null:g.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(v=s.getAttribute("src"),(v!==(g.src==null?null:g.src)||s.getAttribute("type")!==(g.type==null?null:g.type)||s.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&v&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(o==="input"&&s.type==="hidden"){var v=g.name==null?null:""+g.name;if(g.type==="hidden"&&s.getAttribute("name")===v)return s}else return s;if(s=$t(s.nextSibling),s===null)break}return null}function DT(s,o,l){if(o==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=$t(s.nextSibling),s===null))return null;return s}function Qu(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function UT(s,o){var l=s.ownerDocument;if(s.data!=="$?"||l.readyState==="complete")o();else{var d=function(){o(),l.removeEventListener("DOMContentLoaded",d)};l.addEventListener("DOMContentLoaded",d),s._reactRetry=d}}function $t(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return s}var Xu=null;function Vm(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"){if(o===0)return s;o--}else l==="/$"&&o++}s=s.previousSibling}return null}function qm(s,o,l){switch(o=aa(l),s){case"html":if(s=o.documentElement,!s)throw Error(i(452));return s;case"head":if(s=o.head,!s)throw Error(i(453));return s;case"body":if(s=o.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function Ro(s){for(var o=s.attributes;o.length;)s.removeAttributeNode(o[0]);tl(s)}var Vt=new Map,Gm=new Set;function la(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var gn=J.d;J.d={f:LT,r:PT,D:HT,C:OT,L:BT,m:VT,X:GT,S:qT,M:zT};function LT(){var s=gn.f(),o=Zr();return s||o}function PT(s){var o=Ni(s);o!==null&&o.tag===5&&o.type==="form"?lh(o):gn.r(s)}var cs=typeof document>"u"?null:document;function zm(s,o,l){var d=cs;if(d&&typeof o=="string"&&o){var g=Dt(o);g='link[rel="'+s+'"][href="'+g+'"]',typeof l=="string"&&(g+='[crossorigin="'+l+'"]'),Gm.has(g)||(Gm.add(g),s={rel:s,crossOrigin:l,href:o},d.querySelector(g)===null&&(o=d.createElement("link"),ut(o,"link",s),tt(o),d.head.appendChild(o)))}}function HT(s){gn.D(s),zm("dns-prefetch",s,null)}function OT(s,o){gn.C(s,o),zm("preconnect",s,o)}function BT(s,o,l){gn.L(s,o,l);var d=cs;if(d&&s&&o){var g='link[rel="preload"][as="'+Dt(o)+'"]';o==="image"&&l&&l.imageSrcSet?(g+='[imagesrcset="'+Dt(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(g+='[imagesizes="'+Dt(l.imageSizes)+'"]')):g+='[href="'+Dt(s)+'"]';var v=g;switch(o){case"style":v=fs(s);break;case"script":v=ds(s)}Vt.has(v)||(s=y({rel:"preload",href:o==="image"&&l&&l.imageSrcSet?void 0:s,as:o},l),Vt.set(v,s),d.querySelector(g)!==null||o==="style"&&d.querySelector(Mo(v))||o==="script"&&d.querySelector(No(v))||(o=d.createElement("link"),ut(o,"link",s),tt(o),d.head.appendChild(o)))}}function VT(s,o){gn.m(s,o);var l=cs;if(l&&s){var d=o&&typeof o.as=="string"?o.as:"script",g='link[rel="modulepreload"][as="'+Dt(d)+'"][href="'+Dt(s)+'"]',v=g;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=ds(s)}if(!Vt.has(v)&&(s=y({rel:"modulepreload",href:s},o),Vt.set(v,s),l.querySelector(g)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(No(v)))return}d=l.createElement("link"),ut(d,"link",s),tt(d),l.head.appendChild(d)}}}function qT(s,o,l){gn.S(s,o,l);var d=cs;if(d&&s){var g=ki(d).hoistableStyles,v=fs(s);o=o||"default";var _=g.get(v);if(!_){var E={loading:0,preload:null};if(_=d.querySelector(Mo(v)))E.loading=5;else{s=y({rel:"stylesheet",href:s,"data-precedence":o},l),(l=Vt.get(v))&&Zu(s,l);var b=_=d.createElement("link");tt(b),ut(b,"link",s),b._p=new Promise(function(L,G){b.onload=L,b.onerror=G}),b.addEventListener("load",function(){E.loading|=1}),b.addEventListener("error",function(){E.loading|=2}),E.loading|=4,ua(_,o,d)}_={type:"stylesheet",instance:_,count:1,state:E},g.set(v,_)}}}function GT(s,o){gn.X(s,o);var l=cs;if(l&&s){var d=ki(l).hoistableScripts,g=ds(s),v=d.get(g);v||(v=l.querySelector(No(g)),v||(s=y({src:s,async:!0},o),(o=Vt.get(g))&&ec(s,o),v=l.createElement("script"),tt(v),ut(v,"link",s),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},d.set(g,v))}}function zT(s,o){gn.M(s,o);var l=cs;if(l&&s){var d=ki(l).hoistableScripts,g=ds(s),v=d.get(g);v||(v=l.querySelector(No(g)),v||(s=y({src:s,async:!0,type:"module"},o),(o=Vt.get(g))&&ec(s,o),v=l.createElement("script"),tt(v),ut(v,"link",s),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},d.set(g,v))}}function $m(s,o,l,d){var g=(g=me.current)?la(g):null;if(!g)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(o=fs(l.href),l=ki(g).hoistableStyles,d=l.get(o),d||(d={type:"style",instance:null,count:0,state:null},l.set(o,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=fs(l.href);var v=ki(g).hoistableStyles,_=v.get(s);if(_||(g=g.ownerDocument||g,_={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(s,_),(v=g.querySelector(Mo(s)))&&!v._p&&(_.instance=v,_.state.loading=5),Vt.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Vt.set(s,l),v||$T(g,s,l,_.state))),o&&d===null)throw Error(i(528,""));return _}if(o&&d!==null)throw Error(i(529,""));return null;case"script":return o=l.async,l=l.src,typeof l=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=ds(l),l=ki(g).hoistableScripts,d=l.get(o),d||(d={type:"script",instance:null,count:0,state:null},l.set(o,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function fs(s){return'href="'+Dt(s)+'"'}function Mo(s){return'link[rel="stylesheet"]['+s+"]"}function Fm(s){return y({},s,{"data-precedence":s.precedence,precedence:null})}function $T(s,o,l,d){s.querySelector('link[rel="preload"][as="style"]['+o+"]")?d.loading=1:(o=s.createElement("link"),d.preload=o,o.addEventListener("load",function(){return d.loading|=1}),o.addEventListener("error",function(){return d.loading|=2}),ut(o,"link",l),tt(o),s.head.appendChild(o))}function ds(s){return'[src="'+Dt(s)+'"]'}function No(s){return"script[async]"+s}function Ym(s,o,l){if(o.count++,o.instance===null)switch(o.type){case"style":var d=s.querySelector('style[data-href~="'+Dt(l.href)+'"]');if(d)return o.instance=d,tt(d),d;var g=y({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return d=(s.ownerDocument||s).createElement("style"),tt(d),ut(d,"style",g),ua(d,l.precedence,s),o.instance=d;case"stylesheet":g=fs(l.href);var v=s.querySelector(Mo(g));if(v)return o.state.loading|=4,o.instance=v,tt(v),v;d=Fm(l),(g=Vt.get(g))&&Zu(d,g),v=(s.ownerDocument||s).createElement("link"),tt(v);var _=v;return _._p=new Promise(function(E,b){_.onload=E,_.onerror=b}),ut(v,"link",d),o.state.loading|=4,ua(v,l.precedence,s),o.instance=v;case"script":return v=ds(l.src),(g=s.querySelector(No(v)))?(o.instance=g,tt(g),g):(d=l,(g=Vt.get(v))&&(d=y({},l),ec(d,g)),s=s.ownerDocument||s,g=s.createElement("script"),tt(g),ut(g,"link",d),s.head.appendChild(g),o.instance=g);case"void":return null;default:throw Error(i(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(d=o.instance,o.state.loading|=4,ua(d,l.precedence,s));return o.instance}function ua(s,o,l){for(var d=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=d.length?d[d.length-1]:null,v=g,_=0;_<d.length;_++){var E=d[_];if(E.dataset.precedence===o)v=E;else if(v!==g)break}v?v.parentNode.insertBefore(s,v.nextSibling):(o=l.nodeType===9?l.head:l,o.insertBefore(s,o.firstChild))}function Zu(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.title==null&&(s.title=o.title)}function ec(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.integrity==null&&(s.integrity=o.integrity)}var ca=null;function Jm(s,o,l){if(ca===null){var d=new Map,g=ca=new Map;g.set(l,d)}else g=ca,d=g.get(l),d||(d=new Map,g.set(l,d));if(d.has(s))return d;for(d.set(s,null),l=l.getElementsByTagName(s),g=0;g<l.length;g++){var v=l[g];if(!(v[Gs]||v[ct]||s==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var _=v.getAttribute(o)||"";_=s+_;var E=d.get(_);E?E.push(v):d.set(_,[v])}}return d}function jm(s,o,l){s=s.ownerDocument||s,s.head.insertBefore(l,o==="title"?s.querySelector("head > title"):null)}function FT(s,o,l){if(l===1||o.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return s=o.disabled,typeof o.precedence=="string"&&s==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function Km(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var ko=null;function YT(){}function JT(s,o,l){if(ko===null)throw Error(i(475));var d=ko;if(o.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var g=fs(l.href),v=s.querySelector(Mo(g));if(v){s=v._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(d.count++,d=fa.bind(d),s.then(d,d)),o.state.loading|=4,o.instance=v,tt(v);return}v=s.ownerDocument||s,l=Fm(l),(g=Vt.get(g))&&Zu(l,g),v=v.createElement("link"),tt(v);var _=v;_._p=new Promise(function(E,b){_.onload=E,_.onerror=b}),ut(v,"link",l),o.instance=v}d.stylesheets===null&&(d.stylesheets=new Map),d.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(d.count++,o=fa.bind(d),s.addEventListener("load",o),s.addEventListener("error",o))}}function jT(){if(ko===null)throw Error(i(475));var s=ko;return s.stylesheets&&s.count===0&&tc(s,s.stylesheets),0<s.count?function(o){var l=setTimeout(function(){if(s.stylesheets&&tc(s,s.stylesheets),s.unsuspend){var d=s.unsuspend;s.unsuspend=null,d()}},6e4);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(l)}}:null}function fa(){if(this.count--,this.count===0){if(this.stylesheets)tc(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var da=null;function tc(s,o){s.stylesheets=null,s.unsuspend!==null&&(s.count++,da=new Map,o.forEach(KT,s),da=null,fa.call(s))}function KT(s,o){if(!(o.state.loading&4)){var l=da.get(s);if(l)var d=l.get(null);else{l=new Map,da.set(s,l);for(var g=s.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<g.length;v++){var _=g[v];(_.nodeName==="LINK"||_.getAttribute("media")!=="not all")&&(l.set(_.dataset.precedence,_),d=_)}d&&l.set(null,d)}g=o.instance,_=g.getAttribute("data-precedence"),v=l.get(_)||d,v===d&&l.set(null,g),l.set(_,g),this.count++,d=fa.bind(this),g.addEventListener("load",d),g.addEventListener("error",d),v?v.parentNode.insertBefore(g,v.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(g,s.firstChild)),o.state.loading|=4}}var Io={$$typeof:N,Provider:null,Consumer:null,_currentValue:j,_currentValue2:j,_threadCount:0};function WT(s,o,l,d,g,v,_,E){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Qa(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Qa(0),this.hiddenUpdates=Qa(null),this.identifierPrefix=d,this.onUncaughtError=g,this.onCaughtError=v,this.onRecoverableError=_,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=E,this.incompleteTransitions=new Map}function Wm(s,o,l,d,g,v,_,E,b,L,G,$){return s=new WT(s,o,l,_,E,b,L,$),o=1,v===!0&&(o|=24),v=At(3,null,null,o),s.current=v,v.stateNode=s,o=Pl(),o.refCount++,s.pooledCache=o,o.refCount++,v.memoizedState={element:d,isDehydrated:l,cache:o},Vl(v),s}function Qm(s){return s?(s=zi,s):zi}function Xm(s,o,l,d,g,v){g=Qm(g),d.context===null?d.context=g:d.pendingContext=g,d=Rn(o),d.payload={element:l},v=v===void 0?null:v,v!==null&&(d.callback=v),l=Mn(s,d,o),l!==null&&(Nt(l,s,o),ao(l,s,o))}function Zm(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<o?l:o}}function nc(s,o){Zm(s,o),(s=s.alternate)&&Zm(s,o)}function ep(s){if(s.tag===13){var o=Gi(s,67108864);o!==null&&Nt(o,s,67108864),nc(s,67108864)}}var ha=!0;function QT(s,o,l,d){var g=U.T;U.T=null;var v=J.p;try{J.p=2,ic(s,o,l,d)}finally{J.p=v,U.T=g}}function XT(s,o,l,d){var g=U.T;U.T=null;var v=J.p;try{J.p=8,ic(s,o,l,d)}finally{J.p=v,U.T=g}}function ic(s,o,l,d){if(ha){var g=sc(d);if(g===null)$u(s,o,d,ma,l),np(s,d);else if(eS(g,s,o,l,d))d.stopPropagation();else if(np(s,d),o&4&&-1<ZT.indexOf(s)){for(;g!==null;){var v=Ni(g);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var _=Xn(v.pendingLanes);if(_!==0){var E=v;for(E.pendingLanes|=2,E.entangledLanes|=2;_;){var b=1<<31-Ct(_);E.entanglements[1]|=b,_&=~b}Xt(v),(Ne&6)===0&&(Qr=Jt()+500,Ao(0))}}break;case 13:E=Gi(v,2),E!==null&&Nt(E,v,2),Zr(),nc(v,2)}if(v=sc(d),v===null&&$u(s,o,d,ma,l),v===g)break;g=v}g!==null&&d.stopPropagation()}else $u(s,o,d,null,l)}}function sc(s){return s=ul(s),oc(s)}var ma=null;function oc(s){if(ma=null,s=Mi(s),s!==null){var o=a(s);if(o===null)s=null;else{var l=o.tag;if(l===13){if(s=u(o),s!==null)return s;s=null}else if(l===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null)}}return ma=s,null}function tp(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ov()){case pf:return 2;case gf:return 8;case rr:case Bv:return 32;case yf:return 268435456;default:return 32}default:return 32}}var rc=!1,Gn=null,zn=null,$n=null,Do=new Map,Uo=new Map,Fn=[],ZT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function np(s,o){switch(s){case"focusin":case"focusout":Gn=null;break;case"dragenter":case"dragleave":zn=null;break;case"mouseover":case"mouseout":$n=null;break;case"pointerover":case"pointerout":Do.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Uo.delete(o.pointerId)}}function Lo(s,o,l,d,g,v){return s===null||s.nativeEvent!==v?(s={blockedOn:o,domEventName:l,eventSystemFlags:d,nativeEvent:v,targetContainers:[g]},o!==null&&(o=Ni(o),o!==null&&ep(o)),s):(s.eventSystemFlags|=d,o=s.targetContainers,g!==null&&o.indexOf(g)===-1&&o.push(g),s)}function eS(s,o,l,d,g){switch(o){case"focusin":return Gn=Lo(Gn,s,o,l,d,g),!0;case"dragenter":return zn=Lo(zn,s,o,l,d,g),!0;case"mouseover":return $n=Lo($n,s,o,l,d,g),!0;case"pointerover":var v=g.pointerId;return Do.set(v,Lo(Do.get(v)||null,s,o,l,d,g)),!0;case"gotpointercapture":return v=g.pointerId,Uo.set(v,Lo(Uo.get(v)||null,s,o,l,d,g)),!0}return!1}function ip(s){var o=Mi(s.target);if(o!==null){var l=a(o);if(l!==null){if(o=l.tag,o===13){if(o=u(l),o!==null){s.blockedOn=o,Jv(s.priority,function(){if(l.tag===13){var d=Mt();d=Xa(d);var g=Gi(l,d);g!==null&&Nt(g,l,d),nc(l,d)}});return}}else if(o===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function pa(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var l=sc(s.nativeEvent);if(l===null){l=s.nativeEvent;var d=new l.constructor(l.type,l);ll=d,l.target.dispatchEvent(d),ll=null}else return o=Ni(l),o!==null&&ep(o),s.blockedOn=l,!1;o.shift()}return!0}function sp(s,o,l){pa(s)&&l.delete(o)}function tS(){rc=!1,Gn!==null&&pa(Gn)&&(Gn=null),zn!==null&&pa(zn)&&(zn=null),$n!==null&&pa($n)&&($n=null),Do.forEach(sp),Uo.forEach(sp)}function ga(s,o){s.blockedOn===o&&(s.blockedOn=null,rc||(rc=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,tS)))}var ya=null;function op(s){ya!==s&&(ya=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){ya===s&&(ya=null);for(var o=0;o<s.length;o+=3){var l=s[o],d=s[o+1],g=s[o+2];if(typeof d!="function"){if(oc(d||l)===null)continue;break}var v=Ni(l);v!==null&&(s.splice(o,3),o-=3,ou(v,{pending:!0,data:g,method:l.method,action:d},d,g))}}))}function Po(s){function o(b){return ga(b,s)}Gn!==null&&ga(Gn,s),zn!==null&&ga(zn,s),$n!==null&&ga($n,s),Do.forEach(o),Uo.forEach(o);for(var l=0;l<Fn.length;l++){var d=Fn[l];d.blockedOn===s&&(d.blockedOn=null)}for(;0<Fn.length&&(l=Fn[0],l.blockedOn===null);)ip(l),l.blockedOn===null&&Fn.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(d=0;d<l.length;d+=3){var g=l[d],v=l[d+1],_=g[pt]||null;if(typeof v=="function")_||op(l);else if(_){var E=null;if(v&&v.hasAttribute("formAction")){if(g=v,_=v[pt]||null)E=_.formAction;else if(oc(g)!==null)continue}else E=_.action;typeof E=="function"?l[d+1]=E:(l.splice(d,3),d-=3),op(l)}}}function ac(s){this._internalRoot=s}va.prototype.render=ac.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(i(409));var l=o.current,d=Mt();Xm(l,d,s,o,null,null)},va.prototype.unmount=ac.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;Xm(s.current,2,null,s,null,null),Zr(),o[Ri]=null}};function va(s){this._internalRoot=s}va.prototype.unstable_scheduleHydration=function(s){if(s){var o=_f();s={blockedOn:null,target:s,priority:o};for(var l=0;l<Fn.length&&o!==0&&o<Fn[l].priority;l++);Fn.splice(l,0,s),l===0&&ip(s)}};var rp=e.version;if(rp!=="19.1.1")throw Error(i(527,rp,"19.1.1"));J.findDOMNode=function(s){var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=m(o),s=s!==null?p(s):null,s=s===null?null:s.stateNode,s};var nS={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:U,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ta=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ta.isDisabled&&Ta.supportsFiber)try{Bs=Ta.inject(nS),_t=Ta}catch{}}return Bo.createRoot=function(s,o){if(!r(s))throw Error(i(299));var l=!1,d="",g=_h,v=Ch,_=Eh,E=null;return o!=null&&(o.unstable_strictMode===!0&&(l=!0),o.identifierPrefix!==void 0&&(d=o.identifierPrefix),o.onUncaughtError!==void 0&&(g=o.onUncaughtError),o.onCaughtError!==void 0&&(v=o.onCaughtError),o.onRecoverableError!==void 0&&(_=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(E=o.unstable_transitionCallbacks)),o=Wm(s,1,!1,null,null,l,d,g,v,_,E,null),s[Ri]=o.current,zu(s),new ac(o)},Bo.hydrateRoot=function(s,o,l){if(!r(s))throw Error(i(299));var d=!1,g="",v=_h,_=Ch,E=Eh,b=null,L=null;return l!=null&&(l.unstable_strictMode===!0&&(d=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(v=l.onUncaughtError),l.onCaughtError!==void 0&&(_=l.onCaughtError),l.onRecoverableError!==void 0&&(E=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(b=l.unstable_transitionCallbacks),l.formState!==void 0&&(L=l.formState)),o=Wm(s,1,!0,o,l??null,d,g,v,_,E,b,L),o.context=Qm(null),l=o.current,d=Mt(),d=Xa(d),g=Rn(d),g.callback=null,Mn(l,g,d),l=d,o.current.lanes=l,qs(o,l),Xt(o),s[Ri]=o.current,zu(s),new va(o)},Bo.version="19.1.1",Bo}var vp;function gS(){if(vp)return cc.exports;vp=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),cc.exports=pS(),cc.exports}var yS=gS();const vS=Wc(yS),TS=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),SS=n=>S.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:[S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.24-.438.613-.438.995s.145.755.438.995l1.003.827c.48.398.668 1.03.26 1.431l-1.296 2.247a1.125 1.125 0 0 1-1.37.49l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.063-.374-.313-.686-.645-.87a6.52 6.52 0 0 1-.22-.127c-.324-.196-.72-.257-1.075-.124l-1.217.456a1.125 1.125 0 0 1-1.37-.49l-1.296-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.437-.995s-.145-.755-.437-.995l-1.004-.827a1.125 1.125 0 0 1-.26-1.431l1.296-2.247a1.125 1.125 0 0 1 1.37-.49l1.217.456c.355.133.75.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"}),S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"})]}),xS=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"})}),_S=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"})}),CS=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z"})}),ES=({user:n,theme:e,onToggleTheme:t,onOpenSettings:i,onLogout:r})=>{var y,T,x;const[a,u]=ee.useState(!1),h=ee.useRef(null),m=((y=n.user_metadata)==null?void 0:y.name)||((T=n.user_metadata)==null?void 0:T.full_name)||n.email,p=(x=n.user_metadata)==null?void 0:x.avatar_url;return ee.useEffect(()=>{const C=A=>{h.current&&!h.current.contains(A.target)&&u(!1)};return document.addEventListener("mousedown",C),()=>document.removeEventListener("mousedown",C)},[]),S.jsxs("div",{className:"relative",ref:h,children:[S.jsxs("button",{onClick:()=>u(C=>!C),className:"flex items-center w-full gap-3 text-left p-2 rounded-md text-text-secondary hover:bg-input-bg hover:text-text-primary transition-colors","aria-haspopup":"true","aria-expanded":a,children:[p?S.jsx("img",{src:p,alt:m,className:"h-8 w-8 rounded-full bg-border-color"}):S.jsx("span",{className:"h-8 w-8 rounded-full bg-border-color flex items-center justify-center text-text-primary font-bold text-sm",children:(m==null?void 0:m.charAt(0).toUpperCase())||"?"}),S.jsxs("div",{className:"flex-1 overflow-hidden",children:[S.jsx("span",{className:"text-sm font-medium text-text-primary truncate block",children:m}),S.jsx("span",{className:"text-xs text-text-secondary truncate block",children:n.email})]})]}),a&&S.jsx("div",{className:"absolute bottom-full left-0 w-full mb-2 bg-sidebar-bg border border-border-color rounded-lg shadow-xl z-10",children:S.jsxs("div",{className:"p-1",children:[S.jsxs("button",{onClick:()=>{t(),u(!1)},className:"flex items-center gap-3 w-full text-left p-2 text-sm rounded-md text-text-secondary hover:bg-input-bg hover:text-text-primary transition-colors",children:[e==="dark"?S.jsx(_S,{className:"w-4 h-4"}):S.jsx(CS,{className:"w-4 h-4"}),S.jsxs("span",{children:["Switch to ",e==="dark"?"Light":"Dark"," Mode"]})]}),S.jsxs("button",{onClick:()=>{i(),u(!1)},className:"flex items-center gap-3 w-full text-left p-2 text-sm rounded-md text-text-secondary hover:bg-input-bg hover:text-text-primary transition-colors",children:[S.jsx(SS,{className:"w-4 h-4"}),S.jsx("span",{children:"Settings"})]}),S.jsx("div",{className:"my-1 h-px bg-border-color"}),S.jsxs("button",{onClick:()=>{r(),u(!1)},className:"flex items-center gap-3 w-full text-left p-2 text-sm rounded-md text-accent-red hover:bg-red-500/10 transition-colors",children:[S.jsx(xS,{className:"w-4 h-4"}),S.jsx("span",{children:"Logout"})]})]})})]})},AS=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})}),wS=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"})}),bS=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.134-2.036-2.134H8.718c-1.126 0-2.037.955-2.037 2.134v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})}),RS=({session:n,isActive:e,onSelect:t,onDelete:i,onRename:r})=>{const[a,u]=ee.useState(!1),[h,m]=ee.useState(n.title),p=ee.useRef(null);ee.useEffect(()=>{var x,C;a&&((x=p.current)==null||x.focus(),(C=p.current)==null||C.select())},[a]);const y=()=>{u(!1),h.trim()&&h.trim()!==n.title?r(n.id,h.trim()):m(n.title)},T=x=>{x.stopPropagation(),window.confirm(`Are you sure you want to delete "${n.title}"?`)&&i(n.id)};return S.jsxs("div",{onClick:()=>t(n.id),className:`group relative flex items-center w-full text-left rounded-md cursor-pointer transition-colors ${e?"bg-accent-blue text-white":"text-text-secondary hover:bg-input-bg hover:text-text-primary"}`,children:[a?S.jsx("input",{ref:p,type:"text",value:h,onClick:x=>x.stopPropagation(),onChange:x=>m(x.target.value),onBlur:y,onKeyDown:x=>{x.key==="Enter"&&y(),x.key==="Escape"&&(u(!1),m(n.title))},className:"flex-1 bg-transparent px-4 py-2 text-sm focus:outline-none"}):S.jsx("span",{className:"flex-1 px-4 py-2 text-sm truncate",children:n.title}),!a&&S.jsxs("div",{className:"absolute right-1 top-1/2 -translate-y-1/2 flex items-center opacity-0 group-hover:opacity-100 transition-opacity duration-200 bg-inherit rounded-md",children:[S.jsx("button",{onClick:x=>{x.stopPropagation(),u(!0)},className:`p-1 ${e?"hover:bg-blue-400":"hover:bg-border-color"} rounded`,"aria-label":"Rename session",children:S.jsx(wS,{className:"h-4 w-4"})}),S.jsx("button",{onClick:T,className:`p-1 ${e?"hover:bg-blue-400":"hover:bg-border-color"} rounded`,"aria-label":"Delete session",children:S.jsx(bS,{className:"h-4 w-4"})})]})]})},MS=({isOpen:n,sessions:e,activeSessionId:t,user:i,theme:r,onNewSession:a,onSelectSession:u,onDeleteSession:h,onRenameSession:m,onToggleTheme:p,onOpenSettings:y,onLogout:T})=>{const[x,C]=ee.useState(""),[A,R]=ee.useState("");ee.useEffect(()=>{const B=setTimeout(()=>R(x.trim().toLowerCase()),200);return()=>clearTimeout(B)},[x]);const k=ee.useMemo(()=>A?e.filter(B=>{if(B.title.toLowerCase().includes(A))return!0;for(const F of B.messages)if(typeof F.content=="string"){if(F.content.toLowerCase().includes(A))return!0}else if(F.content&&typeof F.content=="object"){const N=F.content;if([N.summary,N.thinkingProcess,N.verificationSummary,N.signal,N.confidence,N.riskRewardRatio,N.timeframe].some(O=>typeof O=="string"&&O.toLowerCase().includes(A)))return!0}return!1}):e,[A,e]);return S.jsxs("aside",{className:`bg-sidebar-bg flex flex-col transition-all duration-300 ease-in-out border-r border-border-color ${n?"w-64":"w-0"} overflow-hidden`,children:[S.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border-color h-14",children:[S.jsx("h2",{className:"text-xl font-bold whitespace-nowrap text-text-primary",children:"History"}),S.jsx("button",{onClick:a,className:"p-2 rounded-md hover:bg-input-bg focus:outline-none focus:ring-2 focus:ring-accent-blue","aria-label":"Create new analysis",children:S.jsx(TS,{className:"h-6 w-6 text-text-secondary"})})]}),S.jsx("div",{className:"p-2 border-b border-border-color",children:S.jsxs("div",{className:"relative",children:[S.jsx("input",{type:"text",placeholder:"Search...",value:x,onChange:B=>C(B.target.value),className:"w-full bg-input-bg border border-transparent rounded-md pl-9 pr-3 py-1.5 text-sm text-text-primary placeholder-text-secondary focus:outline-none focus:ring-2 focus:ring-accent-blue focus:border-transparent"}),S.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:S.jsx(AS,{className:"h-4 w-4 text-text-secondary"})})]})}),S.jsx("nav",{className:"flex-1 overflow-y-auto p-2 space-y-1",children:k.map(B=>S.jsx(RS,{session:B,isActive:B.id===t,onSelect:u,onDelete:h,onRename:m},B.id))}),S.jsx("div",{className:"p-2 border-t border-border-color",children:S.jsx(ES,{user:i,theme:r,onToggleTheme:p,onOpenSettings:y,onLogout:T})})]})},_c=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3.375 3.375 0 1112.81 7.341L5.17 15.011a1.125 1.125 0 001.591 1.59L15.182 8.25"})}),NS=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"})}),kS=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:S.jsx("path",{d:"M6 6h12v12H6z"})}),IS=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 1 1-3 0m3 0a1.5 1.5 0 1 0-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-9.75 0h9.75"})});async function Ey(n,e=1024,t=768){const i=await US(n),r=document.createElement("canvas");r.width=e,r.height=t;const a=r.getContext("2d");if(!a)throw new Error("Canvas not supported");a.fillStyle="#ffffff",a.fillRect(0,0,e,t);const u=Math.min(e/i.naturalWidth,t/i.naturalHeight),h=Math.round(i.naturalWidth*u),m=Math.round(i.naturalHeight*u),p=Math.floor((e-h)/2),y=Math.floor((t-m)/2);a.imageSmoothingEnabled=!0,a.imageSmoothingQuality="high",a.drawImage(i,p,y,h,m);const x=await(await new Promise(C=>r.toBlob(A=>C(A),"image/png"))).arrayBuffer();return new Uint8Array(x)}async function Ay(n){const e=await crypto.subtle.digest("SHA-256",n);return DS(new Uint8Array(e))}function DS(n){return Array.from(n).map(e=>e.toString(16).padStart(2,"0")).join("")}async function US(n){return new Promise((e,t)=>{const i=new Image;i.onload=()=>e(i),i.onerror=r=>t(r),typeof n=="string"?i.src=n.startsWith("data:")?n:URL.createObjectURL(new Blob([n])):i.src=URL.createObjectURL(n)})}function Tp(n){return["v1",n.modelVersion,n.promptVersion,n.ultra?"ultra":"normal",...n.imageHashes.sort()].join("|")}const LS=({className:n="h-6 w-6"})=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})}),PS=[{value:"1M",label:"1 Minute"},{value:"5M",label:"5 Minutes"},{value:"15M",label:"15 Minutes"},{value:"30M",label:"30 Minutes"},{value:"1H",label:"1 Hour"},{value:"4H",label:"4 Hours"},{value:"12H",label:"12 Hours"},{value:"1D",label:"1 Day"},{value:"3D",label:"3 Days"},{value:"1W",label:"1 Week"},{value:"1M_MONTHLY",label:"1 Month"}],HS=async n=>{const e=await Ey(n),t=await Ay(e),i=new Blob([e],{type:"image/png"});return{mimeType:"image/png",data:await new Promise((a,u)=>{const h=new FileReader;h.onloadend=()=>{const m=h.result,p=m.indexOf(",");a(p>=0?m.slice(p+1):m)},h.onerror=m=>u(m),h.readAsDataURL(i)}),hash:t}},OS=({onTimeframeImagesChange:n,disabled:e=!1})=>{const[t,i]=ee.useState([]),[r,a]=ee.useState(!1),u=ee.useRef(null),h=async x=>{if(!(!x||x.length===0)){a(!0);try{const C=[];for(let R=0;R<x.length;R++){const k=x[R];if(k.type.startsWith("image/")){const B=await HS(k),F=R===0?"1H":R===1?"4H":"1D";C.push({imageData:B,timeframe:F,label:k.name.replace(/\.[^/.]+$/,"")})}}const A=[...t,...C];i(A),n(A)}catch(C){console.error("Error processing images:",C)}finally{a(!1)}}},m=(x,C)=>{const A=[...t];A[x]={...A[x],timeframe:C},i(A),n(A)},p=(x,C)=>{const A=[...t];A[x]={...A[x],label:C},i(A),n(A)},y=x=>{const C=t.filter((A,R)=>R!==x);i(C),n(C)},T=x=>`data:${x.mimeType};base64,${x.data}`;return S.jsxs("div",{className:"space-y-4",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsx("h3",{className:"font-medium text-text-primary",children:"Multi-Timeframe Analysis"}),S.jsxs("button",{type:"button",onClick:()=>{var x;return(x=u.current)==null?void 0:x.click()},disabled:e||r,className:"inline-flex items-center px-3 py-1.5 text-sm font-medium text-accent-blue hover:text-blue-700 disabled:opacity-50",children:[S.jsx(_c,{className:"h-4 w-4 mr-1"}),"Add Charts"]})]}),S.jsx("input",{ref:u,type:"file",multiple:!0,accept:"image/png, image/jpeg, image/webp",onChange:x=>h(x.target.files),className:"hidden"}),r&&S.jsxs("div",{className:"flex items-center justify-center py-4",children:[S.jsx("div",{className:"h-5 w-5 border-2 border-t-transparent border-accent-blue rounded-full animate-spin"}),S.jsx("span",{className:"ml-2 text-sm text-text-secondary",children:"Processing images..."})]}),t.length>0&&S.jsx("div",{className:"space-y-3",children:t.map((x,C)=>S.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-input-bg-50 rounded-lg border border-border-color",children:[S.jsx("div",{className:"flex-shrink-0",children:S.jsx("img",{src:T(x.imageData),alt:`Chart ${C+1}`,className:"h-16 w-16 object-cover rounded border border-border-color"})}),S.jsxs("div",{className:"flex-1 space-y-2",children:[S.jsxs("div",{children:[S.jsx("label",{className:"block text-xs font-medium text-text-secondary mb-1",children:"Chart Label"}),S.jsx("input",{type:"text",value:x.label||"",onChange:A=>p(C,A.target.value),placeholder:"e.g., Bitcoin 4H Chart",className:"w-full px-2 py-1 text-sm bg-input-bg border border-border-color rounded focus:outline-none focus:ring-1 focus:ring-accent-blue",disabled:e})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-xs font-medium text-text-secondary mb-1",children:"Timeframe"}),S.jsx("select",{value:x.timeframe,onChange:A=>m(C,A.target.value),className:"w-full px-2 py-1 text-sm bg-input-bg border border-border-color rounded focus:outline-none focus:ring-1 focus:ring-accent-blue",disabled:e,children:PS.map(A=>S.jsx("option",{value:A.value,children:A.label},A.value))})]})]}),S.jsx("button",{type:"button",onClick:()=>y(C),disabled:e,className:"flex-shrink-0 p-1 text-text-secondary hover:text-accent-red transition-colors disabled:opacity-50","aria-label":"Remove chart",children:S.jsx(LS,{className:"h-4 w-4"})})]},C))}),t.length===0&&!r&&S.jsxs("div",{className:"text-center py-8 bg-input-bg-50 rounded-lg border-2 border-dashed border-border-color",children:[S.jsx(_c,{className:"h-8 w-8 mx-auto text-text-secondary mb-2"}),S.jsx("p",{className:"text-sm text-text-secondary",children:"Upload multiple chart images for multi-timeframe analysis"}),S.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Add charts from different timeframes (1H, 4H, 1D, etc.) for better confluence"})]}),t.length>0&&S.jsx("div",{className:"text-xs text-text-secondary",children:S.jsxs("p",{children:[S.jsx("strong",{children:"Tip:"})," Include different timeframes (e.g., 1H, 4H, 1D) for better analysis confluence. Higher timeframes provide trend context while lower timeframes refine entry timing."]})})]})},Xo=class Xo{static detectMultiTimeframeAnalysis(e,t=""){const i={isMultiTimeframe:!1,isCorrelationAnalysis:!1,isDifferentAssets:!1,detectedTimeframes:[],confidence:0,reasoning:""};if(e.length<=1)return i.reasoning="Single image detected - not multi-timeframe analysis",i;const r=t.toLowerCase();let a=0;const u=[];this.CORRELATION_KEYWORDS.some(y=>r.includes(y))&&(i.isCorrelationAnalysis=!0,a+=30,u.push("Correlation analysis keywords detected in prompt"));const m=this.ASSET_KEYWORDS.filter(y=>r.includes(y));m.length>1&&(i.isDifferentAssets=!0,a+=25,u.push(`Multiple assets detected: ${m.join(", ")}`));const p=[];for(const[y,T]of Object.entries(this.TIMEFRAME_KEYWORDS))T.some(x=>r.includes(x))&&p.push(y);return p.length>1&&(a+=35,u.push(`Multiple timeframes mentioned: ${p.join(", ")}`)),e.length>=2&&(a+=20,u.push(`${e.length} images uploaded - likely different timeframes`)),e.length>=3&&(a+=10,u.push("Three or more images suggest comprehensive multi-timeframe analysis")),i.isMultiTimeframe=a>=50,i.confidence=Math.min(a,100),i.detectedTimeframes=p,i.reasoning=u.join("; "),i}static generateDefaultTimeframes(e){const t=["1H","4H","1D"];return e.map((i,r)=>({imageData:i,timeframe:t[r]||"1D",label:`Chart ${r+1}`}))}static shouldUseMultiTimeframeAnalysis(e,t=""){const i=this.detectMultiTimeframeAnalysis(e,t);return e.length>1&&!i.isCorrelationAnalysis&&!i.isDifferentAssets&&i.confidence>=50}};Xo.TIMEFRAME_KEYWORDS={"1M":["1m","1 minute","1min","minute"],"5M":["5m","5 minute","5min","5 minutes"],"15M":["15m","15 minute","15min","15 minutes"],"30M":["30m","30 minute","30min","30 minutes"],"1H":["1h","1 hour","1hr","hour","1 hour"],"4H":["4h","4 hour","4hr","4 hours"],"12H":["12h","12 hour","12hr","12 hours"],"1D":["1d","1 day","daily","day"],"3D":["3d","3 day","3 days"],"1W":["1w","1 week","weekly","week"],"1M_MONTHLY":["1m","1 month","monthly","month"]},Xo.CORRELATION_KEYWORDS=["correlation","correlate","relationship","compare","versus","vs","against","correlation analysis","correlation study","correlation between","correlation of","how do","how does","relationship between","compare","comparison"],Xo.ASSET_KEYWORDS=["bitcoin","btc","ethereum","eth","binance","bnb","cardano","ada","solana","sol","polkadot","dot","chainlink","link","litecoin","ltc","ripple","xrp","dogecoin","doge","shiba","shib","avalanche","avax","polygon","matic","cosmos","atom","uniswap","uni","aave","aave","compound","comp","sushi","sushi","yearn","yfi","curve","crv"];let Cc=Xo;const BS=async n=>{const e=await Ey(n),t=await Ay(e),i=new Blob([e],{type:"image/png"});return{mimeType:"image/png",data:await new Promise((a,u)=>{const h=new FileReader;h.onloadend=()=>{const m=h.result,p=m.indexOf(",");a(p>=0?m.slice(p+1):m)},h.onerror=m=>u(m),h.readAsDataURL(i)}),hash:t}},VS=({onSendMessage:n,onSendMultiTimeframeMessage:e,isLoading:t,onStopGeneration:i,initialPrompt:r,isUltraMode:a,onToggleUltraMode:u})=>{const[h,m]=ee.useState(""),[p,y]=ee.useState([]),[T,x]=ee.useState([]),[C,A]=ee.useState(!1),[R,k]=ee.useState(!1),[B,F]=ee.useState([]),[N,q]=ee.useState(!1),O=ee.useRef(null),K=ee.useRef(null),Q=ee.useRef(null);ee.useEffect(()=>{var W;r&&(m(r),(W=K.current)==null||W.focus())},[r]),ee.useEffect(()=>{const W=U=>{Q.current&&!Q.current.contains(U.target)&&A(!1)};return document.addEventListener("mousedown",W),()=>document.removeEventListener("mousedown",W)},[]);const de=async W=>{const U=[],J=[],j=new Set(p.map(w=>w.name+w.size)),se=Array.from(W);for(const w of se){if(!w.type.startsWith("image/"))continue;const V=w.name+w.size;if(j.has(V))continue;U.push(w);const Y=URL.createObjectURL(w);J.push(Y)}if(y(w=>[...w,...U]),x(w=>[...w,...J]),!R&&!N){const w=[...p,...U];w.length>=2&&await new Cc().detectMultiTimeframeFromFiles(w)&&q(!0)}},ne=W=>{const U=W.target.files;U&&de(U)},ue=W=>{W.preventDefault();const U=W.dataTransfer.files;U&&de(U)},ae=W=>{const U=W.clipboardData.items,J=[];for(let j=0;j<U.length;j++){const se=U[j];if(se.type.startsWith("image/")){const w=se.getAsFile();w&&J.push(w)}}J.length>0&&de(J)},pe=async()=>{if(R||N){if(!h.trim()&&B.length===0||t)return;e&&(e(h.trim(),B),m(""),F([]),q(!1))}else{if(!h.trim()&&p.length===0||t)return;let W=[];p.length>0&&(W=await Promise.all(p.map(BS))),n(h,W),m(""),y([]),x([]),O.current&&(O.current.value="")}},xe=W=>{W.key==="Enter"&&!W.shiftKey&&(W.preventDefault(),pe())},ve=W=>{y(U=>U.filter((J,j)=>j!==W)),x(U=>U.filter((J,j)=>j!==W)),O.current&&p.length===1&&(O.current.value="")};return S.jsxs("div",{className:"bg-input-bg border border-border-color rounded-lg p-2 flex flex-col",onDrop:ue,onDragOver:W=>W.preventDefault(),onPaste:ae,children:[!(R||N)&&T.length>0&&S.jsx("div",{className:"p-2 grid grid-cols-3 gap-2",children:T.map((W,U)=>S.jsxs("div",{className:"relative",children:[S.jsx("img",{src:W,alt:`Image preview ${U+1}`,className:"max-h-24 w-full object-cover rounded-md"}),S.jsx("button",{onClick:()=>ve(U),className:"absolute top-0 right-0 m-1 bg-red-500 text-white rounded-full h-5 w-5 flex items-center justify-center text-xs",children:""})]},U))}),(R||N)&&S.jsxs("div",{className:"p-3 border-b border-border-color",children:[N&&S.jsx("div",{className:"mb-2 p-2 bg-blue-100 dark:bg-blue-900/30 rounded-md",children:S.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:" Auto-detected multi-timeframe analysis"})}),S.jsx(OS,{onTimeframeImagesChange:F,disabled:t})]}),S.jsxs("div",{className:"flex items-start",children:[!(R||N)&&S.jsx("button",{onClick:()=>{var W;return(W=O.current)==null?void 0:W.click()},className:"p-2 text-text-secondary hover:text-text-primary self-center",disabled:t,"aria-label":"Attach images",children:S.jsx(_c,{className:"h-5 w-5"})}),S.jsx("input",{type:"file",ref:O,onChange:ne,className:"hidden",multiple:!0,accept:"image/png, image/jpeg, image/webp"}),S.jsxs("div",{className:"relative self-center",ref:Q,children:[S.jsx("button",{onClick:()=>A(W=>!W),className:`p-2 text-text-secondary hover:text-text-primary transition-colors ${a?"text-accent-blue":""}`,disabled:t,"aria-label":"Wizz Ultra Settings",children:S.jsx(IS,{className:"h-5 w-5"})}),C&&S.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-72 bg-sidebar-bg border border-border-color rounded-lg shadow-xl z-10 p-3",children:[S.jsx("div",{className:"space-y-3",children:S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{children:[S.jsx("h4",{className:"font-semibold text-text-primary",children:"Wizz Ultra"}),S.jsx("p",{className:"text-xs text-text-secondary",children:"Advanced analysis with SMC, Patterns & Progressive loading"})]}),S.jsxs("label",{htmlFor:"ultra-toggle",className:"relative inline-flex items-center cursor-pointer",children:[S.jsx("input",{type:"checkbox",id:"ultra-toggle",className:"sr-only peer",checked:a,onChange:u}),S.jsx("div",{className:"w-11 h-6 bg-border-color peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-offset-2 peer-focus:ring-accent-blue peer-focus:ring-offset-sidebar-bg rounded-full peer peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent-blue"})]})]})}),S.jsx("p",{className:"text-xs text-text-secondary mt-2 border-t border-border-color pt-2",children:a?"Ultra mode combines advanced analysis techniques including Smart Money Concepts, pattern recognition, progressive loading, and enhanced confidence calibration for maximum accuracy.":"Multi-timeframe analysis is automatically detected when multiple charts are uploaded. Upload charts from different timeframes (1H, 4H, 1D) for better confluence analysis."})]})]}),S.jsx("textarea",{ref:K,value:h,onChange:W=>m(W.target.value),onKeyDown:xe,placeholder:"Describe the chart or ask a question... (you can also paste or drag-and-drop images)",className:"flex-1 bg-transparent resize-none focus:outline-none text-text-primary placeholder-text-secondary px-2 pt-1.5 max-h-28",rows:1,disabled:t}),S.jsx("div",{className:"self-center",children:t?S.jsx("button",{onClick:i,className:"p-2 rounded-md bg-accent-red text-white","aria-label":"Stop generation",children:S.jsx(kS,{className:"h-5 w-5"})}):S.jsx("button",{onClick:pe,disabled:!h.trim()&&p.length===0,className:"p-2 rounded-md bg-accent-blue text-white disabled:bg-gray-500 disabled:cursor-not-allowed","aria-label":"Send message",children:S.jsx(NS,{className:"h-5 w-5"})})})]})]})};function Xc(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let Ei=Xc();function wy(n){Ei=n}const by=/[&<>"']/,qS=new RegExp(by.source,"g"),Ry=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,GS=new RegExp(Ry.source,"g"),zS={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Sp=n=>zS[n];function kt(n,e){if(e){if(by.test(n))return n.replace(qS,Sp)}else if(Ry.test(n))return n.replace(GS,Sp);return n}const $S=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function FS(n){return n.replace($S,(e,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const YS=/(^|[^\[])\^/g;function Pe(n,e){let t=typeof n=="string"?n:n.source;e=e||"";const i={replace:(r,a)=>{let u=typeof a=="string"?a:a.source;return u=u.replace(YS,"$1"),t=t.replace(r,u),i},getRegex:()=>new RegExp(t,e)};return i}function xp(n){try{n=encodeURI(n).replace(/%25/g,"%")}catch{return null}return n}const Yo={exec:()=>null};function _p(n,e){const t=n.replace(/\|/g,(a,u,h)=>{let m=!1,p=u;for(;--p>=0&&h[p]==="\\";)m=!m;return m?"|":" |"}),i=t.split(/ \|/);let r=0;if(i[0].trim()||i.shift(),i.length>0&&!i[i.length-1].trim()&&i.pop(),e)if(i.length>e)i.splice(e);else for(;i.length<e;)i.push("");for(;r<i.length;r++)i[r]=i[r].trim().replace(/\\\|/g,"|");return i}function Vo(n,e,t){const i=n.length;if(i===0)return"";let r=0;for(;r<i&&n.charAt(i-r-1)===e;)r++;return n.slice(0,i-r)}function JS(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let i=0;i<n.length;i++)if(n[i]==="\\")i++;else if(n[i]===e[0])t++;else if(n[i]===e[1]&&(t--,t<0))return i;return-1}function Cp(n,e,t,i){const r=e.href,a=e.title?kt(e.title):null,u=n[1].replace(/\\([\[\]])/g,"$1");if(n[0].charAt(0)!=="!"){i.state.inLink=!0;const h={type:"link",raw:t,href:r,title:a,text:u,tokens:i.inlineTokens(u)};return i.state.inLink=!1,h}return{type:"image",raw:t,href:r,title:a,text:kt(u)}}function jS(n,e){const t=n.match(/^(\s+)(?:```)/);if(t===null)return e;const i=t[1];return e.split(`
`).map(r=>{const a=r.match(/^\s+/);if(a===null)return r;const[u]=a;return u.length>=i.length?r.slice(i.length):r}).join(`
`)}class Ia{constructor(e){Be(this,"options");Be(this,"rules");Be(this,"lexer");this.options=e||Ei}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const i=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?i:Vo(i,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const i=t[0],r=jS(i,t[3]||"");return{type:"code",raw:i,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let i=t[2].trim();if(/#$/.test(i)){const r=Vo(i,"#");(this.options.pedantic||!r||/ $/.test(r))&&(i=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:i,tokens:this.lexer.inline(i)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:Vo(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let i=Vo(t[0],`
`).split(`
`),r="",a="";const u=[];for(;i.length>0;){let h=!1;const m=[];let p;for(p=0;p<i.length;p++)if(/^ {0,3}>/.test(i[p]))m.push(i[p]),h=!0;else if(!h)m.push(i[p]);else break;i=i.slice(p);const y=m.join(`
`),T=y.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");r=r?`${r}
${y}`:y,a=a?`${a}
${T}`:T;const x=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(T,u,!0),this.lexer.state.top=x,i.length===0)break;const C=u[u.length-1];if((C==null?void 0:C.type)==="code")break;if((C==null?void 0:C.type)==="blockquote"){const A=C,R=A.raw+`
`+i.join(`
`),k=this.blockquote(R);u[u.length-1]=k,r=r.substring(0,r.length-A.raw.length)+k.raw,a=a.substring(0,a.length-A.text.length)+k.text;break}else if((C==null?void 0:C.type)==="list"){const A=C,R=A.raw+`
`+i.join(`
`),k=this.list(R);u[u.length-1]=k,r=r.substring(0,r.length-C.raw.length)+k.raw,a=a.substring(0,a.length-A.raw.length)+k.raw,i=R.substring(u[u.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:u,text:a}}}list(e){let t=this.rules.block.list.exec(e);if(t){let i=t[1].trim();const r=i.length>1,a={type:"list",raw:"",ordered:r,start:r?+i.slice(0,-1):"",loose:!1,items:[]};i=r?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=r?i:"[*+-]");const u=new RegExp(`^( {0,3}${i})((?:[	 ][^\\n]*)?(?:\\n|$))`);let h=!1;for(;e;){let m=!1,p="",y="";if(!(t=u.exec(e))||this.rules.block.hr.test(e))break;p=t[0],e=e.substring(p.length);let T=t[2].split(`
`,1)[0].replace(/^\t+/,B=>" ".repeat(3*B.length)),x=e.split(`
`,1)[0],C=!T.trim(),A=0;if(this.options.pedantic?(A=2,y=T.trimStart()):C?A=t[1].length+1:(A=t[2].search(/[^ ]/),A=A>4?1:A,y=T.slice(A),A+=t[1].length),C&&/^ *$/.test(x)&&(p+=x+`
`,e=e.substring(x.length+1),m=!0),!m){const B=new RegExp(`^ {0,${Math.min(3,A-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),F=new RegExp(`^ {0,${Math.min(3,A-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),N=new RegExp(`^ {0,${Math.min(3,A-1)}}(?:\`\`\`|~~~)`),q=new RegExp(`^ {0,${Math.min(3,A-1)}}#`);for(;e;){const O=e.split(`
`,1)[0];if(x=O,this.options.pedantic&&(x=x.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),N.test(x)||q.test(x)||B.test(x)||F.test(e))break;if(x.search(/[^ ]/)>=A||!x.trim())y+=`
`+x.slice(A);else{if(C||T.search(/[^ ]/)>=4||N.test(T)||q.test(T)||F.test(T))break;y+=`
`+x}!C&&!x.trim()&&(C=!0),p+=O+`
`,e=e.substring(O.length+1),T=x.slice(A)}}a.loose||(h?a.loose=!0:/\n *\n *$/.test(p)&&(h=!0));let R=null,k;this.options.gfm&&(R=/^\[[ xX]\] /.exec(y),R&&(k=R[0]!=="[ ] ",y=y.replace(/^\[[ xX]\] +/,""))),a.items.push({type:"list_item",raw:p,task:!!R,checked:k,loose:!1,text:y,tokens:[]}),a.raw+=p}a.items[a.items.length-1].raw=a.items[a.items.length-1].raw.trimEnd(),a.items[a.items.length-1].text=a.items[a.items.length-1].text.trimEnd(),a.raw=a.raw.trimEnd();for(let m=0;m<a.items.length;m++)if(this.lexer.state.top=!1,a.items[m].tokens=this.lexer.blockTokens(a.items[m].text,[]),!a.loose){const p=a.items[m].tokens.filter(T=>T.type==="space"),y=p.length>0&&p.some(T=>/\n.*\n/.test(T.raw));a.loose=y}if(a.loose)for(let m=0;m<a.items.length;m++)a.items[m].loose=!0;return a}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const i=t[1].toLowerCase().replace(/\s+/g," "),r=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",a=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:i,raw:t[0],href:r,title:a}}}table(e){const t=this.rules.block.table.exec(e);if(!t||!/[:|]/.test(t[2]))return;const i=_p(t[1]),r=t[2].replace(/^\||\| *$/g,"").split("|"),a=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[],u={type:"table",raw:t[0],header:[],align:[],rows:[]};if(i.length===r.length){for(const h of r)/^ *-+: *$/.test(h)?u.align.push("right"):/^ *:-+: *$/.test(h)?u.align.push("center"):/^ *:-+ *$/.test(h)?u.align.push("left"):u.align.push(null);for(let h=0;h<i.length;h++)u.header.push({text:i[h],tokens:this.lexer.inline(i[h]),header:!0,align:u.align[h]});for(const h of a)u.rows.push(_p(h,u.header.length).map((m,p)=>({text:m,tokens:this.lexer.inline(m),header:!1,align:u.align[p]})));return u}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const i=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:i,tokens:this.lexer.inline(i)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:kt(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const i=t[2].trim();if(!this.options.pedantic&&/^</.test(i)){if(!/>$/.test(i))return;const u=Vo(i.slice(0,-1),"\\");if((i.length-u.length)%2===0)return}else{const u=JS(t[2],"()");if(u>-1){const m=(t[0].indexOf("!")===0?5:4)+t[1].length+u;t[2]=t[2].substring(0,u),t[0]=t[0].substring(0,m).trim(),t[3]=""}}let r=t[2],a="";if(this.options.pedantic){const u=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(r);u&&(r=u[1],a=u[3])}else a=t[3]?t[3].slice(1,-1):"";return r=r.trim(),/^</.test(r)&&(this.options.pedantic&&!/>$/.test(i)?r=r.slice(1):r=r.slice(1,-1)),Cp(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:a&&a.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer)}}reflink(e,t){let i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){const r=(i[2]||i[1]).replace(/\s+/g," "),a=t[r.toLowerCase()];if(!a){const u=i[0].charAt(0);return{type:"text",raw:u,text:u}}return Cp(i,a,i[0],this.lexer)}}emStrong(e,t,i=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!r||r[3]&&i.match(/[\p{L}\p{N}]/u))return;if(!(r[1]||r[2]||"")||!i||this.rules.inline.punctuation.exec(i)){const u=[...r[0]].length-1;let h,m,p=u,y=0;const T=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(T.lastIndex=0,t=t.slice(-1*e.length+u);(r=T.exec(t))!=null;){if(h=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!h)continue;if(m=[...h].length,r[3]||r[4]){p+=m;continue}else if((r[5]||r[6])&&u%3&&!((u+m)%3)){y+=m;continue}if(p-=m,p>0)continue;m=Math.min(m,m+p+y);const x=[...r[0]][0].length,C=e.slice(0,u+r.index+x+m);if(Math.min(u,m)%2){const R=C.slice(1,-1);return{type:"em",raw:C,text:R,tokens:this.lexer.inlineTokens(R)}}const A=C.slice(2,-2);return{type:"strong",raw:C,text:A,tokens:this.lexer.inlineTokens(A)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let i=t[2].replace(/\n/g," ");const r=/[^ ]/.test(i),a=/^ /.test(i)&&/ $/.test(i);return r&&a&&(i=i.substring(1,i.length-1)),i=kt(i,!0),{type:"codespan",raw:t[0],text:i}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let i,r;return t[2]==="@"?(i=kt(t[1]),r="mailto:"+i):(i=kt(t[1]),r=i),{type:"link",raw:t[0],text:i,href:r,tokens:[{type:"text",raw:i,text:i}]}}}url(e){var i;let t;if(t=this.rules.inline.url.exec(e)){let r,a;if(t[2]==="@")r=kt(t[0]),a="mailto:"+r;else{let u;do u=t[0],t[0]=((i=this.rules.inline._backpedal.exec(t[0]))==null?void 0:i[0])??"";while(u!==t[0]);r=kt(t[0]),t[1]==="www."?a="http://"+t[0]:a=t[0]}return{type:"link",raw:t[0],text:r,href:a,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let i;return this.lexer.state.inRawBlock?i=t[0]:i=kt(t[0]),{type:"text",raw:t[0],text:i}}}}const KS=/^(?: *(?:\n|$))+/,WS=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,QS=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,er=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,XS=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,My=/(?:[*+-]|\d{1,9}[.)])/,Ny=Pe(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,My).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),Zc=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,ZS=/^[^\n]+/,ef=/(?!\s*\])(?:\\.|[^\[\]\\])+/,ex=Pe(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",ef).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),tx=Pe(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,My).getRegex(),Ga="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",tf=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,nx=Pe("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",tf).replace("tag",Ga).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),ky=Pe(Zc).replace("hr",er).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ga).getRegex(),ix=Pe(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",ky).getRegex(),nf={blockquote:ix,code:WS,def:ex,fences:QS,heading:XS,hr:er,html:nx,lheading:Ny,list:tx,newline:KS,paragraph:ky,table:Yo,text:ZS},Ep=Pe("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",er).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ga).getRegex(),sx={...nf,table:Ep,paragraph:Pe(Zc).replace("hr",er).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Ep).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ga).getRegex()},ox={...nf,html:Pe(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",tf).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Yo,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Pe(Zc).replace("hr",er).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Ny).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Iy=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,rx=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Dy=/^( {2,}|\\)\n(?!\s*$)/,ax=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,tr="\\p{P}\\p{S}",lx=Pe(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,tr).getRegex(),ux=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,cx=Pe(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,tr).getRegex(),fx=Pe("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,tr).getRegex(),dx=Pe("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,tr).getRegex(),hx=Pe(/\\([punct])/,"gu").replace(/punct/g,tr).getRegex(),mx=Pe(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),px=Pe(tf).replace("(?:-->|$)","-->").getRegex(),gx=Pe("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",px).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Da=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,yx=Pe(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",Da).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Uy=Pe(/^!?\[(label)\]\[(ref)\]/).replace("label",Da).replace("ref",ef).getRegex(),Ly=Pe(/^!?\[(ref)\](?:\[\])?/).replace("ref",ef).getRegex(),vx=Pe("reflink|nolink(?!\\()","g").replace("reflink",Uy).replace("nolink",Ly).getRegex(),sf={_backpedal:Yo,anyPunctuation:hx,autolink:mx,blockSkip:ux,br:Dy,code:rx,del:Yo,emStrongLDelim:cx,emStrongRDelimAst:fx,emStrongRDelimUnd:dx,escape:Iy,link:yx,nolink:Ly,punctuation:lx,reflink:Uy,reflinkSearch:vx,tag:gx,text:ax,url:Yo},Tx={...sf,link:Pe(/^!?\[(label)\]\((.*?)\)/).replace("label",Da).getRegex(),reflink:Pe(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Da).getRegex()},Ec={...sf,escape:Pe(Iy).replace("])","~|])").getRegex(),url:Pe(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Sx={...Ec,br:Pe(Dy).replace("{2,}","*").getRegex(),text:Pe(Ec.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Sa={normal:nf,gfm:sx,pedantic:ox},qo={normal:sf,gfm:Ec,breaks:Sx,pedantic:Tx};class Zt{constructor(e){Be(this,"tokens");Be(this,"options");Be(this,"state");Be(this,"tokenizer");Be(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Ei,this.options.tokenizer=this.options.tokenizer||new Ia,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:Sa.normal,inline:qo.normal};this.options.pedantic?(t.block=Sa.pedantic,t.inline=qo.pedantic):this.options.gfm&&(t.block=Sa.gfm,this.options.breaks?t.inline=qo.breaks:t.inline=qo.gfm),this.tokenizer.rules=t}static get rules(){return{block:Sa,inline:qo}}static lex(e,t){return new Zt(t).lex(e)}static lexInline(e,t){return new Zt(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const i=this.inlineQueue[t];this.inlineTokens(i.src,i.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],i=!1){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(h,m,p)=>m+"    ".repeat(p.length));let r,a,u;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(h=>(r=h.call({lexer:this},e,t))?(e=e.substring(r.raw.length),t.push(r),!0):!1))){if(r=this.tokenizer.space(e)){e=e.substring(r.raw.length),r.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(r);continue}if(r=this.tokenizer.code(e)){e=e.substring(r.raw.length),a=t[t.length-1],a&&(a.type==="paragraph"||a.type==="text")?(a.raw+=`
`+r.raw,a.text+=`
`+r.text,this.inlineQueue[this.inlineQueue.length-1].src=a.text):t.push(r);continue}if(r=this.tokenizer.fences(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.heading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.hr(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.blockquote(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.list(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.html(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.def(e)){e=e.substring(r.raw.length),a=t[t.length-1],a&&(a.type==="paragraph"||a.type==="text")?(a.raw+=`
`+r.raw,a.text+=`
`+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=a.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.lheading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(u=e,this.options.extensions&&this.options.extensions.startBlock){let h=1/0;const m=e.slice(1);let p;this.options.extensions.startBlock.forEach(y=>{p=y.call({lexer:this},m),typeof p=="number"&&p>=0&&(h=Math.min(h,p))}),h<1/0&&h>=0&&(u=e.substring(0,h+1))}if(this.state.top&&(r=this.tokenizer.paragraph(u))){a=t[t.length-1],i&&(a==null?void 0:a.type)==="paragraph"?(a.raw+=`
`+r.raw,a.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=a.text):t.push(r),i=u.length!==e.length,e=e.substring(r.raw.length);continue}if(r=this.tokenizer.text(e)){e=e.substring(r.raw.length),a=t[t.length-1],a&&a.type==="text"?(a.raw+=`
`+r.raw,a.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=a.text):t.push(r);continue}if(e){const h="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let i,r,a,u=e,h,m,p;if(this.tokens.links){const y=Object.keys(this.tokens.links);if(y.length>0)for(;(h=this.tokenizer.rules.inline.reflinkSearch.exec(u))!=null;)y.includes(h[0].slice(h[0].lastIndexOf("[")+1,-1))&&(u=u.slice(0,h.index)+"["+"a".repeat(h[0].length-2)+"]"+u.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(h=this.tokenizer.rules.inline.blockSkip.exec(u))!=null;)u=u.slice(0,h.index)+"["+"a".repeat(h[0].length-2)+"]"+u.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(h=this.tokenizer.rules.inline.anyPunctuation.exec(u))!=null;)u=u.slice(0,h.index)+"++"+u.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(m||(p=""),m=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(y=>(i=y.call({lexer:this},e,t))?(e=e.substring(i.raw.length),t.push(i),!0):!1))){if(i=this.tokenizer.escape(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.tag(e)){e=e.substring(i.raw.length),r=t[t.length-1],r&&i.type==="text"&&r.type==="text"?(r.raw+=i.raw,r.text+=i.text):t.push(i);continue}if(i=this.tokenizer.link(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(i.raw.length),r=t[t.length-1],r&&i.type==="text"&&r.type==="text"?(r.raw+=i.raw,r.text+=i.text):t.push(i);continue}if(i=this.tokenizer.emStrong(e,u,p)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.codespan(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.br(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.del(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.autolink(e)){e=e.substring(i.raw.length),t.push(i);continue}if(!this.state.inLink&&(i=this.tokenizer.url(e))){e=e.substring(i.raw.length),t.push(i);continue}if(a=e,this.options.extensions&&this.options.extensions.startInline){let y=1/0;const T=e.slice(1);let x;this.options.extensions.startInline.forEach(C=>{x=C.call({lexer:this},T),typeof x=="number"&&x>=0&&(y=Math.min(y,x))}),y<1/0&&y>=0&&(a=e.substring(0,y+1))}if(i=this.tokenizer.inlineText(a)){e=e.substring(i.raw.length),i.raw.slice(-1)!=="_"&&(p=i.raw.slice(-1)),m=!0,r=t[t.length-1],r&&r.type==="text"?(r.raw+=i.raw,r.text+=i.text):t.push(i);continue}if(e){const y="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(y);break}else throw new Error(y)}}return t}}class Ua{constructor(e){Be(this,"options");Be(this,"parser");this.options=e||Ei}space(e){return""}code({text:e,lang:t,escaped:i}){var u;const r=(u=(t||"").match(/^\S*/))==null?void 0:u[0],a=e.replace(/\n$/,"")+`
`;return r?'<pre><code class="language-'+kt(r)+'">'+(i?a:kt(a,!0))+`</code></pre>
`:"<pre><code>"+(i?a:kt(a,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,i=e.start;let r="";for(let h=0;h<e.items.length;h++){const m=e.items[h];r+=this.listitem(m)}const a=t?"ol":"ul",u=t&&i!==1?' start="'+i+'"':"";return"<"+a+u+`>
`+r+"</"+a+`>
`}listitem(e){let t="";if(e.task){const i=this.checkbox({checked:!!e.checked});e.loose?e.tokens.length>0&&e.tokens[0].type==="paragraph"?(e.tokens[0].text=i+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=i+" "+e.tokens[0].tokens[0].text)):e.tokens.unshift({type:"text",raw:i+" ",text:i+" "}):t+=i+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",i="";for(let a=0;a<e.header.length;a++)i+=this.tablecell(e.header[a]);t+=this.tablerow({text:i});let r="";for(let a=0;a<e.rows.length;a++){const u=e.rows[a];i="";for(let h=0;h<u.length;h++)i+=this.tablecell(u[h]);r+=this.tablerow({text:i})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),i=e.header?"th":"td";return(e.align?`<${i} align="${e.align}">`:`<${i}>`)+t+`</${i}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${e}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:i}){const r=this.parser.parseInline(i),a=xp(e);if(a===null)return r;e=a;let u='<a href="'+e+'"';return t&&(u+=' title="'+t+'"'),u+=">"+r+"</a>",u}image({href:e,title:t,text:i}){const r=xp(e);if(r===null)return i;e=r;let a=`<img src="${e}" alt="${i}"`;return t&&(a+=` title="${t}"`),a+=">",a}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):e.text}}class of{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class en{constructor(e){Be(this,"options");Be(this,"renderer");Be(this,"textRenderer");this.options=e||Ei,this.options.renderer=this.options.renderer||new Ua,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new of}static parse(e,t){return new en(t).parse(e)}static parseInline(e,t){return new en(t).parseInline(e)}parse(e,t=!0){let i="";for(let r=0;r<e.length;r++){const a=e[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[a.type]){const h=a,m=this.options.extensions.renderers[h.type].call({parser:this},h);if(m!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(h.type)){i+=m||"";continue}}const u=a;switch(u.type){case"space":{i+=this.renderer.space(u);continue}case"hr":{i+=this.renderer.hr(u);continue}case"heading":{i+=this.renderer.heading(u);continue}case"code":{i+=this.renderer.code(u);continue}case"table":{i+=this.renderer.table(u);continue}case"blockquote":{i+=this.renderer.blockquote(u);continue}case"list":{i+=this.renderer.list(u);continue}case"html":{i+=this.renderer.html(u);continue}case"paragraph":{i+=this.renderer.paragraph(u);continue}case"text":{let h=u,m=this.renderer.text(h);for(;r+1<e.length&&e[r+1].type==="text";)h=e[++r],m+=`
`+this.renderer.text(h);t?i+=this.renderer.paragraph({type:"paragraph",raw:m,text:m,tokens:[{type:"text",raw:m,text:m}]}):i+=m;continue}default:{const h='Token with "'+u.type+'" type was not found.';if(this.options.silent)return console.error(h),"";throw new Error(h)}}}return i}parseInline(e,t){t=t||this.renderer;let i="";for(let r=0;r<e.length;r++){const a=e[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[a.type]){const h=this.options.extensions.renderers[a.type].call({parser:this},a);if(h!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){i+=h||"";continue}}const u=a;switch(u.type){case"escape":{i+=t.text(u);break}case"html":{i+=t.html(u);break}case"link":{i+=t.link(u);break}case"image":{i+=t.image(u);break}case"strong":{i+=t.strong(u);break}case"em":{i+=t.em(u);break}case"codespan":{i+=t.codespan(u);break}case"br":{i+=t.br(u);break}case"del":{i+=t.del(u);break}case"text":{i+=t.text(u);break}default:{const h='Token with "'+u.type+'" type was not found.';if(this.options.silent)return console.error(h),"";throw new Error(h)}}}return i}}class Jo{constructor(e){Be(this,"options");this.options=e||Ei}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}}Be(Jo,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));var Sn,Py,Ac,Hy;class xx{constructor(...e){lp(this,Sn);Be(this,"defaults",Xc());Be(this,"options",this.setOptions);Be(this,"parse",Ho(this,Sn,Ac).call(this,Zt.lex,en.parse));Be(this,"parseInline",Ho(this,Sn,Ac).call(this,Zt.lexInline,en.parseInline));Be(this,"Parser",en);Be(this,"Renderer",Ua);Be(this,"TextRenderer",of);Be(this,"Lexer",Zt);Be(this,"Tokenizer",Ia);Be(this,"Hooks",Jo);this.use(...e)}walkTokens(e,t){var r,a;let i=[];for(const u of e)switch(i=i.concat(t.call(this,u)),u.type){case"table":{const h=u;for(const m of h.header)i=i.concat(this.walkTokens(m.tokens,t));for(const m of h.rows)for(const p of m)i=i.concat(this.walkTokens(p.tokens,t));break}case"list":{const h=u;i=i.concat(this.walkTokens(h.items,t));break}default:{const h=u;(a=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&a[h.type]?this.defaults.extensions.childTokens[h.type].forEach(m=>{const p=h[m].flat(1/0);i=i.concat(this.walkTokens(p,t))}):h.tokens&&(i=i.concat(this.walkTokens(h.tokens,t)))}}return i}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(i=>{const r={...i};if(r.async=this.defaults.async||r.async||!1,i.extensions&&(i.extensions.forEach(a=>{if(!a.name)throw new Error("extension name required");if("renderer"in a){const u=t.renderers[a.name];u?t.renderers[a.name]=function(...h){let m=a.renderer.apply(this,h);return m===!1&&(m=u.apply(this,h)),m}:t.renderers[a.name]=a.renderer}if("tokenizer"in a){if(!a.level||a.level!=="block"&&a.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const u=t[a.level];u?u.unshift(a.tokenizer):t[a.level]=[a.tokenizer],a.start&&(a.level==="block"?t.startBlock?t.startBlock.push(a.start):t.startBlock=[a.start]:a.level==="inline"&&(t.startInline?t.startInline.push(a.start):t.startInline=[a.start]))}"childTokens"in a&&a.childTokens&&(t.childTokens[a.name]=a.childTokens)}),r.extensions=t),i.renderer){const a=this.defaults.renderer||new Ua(this.defaults);for(const u in i.renderer){if(!(u in a))throw new Error(`renderer '${u}' does not exist`);if(["options","parser"].includes(u))continue;const h=u;let m=i.renderer[h];i.useNewRenderer||(m=Ho(this,Sn,Py).call(this,m,h,a));const p=a[h];a[h]=(...y)=>{let T=m.apply(a,y);return T===!1&&(T=p.apply(a,y)),T||""}}r.renderer=a}if(i.tokenizer){const a=this.defaults.tokenizer||new Ia(this.defaults);for(const u in i.tokenizer){if(!(u in a))throw new Error(`tokenizer '${u}' does not exist`);if(["options","rules","lexer"].includes(u))continue;const h=u,m=i.tokenizer[h],p=a[h];a[h]=(...y)=>{let T=m.apply(a,y);return T===!1&&(T=p.apply(a,y)),T}}r.tokenizer=a}if(i.hooks){const a=this.defaults.hooks||new Jo;for(const u in i.hooks){if(!(u in a))throw new Error(`hook '${u}' does not exist`);if(u==="options")continue;const h=u,m=i.hooks[h],p=a[h];Jo.passThroughHooks.has(u)?a[h]=y=>{if(this.defaults.async)return Promise.resolve(m.call(a,y)).then(x=>p.call(a,x));const T=m.call(a,y);return p.call(a,T)}:a[h]=(...y)=>{let T=m.apply(a,y);return T===!1&&(T=p.apply(a,y)),T}}r.hooks=a}if(i.walkTokens){const a=this.defaults.walkTokens,u=i.walkTokens;r.walkTokens=function(h){let m=[];return m.push(u.call(this,h)),a&&(m=m.concat(a.call(this,h))),m}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Zt.lex(e,t??this.defaults)}parser(e,t){return en.parse(e,t??this.defaults)}}Sn=new WeakSet,Py=function(e,t,i){switch(t){case"heading":return function(r){return!r.type||r.type!==t?e.apply(this,arguments):e.call(this,i.parser.parseInline(r.tokens),r.depth,FS(i.parser.parseInline(r.tokens,i.parser.textRenderer)))};case"code":return function(r){return!r.type||r.type!==t?e.apply(this,arguments):e.call(this,r.text,r.lang,!!r.escaped)};case"table":return function(r){if(!r.type||r.type!==t)return e.apply(this,arguments);let a="",u="";for(let m=0;m<r.header.length;m++)u+=this.tablecell({text:r.header[m].text,tokens:r.header[m].tokens,header:!0,align:r.align[m]});a+=this.tablerow({text:u});let h="";for(let m=0;m<r.rows.length;m++){const p=r.rows[m];u="";for(let y=0;y<p.length;y++)u+=this.tablecell({text:p[y].text,tokens:p[y].tokens,header:!1,align:r.align[y]});h+=this.tablerow({text:u})}return e.call(this,a,h)};case"blockquote":return function(r){if(!r.type||r.type!==t)return e.apply(this,arguments);const a=this.parser.parse(r.tokens);return e.call(this,a)};case"list":return function(r){if(!r.type||r.type!==t)return e.apply(this,arguments);const a=r.ordered,u=r.start,h=r.loose;let m="";for(let p=0;p<r.items.length;p++){const y=r.items[p],T=y.checked,x=y.task;let C="";if(y.task){const A=this.checkbox({checked:!!T});h?y.tokens.length>0&&y.tokens[0].type==="paragraph"?(y.tokens[0].text=A+" "+y.tokens[0].text,y.tokens[0].tokens&&y.tokens[0].tokens.length>0&&y.tokens[0].tokens[0].type==="text"&&(y.tokens[0].tokens[0].text=A+" "+y.tokens[0].tokens[0].text)):y.tokens.unshift({type:"text",text:A+" "}):C+=A+" "}C+=this.parser.parse(y.tokens,h),m+=this.listitem({type:"list_item",raw:C,text:C,task:x,checked:!!T,loose:h,tokens:y.tokens})}return e.call(this,m,a,u)};case"html":return function(r){return!r.type||r.type!==t?e.apply(this,arguments):e.call(this,r.text,r.block)};case"paragraph":return function(r){return!r.type||r.type!==t?e.apply(this,arguments):e.call(this,this.parser.parseInline(r.tokens))};case"escape":return function(r){return!r.type||r.type!==t?e.apply(this,arguments):e.call(this,r.text)};case"link":return function(r){return!r.type||r.type!==t?e.apply(this,arguments):e.call(this,r.href,r.title,this.parser.parseInline(r.tokens))};case"image":return function(r){return!r.type||r.type!==t?e.apply(this,arguments):e.call(this,r.href,r.title,r.text)};case"strong":return function(r){return!r.type||r.type!==t?e.apply(this,arguments):e.call(this,this.parser.parseInline(r.tokens))};case"em":return function(r){return!r.type||r.type!==t?e.apply(this,arguments):e.call(this,this.parser.parseInline(r.tokens))};case"codespan":return function(r){return!r.type||r.type!==t?e.apply(this,arguments):e.call(this,r.text)};case"del":return function(r){return!r.type||r.type!==t?e.apply(this,arguments):e.call(this,this.parser.parseInline(r.tokens))};case"text":return function(r){return!r.type||r.type!==t?e.apply(this,arguments):e.call(this,r.text)}}return e},Ac=function(e,t){return(i,r)=>{const a={...r},u={...this.defaults,...a};this.defaults.async===!0&&a.async===!1&&(u.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),u.async=!0);const h=Ho(this,Sn,Hy).call(this,!!u.silent,!!u.async);if(typeof i>"u"||i===null)return h(new Error("marked(): input parameter is undefined or null"));if(typeof i!="string")return h(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(i)+", string expected"));if(u.hooks&&(u.hooks.options=u),u.async)return Promise.resolve(u.hooks?u.hooks.preprocess(i):i).then(m=>e(m,u)).then(m=>u.hooks?u.hooks.processAllTokens(m):m).then(m=>u.walkTokens?Promise.all(this.walkTokens(m,u.walkTokens)).then(()=>m):m).then(m=>t(m,u)).then(m=>u.hooks?u.hooks.postprocess(m):m).catch(h);try{u.hooks&&(i=u.hooks.preprocess(i));let m=e(i,u);u.hooks&&(m=u.hooks.processAllTokens(m)),u.walkTokens&&this.walkTokens(m,u.walkTokens);let p=t(m,u);return u.hooks&&(p=u.hooks.postprocess(p)),p}catch(m){return h(m)}}},Hy=function(e,t){return i=>{if(i.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const r="<p>An error occurred:</p><pre>"+kt(i.message+"",!0)+"</pre>";return t?Promise.resolve(r):r}if(t)return Promise.reject(i);throw i}};const _i=new xx;function Ie(n,e){return _i.parse(n,e)}Ie.options=Ie.setOptions=function(n){return _i.setOptions(n),Ie.defaults=_i.defaults,wy(Ie.defaults),Ie};Ie.getDefaults=Xc;Ie.defaults=Ei;Ie.use=function(...n){return _i.use(...n),Ie.defaults=_i.defaults,wy(Ie.defaults),Ie};Ie.walkTokens=function(n,e){return _i.walkTokens(n,e)};Ie.parseInline=_i.parseInline;Ie.Parser=en;Ie.parser=en.parse;Ie.Renderer=Ua;Ie.TextRenderer=of;Ie.Lexer=Zt;Ie.lexer=Zt.lex;Ie.Tokenizer=Ia;Ie.Hooks=Jo;Ie.parse=Ie;Ie.options;Ie.setOptions;Ie.use;Ie.walkTokens;Ie.parseInline;en.parse;Zt.lex;const _x=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 11.667 0l3.181-3.183m-4.991-2.691v4.992m0 0h-4.992m4.992 0-3.181-3.183a8.25 8.25 0 0 0-11.667 0L2.985 16.652"})}),Cx=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"})}),Ex=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"})}),Ax=({calibratedConfidence:n,className:e=""})=>{const[t,i]=ee.useState(!1),{overallScore:r,factors:a,interval:u,breakdown:h,historicalContext:m,riskAdjustments:p}=n,y=C=>C>=80?"text-green-600 dark:text-green-400":C>=60?"text-yellow-600 dark:text-yellow-400":C>=40?"text-orange-600 dark:text-orange-400":"text-red-600 dark:text-red-400",T=C=>{switch(C){case"VERY_HIGH":return"text-green-600 dark:text-green-400";case"HIGH":return"text-blue-600 dark:text-blue-400";case"MEDIUM":return"text-yellow-600 dark:text-yellow-400";case"LOW":return"text-red-600 dark:text-red-400";default:return"text-gray-600 dark:text-gray-400"}},x=C=>`${Math.round(C)}%`;return S.jsxs("div",{className:`bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 ${e}`,children:[S.jsxs("div",{className:"flex items-center justify-between mb-3",children:[S.jsxs("div",{className:"flex items-center space-x-3",children:[S.jsxs("div",{className:"flex items-center space-x-2",children:[S.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Confidence:"}),S.jsxs("span",{className:`text-lg font-bold ${y(r)}`,children:[r,"%"]})]}),S.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600 dark:text-gray-400",children:[S.jsxs("span",{children:["",u.uncertainty,"%"]}),S.jsxs("span",{className:`font-medium ${T(u.reliability)}`,children:["(",u.reliability.toLowerCase()," reliability)"]})]})]}),S.jsx("button",{onClick:()=>i(!t),className:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium",children:t?"Hide Details":"Show Details"})]}),S.jsxs("div",{className:"mb-3",children:[S.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400 mb-1",children:[S.jsxs("span",{children:[u.lowerBound,"%"]}),S.jsxs("span",{children:["Range: ",u.lowerBound,"% - ",u.upperBound,"%"]}),S.jsxs("span",{children:[u.upperBound,"%"]})]}),S.jsxs("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 relative",children:[S.jsx("div",{className:"absolute h-2 bg-blue-200 dark:bg-blue-800 rounded-full",style:{left:`${u.lowerBound}%`,width:`${u.upperBound-u.lowerBound}%`}}),S.jsx("div",{className:`absolute h-2 w-1 ${y(r).replace("text-","bg-")} rounded-full`,style:{left:`${r}%`}})]})]}),t&&S.jsxs("div",{className:"space-y-4 border-t border-gray-200 dark:border-gray-700 pt-4",children:[S.jsxs("div",{children:[S.jsx("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Confidence Factors"}),S.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[S.jsxs("div",{className:"space-y-2",children:[S.jsxs("div",{className:"flex justify-between",children:[S.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Technical Confluence:"}),S.jsx("span",{className:y(a.technicalConfluence),children:x(a.technicalConfluence)})]}),S.jsxs("div",{className:"flex justify-between",children:[S.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Historical Patterns:"}),S.jsx("span",{className:y(a.historicalPatternSuccess),children:x(a.historicalPatternSuccess)})]}),S.jsxs("div",{className:"flex justify-between",children:[S.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Market Conditions:"}),S.jsx("span",{className:y(a.marketConditions),children:x(a.marketConditions)})]})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsxs("div",{className:"flex justify-between",children:[S.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Volatility Adjustment:"}),S.jsx("span",{className:y(a.volatilityAdjustment),children:x(a.volatilityAdjustment)})]}),S.jsxs("div",{className:"flex justify-between",children:[S.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Volume Confirmation:"}),S.jsx("span",{className:y(a.volumeConfirmation),children:x(a.volumeConfirmation)})]}),S.jsxs("div",{className:"flex justify-between",children:[S.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Structural Integrity:"}),S.jsx("span",{className:y(a.structuralIntegrity),children:x(a.structuralIntegrity)})]})]})]})]}),S.jsxs("div",{children:[S.jsx("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Quality Metrics"}),S.jsxs("div",{className:"grid grid-cols-3 gap-3 text-sm",children:[S.jsxs("div",{className:"text-center",children:[S.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Data Quality"}),S.jsx("div",{className:y(h.qualityMetrics.dataQuality),children:x(h.qualityMetrics.dataQuality)})]}),S.jsxs("div",{className:"text-center",children:[S.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Signal Clarity"}),S.jsx("div",{className:y(h.qualityMetrics.signalClarity),children:x(h.qualityMetrics.signalClarity)})]}),S.jsxs("div",{className:"text-center",children:[S.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Market Noise"}),S.jsx("div",{className:y(100-h.qualityMetrics.marketNoise),children:x(h.qualityMetrics.marketNoise)})]})]})]}),S.jsxs("div",{children:[S.jsx("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Historical Context"}),S.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded p-3 text-sm",children:S.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[S.jsxs("div",{children:[S.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Similar Patterns"}),S.jsx("div",{className:"font-medium",children:m.similarPatternCount})]}),S.jsxs("div",{children:[S.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Success Rate"}),S.jsx("div",{className:`font-medium ${y(m.successRate)}`,children:x(m.successRate)})]}),S.jsxs("div",{children:[S.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Avg Win"}),S.jsxs("div",{className:"font-medium text-green-600 dark:text-green-400",children:["+",m.avgReturnOnSuccess,"%"]})]}),S.jsxs("div",{children:[S.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Avg Loss"}),S.jsxs("div",{className:"font-medium text-red-600 dark:text-red-400",children:[m.avgLossOnFailure,"%"]})]})]})})]}),(p.volatilityPenalty>0||p.liquidityDiscount>0||p.newsRisk>0)&&S.jsxs("div",{children:[S.jsx("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Risk Adjustments"}),S.jsxs("div",{className:"space-y-1 text-sm",children:[p.volatilityPenalty>0&&S.jsxs("div",{className:"flex justify-between text-red-600 dark:text-red-400",children:[S.jsx("span",{children:"Volatility Penalty:"}),S.jsxs("span",{children:["-",p.volatilityPenalty,"%"]})]}),p.liquidityDiscount>0&&S.jsxs("div",{className:"flex justify-between text-orange-600 dark:text-orange-400",children:[S.jsx("span",{children:"Liquidity Discount:"}),S.jsxs("span",{children:["-",p.liquidityDiscount,"%"]})]}),p.newsRisk>0&&S.jsxs("div",{className:"flex justify-between text-yellow-600 dark:text-yellow-400",children:[S.jsx("span",{children:"News Risk:"}),S.jsxs("span",{children:["-",p.newsRisk,"%"]})]})]})]}),S.jsxs("div",{children:[S.jsx("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Factor Contributions to Final Score"}),S.jsx("div",{className:"space-y-1 text-xs",children:Object.entries(h.factorContributions).map(([C,A])=>S.jsxs("div",{className:"flex justify-between",children:[S.jsxs("span",{className:"text-gray-600 dark:text-gray-400 capitalize",children:[C.replace(/([A-Z])/g," $1").toLowerCase(),":"]}),S.jsxs("span",{className:y(A),children:["+",A]})]},C))})]})]})]})},wx=()=>S.jsx("div",{className:"w-8 h-8 rounded-full bg-accent-blue flex items-center justify-center font-bold text-white flex-shrink-0",children:"U"}),bx=()=>S.jsx("div",{className:"w-8 h-8 rounded-full bg-sidebar-bg border border-border-color flex items-center justify-center flex-shrink-0",children:S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5 text-accent-blue",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456Z"})})}),Ap=({content:n})=>{const e=Ie.parse(n,{gfm:!0,breaks:!0});return S.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:e}})},Rx=({result:n})=>{const[e,t]=ee.useState(!1),i=n.signal==="BUY"?"text-accent-green":n.signal==="SELL"?"text-accent-red":"text-accent-yellow",r=n.signal==="BUY"?"bg-accent-green-10":n.signal==="SELL"?"bg-accent-red-10":"bg-accent-yellow-10",a=()=>{let u=`Wizz AI Analysis
---
`;if(u+=`Summary: ${n.summary}
`,u+=`Signal: ${n.signal} (${n.confidence} Confidence)
`,n.trade&&n.confidence==="HIGH"&&(u+=`Entry Price: ${n.trade.entryPrice}
`,u+=`Take Profit: ${n.trade.takeProfit}
`,u+=`Stop Loss: ${n.trade.stopLoss}
`),n.riskRewardRatio&&(u+=`Risk/Reward Ratio: ${n.riskRewardRatio}
`),n.calibratedConfidence){const h=n.calibratedConfidence;u+=`Enhanced Confidence: ${h.overallScore}% ${h.interval.uncertainty}% (${h.interval.reliability.toLowerCase()} reliability)
`,u+=`Factors - Technical: ${h.factors.technicalConfluence}%, Historical: ${h.factors.historicalPatternSuccess}%, Market: ${h.factors.marketConditions}%`}else u+=`AI Confidence Score: ${n.overallConfidenceScore}/100`;navigator.clipboard.writeText(u).then(()=>{t(!0),setTimeout(()=>t(!1),2e3)})};return S.jsxs("div",{className:"border border-border-color rounded-lg space-y-4 bg-sidebar-bg relative",children:[S.jsx("div",{className:"absolute top-2 right-2",children:S.jsx("button",{onClick:a,className:"p-1.5 rounded-md text-text-secondary hover:bg-input-bg hover:text-text-primary transition-colors","aria-label":"Copy analysis to clipboard",children:e?S.jsx(Ex,{className:"h-4 w-4 text-accent-green"}):S.jsx(Cx,{className:"h-4 w-4"})})}),S.jsxs("div",{className:"p-4 space-y-4",children:[S.jsxs("div",{children:[S.jsx("h3",{className:"font-semibold text-text-primary mb-1",children:"Summary"}),S.jsx("p",{className:"text-sm text-text-secondary",children:n.summary})]}),S.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[S.jsxs("div",{className:`p-3 rounded-lg ${r}`,children:[S.jsx("h4",{className:"text-xs font-semibold text-text-secondary mb-1",children:"Signal"}),S.jsx("p",{className:`text-lg font-bold ${i}`,children:n.signal})]}),S.jsxs("div",{className:"p-3 rounded-lg bg-input-bg-50",children:[S.jsx("h4",{className:"text-xs font-semibold text-text-secondary mb-1",children:"Confidence"}),S.jsx("p",{className:`text-lg font-bold ${n.confidence==="HIGH"?"text-text-primary":"text-text-secondary"}`,children:n.confidence})]})]}),n.timeframe&&S.jsxs("div",{children:[S.jsx("h3",{className:"font-semibold text-text-primary mb-2",children:"Analysis Context"}),S.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[S.jsxs("div",{className:"bg-input-bg-50 p-2 rounded-md",children:[S.jsx("span",{className:"text-text-secondary block text-xs",children:"Chart Timeframe"}),S.jsx("span",{className:"font-mono text-text-primary",children:n.timeframe})]}),n.riskRewardRatio&&S.jsxs("div",{className:"bg-input-bg-50 p-2 rounded-md",children:[S.jsx("span",{className:"text-text-secondary block text-xs",children:"Risk/Reward Ratio"}),S.jsx("span",{className:"font-mono text-text-primary",children:n.riskRewardRatio})]})]})]}),n.trade&&n.confidence==="HIGH"&&S.jsxs("div",{children:[S.jsx("h3",{className:"font-semibold text-text-primary mb-2",children:"Trade Details"}),S.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm",children:[S.jsxs("div",{className:"bg-input-bg-50 p-2 rounded-md",children:[S.jsx("span",{className:"text-text-secondary block text-xs",children:"Entry Price"}),S.jsx("span",{className:"font-mono text-text-primary",children:n.trade.entryPrice})]}),S.jsxs("div",{className:"bg-input-bg-50 p-2 rounded-md",children:[S.jsx("span",{className:"text-text-secondary block text-xs",children:"Take Profit"}),S.jsx("span",{className:"font-mono text-accent-green",children:n.trade.takeProfit})]}),S.jsxs("div",{className:"bg-input-bg-50 p-2 rounded-md",children:[S.jsx("span",{className:"text-text-secondary block text-xs",children:"Stop Loss"}),S.jsx("span",{className:"font-mono text-accent-red",children:n.trade.stopLoss})]})]})]}),n.confidence==="LOW"&&S.jsx("p",{className:"text-xs text-center text-text-secondary italic",children:"No trade signal provided due to low confidence."}),n.isMultiTimeframeAnalysis&&n.multiTimeframeContext&&S.jsxs("div",{children:[S.jsx("h3",{className:"font-semibold text-text-primary mb-2",children:"Multi-Timeframe Confluence"}),S.jsxs("div",{className:"bg-input-bg-50 p-3 rounded-lg space-y-3",children:[S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsx("span",{className:"text-sm font-medium text-text-secondary",children:"Confluence Score"}),S.jsxs("span",{className:"text-lg font-bold text-text-primary",children:[n.multiTimeframeContext.confluenceScore,"/100"]})]}),S.jsx("div",{className:"w-full bg-border-color rounded-full h-2.5",children:S.jsx("div",{className:"bg-accent-green h-2.5 rounded-full",style:{width:`${n.multiTimeframeContext.confluenceScore}%`}})}),S.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[S.jsxs("div",{children:[S.jsx("span",{className:"text-text-secondary",children:"Overall Trend:"}),S.jsx("span",{className:`ml-1 font-medium ${n.multiTimeframeContext.overallTrend==="BULLISH"?"text-accent-green":n.multiTimeframeContext.overallTrend==="BEARISH"?"text-accent-red":n.multiTimeframeContext.overallTrend==="MIXED"?"text-accent-yellow":"text-text-secondary"}`,children:n.multiTimeframeContext.overallTrend})]}),S.jsxs("div",{children:[S.jsx("span",{className:"text-text-secondary",children:"Primary TF:"}),S.jsx("span",{className:"ml-1 font-medium text-text-primary",children:n.multiTimeframeContext.primaryTimeframe})]})]}),S.jsxs("div",{className:"border-t border-border-color pt-2",children:[S.jsx("div",{className:"text-xs font-medium text-text-secondary mb-2",children:"Timeframe Analysis:"}),S.jsx("div",{className:"space-y-1",children:n.multiTimeframeContext.timeframeAnalyses.map((u,h)=>S.jsxs("div",{className:"flex justify-between items-center text-xs",children:[S.jsx("span",{className:"font-medium",children:u.timeframe}),S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs ${u.trend==="BULLISH"?"bg-accent-green-10 text-accent-green":u.trend==="BEARISH"?"bg-accent-red-10 text-accent-red":u.trend==="CONSOLIDATING"?"bg-accent-yellow-10 text-accent-yellow":"bg-input-bg text-text-secondary"}`,children:u.trend}),S.jsxs("span",{className:"text-text-secondary",children:[u.confidence,"%"]})]})]},h))})]}),n.multiTimeframeContext.conflictingSignals&&n.multiTimeframeContext.conflictingSignals.length>0&&S.jsxs("div",{className:"border-t border-border-color pt-2",children:[S.jsx("div",{className:"text-xs font-medium text-accent-red mb-1",children:"Conflicting Signals:"}),S.jsx("ul",{className:"text-xs text-text-secondary space-y-0.5",children:n.multiTimeframeContext.conflictingSignals.map((u,h)=>S.jsxs("li",{className:"flex items-start",children:[S.jsx("span",{className:"text-accent-red mr-1",children:""}),u]},h))})]})]})]}),n.hasSMCAnalysis&&n.smcAnalysis&&S.jsxs("div",{children:[S.jsx("h3",{className:"font-semibold text-text-primary mb-2",children:"Smart Money Concepts Analysis"}),S.jsxs("div",{className:"bg-input-bg-50 p-3 rounded-lg space-y-3",children:[S.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[S.jsxs("div",{children:[S.jsx("span",{className:"text-sm font-medium text-text-secondary",children:"Market Structure:"}),S.jsx("span",{className:`ml-2 px-2 py-1 rounded text-xs font-medium ${n.smcAnalysis.overallStructure==="BULLISH_STRUCTURE"?"bg-accent-green-10 text-accent-green":n.smcAnalysis.overallStructure==="BEARISH_STRUCTURE"?"bg-accent-red-10 text-accent-red":n.smcAnalysis.overallStructure==="RANGING"?"bg-accent-yellow-10 text-accent-yellow":"bg-input-bg text-text-secondary"}`,children:n.smcAnalysis.overallStructure.replace("_"," ")})]}),S.jsxs("div",{children:[S.jsx("span",{className:"text-sm font-medium text-text-secondary",children:"Market Phase:"}),S.jsx("span",{className:"ml-2 text-sm font-medium text-text-primary",children:n.smcAnalysis.marketPhase})]})]}),S.jsxs("div",{className:"border-t border-border-color pt-3",children:[S.jsxs("div",{className:"flex justify-between items-center mb-2",children:[S.jsx("span",{className:"text-sm font-medium text-text-secondary",children:"Trading Bias"}),S.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${n.smcAnalysis.tradingBias.direction==="BULLISH"?"bg-accent-green-10 text-accent-green":n.smcAnalysis.tradingBias.direction==="BEARISH"?"bg-accent-red-10 text-accent-red":"bg-input-bg text-text-secondary"}`,children:n.smcAnalysis.tradingBias.direction})]}),S.jsxs("div",{className:"flex justify-between items-center mb-1",children:[S.jsx("span",{className:"text-xs text-text-secondary",children:"SMC Confidence:"}),S.jsxs("span",{className:"text-sm font-medium",children:[n.smcAnalysis.tradingBias.confidence,"%"]})]}),S.jsx("div",{className:"w-full bg-border-color rounded-full h-2",children:S.jsx("div",{className:"bg-accent-purple h-2 rounded-full",style:{width:`${n.smcAnalysis.tradingBias.confidence}%`}})}),S.jsx("p",{className:"text-xs text-text-secondary mt-2",children:n.smcAnalysis.tradingBias.reasoning})]}),n.smcAnalysis.criticalLevels.orderBlocks&&n.smcAnalysis.criticalLevels.orderBlocks.length>0&&S.jsxs("div",{className:"border-t border-border-color pt-3",children:[S.jsx("div",{className:"text-sm font-medium text-text-secondary mb-2",children:"Order Blocks"}),S.jsx("div",{className:"space-y-2",children:n.smcAnalysis.criticalLevels.orderBlocks.map((u,h)=>S.jsxs("div",{className:"flex justify-between items-center text-xs bg-input-bg p-2 rounded",children:[S.jsxs("div",{className:"flex items-center space-x-2",children:[S.jsx("span",{className:`px-1.5 py-0.5 rounded ${u.type==="BULLISH_OB"?"bg-accent-green-10 text-accent-green":"bg-accent-red-10 text-accent-red"}`,children:u.type==="BULLISH_OB"?"Bull OB":"Bear OB"}),S.jsx("span",{className:"font-mono text-text-primary",children:u.price})]}),S.jsxs("div",{className:"flex items-center space-x-2",children:[S.jsx("span",{className:`text-xs ${u.mitigated?"text-accent-red":"text-accent-green"}`,children:u.mitigated?"Mitigated":"Active"}),S.jsx("span",{className:"text-text-secondary",children:u.strength})]})]},h))})]}),n.smcAnalysis.criticalLevels.fairValueGaps&&n.smcAnalysis.criticalLevels.fairValueGaps.length>0&&S.jsxs("div",{className:"border-t border-border-color pt-3",children:[S.jsx("div",{className:"text-sm font-medium text-text-secondary mb-2",children:"Fair Value Gaps"}),S.jsx("div",{className:"space-y-2",children:n.smcAnalysis.criticalLevels.fairValueGaps.map((u,h)=>S.jsxs("div",{className:"flex justify-between items-center text-xs bg-input-bg p-2 rounded",children:[S.jsxs("div",{className:"flex items-center space-x-2",children:[S.jsx("span",{className:`px-1.5 py-0.5 rounded ${u.type==="BULLISH_FVG"?"bg-accent-green-10 text-accent-green":"bg-accent-red-10 text-accent-red"}`,children:u.type==="BULLISH_FVG"?"Bull FVG":"Bear FVG"}),S.jsx("span",{className:"font-mono text-text-primary",children:u.priceRange})]}),S.jsxs("div",{className:"flex items-center space-x-2",children:[S.jsx("span",{className:`text-xs ${u.filled?"text-accent-red":"text-accent-green"}`,children:u.filled?"Filled":"Open"}),S.jsx("span",{className:"text-text-secondary",children:u.significance})]})]},h))})]}),n.smcAnalysis.criticalLevels.liquidityLevels&&n.smcAnalysis.criticalLevels.liquidityLevels.length>0&&S.jsxs("div",{className:"border-t border-border-color pt-3",children:[S.jsx("div",{className:"text-sm font-medium text-text-secondary mb-2",children:"Liquidity Levels"}),S.jsx("div",{className:"space-y-2",children:n.smcAnalysis.criticalLevels.liquidityLevels.map((u,h)=>S.jsxs("div",{className:"flex justify-between items-center text-xs bg-input-bg p-2 rounded",children:[S.jsxs("div",{className:"flex items-center space-x-2",children:[S.jsx("span",{className:`px-1.5 py-0.5 rounded ${u.type==="BUY_SIDE_LIQUIDITY"?"bg-accent-green-10 text-accent-green":u.type==="SELL_SIDE_LIQUIDITY"?"bg-accent-red-10 text-accent-red":"bg-accent-yellow-10 text-accent-yellow"}`,children:u.type==="BUY_SIDE_LIQUIDITY"?"BSL":u.type==="SELL_SIDE_LIQUIDITY"?"SSL":"Both"}),S.jsx("span",{className:"font-mono text-text-primary",children:u.price})]}),S.jsxs("div",{className:"flex items-center space-x-2",children:[S.jsx("span",{className:`text-xs ${u.swept?"text-accent-red":"text-accent-green"}`,children:u.swept?"Swept":"Active"}),S.jsx("span",{className:"text-text-secondary",children:u.significance})]})]},h))})]}),n.smcAnalysis.displacement.detected&&S.jsxs("div",{className:"border-t border-border-color pt-3",children:[S.jsx("div",{className:"text-sm font-medium text-text-secondary mb-2",children:"Displacement Detected"}),S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsxs("span",{className:`px-2 py-1 rounded text-xs font-medium ${n.smcAnalysis.displacement.direction==="BULLISH"?"bg-accent-green-10 text-accent-green":"bg-accent-red-10 text-accent-red"}`,children:[n.smcAnalysis.displacement.direction," Displacement"]}),S.jsxs("span",{className:"text-sm font-medium text-text-primary",children:[n.smcAnalysis.displacement.strength," Strength"]})]})]})]})]}),S.jsxs("div",{children:[S.jsx("h3",{className:"font-semibold text-text-primary mb-2",children:n.isMultiTimeframeAnalysis?"Final Verification":"Verification"}),n.calibratedConfidence?S.jsx(Ax,{calibratedConfidence:n.calibratedConfidence,className:"mb-3"}):S.jsxs("div",{className:"bg-input-bg-50 p-3 rounded-lg space-y-2 mb-3",children:[S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsx("span",{className:"text-sm font-medium text-text-secondary",children:"AI Confidence Score"}),S.jsxs("span",{className:"text-lg font-bold text-text-primary",children:[n.overallConfidenceScore,"/100"]})]}),S.jsx("div",{className:"w-full bg-border-color rounded-full h-2.5",children:S.jsx("div",{className:"bg-accent-blue h-2.5 rounded-full",style:{width:`${n.overallConfidenceScore}%`}})})]}),S.jsx("div",{className:"bg-input-bg-50 p-3 rounded-lg",children:S.jsx("p",{className:"text-xs text-text-secondary",children:n.verificationSummary})})]})]})]})},Mx=ws.memo(({message:n,isLastMessage:e,isLoading:t,onRegenerate:i})=>{const r=n.role==="user",{content:a,thinkingText:u}=n;if(r){const m=[];Array.isArray(n.images)&&n.images.length>0?m.push(...n.images):n.image&&m.push(n.image);const p=n.timeframeImages,y=p&&p.length>0;return S.jsxs("div",{className:"flex items-start gap-4 justify-end",children:[S.jsxs("div",{className:"flex-1 max-w-2xl bg-accent-blue rounded-lg p-3 text-white",children:[typeof a=="string"&&a&&S.jsx("p",{className:"whitespace-pre-wrap",children:a}),m.length>0&&!y&&S.jsx("div",{className:"mt-2 grid grid-cols-2 md:grid-cols-3 gap-2",children:m.map((T,x)=>S.jsx("img",{src:T,alt:`User upload ${x+1}`,className:"max-w-xs max-h-64 rounded-md border border-blue-400"},x))}),y&&S.jsxs("div",{className:"mt-2 space-y-2",children:[S.jsx("div",{className:"text-xs font-medium opacity-90",children:"Multi-Timeframe Analysis:"}),S.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:p.map((T,x)=>S.jsxs("div",{className:"bg-white bg-opacity-10 rounded-lg p-2",children:[S.jsxs("div",{className:"text-xs font-medium mb-1",children:[T.timeframe," ",T.label&&`- ${T.label}`]}),S.jsx("img",{src:`data:${T.imageData.mimeType};base64,${T.imageData.data}`,alt:`${T.timeframe} chart`,className:"w-full max-h-48 object-cover rounded border border-blue-400"})]},x))})]})]}),S.jsx(wx,{})]})}const h=typeof a=="string"&&(a.startsWith("Error:")||a.startsWith("Sorry, I encountered an error")||a==="Response stopped by user."||a==="An unexpected error occurred. Please try again.");return S.jsxs("div",{className:"flex items-start gap-4",children:[S.jsx(bx,{}),S.jsxs("div",{className:"flex-1 max-w-2xl space-y-4",children:[t&&S.jsxs("div",{className:"flex items-center gap-2 text-text-secondary",children:[S.jsx("div",{className:"h-5 w-5 border-2 border-t-transparent border-accent-blue rounded-full animate-spin"}),S.jsx("span",{children:"Wizz is analyzing..."})]}),u&&S.jsx(Ap,{content:u}),typeof a=="object"&&S.jsx(Rx,{result:a}),typeof a=="string"&&a&&(h?S.jsx("p",{className:"text-text-secondary italic",children:a}):S.jsx(Ap,{content:a})),e&&n.role==="assistant"&&!t&&n.content&&S.jsx("div",{className:"!mt-2 flex justify-start",children:S.jsxs("button",{onClick:i,className:"flex items-center gap-1.5 text-xs text-text-secondary hover:text-text-primary px-2 py-1 rounded-md hover:bg-input-bg transition-colors","aria-label":"Regenerate response",children:[S.jsx(_x,{className:"h-4 w-4"}),S.jsx("span",{children:"Regenerate"})]})})]})]})}),Nx=({regimeContext:n,className:e=""})=>{if(!n)return S.jsx("div",{className:`bg-gray-800/50 border border-gray-700 rounded-lg p-4 ${e}`,children:S.jsxs("div",{className:"flex items-center space-x-2",children:[S.jsx("div",{className:"w-3 h-3 bg-gray-500 rounded-full animate-pulse"}),S.jsx("span",{className:"text-gray-400 text-sm",children:"Market regime analysis unavailable"})]})});const t=h=>h.includes("BULL")?"text-green-400":h.includes("BEAR")?"text-red-400":h.includes("NEUTRAL")?"text-yellow-400":h.includes("TRANSITIONAL")?"text-purple-400":"text-gray-400",i=h=>h.includes("BULL_TRENDING")?"":h.includes("BEAR_TRENDING")?"":h.includes("BULL_RANGING")?"":h.includes("BEAR_RANGING")?"":h.includes("NEUTRAL_TRENDING")?"":h.includes("NEUTRAL_RANGING")?"":h.includes("TRANSITIONAL")?"":"",r=h=>{switch(h){case"LOW":return"text-blue-400";case"NORMAL":return"text-green-400";case"HIGH":return"text-orange-400";case"EXTREME":return"text-red-400";default:return"text-gray-400"}},a=h=>h>=80?"text-green-400":h>=60?"text-yellow-400":h>=40?"text-orange-400":"text-red-400",u=h=>h>=80?"text-green-400":h>=60?"text-yellow-400":h>=40?"text-orange-400":"text-red-400";return S.jsxs("div",{className:`bg-gray-800/50 border border-gray-700 rounded-lg p-4 space-y-4 ${e}`,children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{className:"flex items-center space-x-2",children:[S.jsx("span",{className:"text-lg",children:i(n.overallRegime)}),S.jsx("h3",{className:"text-lg font-semibold text-white",children:"Market Regime"})]}),S.jsx("div",{className:"flex items-center space-x-4",children:S.jsxs("div",{className:"text-right",children:[S.jsxs("div",{className:`text-sm font-medium ${a(n.confidence)}`,children:[n.confidence,"% Confidence"]}),S.jsxs("div",{className:`text-xs ${u(n.stability)}`,children:[n.stability,"% Stable"]})]})})]}),S.jsx("div",{className:"bg-gray-900/50 rounded-lg p-3",children:S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsx("span",{className:"text-gray-400 text-sm",children:"Overall Regime"}),S.jsx("span",{className:`font-semibold ${t(n.overallRegime)}`,children:n.overallRegime.replace(/_/g," ")})]})}),S.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[S.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-3",children:[S.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Trend"}),S.jsx("div",{className:`text-sm font-medium ${t(n.trendRegime)}`,children:n.trendRegime.replace(/_/g," ")}),S.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["ADX: ",n.trendMetrics.adx.toFixed(1)]})]}),S.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-3",children:[S.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Direction"}),S.jsx("div",{className:`text-sm font-medium ${n.directionRegime==="TRENDING"?"text-blue-400":n.directionRegime==="RANGING"?"text-orange-400":"text-purple-400"}`,children:n.directionRegime}),S.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Efficiency: ",n.rangingMetrics.efficiency.toFixed(0),"%"]})]}),S.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-3",children:[S.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Volatility"}),S.jsx("div",{className:`text-sm font-medium ${r(n.volatilityRegime)}`,children:n.volatilityRegime}),S.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["ATR: ",n.volatilityMetrics.atrNormalized.toFixed(2),"%"]})]}),S.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-3",children:[S.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Momentum"}),S.jsx("div",{className:`text-sm font-medium ${n.momentumRegime==="ACCELERATING"?"text-green-400":n.momentumRegime==="DECELERATING"?"text-red-400":n.momentumRegime==="STABLE"?"text-blue-400":"text-yellow-400"}`,children:n.momentumRegime}),S.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["RSI: ",n.momentumMetrics.rsi.toFixed(0)]})]})]}),S.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-3",children:[S.jsx("div",{className:"text-sm font-medium text-white mb-2",children:"Analysis Adjustments"}),S.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[S.jsxs("div",{className:"flex justify-between",children:[S.jsx("span",{className:"text-gray-400",children:"Risk Multiplier:"}),S.jsxs("span",{className:`font-medium ${n.analysisAdjustments.riskMultiplier>1?"text-green-400":n.analysisAdjustments.riskMultiplier<1?"text-red-400":"text-gray-300"}`,children:[n.analysisAdjustments.riskMultiplier.toFixed(2),"x"]})]}),S.jsxs("div",{className:"flex justify-between",children:[S.jsx("span",{className:"text-gray-400",children:"Stop Adjustment:"}),S.jsxs("span",{className:`font-medium ${n.analysisAdjustments.stopLossAdjustment>1?"text-red-400":"text-green-400"}`,children:[n.analysisAdjustments.stopLossAdjustment.toFixed(2),"x"]})]}),S.jsxs("div",{className:"flex justify-between",children:[S.jsx("span",{className:"text-gray-400",children:"Target Adjustment:"}),S.jsxs("span",{className:`font-medium ${n.analysisAdjustments.takeProfitAdjustment>1?"text-green-400":"text-red-400"}`,children:[n.analysisAdjustments.takeProfitAdjustment.toFixed(2),"x"]})]}),S.jsxs("div",{className:"flex justify-between",children:[S.jsx("span",{className:"text-gray-400",children:"Entry Approach:"}),S.jsx("span",{className:`font-medium ${n.analysisAdjustments.entryApproach==="AGGRESSIVE"?"text-red-400":n.analysisAdjustments.entryApproach==="CONSERVATIVE"?"text-blue-400":n.analysisAdjustments.entryApproach==="PATIENT"?"text-green-400":"text-purple-400"}`,children:n.analysisAdjustments.entryApproach})]})]})]}),(n.warnings.length>0||n.opportunities.length>0)&&S.jsxs("div",{className:"space-y-2",children:[n.warnings.length>0&&S.jsxs("div",{className:"bg-red-900/20 border border-red-700/50 rounded-lg p-3",children:[S.jsx("div",{className:"text-sm font-medium text-red-400 mb-1",children:" Warnings"}),S.jsx("ul",{className:"text-xs text-red-300 space-y-1",children:n.warnings.map((h,m)=>S.jsxs("li",{className:"flex items-start space-x-2",children:[S.jsx("span",{className:"text-red-500 mt-0.5",children:""}),S.jsx("span",{children:h})]},m))})]}),n.opportunities.length>0&&S.jsxs("div",{className:"bg-green-900/20 border border-green-700/50 rounded-lg p-3",children:[S.jsx("div",{className:"text-sm font-medium text-green-400 mb-1",children:" Opportunities"}),S.jsx("ul",{className:"text-xs text-green-300 space-y-1",children:n.opportunities.map((h,m)=>S.jsxs("li",{className:"flex items-start space-x-2",children:[S.jsx("span",{className:"text-green-500 mt-0.5",children:""}),S.jsx("span",{children:h})]},m))})]})]}),S.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-3",children:[S.jsx("div",{className:"text-sm font-medium text-white mb-2",children:"Historical Context"}),S.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[S.jsxs("div",{className:"flex justify-between",children:[S.jsx("span",{className:"text-gray-400",children:"Time in Regime:"}),S.jsxs("span",{className:"text-gray-300",children:[n.regimeHistory.timeInCurrentRegime.toFixed(1),"h"]})]}),S.jsxs("div",{className:"flex justify-between",children:[S.jsx("span",{className:"text-gray-400",children:"Recent Changes:"}),S.jsx("span",{className:`font-medium ${n.regimeHistory.recentRegimeChanges>3?"text-red-400":n.regimeHistory.recentRegimeChanges>1?"text-yellow-400":"text-green-400"}`,children:n.regimeHistory.recentRegimeChanges})]})]})]}),S.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[S.jsxs("span",{children:["Last Updated: ",new Date(n.timestamp).toLocaleTimeString()]}),S.jsxs("span",{children:["Next Review: ",new Date(n.nextReviewTime).toLocaleTimeString()]})]})]})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let kx,Ix;function Dx(){return{geminiUrl:kx,vertexUrl:Ix}}function Ux(n,e,t,i){var r,a;if(!(n!=null&&n.baseUrl)){const u=Dx();return e?(r=u.vertexUrl)!==null&&r!==void 0?r:t:(a=u.geminiUrl)!==null&&a!==void 0?a:i}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ai{}function ie(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(i,r)=>{if(Object.prototype.hasOwnProperty.call(e,r)){const a=e[r];return a!=null?String(a):""}else throw new Error(`Key '${r}' not found in valueMap.`)})}function f(n,e,t){for(let a=0;a<e.length-1;a++){const u=e[a];if(u.endsWith("[]")){const h=u.slice(0,-2);if(!(h in n))if(Array.isArray(t))n[h]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${u}`);if(Array.isArray(n[h])){const m=n[h];if(Array.isArray(t))for(let p=0;p<m.length;p++){const y=m[p];f(y,e.slice(a+1),t[p])}else for(const p of m)f(p,e.slice(a+1),t)}return}else if(u.endsWith("[0]")){const h=u.slice(0,-3);h in n||(n[h]=[{}]);const m=n[h];f(m[0],e.slice(a+1),t);return}(!n[u]||typeof n[u]!="object")&&(n[u]={}),n=n[u]}const i=e[e.length-1],r=n[i];if(r!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===r)return;if(typeof r=="object"&&typeof t=="object"&&r!==null&&t!==null)Object.assign(r,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else n[i]=t}function c(n,e){try{if(e.length===1&&e[0]==="_self")return n;for(let t=0;t<e.length;t++){if(typeof n!="object"||n===null)return;const i=e[t];if(i.endsWith("[]")){const r=i.slice(0,-2);if(r in n){const a=n[r];return Array.isArray(a)?a.map(u=>c(u,e.slice(t+1))):void 0}else return}else n=n[i]}return n}catch(t){if(t instanceof TypeError)return;throw t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wc(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var wp;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(wp||(wp={}));var bp;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(bp||(bp={}));var re;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(re||(re={}));var Rp;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(Rp||(Rp={}));var Mp;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(Mp||(Mp={}));var Np;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(Np||(Np={}));var kp;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(kp||(kp={}));var Ip;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(Ip||(Ip={}));var Dp;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Dp||(Dp={}));var Up;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Up||(Up={}));var Lp;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Lp||(Lp={}));var Pp;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(Pp||(Pp={}));var Hp;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(Hp||(Hp={}));var Op;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Op||(Op={}));var Bp;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY"})(Bp||(Bp={}));var Vp;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Vp||(Vp={}));var La;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(La||(La={}));var qp;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(qp||(qp={}));var bc;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(bc||(bc={}));var Gp;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Gp||(Gp={}));var zp;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(zp||(zp={}));var $p;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})($p||($p={}));var Fp;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(Fp||(Fp={}));var Yp;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE"})(Yp||(Yp={}));var Jp;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(Jp||(Jp={}));var jp;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(jp||(jp={}));var Kp;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(Kp||(Kp={}));var Wp;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Wp||(Wp={}));var Qp;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Qp||(Qp={}));var Xp;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Xp||(Xp={}));var Zp;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Zp||(Zp={}));var eg;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(eg||(eg={}));var tg;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(tg||(tg={}));var ng;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(ng||(ng={}));var ig;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(ig||(ig={}));var sg;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(sg||(sg={}));var og;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(og||(og={}));var rg;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(rg||(rg={}));var ag;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(ag||(ag={}));var lg;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(lg||(lg={}));var ug;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(ug||(ug={}));var cg;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(cg||(cg={}));var bs;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(bs||(bs={}));class Rc{constructor(e){const t={};for(const i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class Go{get text(){var e,t,i,r,a,u,h,m;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let p="",y=!1;const T=[];for(const x of(m=(h=(u=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||u===void 0?void 0:u.content)===null||h===void 0?void 0:h.parts)!==null&&m!==void 0?m:[]){for(const[C,A]of Object.entries(x))C!=="text"&&C!=="thought"&&(A!==null||A!==void 0)&&T.push(C);if(typeof x.text=="string"){if(typeof x.thought=="boolean"&&x.thought)continue;y=!0,p+=x.text}}return T.length>0&&console.warn(`there are non-text parts ${T} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),y?p:void 0}get data(){var e,t,i,r,a,u,h,m;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let p="";const y=[];for(const T of(m=(h=(u=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||u===void 0?void 0:u.content)===null||h===void 0?void 0:h.parts)!==null&&m!==void 0?m:[]){for(const[x,C]of Object.entries(T))x!=="inlineData"&&(C!==null||C!==void 0)&&y.push(x);T.inlineData&&typeof T.inlineData.data=="string"&&(p+=atob(T.inlineData.data))}return y.length>0&&console.warn(`there are non-data parts ${y} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),p.length>0?btoa(p):void 0}get functionCalls(){var e,t,i,r,a,u,h,m;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const p=(m=(h=(u=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||u===void 0?void 0:u.content)===null||h===void 0?void 0:h.parts)===null||m===void 0?void 0:m.filter(y=>y.functionCall).map(y=>y.functionCall).filter(y=>y!==void 0);if((p==null?void 0:p.length)!==0)return p}get executableCode(){var e,t,i,r,a,u,h,m,p;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const y=(m=(h=(u=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||u===void 0?void 0:u.content)===null||h===void 0?void 0:h.parts)===null||m===void 0?void 0:m.filter(T=>T.executableCode).map(T=>T.executableCode).filter(T=>T!==void 0);if((y==null?void 0:y.length)!==0)return(p=y==null?void 0:y[0])===null||p===void 0?void 0:p.code}get codeExecutionResult(){var e,t,i,r,a,u,h,m,p;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const y=(m=(h=(u=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||u===void 0?void 0:u.content)===null||h===void 0?void 0:h.parts)===null||m===void 0?void 0:m.filter(T=>T.codeExecutionResult).map(T=>T.codeExecutionResult).filter(T=>T!==void 0);if((y==null?void 0:y.length)!==0)return(p=y==null?void 0:y[0])===null||p===void 0?void 0:p.output}}class fg{}class dg{}class Lx{}class Px{}class Hx{}class hg{}class mg{}class pg{}class Ox{}class gg{}class yg{}class vg{}class Tg{}class Bx{}class Vx{}class qx{}class Sg{}class Gx{get text(){var e,t,i;let r="",a=!1;const u=[];for(const h of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[m,p]of Object.entries(h))m!=="text"&&m!=="thought"&&p!==null&&u.push(m);if(typeof h.text=="string"){if(typeof h.thought=="boolean"&&h.thought)continue;a=!0,r+=h.text}}return u.length>0&&console.warn(`there are non-text parts ${u} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),a?r:void 0}get data(){var e,t,i;let r="";const a=[];for(const u of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[h,m]of Object.entries(u))h!=="inlineData"&&m!==null&&a.push(h);u.inlineData&&typeof u.inlineData.data=="string"&&(r+=atob(u.inlineData.data))}return a.length>0&&console.warn(`there are non-data parts ${a} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),r.length>0?btoa(r):void 0}}class Pa{_fromAPIResponse({apiResponse:e,isVertexAI:t}){const i=new Pa;if(i.name=e.name,i.metadata=e.metadata,i.done=e.done,i.error=e.error,t){const r=e.response;if(r){const a=new gg,u=r.videos;a.generatedVideos=u==null?void 0:u.map(h=>({video:{uri:h.gcsUri,videoBytes:h.bytesBase64Encoded?wc(h.bytesBase64Encoded):void 0,mimeType:h.mimeType}})),a.raiMediaFilteredCount=r.raiMediaFilteredCount,a.raiMediaFilteredReasons=r.raiMediaFilteredReasons,i.response=a}}else{const r=e.response;if(r){const a=new gg,u=r.generateVideoResponse,h=u==null?void 0:u.generatedSamples;a.generatedVideos=h==null?void 0:h.map(m=>{const p=m.video;return{video:{uri:p==null?void 0:p.uri,videoBytes:p!=null&&p.encodedVideo?wc(p==null?void 0:p.encodedVideo):void 0,mimeType:m.encoding}}}),a.raiMediaFilteredCount=u==null?void 0:u.raiMediaFilteredCount,a.raiMediaFilteredReasons=u==null?void 0:u.raiMediaFilteredReasons,i.response=a}}return i}}class zx{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Me(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function Oy(n,e){const t=Me(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function By(n){return Array.isArray(n)?n.map(e=>Ha(e)):[Ha(n)]}function Ha(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function Vy(n){const e=Ha(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function qy(n){const e=Ha(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function xg(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function Gy(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>xg(e)):[xg(n)]}function Mc(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function _g(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function Cg(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function ht(n){if(n==null)throw new Error("ContentUnion is required");return Mc(n)?n:{role:"user",parts:Gy(n)}}function zy(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const i=ht(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){const t=ht(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>ht(t)):[ht(e)]}function qt(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(_g(n)||Cg(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[ht(n)]}const e=[],t=[],i=Mc(n[0]);for(const r of n){const a=Mc(r);if(a!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)e.push(r);else{if(_g(r)||Cg(r))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(r)}}return i||e.push({role:"user",parts:Gy(t)}),e}function $x(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(re).includes(t[0].toUpperCase())?t[0].toUpperCase():re.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of t)e.anyOf.push({type:Object.values(re).includes(i.toUpperCase())?i.toUpperCase():re.TYPE_UNSPECIFIED})}}function Ms(n){const e={},t=["items"],i=["anyOf"],r=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const a=n.anyOf;a!=null&&a.length==2&&(a[0].type==="null"?(e.nullable=!0,n=a[1]):a[1].type==="null"&&(e.nullable=!0,n=a[0])),n.type instanceof Array&&$x(n.type,e);for(const[u,h]of Object.entries(n))if(h!=null)if(u=="type"){if(h==="null")throw new Error("type: null can not be the only possible type for the field.");if(h instanceof Array)continue;e.type=Object.values(re).includes(h.toUpperCase())?h.toUpperCase():re.TYPE_UNSPECIFIED}else if(t.includes(u))e[u]=Ms(h);else if(i.includes(u)){const m=[];for(const p of h){if(p.type=="null"){e.nullable=!0;continue}m.push(Ms(p))}e[u]=m}else if(r.includes(u)){const m={};for(const[p,y]of Object.entries(h))m[p]=Ms(y);e[u]=m}else{if(u==="additionalProperties")continue;e[u]=h}return e}function rf(n){return Ms(n)}function af(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function lf(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function Ds(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Ms(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Ms(e.response));return n}function Us(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function Fx(n,e,t,i=1){const r=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:r?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:r?`${t}/${e}`:e}function xn(n,e){if(typeof e!="string")throw new Error("name must be a string");return Fx(n,e,"cachedContents")}function $y(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function wi(n){return wc(n)}function Yx(n){return n!=null&&typeof n=="object"&&"name"in n}function Jx(n){return n!=null&&typeof n=="object"&&"video"in n}function jx(n){return n!=null&&typeof n=="object"&&"uri"in n}function Fy(n){var e;let t;if(Yx(n)&&(t=n.name),!(jx(n)&&(t=n.uri,t===void 0))&&!(Jx(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const r=t.split("files/")[1].match(/[a-z0-9]+/);if(r===null)throw new Error(`Could not extract file name from URI ${t}`);t=r[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function Yy(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function Jy(n){for(const e of["models","tunedModels","publisherModels"])if(Kx(n,e))return n[e];return[]}function Kx(n,e){return n!==null&&typeof n=="object"&&e in n}function Wx(n,e={}){const t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function Qx(n,e={}){const t=[],i=new Set;for(const r of n){const a=r.name;if(i.has(a))throw new Error(`Duplicate function name ${a} found in MCP tools. Please ensure function names are unique.`);i.add(a);const u=Wx(r,e);u.functionDeclarations&&t.push(...u.functionDeclarations)}return{functionDeclarations:t}}function jy(n,e){if(typeof e!="string"&&!Array.isArray(e)){if(n&&n.isVertexAI()){if(e.gcsUri&&e.bigqueryUri)throw new Error("Only one of `gcsUri` or `bigqueryUri` can be set.");if(!e.gcsUri&&!e.bigqueryUri)throw new Error("One of `gcsUri` or `bigqueryUri` must be set.")}else{if(e.inlinedRequests&&e.fileName)throw new Error("Only one of `inlinedRequests` or `fileName` can be set.");if(!e.inlinedRequests&&!e.fileName)throw new Error("One of `inlinedRequests` or `fileName` must be set.")}return e}else{if(Array.isArray(e))return{inlinedRequests:e};if(typeof e=="string"){if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:[e]};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};if(e.startsWith("files/"))return{fileName:e}}}throw new Error(`Unsupported source: ${e}`)}function Xx(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function Ls(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function Ky(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Zx(n){const e={},t=c(n,["fps"]);t!=null&&f(e,["fps"],t);const i=c(n,["endOffset"]);i!=null&&f(e,["endOffset"],i);const r=c(n,["startOffset"]);return r!=null&&f(e,["startOffset"],r),e}function e_(n){const e={};if(c(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=c(n,["data"]);t!=null&&f(e,["data"],t);const i=c(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function t_(n){const e={};if(c(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=c(n,["fileUri"]);t!=null&&f(e,["fileUri"],t);const i=c(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function n_(n){const e={},t=c(n,["videoMetadata"]);t!=null&&f(e,["videoMetadata"],Zx(t));const i=c(n,["thought"]);i!=null&&f(e,["thought"],i);const r=c(n,["inlineData"]);r!=null&&f(e,["inlineData"],e_(r));const a=c(n,["fileData"]);a!=null&&f(e,["fileData"],t_(a));const u=c(n,["thoughtSignature"]);u!=null&&f(e,["thoughtSignature"],u);const h=c(n,["codeExecutionResult"]);h!=null&&f(e,["codeExecutionResult"],h);const m=c(n,["executableCode"]);m!=null&&f(e,["executableCode"],m);const p=c(n,["functionCall"]);p!=null&&f(e,["functionCall"],p);const y=c(n,["functionResponse"]);y!=null&&f(e,["functionResponse"],y);const T=c(n,["text"]);return T!=null&&f(e,["text"],T),e}function Wy(n){const e={},t=c(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>n_(a))),f(e,["parts"],r)}const i=c(n,["role"]);return i!=null&&f(e,["role"],i),e}function i_(n){const e={},t=c(n,["anyOf"]);t!=null&&f(e,["anyOf"],t);const i=c(n,["default"]);i!=null&&f(e,["default"],i);const r=c(n,["description"]);r!=null&&f(e,["description"],r);const a=c(n,["enum"]);a!=null&&f(e,["enum"],a);const u=c(n,["example"]);u!=null&&f(e,["example"],u);const h=c(n,["format"]);h!=null&&f(e,["format"],h);const m=c(n,["items"]);m!=null&&f(e,["items"],m);const p=c(n,["maxItems"]);p!=null&&f(e,["maxItems"],p);const y=c(n,["maxLength"]);y!=null&&f(e,["maxLength"],y);const T=c(n,["maxProperties"]);T!=null&&f(e,["maxProperties"],T);const x=c(n,["maximum"]);x!=null&&f(e,["maximum"],x);const C=c(n,["minItems"]);C!=null&&f(e,["minItems"],C);const A=c(n,["minLength"]);A!=null&&f(e,["minLength"],A);const R=c(n,["minProperties"]);R!=null&&f(e,["minProperties"],R);const k=c(n,["minimum"]);k!=null&&f(e,["minimum"],k);const B=c(n,["nullable"]);B!=null&&f(e,["nullable"],B);const F=c(n,["pattern"]);F!=null&&f(e,["pattern"],F);const N=c(n,["properties"]);N!=null&&f(e,["properties"],N);const q=c(n,["propertyOrdering"]);q!=null&&f(e,["propertyOrdering"],q);const O=c(n,["required"]);O!=null&&f(e,["required"],O);const K=c(n,["title"]);K!=null&&f(e,["title"],K);const Q=c(n,["type"]);return Q!=null&&f(e,["type"],Q),e}function s_(n){const e={};if(c(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=c(n,["category"]);t!=null&&f(e,["category"],t);const i=c(n,["threshold"]);return i!=null&&f(e,["threshold"],i),e}function o_(n){const e={},t=c(n,["behavior"]);t!=null&&f(e,["behavior"],t);const i=c(n,["description"]);i!=null&&f(e,["description"],i);const r=c(n,["name"]);r!=null&&f(e,["name"],r);const a=c(n,["parameters"]);a!=null&&f(e,["parameters"],a);const u=c(n,["parametersJsonSchema"]);u!=null&&f(e,["parametersJsonSchema"],u);const h=c(n,["response"]);h!=null&&f(e,["response"],h);const m=c(n,["responseJsonSchema"]);return m!=null&&f(e,["responseJsonSchema"],m),e}function r_(n){const e={},t=c(n,["startTime"]);t!=null&&f(e,["startTime"],t);const i=c(n,["endTime"]);return i!=null&&f(e,["endTime"],i),e}function a_(n){const e={},t=c(n,["timeRangeFilter"]);return t!=null&&f(e,["timeRangeFilter"],r_(t)),e}function l_(n){const e={},t=c(n,["mode"]);t!=null&&f(e,["mode"],t);const i=c(n,["dynamicThreshold"]);return i!=null&&f(e,["dynamicThreshold"],i),e}function u_(n){const e={},t=c(n,["dynamicRetrievalConfig"]);return t!=null&&f(e,["dynamicRetrievalConfig"],l_(t)),e}function c_(){return{}}function f_(n){const e={},t=c(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(p=>o_(p))),f(e,["functionDeclarations"],m)}if(c(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=c(n,["googleSearch"]);i!=null&&f(e,["googleSearch"],a_(i));const r=c(n,["googleSearchRetrieval"]);if(r!=null&&f(e,["googleSearchRetrieval"],u_(r)),c(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(c(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");c(n,["urlContext"])!=null&&f(e,["urlContext"],c_());const u=c(n,["codeExecution"]);u!=null&&f(e,["codeExecution"],u);const h=c(n,["computerUse"]);return h!=null&&f(e,["computerUse"],h),e}function d_(n){const e={},t=c(n,["mode"]);t!=null&&f(e,["mode"],t);const i=c(n,["allowedFunctionNames"]);return i!=null&&f(e,["allowedFunctionNames"],i),e}function h_(n){const e={},t=c(n,["latitude"]);t!=null&&f(e,["latitude"],t);const i=c(n,["longitude"]);return i!=null&&f(e,["longitude"],i),e}function m_(n){const e={},t=c(n,["latLng"]);t!=null&&f(e,["latLng"],h_(t));const i=c(n,["languageCode"]);return i!=null&&f(e,["languageCode"],i),e}function p_(n){const e={},t=c(n,["functionCallingConfig"]);t!=null&&f(e,["functionCallingConfig"],d_(t));const i=c(n,["retrievalConfig"]);return i!=null&&f(e,["retrievalConfig"],m_(i)),e}function g_(n){const e={},t=c(n,["voiceName"]);return t!=null&&f(e,["voiceName"],t),e}function Qy(n){const e={},t=c(n,["prebuiltVoiceConfig"]);return t!=null&&f(e,["prebuiltVoiceConfig"],g_(t)),e}function y_(n){const e={},t=c(n,["speaker"]);t!=null&&f(e,["speaker"],t);const i=c(n,["voiceConfig"]);return i!=null&&f(e,["voiceConfig"],Qy(i)),e}function v_(n){const e={},t=c(n,["speakerVoiceConfigs"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>y_(r))),f(e,["speakerVoiceConfigs"],i)}return e}function T_(n){const e={},t=c(n,["voiceConfig"]);t!=null&&f(e,["voiceConfig"],Qy(t));const i=c(n,["multiSpeakerVoiceConfig"]);i!=null&&f(e,["multiSpeakerVoiceConfig"],v_(i));const r=c(n,["languageCode"]);return r!=null&&f(e,["languageCode"],r),e}function S_(n){const e={},t=c(n,["includeThoughts"]);t!=null&&f(e,["includeThoughts"],t);const i=c(n,["thinkingBudget"]);return i!=null&&f(e,["thinkingBudget"],i),e}function x_(n,e,t){const i={},r=c(e,["systemInstruction"]);t!==void 0&&r!=null&&f(t,["systemInstruction"],Wy(ht(r)));const a=c(e,["temperature"]);a!=null&&f(i,["temperature"],a);const u=c(e,["topP"]);u!=null&&f(i,["topP"],u);const h=c(e,["topK"]);h!=null&&f(i,["topK"],h);const m=c(e,["candidateCount"]);m!=null&&f(i,["candidateCount"],m);const p=c(e,["maxOutputTokens"]);p!=null&&f(i,["maxOutputTokens"],p);const y=c(e,["stopSequences"]);y!=null&&f(i,["stopSequences"],y);const T=c(e,["responseLogprobs"]);T!=null&&f(i,["responseLogprobs"],T);const x=c(e,["logprobs"]);x!=null&&f(i,["logprobs"],x);const C=c(e,["presencePenalty"]);C!=null&&f(i,["presencePenalty"],C);const A=c(e,["frequencyPenalty"]);A!=null&&f(i,["frequencyPenalty"],A);const R=c(e,["seed"]);R!=null&&f(i,["seed"],R);const k=c(e,["responseMimeType"]);k!=null&&f(i,["responseMimeType"],k);const B=c(e,["responseSchema"]);B!=null&&f(i,["responseSchema"],i_(rf(B)));const F=c(e,["responseJsonSchema"]);if(F!=null&&f(i,["responseJsonSchema"],F),c(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const N=c(e,["safetySettings"]);if(t!==void 0&&N!=null){let ae=N;Array.isArray(ae)&&(ae=ae.map(pe=>s_(pe))),f(t,["safetySettings"],ae)}const q=c(e,["tools"]);if(t!==void 0&&q!=null){let ae=Us(q);Array.isArray(ae)&&(ae=ae.map(pe=>f_(Ds(pe)))),f(t,["tools"],ae)}const O=c(e,["toolConfig"]);if(t!==void 0&&O!=null&&f(t,["toolConfig"],p_(O)),c(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const K=c(e,["cachedContent"]);t!==void 0&&K!=null&&f(t,["cachedContent"],xn(n,K));const Q=c(e,["responseModalities"]);Q!=null&&f(i,["responseModalities"],Q);const de=c(e,["mediaResolution"]);de!=null&&f(i,["mediaResolution"],de);const ne=c(e,["speechConfig"]);if(ne!=null&&f(i,["speechConfig"],T_(af(ne))),c(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const ue=c(e,["thinkingConfig"]);return ue!=null&&f(i,["thinkingConfig"],S_(ue)),i}function __(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["request","model"],Me(n,i));const r=c(e,["contents"]);if(r!=null){let u=qt(r);Array.isArray(u)&&(u=u.map(h=>Wy(h))),f(t,["request","contents"],u)}const a=c(e,["config"]);return a!=null&&f(t,["request","generationConfig"],x_(n,a,t)),t}function C_(n,e){const t={};if(c(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(c(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=c(e,["fileName"]);i!=null&&f(t,["fileName"],i);const r=c(e,["inlinedRequests"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(u=>__(n,u))),f(t,["requests","requests"],a)}return t}function E_(n,e){const t={},i=c(n,["displayName"]);if(e!==void 0&&i!=null&&f(e,["batch","displayName"],i),c(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function A_(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["_url","model"],Me(n,i));const r=c(e,["src"]);r!=null&&f(t,["batch","inputConfig"],C_(n,jy(n,r)));const a=c(e,["config"]);return a!=null&&f(t,["config"],E_(a,t)),t}function w_(n,e){const t={},i=c(e,["name"]);i!=null&&f(t,["_url","name"],Ls(n,i));const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function b_(n,e){const t={},i=c(e,["name"]);i!=null&&f(t,["_url","name"],Ls(n,i));const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function R_(n,e){const t={},i=c(n,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const r=c(n,["pageToken"]);if(e!==void 0&&r!=null&&f(e,["_query","pageToken"],r),c(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function M_(n){const e={},t=c(n,["config"]);return t!=null&&f(e,["config"],R_(t,e)),e}function N_(n,e){const t={},i=c(e,["name"]);i!=null&&f(t,["_url","name"],Ls(n,i));const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function k_(n){const e={},t=c(n,["format"]);t!=null&&f(e,["instancesFormat"],t);const i=c(n,["gcsUri"]);i!=null&&f(e,["gcsSource","uris"],i);const r=c(n,["bigqueryUri"]);if(r!=null&&f(e,["bigquerySource","inputUri"],r),c(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function I_(n){const e={},t=c(n,["format"]);t!=null&&f(e,["predictionsFormat"],t);const i=c(n,["gcsUri"]);i!=null&&f(e,["gcsDestination","outputUriPrefix"],i);const r=c(n,["bigqueryUri"]);if(r!=null&&f(e,["bigqueryDestination","outputUri"],r),c(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");return e}function D_(n,e){const t={},i=c(n,["displayName"]);e!==void 0&&i!=null&&f(e,["displayName"],i);const r=c(n,["dest"]);return e!==void 0&&r!=null&&f(e,["outputConfig"],I_(Xx(r))),t}function U_(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["model"],Me(n,i));const r=c(e,["src"]);r!=null&&f(t,["inputConfig"],k_(jy(n,r)));const a=c(e,["config"]);return a!=null&&f(t,["config"],D_(a,t)),t}function L_(n,e){const t={},i=c(e,["name"]);i!=null&&f(t,["_url","name"],Ls(n,i));const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function P_(n,e){const t={},i=c(e,["name"]);i!=null&&f(t,["_url","name"],Ls(n,i));const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function H_(n,e){const t={},i=c(n,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const r=c(n,["pageToken"]);e!==void 0&&r!=null&&f(e,["_query","pageToken"],r);const a=c(n,["filter"]);return e!==void 0&&a!=null&&f(e,["_query","filter"],a),t}function O_(n){const e={},t=c(n,["config"]);return t!=null&&f(e,["config"],H_(t,e)),e}function B_(n,e){const t={},i=c(e,["name"]);i!=null&&f(t,["_url","name"],Ls(n,i));const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function V_(n){const e={},t=c(n,["fps"]);t!=null&&f(e,["fps"],t);const i=c(n,["endOffset"]);i!=null&&f(e,["endOffset"],i);const r=c(n,["startOffset"]);return r!=null&&f(e,["startOffset"],r),e}function q_(n){const e={},t=c(n,["data"]);t!=null&&f(e,["data"],t);const i=c(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function G_(n){const e={},t=c(n,["fileUri"]);t!=null&&f(e,["fileUri"],t);const i=c(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function z_(n){const e={},t=c(n,["videoMetadata"]);t!=null&&f(e,["videoMetadata"],V_(t));const i=c(n,["thought"]);i!=null&&f(e,["thought"],i);const r=c(n,["inlineData"]);r!=null&&f(e,["inlineData"],q_(r));const a=c(n,["fileData"]);a!=null&&f(e,["fileData"],G_(a));const u=c(n,["thoughtSignature"]);u!=null&&f(e,["thoughtSignature"],u);const h=c(n,["codeExecutionResult"]);h!=null&&f(e,["codeExecutionResult"],h);const m=c(n,["executableCode"]);m!=null&&f(e,["executableCode"],m);const p=c(n,["functionCall"]);p!=null&&f(e,["functionCall"],p);const y=c(n,["functionResponse"]);y!=null&&f(e,["functionResponse"],y);const T=c(n,["text"]);return T!=null&&f(e,["text"],T),e}function $_(n){const e={},t=c(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>z_(a))),f(e,["parts"],r)}const i=c(n,["role"]);return i!=null&&f(e,["role"],i),e}function F_(n){const e={},t=c(n,["citationSources"]);return t!=null&&f(e,["citations"],t),e}function Y_(n){const e={},t=c(n,["retrievedUrl"]);t!=null&&f(e,["retrievedUrl"],t);const i=c(n,["urlRetrievalStatus"]);return i!=null&&f(e,["urlRetrievalStatus"],i),e}function J_(n){const e={},t=c(n,["urlMetadata"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>Y_(r))),f(e,["urlMetadata"],i)}return e}function j_(n){const e={},t=c(n,["content"]);t!=null&&f(e,["content"],$_(t));const i=c(n,["citationMetadata"]);i!=null&&f(e,["citationMetadata"],F_(i));const r=c(n,["tokenCount"]);r!=null&&f(e,["tokenCount"],r);const a=c(n,["finishReason"]);a!=null&&f(e,["finishReason"],a);const u=c(n,["urlContextMetadata"]);u!=null&&f(e,["urlContextMetadata"],J_(u));const h=c(n,["avgLogprobs"]);h!=null&&f(e,["avgLogprobs"],h);const m=c(n,["groundingMetadata"]);m!=null&&f(e,["groundingMetadata"],m);const p=c(n,["index"]);p!=null&&f(e,["index"],p);const y=c(n,["logprobsResult"]);y!=null&&f(e,["logprobsResult"],y);const T=c(n,["safetyRatings"]);return T!=null&&f(e,["safetyRatings"],T),e}function K_(n){const e={},t=c(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=c(n,["candidates"]);if(i!=null){let m=i;Array.isArray(m)&&(m=m.map(p=>j_(p))),f(e,["candidates"],m)}const r=c(n,["modelVersion"]);r!=null&&f(e,["modelVersion"],r);const a=c(n,["promptFeedback"]);a!=null&&f(e,["promptFeedback"],a);const u=c(n,["responseId"]);u!=null&&f(e,["responseId"],u);const h=c(n,["usageMetadata"]);return h!=null&&f(e,["usageMetadata"],h),e}function Xy(n){const e={},t=c(n,["details"]);t!=null&&f(e,["details"],t);const i=c(n,["code"]);i!=null&&f(e,["code"],i);const r=c(n,["message"]);return r!=null&&f(e,["message"],r),e}function W_(n){const e={},t=c(n,["response"]);t!=null&&f(e,["response"],K_(t));const i=c(n,["error"]);return i!=null&&f(e,["error"],Xy(i)),e}function Q_(n){const e={},t=c(n,["responsesFile"]);t!=null&&f(e,["fileName"],t);const i=c(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>W_(a))),f(e,["inlinedResponses"],r)}return e}function Nc(n){const e={},t=c(n,["name"]);t!=null&&f(e,["name"],t);const i=c(n,["metadata","displayName"]);i!=null&&f(e,["displayName"],i);const r=c(n,["metadata","state"]);r!=null&&f(e,["state"],Ky(r));const a=c(n,["metadata","createTime"]);a!=null&&f(e,["createTime"],a);const u=c(n,["metadata","endTime"]);u!=null&&f(e,["endTime"],u);const h=c(n,["metadata","updateTime"]);h!=null&&f(e,["updateTime"],h);const m=c(n,["metadata","model"]);m!=null&&f(e,["model"],m);const p=c(n,["metadata","output"]);return p!=null&&f(e,["dest"],Q_(p)),e}function X_(n){const e={},t=c(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=c(n,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const r=c(n,["operations"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(u=>Nc(u))),f(e,["batchJobs"],a)}return e}function Z_(n){const e={},t=c(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=c(n,["name"]);i!=null&&f(e,["name"],i);const r=c(n,["done"]);r!=null&&f(e,["done"],r);const a=c(n,["error"]);return a!=null&&f(e,["error"],Xy(a)),e}function Zy(n){const e={},t=c(n,["details"]);t!=null&&f(e,["details"],t);const i=c(n,["code"]);i!=null&&f(e,["code"],i);const r=c(n,["message"]);return r!=null&&f(e,["message"],r),e}function eC(n){const e={},t=c(n,["instancesFormat"]);t!=null&&f(e,["format"],t);const i=c(n,["gcsSource","uris"]);i!=null&&f(e,["gcsUri"],i);const r=c(n,["bigquerySource","inputUri"]);return r!=null&&f(e,["bigqueryUri"],r),e}function tC(n){const e={},t=c(n,["predictionsFormat"]);t!=null&&f(e,["format"],t);const i=c(n,["gcsDestination","outputUriPrefix"]);i!=null&&f(e,["gcsUri"],i);const r=c(n,["bigqueryDestination","outputUri"]);return r!=null&&f(e,["bigqueryUri"],r),e}function kc(n){const e={},t=c(n,["name"]);t!=null&&f(e,["name"],t);const i=c(n,["displayName"]);i!=null&&f(e,["displayName"],i);const r=c(n,["state"]);r!=null&&f(e,["state"],Ky(r));const a=c(n,["error"]);a!=null&&f(e,["error"],Zy(a));const u=c(n,["createTime"]);u!=null&&f(e,["createTime"],u);const h=c(n,["startTime"]);h!=null&&f(e,["startTime"],h);const m=c(n,["endTime"]);m!=null&&f(e,["endTime"],m);const p=c(n,["updateTime"]);p!=null&&f(e,["updateTime"],p);const y=c(n,["model"]);y!=null&&f(e,["model"],y);const T=c(n,["inputConfig"]);T!=null&&f(e,["src"],eC(T));const x=c(n,["outputConfig"]);return x!=null&&f(e,["dest"],tC(x)),e}function nC(n){const e={},t=c(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=c(n,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const r=c(n,["batchPredictionJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(u=>kc(u))),f(e,["batchJobs"],a)}return e}function iC(n){const e={},t=c(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=c(n,["name"]);i!=null&&f(e,["name"],i);const r=c(n,["done"]);r!=null&&f(e,["done"],r);const a=c(n,["error"]);return a!=null&&f(e,["error"],Zy(a)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ci;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Ci||(Ci={}));class nr{constructor(e,t,i,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,r)}init(e,t,i){var r,a;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let u={config:{}};!i||Object.keys(i).length===0?u={config:{}}:typeof i=="object"?u=Object.assign({},i):u=i,u.config&&(u.config.pageToken=t.nextPageToken),this.paramsInternal=u,this.pageInternalSize=(a=(r=u.config)===null||r===void 0?void 0:r.pageSize)!==null&&a!==void 0?a:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sC extends Ai{constructor(e){super(),this.apiClient=e,this.create=async t=>{if(this.apiClient.isVertexAI()){const r=Date.now().toString();if(Array.isArray(t.src))throw new Error("InlinedRequest[] is not supported in Vertex AI. Please use Google Cloud Storage URI or BigQuery URI instead.");if(t.config=t.config||{},t.config.displayName===void 0&&(t.config.displayName="genaiBatchJob_${timestampStr}"),t.config.dest===void 0&&typeof t.src=="string")if(t.src.startsWith("gs://")&&t.src.endsWith(".jsonl"))t.config.dest=`${t.src.slice(0,-6)}/dest`;else if(t.src.startsWith("bq://"))t.config.dest=`${t.src}_dest_${r}`;else throw new Error("Unsupported source:"+t.src)}return await this.createInternal(t)},this.list=async(t={})=>new nr(Ci.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t)}async createInternal(e){var t,i,r,a;let u,h="",m={};if(this.apiClient.isVertexAI()){const p=U_(this.apiClient,e);return h=ie("batchPredictionJobs",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json()),u.then(y=>kc(y))}else{const p=A_(this.apiClient,e);return h=ie("{model}:batchGenerateContent",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),u.then(y=>Nc(y))}}async get(e){var t,i,r,a;let u,h="",m={};if(this.apiClient.isVertexAI()){const p=L_(this.apiClient,e);return h=ie("batchPredictionJobs/{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json()),u.then(y=>kc(y))}else{const p=w_(this.apiClient,e);return h=ie("batches/{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),u.then(y=>Nc(y))}}async cancel(e){var t,i,r,a;let u="",h={};if(this.apiClient.isVertexAI()){const m=P_(this.apiClient,e);u=ie("batchPredictionJobs/{name}:cancel",m._url),h=m._query,delete m.config,delete m._url,delete m._query,await this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const m=b_(this.apiClient,e);u=ie("batches/{name}:cancel",m._url),h=m._query,delete m.config,delete m._url,delete m._query,await this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal})}}async listInternal(e){var t,i,r,a;let u,h="",m={};if(this.apiClient.isVertexAI()){const p=O_(e);return h=ie("batchPredictionJobs",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),u.then(y=>{const T=nC(y),x=new Sg;return Object.assign(x,T),x})}else{const p=M_(e);return h=ie("batches",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),u.then(y=>{const T=X_(y),x=new Sg;return Object.assign(x,T),x})}}async delete(e){var t,i,r,a;let u,h="",m={};if(this.apiClient.isVertexAI()){const p=B_(this.apiClient,e);return h=ie("batchPredictionJobs/{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),u.then(y=>iC(y))}else{const p=N_(this.apiClient,e);return h=ie("batches/{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),u.then(y=>Z_(y))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function oC(n){const e={},t=c(n,["fps"]);t!=null&&f(e,["fps"],t);const i=c(n,["endOffset"]);i!=null&&f(e,["endOffset"],i);const r=c(n,["startOffset"]);return r!=null&&f(e,["startOffset"],r),e}function rC(n){const e={};if(c(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=c(n,["data"]);t!=null&&f(e,["data"],t);const i=c(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function aC(n){const e={};if(c(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=c(n,["fileUri"]);t!=null&&f(e,["fileUri"],t);const i=c(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function lC(n){const e={},t=c(n,["videoMetadata"]);t!=null&&f(e,["videoMetadata"],oC(t));const i=c(n,["thought"]);i!=null&&f(e,["thought"],i);const r=c(n,["inlineData"]);r!=null&&f(e,["inlineData"],rC(r));const a=c(n,["fileData"]);a!=null&&f(e,["fileData"],aC(a));const u=c(n,["thoughtSignature"]);u!=null&&f(e,["thoughtSignature"],u);const h=c(n,["codeExecutionResult"]);h!=null&&f(e,["codeExecutionResult"],h);const m=c(n,["executableCode"]);m!=null&&f(e,["executableCode"],m);const p=c(n,["functionCall"]);p!=null&&f(e,["functionCall"],p);const y=c(n,["functionResponse"]);y!=null&&f(e,["functionResponse"],y);const T=c(n,["text"]);return T!=null&&f(e,["text"],T),e}function Eg(n){const e={},t=c(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>lC(a))),f(e,["parts"],r)}const i=c(n,["role"]);return i!=null&&f(e,["role"],i),e}function uC(n){const e={},t=c(n,["behavior"]);t!=null&&f(e,["behavior"],t);const i=c(n,["description"]);i!=null&&f(e,["description"],i);const r=c(n,["name"]);r!=null&&f(e,["name"],r);const a=c(n,["parameters"]);a!=null&&f(e,["parameters"],a);const u=c(n,["parametersJsonSchema"]);u!=null&&f(e,["parametersJsonSchema"],u);const h=c(n,["response"]);h!=null&&f(e,["response"],h);const m=c(n,["responseJsonSchema"]);return m!=null&&f(e,["responseJsonSchema"],m),e}function cC(n){const e={},t=c(n,["startTime"]);t!=null&&f(e,["startTime"],t);const i=c(n,["endTime"]);return i!=null&&f(e,["endTime"],i),e}function fC(n){const e={},t=c(n,["timeRangeFilter"]);return t!=null&&f(e,["timeRangeFilter"],cC(t)),e}function dC(n){const e={},t=c(n,["mode"]);t!=null&&f(e,["mode"],t);const i=c(n,["dynamicThreshold"]);return i!=null&&f(e,["dynamicThreshold"],i),e}function hC(n){const e={},t=c(n,["dynamicRetrievalConfig"]);return t!=null&&f(e,["dynamicRetrievalConfig"],dC(t)),e}function mC(){return{}}function pC(n){const e={},t=c(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(p=>uC(p))),f(e,["functionDeclarations"],m)}if(c(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=c(n,["googleSearch"]);i!=null&&f(e,["googleSearch"],fC(i));const r=c(n,["googleSearchRetrieval"]);if(r!=null&&f(e,["googleSearchRetrieval"],hC(r)),c(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(c(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");c(n,["urlContext"])!=null&&f(e,["urlContext"],mC());const u=c(n,["codeExecution"]);u!=null&&f(e,["codeExecution"],u);const h=c(n,["computerUse"]);return h!=null&&f(e,["computerUse"],h),e}function gC(n){const e={},t=c(n,["mode"]);t!=null&&f(e,["mode"],t);const i=c(n,["allowedFunctionNames"]);return i!=null&&f(e,["allowedFunctionNames"],i),e}function yC(n){const e={},t=c(n,["latitude"]);t!=null&&f(e,["latitude"],t);const i=c(n,["longitude"]);return i!=null&&f(e,["longitude"],i),e}function vC(n){const e={},t=c(n,["latLng"]);t!=null&&f(e,["latLng"],yC(t));const i=c(n,["languageCode"]);return i!=null&&f(e,["languageCode"],i),e}function TC(n){const e={},t=c(n,["functionCallingConfig"]);t!=null&&f(e,["functionCallingConfig"],gC(t));const i=c(n,["retrievalConfig"]);return i!=null&&f(e,["retrievalConfig"],vC(i)),e}function SC(n,e){const t={},i=c(n,["ttl"]);e!==void 0&&i!=null&&f(e,["ttl"],i);const r=c(n,["expireTime"]);e!==void 0&&r!=null&&f(e,["expireTime"],r);const a=c(n,["displayName"]);e!==void 0&&a!=null&&f(e,["displayName"],a);const u=c(n,["contents"]);if(e!==void 0&&u!=null){let y=qt(u);Array.isArray(y)&&(y=y.map(T=>Eg(T))),f(e,["contents"],y)}const h=c(n,["systemInstruction"]);e!==void 0&&h!=null&&f(e,["systemInstruction"],Eg(ht(h)));const m=c(n,["tools"]);if(e!==void 0&&m!=null){let y=m;Array.isArray(y)&&(y=y.map(T=>pC(T))),f(e,["tools"],y)}const p=c(n,["toolConfig"]);if(e!==void 0&&p!=null&&f(e,["toolConfig"],TC(p)),c(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function xC(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["model"],Oy(n,i));const r=c(e,["config"]);return r!=null&&f(t,["config"],SC(r,t)),t}function _C(n,e){const t={},i=c(e,["name"]);i!=null&&f(t,["_url","name"],xn(n,i));const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function CC(n,e){const t={},i=c(e,["name"]);i!=null&&f(t,["_url","name"],xn(n,i));const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function EC(n,e){const t={},i=c(n,["ttl"]);e!==void 0&&i!=null&&f(e,["ttl"],i);const r=c(n,["expireTime"]);return e!==void 0&&r!=null&&f(e,["expireTime"],r),t}function AC(n,e){const t={},i=c(e,["name"]);i!=null&&f(t,["_url","name"],xn(n,i));const r=c(e,["config"]);return r!=null&&f(t,["config"],EC(r,t)),t}function wC(n,e){const t={},i=c(n,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const r=c(n,["pageToken"]);return e!==void 0&&r!=null&&f(e,["_query","pageToken"],r),t}function bC(n){const e={},t=c(n,["config"]);return t!=null&&f(e,["config"],wC(t,e)),e}function RC(n){const e={},t=c(n,["fps"]);t!=null&&f(e,["fps"],t);const i=c(n,["endOffset"]);i!=null&&f(e,["endOffset"],i);const r=c(n,["startOffset"]);return r!=null&&f(e,["startOffset"],r),e}function MC(n){const e={},t=c(n,["displayName"]);t!=null&&f(e,["displayName"],t);const i=c(n,["data"]);i!=null&&f(e,["data"],i);const r=c(n,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function NC(n){const e={},t=c(n,["displayName"]);t!=null&&f(e,["displayName"],t);const i=c(n,["fileUri"]);i!=null&&f(e,["fileUri"],i);const r=c(n,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function kC(n){const e={},t=c(n,["videoMetadata"]);t!=null&&f(e,["videoMetadata"],RC(t));const i=c(n,["thought"]);i!=null&&f(e,["thought"],i);const r=c(n,["inlineData"]);r!=null&&f(e,["inlineData"],MC(r));const a=c(n,["fileData"]);a!=null&&f(e,["fileData"],NC(a));const u=c(n,["thoughtSignature"]);u!=null&&f(e,["thoughtSignature"],u);const h=c(n,["codeExecutionResult"]);h!=null&&f(e,["codeExecutionResult"],h);const m=c(n,["executableCode"]);m!=null&&f(e,["executableCode"],m);const p=c(n,["functionCall"]);p!=null&&f(e,["functionCall"],p);const y=c(n,["functionResponse"]);y!=null&&f(e,["functionResponse"],y);const T=c(n,["text"]);return T!=null&&f(e,["text"],T),e}function Ag(n){const e={},t=c(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>kC(a))),f(e,["parts"],r)}const i=c(n,["role"]);return i!=null&&f(e,["role"],i),e}function IC(n){const e={};if(c(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=c(n,["description"]);t!=null&&f(e,["description"],t);const i=c(n,["name"]);i!=null&&f(e,["name"],i);const r=c(n,["parameters"]);r!=null&&f(e,["parameters"],r);const a=c(n,["parametersJsonSchema"]);a!=null&&f(e,["parametersJsonSchema"],a);const u=c(n,["response"]);u!=null&&f(e,["response"],u);const h=c(n,["responseJsonSchema"]);return h!=null&&f(e,["responseJsonSchema"],h),e}function DC(n){const e={},t=c(n,["startTime"]);t!=null&&f(e,["startTime"],t);const i=c(n,["endTime"]);return i!=null&&f(e,["endTime"],i),e}function UC(n){const e={},t=c(n,["timeRangeFilter"]);return t!=null&&f(e,["timeRangeFilter"],DC(t)),e}function LC(n){const e={},t=c(n,["mode"]);t!=null&&f(e,["mode"],t);const i=c(n,["dynamicThreshold"]);return i!=null&&f(e,["dynamicThreshold"],i),e}function PC(n){const e={},t=c(n,["dynamicRetrievalConfig"]);return t!=null&&f(e,["dynamicRetrievalConfig"],LC(t)),e}function HC(){return{}}function OC(n){const e={},t=c(n,["apiKeyString"]);return t!=null&&f(e,["apiKeyString"],t),e}function BC(n){const e={},t=c(n,["apiKeyConfig"]);t!=null&&f(e,["apiKeyConfig"],OC(t));const i=c(n,["authType"]);i!=null&&f(e,["authType"],i);const r=c(n,["googleServiceAccountConfig"]);r!=null&&f(e,["googleServiceAccountConfig"],r);const a=c(n,["httpBasicAuthConfig"]);a!=null&&f(e,["httpBasicAuthConfig"],a);const u=c(n,["oauthConfig"]);u!=null&&f(e,["oauthConfig"],u);const h=c(n,["oidcConfig"]);return h!=null&&f(e,["oidcConfig"],h),e}function VC(n){const e={},t=c(n,["authConfig"]);return t!=null&&f(e,["authConfig"],BC(t)),e}function qC(){return{}}function GC(n){const e={},t=c(n,["functionDeclarations"]);if(t!=null){let T=t;Array.isArray(T)&&(T=T.map(x=>IC(x))),f(e,["functionDeclarations"],T)}const i=c(n,["retrieval"]);i!=null&&f(e,["retrieval"],i);const r=c(n,["googleSearch"]);r!=null&&f(e,["googleSearch"],UC(r));const a=c(n,["googleSearchRetrieval"]);a!=null&&f(e,["googleSearchRetrieval"],PC(a)),c(n,["enterpriseWebSearch"])!=null&&f(e,["enterpriseWebSearch"],HC());const h=c(n,["googleMaps"]);h!=null&&f(e,["googleMaps"],VC(h)),c(n,["urlContext"])!=null&&f(e,["urlContext"],qC());const p=c(n,["codeExecution"]);p!=null&&f(e,["codeExecution"],p);const y=c(n,["computerUse"]);return y!=null&&f(e,["computerUse"],y),e}function zC(n){const e={},t=c(n,["mode"]);t!=null&&f(e,["mode"],t);const i=c(n,["allowedFunctionNames"]);return i!=null&&f(e,["allowedFunctionNames"],i),e}function $C(n){const e={},t=c(n,["latitude"]);t!=null&&f(e,["latitude"],t);const i=c(n,["longitude"]);return i!=null&&f(e,["longitude"],i),e}function FC(n){const e={},t=c(n,["latLng"]);t!=null&&f(e,["latLng"],$C(t));const i=c(n,["languageCode"]);return i!=null&&f(e,["languageCode"],i),e}function YC(n){const e={},t=c(n,["functionCallingConfig"]);t!=null&&f(e,["functionCallingConfig"],zC(t));const i=c(n,["retrievalConfig"]);return i!=null&&f(e,["retrievalConfig"],FC(i)),e}function JC(n,e){const t={},i=c(n,["ttl"]);e!==void 0&&i!=null&&f(e,["ttl"],i);const r=c(n,["expireTime"]);e!==void 0&&r!=null&&f(e,["expireTime"],r);const a=c(n,["displayName"]);e!==void 0&&a!=null&&f(e,["displayName"],a);const u=c(n,["contents"]);if(e!==void 0&&u!=null){let T=qt(u);Array.isArray(T)&&(T=T.map(x=>Ag(x))),f(e,["contents"],T)}const h=c(n,["systemInstruction"]);e!==void 0&&h!=null&&f(e,["systemInstruction"],Ag(ht(h)));const m=c(n,["tools"]);if(e!==void 0&&m!=null){let T=m;Array.isArray(T)&&(T=T.map(x=>GC(x))),f(e,["tools"],T)}const p=c(n,["toolConfig"]);e!==void 0&&p!=null&&f(e,["toolConfig"],YC(p));const y=c(n,["kmsKeyName"]);return e!==void 0&&y!=null&&f(e,["encryption_spec","kmsKeyName"],y),t}function jC(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["model"],Oy(n,i));const r=c(e,["config"]);return r!=null&&f(t,["config"],JC(r,t)),t}function KC(n,e){const t={},i=c(e,["name"]);i!=null&&f(t,["_url","name"],xn(n,i));const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function WC(n,e){const t={},i=c(e,["name"]);i!=null&&f(t,["_url","name"],xn(n,i));const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function QC(n,e){const t={},i=c(n,["ttl"]);e!==void 0&&i!=null&&f(e,["ttl"],i);const r=c(n,["expireTime"]);return e!==void 0&&r!=null&&f(e,["expireTime"],r),t}function XC(n,e){const t={},i=c(e,["name"]);i!=null&&f(t,["_url","name"],xn(n,i));const r=c(e,["config"]);return r!=null&&f(t,["config"],QC(r,t)),t}function ZC(n,e){const t={},i=c(n,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const r=c(n,["pageToken"]);return e!==void 0&&r!=null&&f(e,["_query","pageToken"],r),t}function eE(n){const e={},t=c(n,["config"]);return t!=null&&f(e,["config"],ZC(t,e)),e}function Ma(n){const e={},t=c(n,["name"]);t!=null&&f(e,["name"],t);const i=c(n,["displayName"]);i!=null&&f(e,["displayName"],i);const r=c(n,["model"]);r!=null&&f(e,["model"],r);const a=c(n,["createTime"]);a!=null&&f(e,["createTime"],a);const u=c(n,["updateTime"]);u!=null&&f(e,["updateTime"],u);const h=c(n,["expireTime"]);h!=null&&f(e,["expireTime"],h);const m=c(n,["usageMetadata"]);return m!=null&&f(e,["usageMetadata"],m),e}function tE(){return{}}function nE(n){const e={},t=c(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=c(n,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const r=c(n,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(u=>Ma(u))),f(e,["cachedContents"],a)}return e}function Na(n){const e={},t=c(n,["name"]);t!=null&&f(e,["name"],t);const i=c(n,["displayName"]);i!=null&&f(e,["displayName"],i);const r=c(n,["model"]);r!=null&&f(e,["model"],r);const a=c(n,["createTime"]);a!=null&&f(e,["createTime"],a);const u=c(n,["updateTime"]);u!=null&&f(e,["updateTime"],u);const h=c(n,["expireTime"]);h!=null&&f(e,["expireTime"],h);const m=c(n,["usageMetadata"]);return m!=null&&f(e,["usageMetadata"],m),e}function iE(){return{}}function sE(n){const e={},t=c(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=c(n,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const r=c(n,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(u=>Na(u))),f(e,["cachedContents"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class oE extends Ai{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new nr(Ci.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,r,a;let u,h="",m={};if(this.apiClient.isVertexAI()){const p=jC(this.apiClient,e);return h=ie("cachedContents",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json()),u.then(y=>Na(y))}else{const p=xC(this.apiClient,e);return h=ie("cachedContents",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),u.then(y=>Ma(y))}}async get(e){var t,i,r,a;let u,h="",m={};if(this.apiClient.isVertexAI()){const p=KC(this.apiClient,e);return h=ie("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json()),u.then(y=>Na(y))}else{const p=_C(this.apiClient,e);return h=ie("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),u.then(y=>Ma(y))}}async delete(e){var t,i,r,a;let u,h="",m={};if(this.apiClient.isVertexAI()){const p=WC(this.apiClient,e);return h=ie("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json()),u.then(()=>{const y=iE(),T=new vg;return Object.assign(T,y),T})}else{const p=CC(this.apiClient,e);return h=ie("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),u.then(()=>{const y=tE(),T=new vg;return Object.assign(T,y),T})}}async update(e){var t,i,r,a;let u,h="",m={};if(this.apiClient.isVertexAI()){const p=XC(this.apiClient,e);return h=ie("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json()),u.then(y=>Na(y))}else{const p=AC(this.apiClient,e);return h=ie("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),u.then(y=>Ma(y))}}async listInternal(e){var t,i,r,a;let u,h="",m={};if(this.apiClient.isVertexAI()){const p=eE(e);return h=ie("cachedContents",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),u.then(y=>{const T=sE(y),x=new Tg;return Object.assign(x,T),x})}else{const p=bC(e);return h=ie("cachedContents",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),u.then(y=>{const T=nE(y),x=new Tg;return Object.assign(x,T),x})}}}function wg(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function qe(n){return this instanceof qe?(this.v=n,this):new qe(n)}function Ns(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,a=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),h("next"),h("throw"),h("return",u),r[Symbol.asyncIterator]=function(){return this},r;function u(C){return function(A){return Promise.resolve(A).then(C,T)}}function h(C,A){i[C]&&(r[C]=function(R){return new Promise(function(k,B){a.push([C,R,k,B])>1||m(C,R)})},A&&(r[C]=A(r[C])))}function m(C,A){try{p(i[C](A))}catch(R){x(a[0][3],R)}}function p(C){C.value instanceof qe?Promise.resolve(C.value.v).then(y,T):x(a[0][2],C)}function y(C){m("next",C)}function T(C){m("throw",C)}function x(C,A){C(A),a.shift(),a.length&&m(a[0][0],a[0][1])}}function jo(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof wg=="function"?wg(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(a){t[a]=n[a]&&function(u){return new Promise(function(h,m){u=n[a](u),r(h,m,u.done,u.value)})}}function r(a,u,h,m){Promise.resolve(m).then(function(p){a({value:p,done:h})},u)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rE(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:ev(t)}function ev(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0||!e.thought&&e.text!==void 0&&e.text==="")return!1;return!0}function aE(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function bg(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{const r=[];let a=!0;for(;i<t&&n[i].role==="model";)r.push(n[i]),a&&!ev(n[i])&&(a=!1),i++;a?e.push(...r):e.pop()}return e}class lE{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new uE(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class uE{constructor(e,t,i,r={},a=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=r,this.history=a,this.sendPromise=Promise.resolve(),aE(a)}async sendMessage(e){var t;await this.sendPromise;const i=ht(e.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var a,u,h;const m=await r,p=(u=(a=m.candidates)===null||a===void 0?void 0:a[0])===null||u===void 0?void 0:u.content,y=m.automaticFunctionCallingHistory,T=this.getHistory(!0).length;let x=[];y!=null&&(x=(h=y.slice(T))!==null&&h!==void 0?h:[]);const C=p?[p]:[];this.recordHistory(i,C,x)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),r}async sendMessageStream(e){var t;await this.sendPromise;const i=ht(e.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=r.then(()=>{}).catch(()=>{});const a=await r;return this.processStreamResponse(a,i)}getHistory(e=!1){const t=e?bg(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var i,r;return Ns(this,arguments,function*(){var u,h,m,p;const y=[];try{for(var T=!0,x=jo(e),C;C=yield qe(x.next()),u=C.done,!u;T=!0){p=C.value,T=!1;const A=p;if(rE(A)){const R=(r=(i=A.candidates)===null||i===void 0?void 0:i[0])===null||r===void 0?void 0:r.content;R!==void 0&&y.push(R)}yield yield qe(A)}}catch(A){h={error:A}}finally{try{!T&&!u&&(m=x.return)&&(yield qe(m.call(x)))}finally{if(h)throw h.error}}this.recordHistory(t,y)})}recordHistory(e,t,i){let r=[];t.length>0&&t.every(a=>a.role!==void 0)?r=t:r.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...bg(i)):this.history.push(e),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class za extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,za.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cE(n,e){const t={},i=c(n,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const r=c(n,["pageToken"]);return e!==void 0&&r!=null&&f(e,["_query","pageToken"],r),t}function fE(n){const e={},t=c(n,["config"]);return t!=null&&f(e,["config"],cE(t,e)),e}function dE(n){const e={},t=c(n,["details"]);t!=null&&f(e,["details"],t);const i=c(n,["message"]);i!=null&&f(e,["message"],i);const r=c(n,["code"]);return r!=null&&f(e,["code"],r),e}function hE(n){const e={},t=c(n,["name"]);t!=null&&f(e,["name"],t);const i=c(n,["displayName"]);i!=null&&f(e,["displayName"],i);const r=c(n,["mimeType"]);r!=null&&f(e,["mimeType"],r);const a=c(n,["sizeBytes"]);a!=null&&f(e,["sizeBytes"],a);const u=c(n,["createTime"]);u!=null&&f(e,["createTime"],u);const h=c(n,["expirationTime"]);h!=null&&f(e,["expirationTime"],h);const m=c(n,["updateTime"]);m!=null&&f(e,["updateTime"],m);const p=c(n,["sha256Hash"]);p!=null&&f(e,["sha256Hash"],p);const y=c(n,["uri"]);y!=null&&f(e,["uri"],y);const T=c(n,["downloadUri"]);T!=null&&f(e,["downloadUri"],T);const x=c(n,["state"]);x!=null&&f(e,["state"],x);const C=c(n,["source"]);C!=null&&f(e,["source"],C);const A=c(n,["videoMetadata"]);A!=null&&f(e,["videoMetadata"],A);const R=c(n,["error"]);return R!=null&&f(e,["error"],dE(R)),e}function mE(n){const e={},t=c(n,["file"]);t!=null&&f(e,["file"],hE(t));const i=c(n,["config"]);return i!=null&&f(e,["config"],i),e}function pE(n){const e={},t=c(n,["name"]);t!=null&&f(e,["_url","file"],Fy(t));const i=c(n,["config"]);return i!=null&&f(e,["config"],i),e}function gE(n){const e={},t=c(n,["name"]);t!=null&&f(e,["_url","file"],Fy(t));const i=c(n,["config"]);return i!=null&&f(e,["config"],i),e}function yE(n){const e={},t=c(n,["details"]);t!=null&&f(e,["details"],t);const i=c(n,["message"]);i!=null&&f(e,["message"],i);const r=c(n,["code"]);return r!=null&&f(e,["code"],r),e}function Ic(n){const e={},t=c(n,["name"]);t!=null&&f(e,["name"],t);const i=c(n,["displayName"]);i!=null&&f(e,["displayName"],i);const r=c(n,["mimeType"]);r!=null&&f(e,["mimeType"],r);const a=c(n,["sizeBytes"]);a!=null&&f(e,["sizeBytes"],a);const u=c(n,["createTime"]);u!=null&&f(e,["createTime"],u);const h=c(n,["expirationTime"]);h!=null&&f(e,["expirationTime"],h);const m=c(n,["updateTime"]);m!=null&&f(e,["updateTime"],m);const p=c(n,["sha256Hash"]);p!=null&&f(e,["sha256Hash"],p);const y=c(n,["uri"]);y!=null&&f(e,["uri"],y);const T=c(n,["downloadUri"]);T!=null&&f(e,["downloadUri"],T);const x=c(n,["state"]);x!=null&&f(e,["state"],x);const C=c(n,["source"]);C!=null&&f(e,["source"],C);const A=c(n,["videoMetadata"]);A!=null&&f(e,["videoMetadata"],A);const R=c(n,["error"]);return R!=null&&f(e,["error"],yE(R)),e}function vE(n){const e={},t=c(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=c(n,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const r=c(n,["files"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(u=>Ic(u))),f(e,["files"],a)}return e}function TE(n){const e={},t=c(n,["sdkHttpResponse"]);return t!=null&&f(e,["sdkHttpResponse"],t),e}function SE(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class xE extends Ai{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new nr(Ci.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>Ic(t))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=fE(e);return a=ie("files",h._url),u=h._query,delete h.config,delete h._url,delete h._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(p=>{const y=p;return y.sdkHttpResponse={headers:m.headers},y})),r.then(m=>{const p=vE(m),y=new Bx;return Object.assign(y,p),y})}}async createInternal(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=mE(e);return a=ie("upload/v1beta/files",h._url),u=h._query,delete h.config,delete h._url,delete h._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),r.then(m=>{const p=TE(m),y=new Vx;return Object.assign(y,p),y})}}async get(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=pE(e);return a=ie("files/{file}",h._url),u=h._query,delete h.config,delete h._url,delete h._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),r.then(m=>Ic(m))}}async delete(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=gE(e);return a=ie("files/{file}",h._url),u=h._query,delete h.config,delete h._url,delete h._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),r.then(()=>{const m=SE(),p=new qx;return Object.assign(p,m),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _E(n){const e={},t=c(n,["voiceName"]);return t!=null&&f(e,["voiceName"],t),e}function tv(n){const e={},t=c(n,["prebuiltVoiceConfig"]);return t!=null&&f(e,["prebuiltVoiceConfig"],_E(t)),e}function CE(n){const e={},t=c(n,["speaker"]);t!=null&&f(e,["speaker"],t);const i=c(n,["voiceConfig"]);return i!=null&&f(e,["voiceConfig"],tv(i)),e}function EE(n){const e={},t=c(n,["speakerVoiceConfigs"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>CE(r))),f(e,["speakerVoiceConfigs"],i)}return e}function AE(n){const e={},t=c(n,["voiceConfig"]);t!=null&&f(e,["voiceConfig"],tv(t));const i=c(n,["multiSpeakerVoiceConfig"]);i!=null&&f(e,["multiSpeakerVoiceConfig"],EE(i));const r=c(n,["languageCode"]);return r!=null&&f(e,["languageCode"],r),e}function wE(n){const e={},t=c(n,["fps"]);t!=null&&f(e,["fps"],t);const i=c(n,["endOffset"]);i!=null&&f(e,["endOffset"],i);const r=c(n,["startOffset"]);return r!=null&&f(e,["startOffset"],r),e}function bE(n){const e={};if(c(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=c(n,["data"]);t!=null&&f(e,["data"],t);const i=c(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function RE(n){const e={};if(c(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=c(n,["fileUri"]);t!=null&&f(e,["fileUri"],t);const i=c(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function ME(n){const e={},t=c(n,["videoMetadata"]);t!=null&&f(e,["videoMetadata"],wE(t));const i=c(n,["thought"]);i!=null&&f(e,["thought"],i);const r=c(n,["inlineData"]);r!=null&&f(e,["inlineData"],bE(r));const a=c(n,["fileData"]);a!=null&&f(e,["fileData"],RE(a));const u=c(n,["thoughtSignature"]);u!=null&&f(e,["thoughtSignature"],u);const h=c(n,["codeExecutionResult"]);h!=null&&f(e,["codeExecutionResult"],h);const m=c(n,["executableCode"]);m!=null&&f(e,["executableCode"],m);const p=c(n,["functionCall"]);p!=null&&f(e,["functionCall"],p);const y=c(n,["functionResponse"]);y!=null&&f(e,["functionResponse"],y);const T=c(n,["text"]);return T!=null&&f(e,["text"],T),e}function NE(n){const e={},t=c(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>ME(a))),f(e,["parts"],r)}const i=c(n,["role"]);return i!=null&&f(e,["role"],i),e}function kE(n){const e={},t=c(n,["behavior"]);t!=null&&f(e,["behavior"],t);const i=c(n,["description"]);i!=null&&f(e,["description"],i);const r=c(n,["name"]);r!=null&&f(e,["name"],r);const a=c(n,["parameters"]);a!=null&&f(e,["parameters"],a);const u=c(n,["parametersJsonSchema"]);u!=null&&f(e,["parametersJsonSchema"],u);const h=c(n,["response"]);h!=null&&f(e,["response"],h);const m=c(n,["responseJsonSchema"]);return m!=null&&f(e,["responseJsonSchema"],m),e}function IE(n){const e={},t=c(n,["startTime"]);t!=null&&f(e,["startTime"],t);const i=c(n,["endTime"]);return i!=null&&f(e,["endTime"],i),e}function DE(n){const e={},t=c(n,["timeRangeFilter"]);return t!=null&&f(e,["timeRangeFilter"],IE(t)),e}function UE(n){const e={},t=c(n,["mode"]);t!=null&&f(e,["mode"],t);const i=c(n,["dynamicThreshold"]);return i!=null&&f(e,["dynamicThreshold"],i),e}function LE(n){const e={},t=c(n,["dynamicRetrievalConfig"]);return t!=null&&f(e,["dynamicRetrievalConfig"],UE(t)),e}function PE(){return{}}function HE(n){const e={},t=c(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(p=>kE(p))),f(e,["functionDeclarations"],m)}if(c(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=c(n,["googleSearch"]);i!=null&&f(e,["googleSearch"],DE(i));const r=c(n,["googleSearchRetrieval"]);if(r!=null&&f(e,["googleSearchRetrieval"],LE(r)),c(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(c(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");c(n,["urlContext"])!=null&&f(e,["urlContext"],PE());const u=c(n,["codeExecution"]);u!=null&&f(e,["codeExecution"],u);const h=c(n,["computerUse"]);return h!=null&&f(e,["computerUse"],h),e}function OE(n){const e={},t=c(n,["handle"]);if(t!=null&&f(e,["handle"],t),c(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Rg(){return{}}function BE(n){const e={},t=c(n,["disabled"]);t!=null&&f(e,["disabled"],t);const i=c(n,["startOfSpeechSensitivity"]);i!=null&&f(e,["startOfSpeechSensitivity"],i);const r=c(n,["endOfSpeechSensitivity"]);r!=null&&f(e,["endOfSpeechSensitivity"],r);const a=c(n,["prefixPaddingMs"]);a!=null&&f(e,["prefixPaddingMs"],a);const u=c(n,["silenceDurationMs"]);return u!=null&&f(e,["silenceDurationMs"],u),e}function VE(n){const e={},t=c(n,["automaticActivityDetection"]);t!=null&&f(e,["automaticActivityDetection"],BE(t));const i=c(n,["activityHandling"]);i!=null&&f(e,["activityHandling"],i);const r=c(n,["turnCoverage"]);return r!=null&&f(e,["turnCoverage"],r),e}function qE(n){const e={},t=c(n,["targetTokens"]);return t!=null&&f(e,["targetTokens"],t),e}function GE(n){const e={},t=c(n,["triggerTokens"]);t!=null&&f(e,["triggerTokens"],t);const i=c(n,["slidingWindow"]);return i!=null&&f(e,["slidingWindow"],qE(i)),e}function zE(n){const e={},t=c(n,["proactiveAudio"]);return t!=null&&f(e,["proactiveAudio"],t),e}function $E(n,e){const t={},i=c(n,["generationConfig"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig"],i);const r=c(n,["responseModalities"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig","responseModalities"],r);const a=c(n,["temperature"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","temperature"],a);const u=c(n,["topP"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","topP"],u);const h=c(n,["topK"]);e!==void 0&&h!=null&&f(e,["setup","generationConfig","topK"],h);const m=c(n,["maxOutputTokens"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","maxOutputTokens"],m);const p=c(n,["mediaResolution"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","mediaResolution"],p);const y=c(n,["seed"]);e!==void 0&&y!=null&&f(e,["setup","generationConfig","seed"],y);const T=c(n,["speechConfig"]);e!==void 0&&T!=null&&f(e,["setup","generationConfig","speechConfig"],AE(lf(T)));const x=c(n,["enableAffectiveDialog"]);e!==void 0&&x!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],x);const C=c(n,["systemInstruction"]);e!==void 0&&C!=null&&f(e,["setup","systemInstruction"],NE(ht(C)));const A=c(n,["tools"]);if(e!==void 0&&A!=null){let O=Us(A);Array.isArray(O)&&(O=O.map(K=>HE(Ds(K)))),f(e,["setup","tools"],O)}const R=c(n,["sessionResumption"]);e!==void 0&&R!=null&&f(e,["setup","sessionResumption"],OE(R));const k=c(n,["inputAudioTranscription"]);e!==void 0&&k!=null&&f(e,["setup","inputAudioTranscription"],Rg());const B=c(n,["outputAudioTranscription"]);e!==void 0&&B!=null&&f(e,["setup","outputAudioTranscription"],Rg());const F=c(n,["realtimeInputConfig"]);e!==void 0&&F!=null&&f(e,["setup","realtimeInputConfig"],VE(F));const N=c(n,["contextWindowCompression"]);e!==void 0&&N!=null&&f(e,["setup","contextWindowCompression"],GE(N));const q=c(n,["proactivity"]);return e!==void 0&&q!=null&&f(e,["setup","proactivity"],zE(q)),t}function FE(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["setup","model"],Me(n,i));const r=c(e,["config"]);return r!=null&&f(t,["config"],$E(r,t)),t}function YE(){return{}}function JE(){return{}}function jE(n){const e={},t=c(n,["media"]);t!=null&&f(e,["mediaChunks"],By(t));const i=c(n,["audio"]);i!=null&&f(e,["audio"],qy(i));const r=c(n,["audioStreamEnd"]);r!=null&&f(e,["audioStreamEnd"],r);const a=c(n,["video"]);a!=null&&f(e,["video"],Vy(a));const u=c(n,["text"]);return u!=null&&f(e,["text"],u),c(n,["activityStart"])!=null&&f(e,["activityStart"],YE()),c(n,["activityEnd"])!=null&&f(e,["activityEnd"],JE()),e}function nv(n){const e={},t=c(n,["text"]);t!=null&&f(e,["text"],t);const i=c(n,["weight"]);return i!=null&&f(e,["weight"],i),e}function KE(n){const e={},t=c(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>nv(r))),f(e,["weightedPrompts"],i)}return e}function iv(n){const e={},t=c(n,["temperature"]);t!=null&&f(e,["temperature"],t);const i=c(n,["topK"]);i!=null&&f(e,["topK"],i);const r=c(n,["seed"]);r!=null&&f(e,["seed"],r);const a=c(n,["guidance"]);a!=null&&f(e,["guidance"],a);const u=c(n,["bpm"]);u!=null&&f(e,["bpm"],u);const h=c(n,["density"]);h!=null&&f(e,["density"],h);const m=c(n,["brightness"]);m!=null&&f(e,["brightness"],m);const p=c(n,["scale"]);p!=null&&f(e,["scale"],p);const y=c(n,["muteBass"]);y!=null&&f(e,["muteBass"],y);const T=c(n,["muteDrums"]);T!=null&&f(e,["muteDrums"],T);const x=c(n,["onlyBassAndDrums"]);x!=null&&f(e,["onlyBassAndDrums"],x);const C=c(n,["musicGenerationMode"]);return C!=null&&f(e,["musicGenerationMode"],C),e}function WE(n){const e={},t=c(n,["musicGenerationConfig"]);return t!=null&&f(e,["musicGenerationConfig"],iv(t)),e}function sv(n){const e={},t=c(n,["model"]);return t!=null&&f(e,["model"],t),e}function ov(n){const e={},t=c(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>nv(r))),f(e,["weightedPrompts"],i)}return e}function Dc(n){const e={},t=c(n,["setup"]);t!=null&&f(e,["setup"],sv(t));const i=c(n,["clientContent"]);i!=null&&f(e,["clientContent"],ov(i));const r=c(n,["musicGenerationConfig"]);r!=null&&f(e,["musicGenerationConfig"],iv(r));const a=c(n,["playbackControl"]);return a!=null&&f(e,["playbackControl"],a),e}function QE(n){const e={},t=c(n,["voiceName"]);return t!=null&&f(e,["voiceName"],t),e}function XE(n){const e={},t=c(n,["prebuiltVoiceConfig"]);return t!=null&&f(e,["prebuiltVoiceConfig"],QE(t)),e}function ZE(n){const e={},t=c(n,["voiceConfig"]);if(t!=null&&f(e,["voiceConfig"],XE(t)),c(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=c(n,["languageCode"]);return i!=null&&f(e,["languageCode"],i),e}function eA(n){const e={},t=c(n,["fps"]);t!=null&&f(e,["fps"],t);const i=c(n,["endOffset"]);i!=null&&f(e,["endOffset"],i);const r=c(n,["startOffset"]);return r!=null&&f(e,["startOffset"],r),e}function tA(n){const e={},t=c(n,["displayName"]);t!=null&&f(e,["displayName"],t);const i=c(n,["data"]);i!=null&&f(e,["data"],i);const r=c(n,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function nA(n){const e={},t=c(n,["displayName"]);t!=null&&f(e,["displayName"],t);const i=c(n,["fileUri"]);i!=null&&f(e,["fileUri"],i);const r=c(n,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function iA(n){const e={},t=c(n,["videoMetadata"]);t!=null&&f(e,["videoMetadata"],eA(t));const i=c(n,["thought"]);i!=null&&f(e,["thought"],i);const r=c(n,["inlineData"]);r!=null&&f(e,["inlineData"],tA(r));const a=c(n,["fileData"]);a!=null&&f(e,["fileData"],nA(a));const u=c(n,["thoughtSignature"]);u!=null&&f(e,["thoughtSignature"],u);const h=c(n,["codeExecutionResult"]);h!=null&&f(e,["codeExecutionResult"],h);const m=c(n,["executableCode"]);m!=null&&f(e,["executableCode"],m);const p=c(n,["functionCall"]);p!=null&&f(e,["functionCall"],p);const y=c(n,["functionResponse"]);y!=null&&f(e,["functionResponse"],y);const T=c(n,["text"]);return T!=null&&f(e,["text"],T),e}function sA(n){const e={},t=c(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>iA(a))),f(e,["parts"],r)}const i=c(n,["role"]);return i!=null&&f(e,["role"],i),e}function oA(n){const e={};if(c(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=c(n,["description"]);t!=null&&f(e,["description"],t);const i=c(n,["name"]);i!=null&&f(e,["name"],i);const r=c(n,["parameters"]);r!=null&&f(e,["parameters"],r);const a=c(n,["parametersJsonSchema"]);a!=null&&f(e,["parametersJsonSchema"],a);const u=c(n,["response"]);u!=null&&f(e,["response"],u);const h=c(n,["responseJsonSchema"]);return h!=null&&f(e,["responseJsonSchema"],h),e}function rA(n){const e={},t=c(n,["startTime"]);t!=null&&f(e,["startTime"],t);const i=c(n,["endTime"]);return i!=null&&f(e,["endTime"],i),e}function aA(n){const e={},t=c(n,["timeRangeFilter"]);return t!=null&&f(e,["timeRangeFilter"],rA(t)),e}function lA(n){const e={},t=c(n,["mode"]);t!=null&&f(e,["mode"],t);const i=c(n,["dynamicThreshold"]);return i!=null&&f(e,["dynamicThreshold"],i),e}function uA(n){const e={},t=c(n,["dynamicRetrievalConfig"]);return t!=null&&f(e,["dynamicRetrievalConfig"],lA(t)),e}function cA(){return{}}function fA(n){const e={},t=c(n,["apiKeyString"]);return t!=null&&f(e,["apiKeyString"],t),e}function dA(n){const e={},t=c(n,["apiKeyConfig"]);t!=null&&f(e,["apiKeyConfig"],fA(t));const i=c(n,["authType"]);i!=null&&f(e,["authType"],i);const r=c(n,["googleServiceAccountConfig"]);r!=null&&f(e,["googleServiceAccountConfig"],r);const a=c(n,["httpBasicAuthConfig"]);a!=null&&f(e,["httpBasicAuthConfig"],a);const u=c(n,["oauthConfig"]);u!=null&&f(e,["oauthConfig"],u);const h=c(n,["oidcConfig"]);return h!=null&&f(e,["oidcConfig"],h),e}function hA(n){const e={},t=c(n,["authConfig"]);return t!=null&&f(e,["authConfig"],dA(t)),e}function mA(){return{}}function pA(n){const e={},t=c(n,["functionDeclarations"]);if(t!=null){let T=t;Array.isArray(T)&&(T=T.map(x=>oA(x))),f(e,["functionDeclarations"],T)}const i=c(n,["retrieval"]);i!=null&&f(e,["retrieval"],i);const r=c(n,["googleSearch"]);r!=null&&f(e,["googleSearch"],aA(r));const a=c(n,["googleSearchRetrieval"]);a!=null&&f(e,["googleSearchRetrieval"],uA(a)),c(n,["enterpriseWebSearch"])!=null&&f(e,["enterpriseWebSearch"],cA());const h=c(n,["googleMaps"]);h!=null&&f(e,["googleMaps"],hA(h)),c(n,["urlContext"])!=null&&f(e,["urlContext"],mA());const p=c(n,["codeExecution"]);p!=null&&f(e,["codeExecution"],p);const y=c(n,["computerUse"]);return y!=null&&f(e,["computerUse"],y),e}function gA(n){const e={},t=c(n,["handle"]);t!=null&&f(e,["handle"],t);const i=c(n,["transparent"]);return i!=null&&f(e,["transparent"],i),e}function Mg(){return{}}function yA(n){const e={},t=c(n,["disabled"]);t!=null&&f(e,["disabled"],t);const i=c(n,["startOfSpeechSensitivity"]);i!=null&&f(e,["startOfSpeechSensitivity"],i);const r=c(n,["endOfSpeechSensitivity"]);r!=null&&f(e,["endOfSpeechSensitivity"],r);const a=c(n,["prefixPaddingMs"]);a!=null&&f(e,["prefixPaddingMs"],a);const u=c(n,["silenceDurationMs"]);return u!=null&&f(e,["silenceDurationMs"],u),e}function vA(n){const e={},t=c(n,["automaticActivityDetection"]);t!=null&&f(e,["automaticActivityDetection"],yA(t));const i=c(n,["activityHandling"]);i!=null&&f(e,["activityHandling"],i);const r=c(n,["turnCoverage"]);return r!=null&&f(e,["turnCoverage"],r),e}function TA(n){const e={},t=c(n,["targetTokens"]);return t!=null&&f(e,["targetTokens"],t),e}function SA(n){const e={},t=c(n,["triggerTokens"]);t!=null&&f(e,["triggerTokens"],t);const i=c(n,["slidingWindow"]);return i!=null&&f(e,["slidingWindow"],TA(i)),e}function xA(n){const e={},t=c(n,["proactiveAudio"]);return t!=null&&f(e,["proactiveAudio"],t),e}function _A(n,e){const t={},i=c(n,["generationConfig"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig"],i);const r=c(n,["responseModalities"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig","responseModalities"],r);const a=c(n,["temperature"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","temperature"],a);const u=c(n,["topP"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","topP"],u);const h=c(n,["topK"]);e!==void 0&&h!=null&&f(e,["setup","generationConfig","topK"],h);const m=c(n,["maxOutputTokens"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","maxOutputTokens"],m);const p=c(n,["mediaResolution"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","mediaResolution"],p);const y=c(n,["seed"]);e!==void 0&&y!=null&&f(e,["setup","generationConfig","seed"],y);const T=c(n,["speechConfig"]);e!==void 0&&T!=null&&f(e,["setup","generationConfig","speechConfig"],ZE(lf(T)));const x=c(n,["enableAffectiveDialog"]);e!==void 0&&x!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],x);const C=c(n,["systemInstruction"]);e!==void 0&&C!=null&&f(e,["setup","systemInstruction"],sA(ht(C)));const A=c(n,["tools"]);if(e!==void 0&&A!=null){let O=Us(A);Array.isArray(O)&&(O=O.map(K=>pA(Ds(K)))),f(e,["setup","tools"],O)}const R=c(n,["sessionResumption"]);e!==void 0&&R!=null&&f(e,["setup","sessionResumption"],gA(R));const k=c(n,["inputAudioTranscription"]);e!==void 0&&k!=null&&f(e,["setup","inputAudioTranscription"],Mg());const B=c(n,["outputAudioTranscription"]);e!==void 0&&B!=null&&f(e,["setup","outputAudioTranscription"],Mg());const F=c(n,["realtimeInputConfig"]);e!==void 0&&F!=null&&f(e,["setup","realtimeInputConfig"],vA(F));const N=c(n,["contextWindowCompression"]);e!==void 0&&N!=null&&f(e,["setup","contextWindowCompression"],SA(N));const q=c(n,["proactivity"]);return e!==void 0&&q!=null&&f(e,["setup","proactivity"],xA(q)),t}function CA(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["setup","model"],Me(n,i));const r=c(e,["config"]);return r!=null&&f(t,["config"],_A(r,t)),t}function EA(){return{}}function AA(){return{}}function wA(n){const e={},t=c(n,["media"]);t!=null&&f(e,["mediaChunks"],By(t));const i=c(n,["audio"]);i!=null&&f(e,["audio"],qy(i));const r=c(n,["audioStreamEnd"]);r!=null&&f(e,["audioStreamEnd"],r);const a=c(n,["video"]);a!=null&&f(e,["video"],Vy(a));const u=c(n,["text"]);return u!=null&&f(e,["text"],u),c(n,["activityStart"])!=null&&f(e,["activityStart"],EA()),c(n,["activityEnd"])!=null&&f(e,["activityEnd"],AA()),e}function bA(){return{}}function RA(n){const e={},t=c(n,["fps"]);t!=null&&f(e,["fps"],t);const i=c(n,["endOffset"]);i!=null&&f(e,["endOffset"],i);const r=c(n,["startOffset"]);return r!=null&&f(e,["startOffset"],r),e}function MA(n){const e={},t=c(n,["data"]);t!=null&&f(e,["data"],t);const i=c(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function NA(n){const e={},t=c(n,["fileUri"]);t!=null&&f(e,["fileUri"],t);const i=c(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function kA(n){const e={},t=c(n,["videoMetadata"]);t!=null&&f(e,["videoMetadata"],RA(t));const i=c(n,["thought"]);i!=null&&f(e,["thought"],i);const r=c(n,["inlineData"]);r!=null&&f(e,["inlineData"],MA(r));const a=c(n,["fileData"]);a!=null&&f(e,["fileData"],NA(a));const u=c(n,["thoughtSignature"]);u!=null&&f(e,["thoughtSignature"],u);const h=c(n,["codeExecutionResult"]);h!=null&&f(e,["codeExecutionResult"],h);const m=c(n,["executableCode"]);m!=null&&f(e,["executableCode"],m);const p=c(n,["functionCall"]);p!=null&&f(e,["functionCall"],p);const y=c(n,["functionResponse"]);y!=null&&f(e,["functionResponse"],y);const T=c(n,["text"]);return T!=null&&f(e,["text"],T),e}function IA(n){const e={},t=c(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>kA(a))),f(e,["parts"],r)}const i=c(n,["role"]);return i!=null&&f(e,["role"],i),e}function Ng(n){const e={},t=c(n,["text"]);t!=null&&f(e,["text"],t);const i=c(n,["finished"]);return i!=null&&f(e,["finished"],i),e}function DA(n){const e={},t=c(n,["retrievedUrl"]);t!=null&&f(e,["retrievedUrl"],t);const i=c(n,["urlRetrievalStatus"]);return i!=null&&f(e,["urlRetrievalStatus"],i),e}function UA(n){const e={},t=c(n,["urlMetadata"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>DA(r))),f(e,["urlMetadata"],i)}return e}function LA(n){const e={},t=c(n,["modelTurn"]);t!=null&&f(e,["modelTurn"],IA(t));const i=c(n,["turnComplete"]);i!=null&&f(e,["turnComplete"],i);const r=c(n,["interrupted"]);r!=null&&f(e,["interrupted"],r);const a=c(n,["groundingMetadata"]);a!=null&&f(e,["groundingMetadata"],a);const u=c(n,["generationComplete"]);u!=null&&f(e,["generationComplete"],u);const h=c(n,["inputTranscription"]);h!=null&&f(e,["inputTranscription"],Ng(h));const m=c(n,["outputTranscription"]);m!=null&&f(e,["outputTranscription"],Ng(m));const p=c(n,["urlContextMetadata"]);return p!=null&&f(e,["urlContextMetadata"],UA(p)),e}function PA(n){const e={},t=c(n,["id"]);t!=null&&f(e,["id"],t);const i=c(n,["args"]);i!=null&&f(e,["args"],i);const r=c(n,["name"]);return r!=null&&f(e,["name"],r),e}function HA(n){const e={},t=c(n,["functionCalls"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>PA(r))),f(e,["functionCalls"],i)}return e}function OA(n){const e={},t=c(n,["ids"]);return t!=null&&f(e,["ids"],t),e}function xa(n){const e={},t=c(n,["modality"]);t!=null&&f(e,["modality"],t);const i=c(n,["tokenCount"]);return i!=null&&f(e,["tokenCount"],i),e}function BA(n){const e={},t=c(n,["promptTokenCount"]);t!=null&&f(e,["promptTokenCount"],t);const i=c(n,["cachedContentTokenCount"]);i!=null&&f(e,["cachedContentTokenCount"],i);const r=c(n,["responseTokenCount"]);r!=null&&f(e,["responseTokenCount"],r);const a=c(n,["toolUsePromptTokenCount"]);a!=null&&f(e,["toolUsePromptTokenCount"],a);const u=c(n,["thoughtsTokenCount"]);u!=null&&f(e,["thoughtsTokenCount"],u);const h=c(n,["totalTokenCount"]);h!=null&&f(e,["totalTokenCount"],h);const m=c(n,["promptTokensDetails"]);if(m!=null){let x=m;Array.isArray(x)&&(x=x.map(C=>xa(C))),f(e,["promptTokensDetails"],x)}const p=c(n,["cacheTokensDetails"]);if(p!=null){let x=p;Array.isArray(x)&&(x=x.map(C=>xa(C))),f(e,["cacheTokensDetails"],x)}const y=c(n,["responseTokensDetails"]);if(y!=null){let x=y;Array.isArray(x)&&(x=x.map(C=>xa(C))),f(e,["responseTokensDetails"],x)}const T=c(n,["toolUsePromptTokensDetails"]);if(T!=null){let x=T;Array.isArray(x)&&(x=x.map(C=>xa(C))),f(e,["toolUsePromptTokensDetails"],x)}return e}function VA(n){const e={},t=c(n,["timeLeft"]);return t!=null&&f(e,["timeLeft"],t),e}function qA(n){const e={},t=c(n,["newHandle"]);t!=null&&f(e,["newHandle"],t);const i=c(n,["resumable"]);i!=null&&f(e,["resumable"],i);const r=c(n,["lastConsumedClientMessageIndex"]);return r!=null&&f(e,["lastConsumedClientMessageIndex"],r),e}function GA(n){const e={};c(n,["setupComplete"])!=null&&f(e,["setupComplete"],bA());const i=c(n,["serverContent"]);i!=null&&f(e,["serverContent"],LA(i));const r=c(n,["toolCall"]);r!=null&&f(e,["toolCall"],HA(r));const a=c(n,["toolCallCancellation"]);a!=null&&f(e,["toolCallCancellation"],OA(a));const u=c(n,["usageMetadata"]);u!=null&&f(e,["usageMetadata"],BA(u));const h=c(n,["goAway"]);h!=null&&f(e,["goAway"],VA(h));const m=c(n,["sessionResumptionUpdate"]);return m!=null&&f(e,["sessionResumptionUpdate"],qA(m)),e}function zA(){return{}}function $A(n){const e={},t=c(n,["text"]);t!=null&&f(e,["text"],t);const i=c(n,["weight"]);return i!=null&&f(e,["weight"],i),e}function FA(n){const e={},t=c(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>$A(r))),f(e,["weightedPrompts"],i)}return e}function YA(n){const e={},t=c(n,["temperature"]);t!=null&&f(e,["temperature"],t);const i=c(n,["topK"]);i!=null&&f(e,["topK"],i);const r=c(n,["seed"]);r!=null&&f(e,["seed"],r);const a=c(n,["guidance"]);a!=null&&f(e,["guidance"],a);const u=c(n,["bpm"]);u!=null&&f(e,["bpm"],u);const h=c(n,["density"]);h!=null&&f(e,["density"],h);const m=c(n,["brightness"]);m!=null&&f(e,["brightness"],m);const p=c(n,["scale"]);p!=null&&f(e,["scale"],p);const y=c(n,["muteBass"]);y!=null&&f(e,["muteBass"],y);const T=c(n,["muteDrums"]);T!=null&&f(e,["muteDrums"],T);const x=c(n,["onlyBassAndDrums"]);x!=null&&f(e,["onlyBassAndDrums"],x);const C=c(n,["musicGenerationMode"]);return C!=null&&f(e,["musicGenerationMode"],C),e}function JA(n){const e={},t=c(n,["clientContent"]);t!=null&&f(e,["clientContent"],FA(t));const i=c(n,["musicGenerationConfig"]);return i!=null&&f(e,["musicGenerationConfig"],YA(i)),e}function jA(n){const e={},t=c(n,["data"]);t!=null&&f(e,["data"],t);const i=c(n,["mimeType"]);i!=null&&f(e,["mimeType"],i);const r=c(n,["sourceMetadata"]);return r!=null&&f(e,["sourceMetadata"],JA(r)),e}function KA(n){const e={},t=c(n,["audioChunks"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>jA(r))),f(e,["audioChunks"],i)}return e}function WA(n){const e={},t=c(n,["text"]);t!=null&&f(e,["text"],t);const i=c(n,["filteredReason"]);return i!=null&&f(e,["filteredReason"],i),e}function QA(n){const e={};c(n,["setupComplete"])!=null&&f(e,["setupComplete"],zA());const i=c(n,["serverContent"]);i!=null&&f(e,["serverContent"],KA(i));const r=c(n,["filteredPrompt"]);return r!=null&&f(e,["filteredPrompt"],WA(r)),e}function XA(n){const e={},t=c(n,["sessionId"]);return t!=null&&f(e,["sessionId"],t),e}function ZA(n){const e={},t=c(n,["fps"]);t!=null&&f(e,["fps"],t);const i=c(n,["endOffset"]);i!=null&&f(e,["endOffset"],i);const r=c(n,["startOffset"]);return r!=null&&f(e,["startOffset"],r),e}function ew(n){const e={},t=c(n,["displayName"]);t!=null&&f(e,["displayName"],t);const i=c(n,["data"]);i!=null&&f(e,["data"],i);const r=c(n,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function tw(n){const e={},t=c(n,["displayName"]);t!=null&&f(e,["displayName"],t);const i=c(n,["fileUri"]);i!=null&&f(e,["fileUri"],i);const r=c(n,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function nw(n){const e={},t=c(n,["videoMetadata"]);t!=null&&f(e,["videoMetadata"],ZA(t));const i=c(n,["thought"]);i!=null&&f(e,["thought"],i);const r=c(n,["inlineData"]);r!=null&&f(e,["inlineData"],ew(r));const a=c(n,["fileData"]);a!=null&&f(e,["fileData"],tw(a));const u=c(n,["thoughtSignature"]);u!=null&&f(e,["thoughtSignature"],u);const h=c(n,["codeExecutionResult"]);h!=null&&f(e,["codeExecutionResult"],h);const m=c(n,["executableCode"]);m!=null&&f(e,["executableCode"],m);const p=c(n,["functionCall"]);p!=null&&f(e,["functionCall"],p);const y=c(n,["functionResponse"]);y!=null&&f(e,["functionResponse"],y);const T=c(n,["text"]);return T!=null&&f(e,["text"],T),e}function iw(n){const e={},t=c(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>nw(a))),f(e,["parts"],r)}const i=c(n,["role"]);return i!=null&&f(e,["role"],i),e}function kg(n){const e={},t=c(n,["text"]);t!=null&&f(e,["text"],t);const i=c(n,["finished"]);return i!=null&&f(e,["finished"],i),e}function sw(n){const e={},t=c(n,["modelTurn"]);t!=null&&f(e,["modelTurn"],iw(t));const i=c(n,["turnComplete"]);i!=null&&f(e,["turnComplete"],i);const r=c(n,["interrupted"]);r!=null&&f(e,["interrupted"],r);const a=c(n,["groundingMetadata"]);a!=null&&f(e,["groundingMetadata"],a);const u=c(n,["generationComplete"]);u!=null&&f(e,["generationComplete"],u);const h=c(n,["inputTranscription"]);h!=null&&f(e,["inputTranscription"],kg(h));const m=c(n,["outputTranscription"]);return m!=null&&f(e,["outputTranscription"],kg(m)),e}function ow(n){const e={},t=c(n,["args"]);t!=null&&f(e,["args"],t);const i=c(n,["name"]);return i!=null&&f(e,["name"],i),e}function rw(n){const e={},t=c(n,["functionCalls"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>ow(r))),f(e,["functionCalls"],i)}return e}function aw(n){const e={},t=c(n,["ids"]);return t!=null&&f(e,["ids"],t),e}function _a(n){const e={},t=c(n,["modality"]);t!=null&&f(e,["modality"],t);const i=c(n,["tokenCount"]);return i!=null&&f(e,["tokenCount"],i),e}function lw(n){const e={},t=c(n,["promptTokenCount"]);t!=null&&f(e,["promptTokenCount"],t);const i=c(n,["cachedContentTokenCount"]);i!=null&&f(e,["cachedContentTokenCount"],i);const r=c(n,["candidatesTokenCount"]);r!=null&&f(e,["responseTokenCount"],r);const a=c(n,["toolUsePromptTokenCount"]);a!=null&&f(e,["toolUsePromptTokenCount"],a);const u=c(n,["thoughtsTokenCount"]);u!=null&&f(e,["thoughtsTokenCount"],u);const h=c(n,["totalTokenCount"]);h!=null&&f(e,["totalTokenCount"],h);const m=c(n,["promptTokensDetails"]);if(m!=null){let C=m;Array.isArray(C)&&(C=C.map(A=>_a(A))),f(e,["promptTokensDetails"],C)}const p=c(n,["cacheTokensDetails"]);if(p!=null){let C=p;Array.isArray(C)&&(C=C.map(A=>_a(A))),f(e,["cacheTokensDetails"],C)}const y=c(n,["candidatesTokensDetails"]);if(y!=null){let C=y;Array.isArray(C)&&(C=C.map(A=>_a(A))),f(e,["responseTokensDetails"],C)}const T=c(n,["toolUsePromptTokensDetails"]);if(T!=null){let C=T;Array.isArray(C)&&(C=C.map(A=>_a(A))),f(e,["toolUsePromptTokensDetails"],C)}const x=c(n,["trafficType"]);return x!=null&&f(e,["trafficType"],x),e}function uw(n){const e={},t=c(n,["timeLeft"]);return t!=null&&f(e,["timeLeft"],t),e}function cw(n){const e={},t=c(n,["newHandle"]);t!=null&&f(e,["newHandle"],t);const i=c(n,["resumable"]);i!=null&&f(e,["resumable"],i);const r=c(n,["lastConsumedClientMessageIndex"]);return r!=null&&f(e,["lastConsumedClientMessageIndex"],r),e}function fw(n){const e={},t=c(n,["setupComplete"]);t!=null&&f(e,["setupComplete"],XA(t));const i=c(n,["serverContent"]);i!=null&&f(e,["serverContent"],sw(i));const r=c(n,["toolCall"]);r!=null&&f(e,["toolCall"],rw(r));const a=c(n,["toolCallCancellation"]);a!=null&&f(e,["toolCallCancellation"],aw(a));const u=c(n,["usageMetadata"]);u!=null&&f(e,["usageMetadata"],lw(u));const h=c(n,["goAway"]);h!=null&&f(e,["goAway"],uw(h));const m=c(n,["sessionResumptionUpdate"]);return m!=null&&f(e,["sessionResumptionUpdate"],cw(m)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dw(n){const e={},t=c(n,["fps"]);t!=null&&f(e,["fps"],t);const i=c(n,["endOffset"]);i!=null&&f(e,["endOffset"],i);const r=c(n,["startOffset"]);return r!=null&&f(e,["startOffset"],r),e}function hw(n){const e={};if(c(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=c(n,["data"]);t!=null&&f(e,["data"],t);const i=c(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function mw(n){const e={};if(c(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=c(n,["fileUri"]);t!=null&&f(e,["fileUri"],t);const i=c(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function pw(n){const e={},t=c(n,["videoMetadata"]);t!=null&&f(e,["videoMetadata"],dw(t));const i=c(n,["thought"]);i!=null&&f(e,["thought"],i);const r=c(n,["inlineData"]);r!=null&&f(e,["inlineData"],hw(r));const a=c(n,["fileData"]);a!=null&&f(e,["fileData"],mw(a));const u=c(n,["thoughtSignature"]);u!=null&&f(e,["thoughtSignature"],u);const h=c(n,["codeExecutionResult"]);h!=null&&f(e,["codeExecutionResult"],h);const m=c(n,["executableCode"]);m!=null&&f(e,["executableCode"],m);const p=c(n,["functionCall"]);p!=null&&f(e,["functionCall"],p);const y=c(n,["functionResponse"]);y!=null&&f(e,["functionResponse"],y);const T=c(n,["text"]);return T!=null&&f(e,["text"],T),e}function $a(n){const e={},t=c(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>pw(a))),f(e,["parts"],r)}const i=c(n,["role"]);return i!=null&&f(e,["role"],i),e}function gw(n){const e={},t=c(n,["anyOf"]);t!=null&&f(e,["anyOf"],t);const i=c(n,["default"]);i!=null&&f(e,["default"],i);const r=c(n,["description"]);r!=null&&f(e,["description"],r);const a=c(n,["enum"]);a!=null&&f(e,["enum"],a);const u=c(n,["example"]);u!=null&&f(e,["example"],u);const h=c(n,["format"]);h!=null&&f(e,["format"],h);const m=c(n,["items"]);m!=null&&f(e,["items"],m);const p=c(n,["maxItems"]);p!=null&&f(e,["maxItems"],p);const y=c(n,["maxLength"]);y!=null&&f(e,["maxLength"],y);const T=c(n,["maxProperties"]);T!=null&&f(e,["maxProperties"],T);const x=c(n,["maximum"]);x!=null&&f(e,["maximum"],x);const C=c(n,["minItems"]);C!=null&&f(e,["minItems"],C);const A=c(n,["minLength"]);A!=null&&f(e,["minLength"],A);const R=c(n,["minProperties"]);R!=null&&f(e,["minProperties"],R);const k=c(n,["minimum"]);k!=null&&f(e,["minimum"],k);const B=c(n,["nullable"]);B!=null&&f(e,["nullable"],B);const F=c(n,["pattern"]);F!=null&&f(e,["pattern"],F);const N=c(n,["properties"]);N!=null&&f(e,["properties"],N);const q=c(n,["propertyOrdering"]);q!=null&&f(e,["propertyOrdering"],q);const O=c(n,["required"]);O!=null&&f(e,["required"],O);const K=c(n,["title"]);K!=null&&f(e,["title"],K);const Q=c(n,["type"]);return Q!=null&&f(e,["type"],Q),e}function yw(n){const e={};if(c(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=c(n,["category"]);t!=null&&f(e,["category"],t);const i=c(n,["threshold"]);return i!=null&&f(e,["threshold"],i),e}function vw(n){const e={},t=c(n,["behavior"]);t!=null&&f(e,["behavior"],t);const i=c(n,["description"]);i!=null&&f(e,["description"],i);const r=c(n,["name"]);r!=null&&f(e,["name"],r);const a=c(n,["parameters"]);a!=null&&f(e,["parameters"],a);const u=c(n,["parametersJsonSchema"]);u!=null&&f(e,["parametersJsonSchema"],u);const h=c(n,["response"]);h!=null&&f(e,["response"],h);const m=c(n,["responseJsonSchema"]);return m!=null&&f(e,["responseJsonSchema"],m),e}function Tw(n){const e={},t=c(n,["startTime"]);t!=null&&f(e,["startTime"],t);const i=c(n,["endTime"]);return i!=null&&f(e,["endTime"],i),e}function Sw(n){const e={},t=c(n,["timeRangeFilter"]);return t!=null&&f(e,["timeRangeFilter"],Tw(t)),e}function xw(n){const e={},t=c(n,["mode"]);t!=null&&f(e,["mode"],t);const i=c(n,["dynamicThreshold"]);return i!=null&&f(e,["dynamicThreshold"],i),e}function _w(n){const e={},t=c(n,["dynamicRetrievalConfig"]);return t!=null&&f(e,["dynamicRetrievalConfig"],xw(t)),e}function Cw(){return{}}function Ew(n){const e={},t=c(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(p=>vw(p))),f(e,["functionDeclarations"],m)}if(c(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=c(n,["googleSearch"]);i!=null&&f(e,["googleSearch"],Sw(i));const r=c(n,["googleSearchRetrieval"]);if(r!=null&&f(e,["googleSearchRetrieval"],_w(r)),c(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(c(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");c(n,["urlContext"])!=null&&f(e,["urlContext"],Cw());const u=c(n,["codeExecution"]);u!=null&&f(e,["codeExecution"],u);const h=c(n,["computerUse"]);return h!=null&&f(e,["computerUse"],h),e}function Aw(n){const e={},t=c(n,["mode"]);t!=null&&f(e,["mode"],t);const i=c(n,["allowedFunctionNames"]);return i!=null&&f(e,["allowedFunctionNames"],i),e}function ww(n){const e={},t=c(n,["latitude"]);t!=null&&f(e,["latitude"],t);const i=c(n,["longitude"]);return i!=null&&f(e,["longitude"],i),e}function bw(n){const e={},t=c(n,["latLng"]);t!=null&&f(e,["latLng"],ww(t));const i=c(n,["languageCode"]);return i!=null&&f(e,["languageCode"],i),e}function Rw(n){const e={},t=c(n,["functionCallingConfig"]);t!=null&&f(e,["functionCallingConfig"],Aw(t));const i=c(n,["retrievalConfig"]);return i!=null&&f(e,["retrievalConfig"],bw(i)),e}function Mw(n){const e={},t=c(n,["voiceName"]);return t!=null&&f(e,["voiceName"],t),e}function rv(n){const e={},t=c(n,["prebuiltVoiceConfig"]);return t!=null&&f(e,["prebuiltVoiceConfig"],Mw(t)),e}function Nw(n){const e={},t=c(n,["speaker"]);t!=null&&f(e,["speaker"],t);const i=c(n,["voiceConfig"]);return i!=null&&f(e,["voiceConfig"],rv(i)),e}function kw(n){const e={},t=c(n,["speakerVoiceConfigs"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>Nw(r))),f(e,["speakerVoiceConfigs"],i)}return e}function Iw(n){const e={},t=c(n,["voiceConfig"]);t!=null&&f(e,["voiceConfig"],rv(t));const i=c(n,["multiSpeakerVoiceConfig"]);i!=null&&f(e,["multiSpeakerVoiceConfig"],kw(i));const r=c(n,["languageCode"]);return r!=null&&f(e,["languageCode"],r),e}function Dw(n){const e={},t=c(n,["includeThoughts"]);t!=null&&f(e,["includeThoughts"],t);const i=c(n,["thinkingBudget"]);return i!=null&&f(e,["thinkingBudget"],i),e}function Uw(n,e,t){const i={},r=c(e,["systemInstruction"]);t!==void 0&&r!=null&&f(t,["systemInstruction"],$a(ht(r)));const a=c(e,["temperature"]);a!=null&&f(i,["temperature"],a);const u=c(e,["topP"]);u!=null&&f(i,["topP"],u);const h=c(e,["topK"]);h!=null&&f(i,["topK"],h);const m=c(e,["candidateCount"]);m!=null&&f(i,["candidateCount"],m);const p=c(e,["maxOutputTokens"]);p!=null&&f(i,["maxOutputTokens"],p);const y=c(e,["stopSequences"]);y!=null&&f(i,["stopSequences"],y);const T=c(e,["responseLogprobs"]);T!=null&&f(i,["responseLogprobs"],T);const x=c(e,["logprobs"]);x!=null&&f(i,["logprobs"],x);const C=c(e,["presencePenalty"]);C!=null&&f(i,["presencePenalty"],C);const A=c(e,["frequencyPenalty"]);A!=null&&f(i,["frequencyPenalty"],A);const R=c(e,["seed"]);R!=null&&f(i,["seed"],R);const k=c(e,["responseMimeType"]);k!=null&&f(i,["responseMimeType"],k);const B=c(e,["responseSchema"]);B!=null&&f(i,["responseSchema"],gw(rf(B)));const F=c(e,["responseJsonSchema"]);if(F!=null&&f(i,["responseJsonSchema"],F),c(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const N=c(e,["safetySettings"]);if(t!==void 0&&N!=null){let ae=N;Array.isArray(ae)&&(ae=ae.map(pe=>yw(pe))),f(t,["safetySettings"],ae)}const q=c(e,["tools"]);if(t!==void 0&&q!=null){let ae=Us(q);Array.isArray(ae)&&(ae=ae.map(pe=>Ew(Ds(pe)))),f(t,["tools"],ae)}const O=c(e,["toolConfig"]);if(t!==void 0&&O!=null&&f(t,["toolConfig"],Rw(O)),c(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const K=c(e,["cachedContent"]);t!==void 0&&K!=null&&f(t,["cachedContent"],xn(n,K));const Q=c(e,["responseModalities"]);Q!=null&&f(i,["responseModalities"],Q);const de=c(e,["mediaResolution"]);de!=null&&f(i,["mediaResolution"],de);const ne=c(e,["speechConfig"]);if(ne!=null&&f(i,["speechConfig"],Iw(af(ne))),c(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const ue=c(e,["thinkingConfig"]);return ue!=null&&f(i,["thinkingConfig"],Dw(ue)),i}function Ig(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["_url","model"],Me(n,i));const r=c(e,["contents"]);if(r!=null){let u=qt(r);Array.isArray(u)&&(u=u.map(h=>$a(h))),f(t,["contents"],u)}const a=c(e,["config"]);return a!=null&&f(t,["generationConfig"],Uw(n,a,t)),t}function Lw(n,e){const t={},i=c(n,["taskType"]);e!==void 0&&i!=null&&f(e,["requests[]","taskType"],i);const r=c(n,["title"]);e!==void 0&&r!=null&&f(e,["requests[]","title"],r);const a=c(n,["outputDimensionality"]);if(e!==void 0&&a!=null&&f(e,["requests[]","outputDimensionality"],a),c(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(c(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function Pw(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["_url","model"],Me(n,i));const r=c(e,["contents"]);r!=null&&f(t,["requests[]","content"],zy(n,r));const a=c(e,["config"]);a!=null&&f(t,["config"],Lw(a,t));const u=c(e,["model"]);return u!==void 0&&f(t,["requests[]","model"],Me(n,u)),t}function Hw(n,e){const t={};if(c(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=c(n,["numberOfImages"]);e!==void 0&&i!=null&&f(e,["parameters","sampleCount"],i);const r=c(n,["aspectRatio"]);e!==void 0&&r!=null&&f(e,["parameters","aspectRatio"],r);const a=c(n,["guidanceScale"]);if(e!==void 0&&a!=null&&f(e,["parameters","guidanceScale"],a),c(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=c(n,["safetyFilterLevel"]);e!==void 0&&u!=null&&f(e,["parameters","safetySetting"],u);const h=c(n,["personGeneration"]);e!==void 0&&h!=null&&f(e,["parameters","personGeneration"],h);const m=c(n,["includeSafetyAttributes"]);e!==void 0&&m!=null&&f(e,["parameters","includeSafetyAttributes"],m);const p=c(n,["includeRaiReason"]);e!==void 0&&p!=null&&f(e,["parameters","includeRaiReason"],p);const y=c(n,["language"]);e!==void 0&&y!=null&&f(e,["parameters","language"],y);const T=c(n,["outputMimeType"]);e!==void 0&&T!=null&&f(e,["parameters","outputOptions","mimeType"],T);const x=c(n,["outputCompressionQuality"]);if(e!==void 0&&x!=null&&f(e,["parameters","outputOptions","compressionQuality"],x),c(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");const C=c(n,["imageSize"]);if(e!==void 0&&C!=null&&f(e,["parameters","sampleImageSize"],C),c(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function Ow(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["_url","model"],Me(n,i));const r=c(e,["prompt"]);r!=null&&f(t,["instances[0]","prompt"],r);const a=c(e,["config"]);return a!=null&&f(t,["config"],Hw(a,t)),t}function Bw(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["_url","name"],Me(n,i));const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function Vw(n,e,t){const i={},r=c(e,["pageSize"]);t!==void 0&&r!=null&&f(t,["_query","pageSize"],r);const a=c(e,["pageToken"]);t!==void 0&&a!=null&&f(t,["_query","pageToken"],a);const u=c(e,["filter"]);t!==void 0&&u!=null&&f(t,["_query","filter"],u);const h=c(e,["queryBase"]);return t!==void 0&&h!=null&&f(t,["_url","models_url"],Yy(n,h)),i}function qw(n,e){const t={},i=c(e,["config"]);return i!=null&&f(t,["config"],Vw(n,i,t)),t}function Gw(n,e){const t={},i=c(n,["displayName"]);e!==void 0&&i!=null&&f(e,["displayName"],i);const r=c(n,["description"]);e!==void 0&&r!=null&&f(e,["description"],r);const a=c(n,["defaultCheckpointId"]);return e!==void 0&&a!=null&&f(e,["defaultCheckpointId"],a),t}function zw(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["_url","name"],Me(n,i));const r=c(e,["config"]);return r!=null&&f(t,["config"],Gw(r,t)),t}function $w(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["_url","name"],Me(n,i));const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function Fw(n){const e={};if(c(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(c(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(c(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function Yw(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["_url","model"],Me(n,i));const r=c(e,["contents"]);if(r!=null){let u=qt(r);Array.isArray(u)&&(u=u.map(h=>$a(h))),f(t,["contents"],u)}const a=c(e,["config"]);return a!=null&&f(t,["config"],Fw(a)),t}function Jw(n){const e={};if(c(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=c(n,["imageBytes"]);t!=null&&f(e,["bytesBase64Encoded"],wi(t));const i=c(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function jw(n,e){const t={},i=c(n,["numberOfVideos"]);if(e!==void 0&&i!=null&&f(e,["parameters","sampleCount"],i),c(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const r=c(n,["durationSeconds"]);if(e!==void 0&&r!=null&&f(e,["parameters","durationSeconds"],r),c(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=c(n,["aspectRatio"]);if(e!==void 0&&a!=null&&f(e,["parameters","aspectRatio"],a),c(n,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const u=c(n,["personGeneration"]);if(e!==void 0&&u!=null&&f(e,["parameters","personGeneration"],u),c(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const h=c(n,["negativePrompt"]);e!==void 0&&h!=null&&f(e,["parameters","negativePrompt"],h);const m=c(n,["enhancePrompt"]);if(e!==void 0&&m!=null&&f(e,["parameters","enhancePrompt"],m),c(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(c(n,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");if(c(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function Kw(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["_url","model"],Me(n,i));const r=c(e,["prompt"]);r!=null&&f(t,["instances[0]","prompt"],r);const a=c(e,["image"]);if(a!=null&&f(t,["instances[0]","image"],Jw(a)),c(e,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const u=c(e,["config"]);return u!=null&&f(t,["config"],jw(u,t)),t}function Ww(n){const e={},t=c(n,["fps"]);t!=null&&f(e,["fps"],t);const i=c(n,["endOffset"]);i!=null&&f(e,["endOffset"],i);const r=c(n,["startOffset"]);return r!=null&&f(e,["startOffset"],r),e}function Qw(n){const e={},t=c(n,["displayName"]);t!=null&&f(e,["displayName"],t);const i=c(n,["data"]);i!=null&&f(e,["data"],i);const r=c(n,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function Xw(n){const e={},t=c(n,["displayName"]);t!=null&&f(e,["displayName"],t);const i=c(n,["fileUri"]);i!=null&&f(e,["fileUri"],i);const r=c(n,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function Zw(n){const e={},t=c(n,["videoMetadata"]);t!=null&&f(e,["videoMetadata"],Ww(t));const i=c(n,["thought"]);i!=null&&f(e,["thought"],i);const r=c(n,["inlineData"]);r!=null&&f(e,["inlineData"],Qw(r));const a=c(n,["fileData"]);a!=null&&f(e,["fileData"],Xw(a));const u=c(n,["thoughtSignature"]);u!=null&&f(e,["thoughtSignature"],u);const h=c(n,["codeExecutionResult"]);h!=null&&f(e,["codeExecutionResult"],h);const m=c(n,["executableCode"]);m!=null&&f(e,["executableCode"],m);const p=c(n,["functionCall"]);p!=null&&f(e,["functionCall"],p);const y=c(n,["functionResponse"]);y!=null&&f(e,["functionResponse"],y);const T=c(n,["text"]);return T!=null&&f(e,["text"],T),e}function Ps(n){const e={},t=c(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>Zw(a))),f(e,["parts"],r)}const i=c(n,["role"]);return i!=null&&f(e,["role"],i),e}function eb(n){const e={},t=c(n,["anyOf"]);t!=null&&f(e,["anyOf"],t);const i=c(n,["default"]);i!=null&&f(e,["default"],i);const r=c(n,["description"]);r!=null&&f(e,["description"],r);const a=c(n,["enum"]);a!=null&&f(e,["enum"],a);const u=c(n,["example"]);u!=null&&f(e,["example"],u);const h=c(n,["format"]);h!=null&&f(e,["format"],h);const m=c(n,["items"]);m!=null&&f(e,["items"],m);const p=c(n,["maxItems"]);p!=null&&f(e,["maxItems"],p);const y=c(n,["maxLength"]);y!=null&&f(e,["maxLength"],y);const T=c(n,["maxProperties"]);T!=null&&f(e,["maxProperties"],T);const x=c(n,["maximum"]);x!=null&&f(e,["maximum"],x);const C=c(n,["minItems"]);C!=null&&f(e,["minItems"],C);const A=c(n,["minLength"]);A!=null&&f(e,["minLength"],A);const R=c(n,["minProperties"]);R!=null&&f(e,["minProperties"],R);const k=c(n,["minimum"]);k!=null&&f(e,["minimum"],k);const B=c(n,["nullable"]);B!=null&&f(e,["nullable"],B);const F=c(n,["pattern"]);F!=null&&f(e,["pattern"],F);const N=c(n,["properties"]);N!=null&&f(e,["properties"],N);const q=c(n,["propertyOrdering"]);q!=null&&f(e,["propertyOrdering"],q);const O=c(n,["required"]);O!=null&&f(e,["required"],O);const K=c(n,["title"]);K!=null&&f(e,["title"],K);const Q=c(n,["type"]);return Q!=null&&f(e,["type"],Q),e}function tb(n){const e={},t=c(n,["featureSelectionPreference"]);return t!=null&&f(e,["featureSelectionPreference"],t),e}function nb(n){const e={},t=c(n,["method"]);t!=null&&f(e,["method"],t);const i=c(n,["category"]);i!=null&&f(e,["category"],i);const r=c(n,["threshold"]);return r!=null&&f(e,["threshold"],r),e}function ib(n){const e={};if(c(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=c(n,["description"]);t!=null&&f(e,["description"],t);const i=c(n,["name"]);i!=null&&f(e,["name"],i);const r=c(n,["parameters"]);r!=null&&f(e,["parameters"],r);const a=c(n,["parametersJsonSchema"]);a!=null&&f(e,["parametersJsonSchema"],a);const u=c(n,["response"]);u!=null&&f(e,["response"],u);const h=c(n,["responseJsonSchema"]);return h!=null&&f(e,["responseJsonSchema"],h),e}function sb(n){const e={},t=c(n,["startTime"]);t!=null&&f(e,["startTime"],t);const i=c(n,["endTime"]);return i!=null&&f(e,["endTime"],i),e}function ob(n){const e={},t=c(n,["timeRangeFilter"]);return t!=null&&f(e,["timeRangeFilter"],sb(t)),e}function rb(n){const e={},t=c(n,["mode"]);t!=null&&f(e,["mode"],t);const i=c(n,["dynamicThreshold"]);return i!=null&&f(e,["dynamicThreshold"],i),e}function ab(n){const e={},t=c(n,["dynamicRetrievalConfig"]);return t!=null&&f(e,["dynamicRetrievalConfig"],rb(t)),e}function lb(){return{}}function ub(n){const e={},t=c(n,["apiKeyString"]);return t!=null&&f(e,["apiKeyString"],t),e}function cb(n){const e={},t=c(n,["apiKeyConfig"]);t!=null&&f(e,["apiKeyConfig"],ub(t));const i=c(n,["authType"]);i!=null&&f(e,["authType"],i);const r=c(n,["googleServiceAccountConfig"]);r!=null&&f(e,["googleServiceAccountConfig"],r);const a=c(n,["httpBasicAuthConfig"]);a!=null&&f(e,["httpBasicAuthConfig"],a);const u=c(n,["oauthConfig"]);u!=null&&f(e,["oauthConfig"],u);const h=c(n,["oidcConfig"]);return h!=null&&f(e,["oidcConfig"],h),e}function fb(n){const e={},t=c(n,["authConfig"]);return t!=null&&f(e,["authConfig"],cb(t)),e}function db(){return{}}function av(n){const e={},t=c(n,["functionDeclarations"]);if(t!=null){let T=t;Array.isArray(T)&&(T=T.map(x=>ib(x))),f(e,["functionDeclarations"],T)}const i=c(n,["retrieval"]);i!=null&&f(e,["retrieval"],i);const r=c(n,["googleSearch"]);r!=null&&f(e,["googleSearch"],ob(r));const a=c(n,["googleSearchRetrieval"]);a!=null&&f(e,["googleSearchRetrieval"],ab(a)),c(n,["enterpriseWebSearch"])!=null&&f(e,["enterpriseWebSearch"],lb());const h=c(n,["googleMaps"]);h!=null&&f(e,["googleMaps"],fb(h)),c(n,["urlContext"])!=null&&f(e,["urlContext"],db());const p=c(n,["codeExecution"]);p!=null&&f(e,["codeExecution"],p);const y=c(n,["computerUse"]);return y!=null&&f(e,["computerUse"],y),e}function hb(n){const e={},t=c(n,["mode"]);t!=null&&f(e,["mode"],t);const i=c(n,["allowedFunctionNames"]);return i!=null&&f(e,["allowedFunctionNames"],i),e}function mb(n){const e={},t=c(n,["latitude"]);t!=null&&f(e,["latitude"],t);const i=c(n,["longitude"]);return i!=null&&f(e,["longitude"],i),e}function pb(n){const e={},t=c(n,["latLng"]);t!=null&&f(e,["latLng"],mb(t));const i=c(n,["languageCode"]);return i!=null&&f(e,["languageCode"],i),e}function gb(n){const e={},t=c(n,["functionCallingConfig"]);t!=null&&f(e,["functionCallingConfig"],hb(t));const i=c(n,["retrievalConfig"]);return i!=null&&f(e,["retrievalConfig"],pb(i)),e}function yb(n){const e={},t=c(n,["voiceName"]);return t!=null&&f(e,["voiceName"],t),e}function vb(n){const e={},t=c(n,["prebuiltVoiceConfig"]);return t!=null&&f(e,["prebuiltVoiceConfig"],yb(t)),e}function Tb(n){const e={},t=c(n,["voiceConfig"]);if(t!=null&&f(e,["voiceConfig"],vb(t)),c(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=c(n,["languageCode"]);return i!=null&&f(e,["languageCode"],i),e}function Sb(n){const e={},t=c(n,["includeThoughts"]);t!=null&&f(e,["includeThoughts"],t);const i=c(n,["thinkingBudget"]);return i!=null&&f(e,["thinkingBudget"],i),e}function xb(n,e,t){const i={},r=c(e,["systemInstruction"]);t!==void 0&&r!=null&&f(t,["systemInstruction"],Ps(ht(r)));const a=c(e,["temperature"]);a!=null&&f(i,["temperature"],a);const u=c(e,["topP"]);u!=null&&f(i,["topP"],u);const h=c(e,["topK"]);h!=null&&f(i,["topK"],h);const m=c(e,["candidateCount"]);m!=null&&f(i,["candidateCount"],m);const p=c(e,["maxOutputTokens"]);p!=null&&f(i,["maxOutputTokens"],p);const y=c(e,["stopSequences"]);y!=null&&f(i,["stopSequences"],y);const T=c(e,["responseLogprobs"]);T!=null&&f(i,["responseLogprobs"],T);const x=c(e,["logprobs"]);x!=null&&f(i,["logprobs"],x);const C=c(e,["presencePenalty"]);C!=null&&f(i,["presencePenalty"],C);const A=c(e,["frequencyPenalty"]);A!=null&&f(i,["frequencyPenalty"],A);const R=c(e,["seed"]);R!=null&&f(i,["seed"],R);const k=c(e,["responseMimeType"]);k!=null&&f(i,["responseMimeType"],k);const B=c(e,["responseSchema"]);B!=null&&f(i,["responseSchema"],eb(rf(B)));const F=c(e,["responseJsonSchema"]);F!=null&&f(i,["responseJsonSchema"],F);const N=c(e,["routingConfig"]);N!=null&&f(i,["routingConfig"],N);const q=c(e,["modelSelectionConfig"]);q!=null&&f(i,["modelConfig"],tb(q));const O=c(e,["safetySettings"]);if(t!==void 0&&O!=null){let W=O;Array.isArray(W)&&(W=W.map(U=>nb(U))),f(t,["safetySettings"],W)}const K=c(e,["tools"]);if(t!==void 0&&K!=null){let W=Us(K);Array.isArray(W)&&(W=W.map(U=>av(Ds(U)))),f(t,["tools"],W)}const Q=c(e,["toolConfig"]);t!==void 0&&Q!=null&&f(t,["toolConfig"],gb(Q));const de=c(e,["labels"]);t!==void 0&&de!=null&&f(t,["labels"],de);const ne=c(e,["cachedContent"]);t!==void 0&&ne!=null&&f(t,["cachedContent"],xn(n,ne));const ue=c(e,["responseModalities"]);ue!=null&&f(i,["responseModalities"],ue);const ae=c(e,["mediaResolution"]);ae!=null&&f(i,["mediaResolution"],ae);const pe=c(e,["speechConfig"]);pe!=null&&f(i,["speechConfig"],Tb(af(pe)));const xe=c(e,["audioTimestamp"]);xe!=null&&f(i,["audioTimestamp"],xe);const ve=c(e,["thinkingConfig"]);return ve!=null&&f(i,["thinkingConfig"],Sb(ve)),i}function Dg(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["_url","model"],Me(n,i));const r=c(e,["contents"]);if(r!=null){let u=qt(r);Array.isArray(u)&&(u=u.map(h=>Ps(h))),f(t,["contents"],u)}const a=c(e,["config"]);return a!=null&&f(t,["generationConfig"],xb(n,a,t)),t}function _b(n,e){const t={},i=c(n,["taskType"]);e!==void 0&&i!=null&&f(e,["instances[]","task_type"],i);const r=c(n,["title"]);e!==void 0&&r!=null&&f(e,["instances[]","title"],r);const a=c(n,["outputDimensionality"]);e!==void 0&&a!=null&&f(e,["parameters","outputDimensionality"],a);const u=c(n,["mimeType"]);e!==void 0&&u!=null&&f(e,["instances[]","mimeType"],u);const h=c(n,["autoTruncate"]);return e!==void 0&&h!=null&&f(e,["parameters","autoTruncate"],h),t}function Cb(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["_url","model"],Me(n,i));const r=c(e,["contents"]);r!=null&&f(t,["instances[]","content"],zy(n,r));const a=c(e,["config"]);return a!=null&&f(t,["config"],_b(a,t)),t}function Eb(n,e){const t={},i=c(n,["outputGcsUri"]);e!==void 0&&i!=null&&f(e,["parameters","storageUri"],i);const r=c(n,["negativePrompt"]);e!==void 0&&r!=null&&f(e,["parameters","negativePrompt"],r);const a=c(n,["numberOfImages"]);e!==void 0&&a!=null&&f(e,["parameters","sampleCount"],a);const u=c(n,["aspectRatio"]);e!==void 0&&u!=null&&f(e,["parameters","aspectRatio"],u);const h=c(n,["guidanceScale"]);e!==void 0&&h!=null&&f(e,["parameters","guidanceScale"],h);const m=c(n,["seed"]);e!==void 0&&m!=null&&f(e,["parameters","seed"],m);const p=c(n,["safetyFilterLevel"]);e!==void 0&&p!=null&&f(e,["parameters","safetySetting"],p);const y=c(n,["personGeneration"]);e!==void 0&&y!=null&&f(e,["parameters","personGeneration"],y);const T=c(n,["includeSafetyAttributes"]);e!==void 0&&T!=null&&f(e,["parameters","includeSafetyAttributes"],T);const x=c(n,["includeRaiReason"]);e!==void 0&&x!=null&&f(e,["parameters","includeRaiReason"],x);const C=c(n,["language"]);e!==void 0&&C!=null&&f(e,["parameters","language"],C);const A=c(n,["outputMimeType"]);e!==void 0&&A!=null&&f(e,["parameters","outputOptions","mimeType"],A);const R=c(n,["outputCompressionQuality"]);e!==void 0&&R!=null&&f(e,["parameters","outputOptions","compressionQuality"],R);const k=c(n,["addWatermark"]);e!==void 0&&k!=null&&f(e,["parameters","addWatermark"],k);const B=c(n,["imageSize"]);e!==void 0&&B!=null&&f(e,["parameters","sampleImageSize"],B);const F=c(n,["enhancePrompt"]);return e!==void 0&&F!=null&&f(e,["parameters","enhancePrompt"],F),t}function Ab(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["_url","model"],Me(n,i));const r=c(e,["prompt"]);r!=null&&f(t,["instances[0]","prompt"],r);const a=c(e,["config"]);return a!=null&&f(t,["config"],Eb(a,t)),t}function Hs(n){const e={},t=c(n,["gcsUri"]);t!=null&&f(e,["gcsUri"],t);const i=c(n,["imageBytes"]);i!=null&&f(e,["bytesBase64Encoded"],wi(i));const r=c(n,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function wb(n){const e={},t=c(n,["maskMode"]);t!=null&&f(e,["maskMode"],t);const i=c(n,["segmentationClasses"]);i!=null&&f(e,["maskClasses"],i);const r=c(n,["maskDilation"]);return r!=null&&f(e,["dilation"],r),e}function bb(n){const e={},t=c(n,["controlType"]);t!=null&&f(e,["controlType"],t);const i=c(n,["enableControlImageComputation"]);return i!=null&&f(e,["computeControl"],i),e}function Rb(n){const e={},t=c(n,["styleDescription"]);return t!=null&&f(e,["styleDescription"],t),e}function Mb(n){const e={},t=c(n,["subjectType"]);t!=null&&f(e,["subjectType"],t);const i=c(n,["subjectDescription"]);return i!=null&&f(e,["subjectDescription"],i),e}function Nb(n){const e={},t=c(n,["referenceImage"]);t!=null&&f(e,["referenceImage"],Hs(t));const i=c(n,["referenceId"]);i!=null&&f(e,["referenceId"],i);const r=c(n,["referenceType"]);r!=null&&f(e,["referenceType"],r);const a=c(n,["maskImageConfig"]);a!=null&&f(e,["maskImageConfig"],wb(a));const u=c(n,["controlImageConfig"]);u!=null&&f(e,["controlImageConfig"],bb(u));const h=c(n,["styleImageConfig"]);h!=null&&f(e,["styleImageConfig"],Rb(h));const m=c(n,["subjectImageConfig"]);return m!=null&&f(e,["subjectImageConfig"],Mb(m)),e}function kb(n,e){const t={},i=c(n,["outputGcsUri"]);e!==void 0&&i!=null&&f(e,["parameters","storageUri"],i);const r=c(n,["negativePrompt"]);e!==void 0&&r!=null&&f(e,["parameters","negativePrompt"],r);const a=c(n,["numberOfImages"]);e!==void 0&&a!=null&&f(e,["parameters","sampleCount"],a);const u=c(n,["aspectRatio"]);e!==void 0&&u!=null&&f(e,["parameters","aspectRatio"],u);const h=c(n,["guidanceScale"]);e!==void 0&&h!=null&&f(e,["parameters","guidanceScale"],h);const m=c(n,["seed"]);e!==void 0&&m!=null&&f(e,["parameters","seed"],m);const p=c(n,["safetyFilterLevel"]);e!==void 0&&p!=null&&f(e,["parameters","safetySetting"],p);const y=c(n,["personGeneration"]);e!==void 0&&y!=null&&f(e,["parameters","personGeneration"],y);const T=c(n,["includeSafetyAttributes"]);e!==void 0&&T!=null&&f(e,["parameters","includeSafetyAttributes"],T);const x=c(n,["includeRaiReason"]);e!==void 0&&x!=null&&f(e,["parameters","includeRaiReason"],x);const C=c(n,["language"]);e!==void 0&&C!=null&&f(e,["parameters","language"],C);const A=c(n,["outputMimeType"]);e!==void 0&&A!=null&&f(e,["parameters","outputOptions","mimeType"],A);const R=c(n,["outputCompressionQuality"]);e!==void 0&&R!=null&&f(e,["parameters","outputOptions","compressionQuality"],R);const k=c(n,["addWatermark"]);e!==void 0&&k!=null&&f(e,["parameters","addWatermark"],k);const B=c(n,["editMode"]);e!==void 0&&B!=null&&f(e,["parameters","editMode"],B);const F=c(n,["baseSteps"]);return e!==void 0&&F!=null&&f(e,["parameters","editConfig","baseSteps"],F),t}function Ib(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["_url","model"],Me(n,i));const r=c(e,["prompt"]);r!=null&&f(t,["instances[0]","prompt"],r);const a=c(e,["referenceImages"]);if(a!=null){let h=a;Array.isArray(h)&&(h=h.map(m=>Nb(m))),f(t,["instances[0]","referenceImages"],h)}const u=c(e,["config"]);return u!=null&&f(t,["config"],kb(u,t)),t}function Db(n,e){const t={},i=c(n,["includeRaiReason"]);e!==void 0&&i!=null&&f(e,["parameters","includeRaiReason"],i);const r=c(n,["outputMimeType"]);e!==void 0&&r!=null&&f(e,["parameters","outputOptions","mimeType"],r);const a=c(n,["outputCompressionQuality"]);e!==void 0&&a!=null&&f(e,["parameters","outputOptions","compressionQuality"],a);const u=c(n,["enhanceInputImage"]);e!==void 0&&u!=null&&f(e,["parameters","upscaleConfig","enhanceInputImage"],u);const h=c(n,["imagePreservationFactor"]);e!==void 0&&h!=null&&f(e,["parameters","upscaleConfig","imagePreservationFactor"],h);const m=c(n,["numberOfImages"]);e!==void 0&&m!=null&&f(e,["parameters","sampleCount"],m);const p=c(n,["mode"]);return e!==void 0&&p!=null&&f(e,["parameters","mode"],p),t}function Ub(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["_url","model"],Me(n,i));const r=c(e,["image"]);r!=null&&f(t,["instances[0]","image"],Hs(r));const a=c(e,["upscaleFactor"]);a!=null&&f(t,["parameters","upscaleConfig","upscaleFactor"],a);const u=c(e,["config"]);return u!=null&&f(t,["config"],Db(u,t)),t}function Lb(n){const e={},t=c(n,["productImage"]);return t!=null&&f(e,["image"],Hs(t)),e}function Pb(n,e){const t={},i=c(n,["prompt"]);e!==void 0&&i!=null&&f(e,["instances[0]","prompt"],i);const r=c(n,["personImage"]);e!==void 0&&r!=null&&f(e,["instances[0]","personImage","image"],Hs(r));const a=c(n,["productImages"]);if(e!==void 0&&a!=null){let u=a;Array.isArray(u)&&(u=u.map(h=>Lb(h))),f(e,["instances[0]","productImages"],u)}return t}function Hb(n,e){const t={},i=c(n,["numberOfImages"]);e!==void 0&&i!=null&&f(e,["parameters","sampleCount"],i);const r=c(n,["baseSteps"]);e!==void 0&&r!=null&&f(e,["parameters","editConfig","baseSteps"],r);const a=c(n,["outputGcsUri"]);e!==void 0&&a!=null&&f(e,["parameters","storageUri"],a);const u=c(n,["seed"]);e!==void 0&&u!=null&&f(e,["parameters","seed"],u);const h=c(n,["safetyFilterLevel"]);e!==void 0&&h!=null&&f(e,["parameters","safetySetting"],h);const m=c(n,["personGeneration"]);e!==void 0&&m!=null&&f(e,["parameters","personGeneration"],m);const p=c(n,["outputMimeType"]);e!==void 0&&p!=null&&f(e,["parameters","outputOptions","mimeType"],p);const y=c(n,["outputCompressionQuality"]);e!==void 0&&y!=null&&f(e,["parameters","outputOptions","compressionQuality"],y);const T=c(n,["enhancePrompt"]);return e!==void 0&&T!=null&&f(e,["parameters","enhancePrompt"],T),t}function Ob(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["_url","model"],Me(n,i));const r=c(e,["source"]);r!=null&&f(t,["config"],Pb(r,t));const a=c(e,["config"]);return a!=null&&f(t,["config"],Hb(a,t)),t}function Bb(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["_url","name"],Me(n,i));const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function Vb(n,e,t){const i={},r=c(e,["pageSize"]);t!==void 0&&r!=null&&f(t,["_query","pageSize"],r);const a=c(e,["pageToken"]);t!==void 0&&a!=null&&f(t,["_query","pageToken"],a);const u=c(e,["filter"]);t!==void 0&&u!=null&&f(t,["_query","filter"],u);const h=c(e,["queryBase"]);return t!==void 0&&h!=null&&f(t,["_url","models_url"],Yy(n,h)),i}function qb(n,e){const t={},i=c(e,["config"]);return i!=null&&f(t,["config"],Vb(n,i,t)),t}function Gb(n,e){const t={},i=c(n,["displayName"]);e!==void 0&&i!=null&&f(e,["displayName"],i);const r=c(n,["description"]);e!==void 0&&r!=null&&f(e,["description"],r);const a=c(n,["defaultCheckpointId"]);return e!==void 0&&a!=null&&f(e,["defaultCheckpointId"],a),t}function zb(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["_url","model"],Me(n,i));const r=c(e,["config"]);return r!=null&&f(t,["config"],Gb(r,t)),t}function $b(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["_url","name"],Me(n,i));const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function Fb(n,e){const t={},i=c(n,["systemInstruction"]);e!==void 0&&i!=null&&f(e,["systemInstruction"],Ps(ht(i)));const r=c(n,["tools"]);if(e!==void 0&&r!=null){let u=r;Array.isArray(u)&&(u=u.map(h=>av(h))),f(e,["tools"],u)}const a=c(n,["generationConfig"]);return e!==void 0&&a!=null&&f(e,["generationConfig"],a),t}function Yb(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["_url","model"],Me(n,i));const r=c(e,["contents"]);if(r!=null){let u=qt(r);Array.isArray(u)&&(u=u.map(h=>Ps(h))),f(t,["contents"],u)}const a=c(e,["config"]);return a!=null&&f(t,["config"],Fb(a,t)),t}function Jb(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["_url","model"],Me(n,i));const r=c(e,["contents"]);if(r!=null){let u=qt(r);Array.isArray(u)&&(u=u.map(h=>Ps(h))),f(t,["contents"],u)}const a=c(e,["config"]);return a!=null&&f(t,["config"],a),t}function jb(n){const e={},t=c(n,["uri"]);t!=null&&f(e,["gcsUri"],t);const i=c(n,["videoBytes"]);i!=null&&f(e,["bytesBase64Encoded"],wi(i));const r=c(n,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function Kb(n,e){const t={},i=c(n,["numberOfVideos"]);e!==void 0&&i!=null&&f(e,["parameters","sampleCount"],i);const r=c(n,["outputGcsUri"]);e!==void 0&&r!=null&&f(e,["parameters","storageUri"],r);const a=c(n,["fps"]);e!==void 0&&a!=null&&f(e,["parameters","fps"],a);const u=c(n,["durationSeconds"]);e!==void 0&&u!=null&&f(e,["parameters","durationSeconds"],u);const h=c(n,["seed"]);e!==void 0&&h!=null&&f(e,["parameters","seed"],h);const m=c(n,["aspectRatio"]);e!==void 0&&m!=null&&f(e,["parameters","aspectRatio"],m);const p=c(n,["resolution"]);e!==void 0&&p!=null&&f(e,["parameters","resolution"],p);const y=c(n,["personGeneration"]);e!==void 0&&y!=null&&f(e,["parameters","personGeneration"],y);const T=c(n,["pubsubTopic"]);e!==void 0&&T!=null&&f(e,["parameters","pubsubTopic"],T);const x=c(n,["negativePrompt"]);e!==void 0&&x!=null&&f(e,["parameters","negativePrompt"],x);const C=c(n,["enhancePrompt"]);e!==void 0&&C!=null&&f(e,["parameters","enhancePrompt"],C);const A=c(n,["generateAudio"]);e!==void 0&&A!=null&&f(e,["parameters","generateAudio"],A);const R=c(n,["lastFrame"]);e!==void 0&&R!=null&&f(e,["instances[0]","lastFrame"],Hs(R));const k=c(n,["compressionQuality"]);return e!==void 0&&k!=null&&f(e,["parameters","compressionQuality"],k),t}function Wb(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["_url","model"],Me(n,i));const r=c(e,["prompt"]);r!=null&&f(t,["instances[0]","prompt"],r);const a=c(e,["image"]);a!=null&&f(t,["instances[0]","image"],Hs(a));const u=c(e,["video"]);u!=null&&f(t,["instances[0]","video"],jb(u));const h=c(e,["config"]);return h!=null&&f(t,["config"],Kb(h,t)),t}function Qb(n){const e={},t=c(n,["fps"]);t!=null&&f(e,["fps"],t);const i=c(n,["endOffset"]);i!=null&&f(e,["endOffset"],i);const r=c(n,["startOffset"]);return r!=null&&f(e,["startOffset"],r),e}function Xb(n){const e={},t=c(n,["data"]);t!=null&&f(e,["data"],t);const i=c(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function Zb(n){const e={},t=c(n,["fileUri"]);t!=null&&f(e,["fileUri"],t);const i=c(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function eR(n){const e={},t=c(n,["videoMetadata"]);t!=null&&f(e,["videoMetadata"],Qb(t));const i=c(n,["thought"]);i!=null&&f(e,["thought"],i);const r=c(n,["inlineData"]);r!=null&&f(e,["inlineData"],Xb(r));const a=c(n,["fileData"]);a!=null&&f(e,["fileData"],Zb(a));const u=c(n,["thoughtSignature"]);u!=null&&f(e,["thoughtSignature"],u);const h=c(n,["codeExecutionResult"]);h!=null&&f(e,["codeExecutionResult"],h);const m=c(n,["executableCode"]);m!=null&&f(e,["executableCode"],m);const p=c(n,["functionCall"]);p!=null&&f(e,["functionCall"],p);const y=c(n,["functionResponse"]);y!=null&&f(e,["functionResponse"],y);const T=c(n,["text"]);return T!=null&&f(e,["text"],T),e}function tR(n){const e={},t=c(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>eR(a))),f(e,["parts"],r)}const i=c(n,["role"]);return i!=null&&f(e,["role"],i),e}function nR(n){const e={},t=c(n,["citationSources"]);return t!=null&&f(e,["citations"],t),e}function iR(n){const e={},t=c(n,["retrievedUrl"]);t!=null&&f(e,["retrievedUrl"],t);const i=c(n,["urlRetrievalStatus"]);return i!=null&&f(e,["urlRetrievalStatus"],i),e}function sR(n){const e={},t=c(n,["urlMetadata"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>iR(r))),f(e,["urlMetadata"],i)}return e}function oR(n){const e={},t=c(n,["content"]);t!=null&&f(e,["content"],tR(t));const i=c(n,["citationMetadata"]);i!=null&&f(e,["citationMetadata"],nR(i));const r=c(n,["tokenCount"]);r!=null&&f(e,["tokenCount"],r);const a=c(n,["finishReason"]);a!=null&&f(e,["finishReason"],a);const u=c(n,["urlContextMetadata"]);u!=null&&f(e,["urlContextMetadata"],sR(u));const h=c(n,["avgLogprobs"]);h!=null&&f(e,["avgLogprobs"],h);const m=c(n,["groundingMetadata"]);m!=null&&f(e,["groundingMetadata"],m);const p=c(n,["index"]);p!=null&&f(e,["index"],p);const y=c(n,["logprobsResult"]);y!=null&&f(e,["logprobsResult"],y);const T=c(n,["safetyRatings"]);return T!=null&&f(e,["safetyRatings"],T),e}function Ug(n){const e={},t=c(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=c(n,["candidates"]);if(i!=null){let m=i;Array.isArray(m)&&(m=m.map(p=>oR(p))),f(e,["candidates"],m)}const r=c(n,["modelVersion"]);r!=null&&f(e,["modelVersion"],r);const a=c(n,["promptFeedback"]);a!=null&&f(e,["promptFeedback"],a);const u=c(n,["responseId"]);u!=null&&f(e,["responseId"],u);const h=c(n,["usageMetadata"]);return h!=null&&f(e,["usageMetadata"],h),e}function rR(n){const e={},t=c(n,["values"]);return t!=null&&f(e,["values"],t),e}function aR(){return{}}function lR(n){const e={},t=c(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=c(n,["embeddings"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(u=>rR(u))),f(e,["embeddings"],a)}return c(n,["metadata"])!=null&&f(e,["metadata"],aR()),e}function uR(n){const e={},t=c(n,["bytesBase64Encoded"]);t!=null&&f(e,["imageBytes"],wi(t));const i=c(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function lv(n){const e={},t=c(n,["safetyAttributes","categories"]);t!=null&&f(e,["categories"],t);const i=c(n,["safetyAttributes","scores"]);i!=null&&f(e,["scores"],i);const r=c(n,["contentType"]);return r!=null&&f(e,["contentType"],r),e}function cR(n){const e={},t=c(n,["_self"]);t!=null&&f(e,["image"],uR(t));const i=c(n,["raiFilteredReason"]);i!=null&&f(e,["raiFilteredReason"],i);const r=c(n,["_self"]);return r!=null&&f(e,["safetyAttributes"],lv(r)),e}function fR(n){const e={},t=c(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=c(n,["predictions"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(u=>cR(u))),f(e,["generatedImages"],a)}const r=c(n,["positivePromptSafetyAttributes"]);return r!=null&&f(e,["positivePromptSafetyAttributes"],lv(r)),e}function dR(n){const e={},t=c(n,["baseModel"]);t!=null&&f(e,["baseModel"],t);const i=c(n,["createTime"]);i!=null&&f(e,["createTime"],i);const r=c(n,["updateTime"]);return r!=null&&f(e,["updateTime"],r),e}function Uc(n){const e={},t=c(n,["name"]);t!=null&&f(e,["name"],t);const i=c(n,["displayName"]);i!=null&&f(e,["displayName"],i);const r=c(n,["description"]);r!=null&&f(e,["description"],r);const a=c(n,["version"]);a!=null&&f(e,["version"],a);const u=c(n,["_self"]);u!=null&&f(e,["tunedModelInfo"],dR(u));const h=c(n,["inputTokenLimit"]);h!=null&&f(e,["inputTokenLimit"],h);const m=c(n,["outputTokenLimit"]);m!=null&&f(e,["outputTokenLimit"],m);const p=c(n,["supportedGenerationMethods"]);return p!=null&&f(e,["supportedActions"],p),e}function hR(n){const e={},t=c(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=c(n,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const r=c(n,["_self"]);if(r!=null){let a=Jy(r);Array.isArray(a)&&(a=a.map(u=>Uc(u))),f(e,["models"],a)}return e}function mR(){return{}}function pR(n){const e={},t=c(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=c(n,["totalTokens"]);i!=null&&f(e,["totalTokens"],i);const r=c(n,["cachedContentTokenCount"]);return r!=null&&f(e,["cachedContentTokenCount"],r),e}function gR(n){const e={},t=c(n,["video","uri"]);t!=null&&f(e,["uri"],t);const i=c(n,["video","encodedVideo"]);i!=null&&f(e,["videoBytes"],wi(i));const r=c(n,["encoding"]);return r!=null&&f(e,["mimeType"],r),e}function yR(n){const e={},t=c(n,["_self"]);return t!=null&&f(e,["video"],gR(t)),e}function vR(n){const e={},t=c(n,["generatedSamples"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(u=>yR(u))),f(e,["generatedVideos"],a)}const i=c(n,["raiMediaFilteredCount"]);i!=null&&f(e,["raiMediaFilteredCount"],i);const r=c(n,["raiMediaFilteredReasons"]);return r!=null&&f(e,["raiMediaFilteredReasons"],r),e}function TR(n){const e={},t=c(n,["name"]);t!=null&&f(e,["name"],t);const i=c(n,["metadata"]);i!=null&&f(e,["metadata"],i);const r=c(n,["done"]);r!=null&&f(e,["done"],r);const a=c(n,["error"]);a!=null&&f(e,["error"],a);const u=c(n,["response","generateVideoResponse"]);return u!=null&&f(e,["response"],vR(u)),e}function SR(n){const e={},t=c(n,["fps"]);t!=null&&f(e,["fps"],t);const i=c(n,["endOffset"]);i!=null&&f(e,["endOffset"],i);const r=c(n,["startOffset"]);return r!=null&&f(e,["startOffset"],r),e}function xR(n){const e={},t=c(n,["displayName"]);t!=null&&f(e,["displayName"],t);const i=c(n,["data"]);i!=null&&f(e,["data"],i);const r=c(n,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function _R(n){const e={},t=c(n,["displayName"]);t!=null&&f(e,["displayName"],t);const i=c(n,["fileUri"]);i!=null&&f(e,["fileUri"],i);const r=c(n,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function CR(n){const e={},t=c(n,["videoMetadata"]);t!=null&&f(e,["videoMetadata"],SR(t));const i=c(n,["thought"]);i!=null&&f(e,["thought"],i);const r=c(n,["inlineData"]);r!=null&&f(e,["inlineData"],xR(r));const a=c(n,["fileData"]);a!=null&&f(e,["fileData"],_R(a));const u=c(n,["thoughtSignature"]);u!=null&&f(e,["thoughtSignature"],u);const h=c(n,["codeExecutionResult"]);h!=null&&f(e,["codeExecutionResult"],h);const m=c(n,["executableCode"]);m!=null&&f(e,["executableCode"],m);const p=c(n,["functionCall"]);p!=null&&f(e,["functionCall"],p);const y=c(n,["functionResponse"]);y!=null&&f(e,["functionResponse"],y);const T=c(n,["text"]);return T!=null&&f(e,["text"],T),e}function ER(n){const e={},t=c(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>CR(a))),f(e,["parts"],r)}const i=c(n,["role"]);return i!=null&&f(e,["role"],i),e}function AR(n){const e={},t=c(n,["citations"]);return t!=null&&f(e,["citations"],t),e}function wR(n){const e={},t=c(n,["retrievedUrl"]);t!=null&&f(e,["retrievedUrl"],t);const i=c(n,["urlRetrievalStatus"]);return i!=null&&f(e,["urlRetrievalStatus"],i),e}function bR(n){const e={},t=c(n,["urlMetadata"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>wR(r))),f(e,["urlMetadata"],i)}return e}function RR(n){const e={},t=c(n,["content"]);t!=null&&f(e,["content"],ER(t));const i=c(n,["citationMetadata"]);i!=null&&f(e,["citationMetadata"],AR(i));const r=c(n,["finishMessage"]);r!=null&&f(e,["finishMessage"],r);const a=c(n,["finishReason"]);a!=null&&f(e,["finishReason"],a);const u=c(n,["urlContextMetadata"]);u!=null&&f(e,["urlContextMetadata"],bR(u));const h=c(n,["avgLogprobs"]);h!=null&&f(e,["avgLogprobs"],h);const m=c(n,["groundingMetadata"]);m!=null&&f(e,["groundingMetadata"],m);const p=c(n,["index"]);p!=null&&f(e,["index"],p);const y=c(n,["logprobsResult"]);y!=null&&f(e,["logprobsResult"],y);const T=c(n,["safetyRatings"]);return T!=null&&f(e,["safetyRatings"],T),e}function Lg(n){const e={},t=c(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=c(n,["candidates"]);if(i!=null){let p=i;Array.isArray(p)&&(p=p.map(y=>RR(y))),f(e,["candidates"],p)}const r=c(n,["createTime"]);r!=null&&f(e,["createTime"],r);const a=c(n,["modelVersion"]);a!=null&&f(e,["modelVersion"],a);const u=c(n,["promptFeedback"]);u!=null&&f(e,["promptFeedback"],u);const h=c(n,["responseId"]);h!=null&&f(e,["responseId"],h);const m=c(n,["usageMetadata"]);return m!=null&&f(e,["usageMetadata"],m),e}function MR(n){const e={},t=c(n,["truncated"]);t!=null&&f(e,["truncated"],t);const i=c(n,["token_count"]);return i!=null&&f(e,["tokenCount"],i),e}function NR(n){const e={},t=c(n,["values"]);t!=null&&f(e,["values"],t);const i=c(n,["statistics"]);return i!=null&&f(e,["statistics"],MR(i)),e}function kR(n){const e={},t=c(n,["billableCharacterCount"]);return t!=null&&f(e,["billableCharacterCount"],t),e}function IR(n){const e={},t=c(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=c(n,["predictions[]","embeddings"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(u=>NR(u))),f(e,["embeddings"],a)}const r=c(n,["metadata"]);return r!=null&&f(e,["metadata"],kR(r)),e}function DR(n){const e={},t=c(n,["gcsUri"]);t!=null&&f(e,["gcsUri"],t);const i=c(n,["bytesBase64Encoded"]);i!=null&&f(e,["imageBytes"],wi(i));const r=c(n,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function uv(n){const e={},t=c(n,["safetyAttributes","categories"]);t!=null&&f(e,["categories"],t);const i=c(n,["safetyAttributes","scores"]);i!=null&&f(e,["scores"],i);const r=c(n,["contentType"]);return r!=null&&f(e,["contentType"],r),e}function Fa(n){const e={},t=c(n,["_self"]);t!=null&&f(e,["image"],DR(t));const i=c(n,["raiFilteredReason"]);i!=null&&f(e,["raiFilteredReason"],i);const r=c(n,["_self"]);r!=null&&f(e,["safetyAttributes"],uv(r));const a=c(n,["prompt"]);return a!=null&&f(e,["enhancedPrompt"],a),e}function UR(n){const e={},t=c(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=c(n,["predictions"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(u=>Fa(u))),f(e,["generatedImages"],a)}const r=c(n,["positivePromptSafetyAttributes"]);return r!=null&&f(e,["positivePromptSafetyAttributes"],uv(r)),e}function LR(n){const e={},t=c(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=c(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>Fa(a))),f(e,["generatedImages"],r)}return e}function PR(n){const e={},t=c(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=c(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>Fa(a))),f(e,["generatedImages"],r)}return e}function HR(n){const e={},t=c(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>Fa(r))),f(e,["generatedImages"],i)}return e}function OR(n){const e={},t=c(n,["endpoint"]);t!=null&&f(e,["name"],t);const i=c(n,["deployedModelId"]);return i!=null&&f(e,["deployedModelId"],i),e}function BR(n){const e={},t=c(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&f(e,["baseModel"],t);const i=c(n,["createTime"]);i!=null&&f(e,["createTime"],i);const r=c(n,["updateTime"]);return r!=null&&f(e,["updateTime"],r),e}function VR(n){const e={},t=c(n,["checkpointId"]);t!=null&&f(e,["checkpointId"],t);const i=c(n,["epoch"]);i!=null&&f(e,["epoch"],i);const r=c(n,["step"]);return r!=null&&f(e,["step"],r),e}function Lc(n){const e={},t=c(n,["name"]);t!=null&&f(e,["name"],t);const i=c(n,["displayName"]);i!=null&&f(e,["displayName"],i);const r=c(n,["description"]);r!=null&&f(e,["description"],r);const a=c(n,["versionId"]);a!=null&&f(e,["version"],a);const u=c(n,["deployedModels"]);if(u!=null){let T=u;Array.isArray(T)&&(T=T.map(x=>OR(x))),f(e,["endpoints"],T)}const h=c(n,["labels"]);h!=null&&f(e,["labels"],h);const m=c(n,["_self"]);m!=null&&f(e,["tunedModelInfo"],BR(m));const p=c(n,["defaultCheckpointId"]);p!=null&&f(e,["defaultCheckpointId"],p);const y=c(n,["checkpoints"]);if(y!=null){let T=y;Array.isArray(T)&&(T=T.map(x=>VR(x))),f(e,["checkpoints"],T)}return e}function qR(n){const e={},t=c(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=c(n,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const r=c(n,["_self"]);if(r!=null){let a=Jy(r);Array.isArray(a)&&(a=a.map(u=>Lc(u))),f(e,["models"],a)}return e}function GR(){return{}}function zR(n){const e={},t=c(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=c(n,["totalTokens"]);return i!=null&&f(e,["totalTokens"],i),e}function $R(n){const e={},t=c(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=c(n,["tokensInfo"]);return i!=null&&f(e,["tokensInfo"],i),e}function FR(n){const e={},t=c(n,["gcsUri"]);t!=null&&f(e,["uri"],t);const i=c(n,["bytesBase64Encoded"]);i!=null&&f(e,["videoBytes"],wi(i));const r=c(n,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function YR(n){const e={},t=c(n,["_self"]);return t!=null&&f(e,["video"],FR(t)),e}function JR(n){const e={},t=c(n,["videos"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(u=>YR(u))),f(e,["generatedVideos"],a)}const i=c(n,["raiMediaFilteredCount"]);i!=null&&f(e,["raiMediaFilteredCount"],i);const r=c(n,["raiMediaFilteredReasons"]);return r!=null&&f(e,["raiMediaFilteredReasons"],r),e}function jR(n){const e={},t=c(n,["name"]);t!=null&&f(e,["name"],t);const i=c(n,["metadata"]);i!=null&&f(e,["metadata"],i);const r=c(n,["done"]);r!=null&&f(e,["done"],r);const a=c(n,["error"]);a!=null&&f(e,["error"],a);const u=c(n,["response"]);return u!=null&&f(e,["response"],JR(u)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const KR="Content-Type",WR="X-Server-Timeout",QR="User-Agent",Pc="x-goog-api-client",XR="1.13.0",ZR=`google-genai-sdk/${XR}`,e1="v1beta1",t1="v1beta",Pg=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class n1{constructor(e){var t,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const r={};this.clientOptions.vertexai?(r.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:e1,r.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(r.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:t1,r.baseUrl="https://generativelanguage.googleapis.com/"),r.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=r,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(r,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){const r=[this.getRequestUrlInternal(t)];return i&&r.push(this.getBaseResourcePath()),e!==""&&r.push(e),new URL(`${r.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,i);if(e.queryParams)for(const[u,h]of Object.entries(e.queryParams))r.searchParams.append(u,String(h));let a={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else a.body=e.body;return a=await this.includeExtraHttpOptionsToRequestInit(a,t,e.abortSignal),this.unaryApiCall(r,a,e.httpMethod)}patchHttpOptions(e,t){const i=JSON.parse(JSON.stringify(e));for(const[r,a]of Object.entries(t))typeof a=="object"?i[r]=Object.assign(Object.assign({},i[r]),a):a!==void 0&&(i[r]=a);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,i);(!r.searchParams.has("alt")||r.searchParams.get("alt")!=="sse")&&r.searchParams.set("alt","sse");let a={};return a.body=e.body,a=await this.includeExtraHttpOptionsToRequestInit(a,t,e.abortSignal),this.streamApiCall(r,a,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i){if(t&&t.timeout||i){const r=new AbortController,a=r.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const u=setTimeout(()=>r.abort(),t.timeout);u&&typeof u.unref=="function"&&u.unref()}i&&i.addEventListener("abort",()=>{r.abort()}),e.signal=a}return t&&t.extraBody!==null&&i1(e,t.extraBody),e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await Hg(r),new Rc(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await Hg(r),this.processStreamResponse(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}processStreamResponse(e){var t;return Ns(this,arguments,function*(){const r=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.getReader(),a=new TextDecoder("utf-8");if(!r)throw new Error("Response body is empty");try{let u="";for(;;){const{done:h,value:m}=yield qe(r.read());if(h){if(u.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const p=a.decode(m,{stream:!0});try{const T=JSON.parse(p);if("error"in T){const x=JSON.parse(JSON.stringify(T.error)),C=x.status,A=x.code,R=`got status: ${C}. ${JSON.stringify(T)}`;if(A>=400&&A<600)throw new za({message:R,status:A})}}catch(T){if(T.name==="ApiError")throw T}u+=p;let y=u.match(Pg);for(;y;){const T=y[1];try{const x=new Response(T,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield qe(new Rc(x)),u=u.slice(y[0].length),y=u.match(Pg)}catch(x){throw new Error(`exception parsing stream chunk ${T}. ${x}`)}}}}finally{r.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},t=ZR+" "+this.clientOptions.userAgentExtra;return e[QR]=t,e[Pc]=t,e[KR]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[i,r]of Object.entries(e.headers))t.append(i,r);e.timeout&&e.timeout>0&&t.append(WR,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var i;const r={};t!=null&&(r.mimeType=t.mimeType,r.name=t.name,r.displayName=t.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);const a=this.clientOptions.uploader,u=await a.stat(e);r.sizeBytes=String(u.size);const h=(i=t==null?void 0:t.mimeType)!==null&&i!==void 0?i:u.type;if(h===void 0||h==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=h;const m=await this.fetchUploadUrl(r,t);return a.upload(e,m,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t){var i;let r={};t!=null&&t.httpOptions?r=t.httpOptions:r={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const a={file:e},u=await this.request({path:ie("upload/v1beta/files",a._url),body:JSON.stringify(a),httpMethod:"POST",httpOptions:r});if(!u||!(u!=null&&u.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const h=(i=u==null?void 0:u.headers)===null||i===void 0?void 0:i["x-goog-upload-url"];if(h===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return h}}async function Hg(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const r=JSON.stringify(i);throw t>=400&&t<600?new za({message:r,status:t}):new Error(r)}}function i1(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const a=JSON.parse(n.body);if(typeof a=="object"&&a!==null&&!Array.isArray(a))t=a;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(a,u){const h=Object.assign({},a);for(const m in u)if(Object.prototype.hasOwnProperty.call(u,m)){const p=u[m],y=h[m];p&&typeof p=="object"&&!Array.isArray(p)&&y&&typeof y=="object"&&!Array.isArray(y)?h[m]=i(y,p):(y&&p&&typeof y!=typeof p&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${m}". Original type: ${typeof y}, New type: ${typeof p}. Overwriting.`),h[m]=p)}return h}const r=i(t,e);n.body=JSON.stringify(r)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const s1="mcp_used/unknown";let o1=!1;function cv(n){for(const e of n)if(r1(e)||typeof e=="object"&&"inputSchema"in e)return!0;return o1}function fv(n){var e;const t=(e=n[Pc])!==null&&e!==void 0?e:"";n[Pc]=(t+` ${s1}`).trimStart()}function r1(n){return n!==null&&typeof n=="object"&&n instanceof uf}function a1(n,e=100){return Ns(this,arguments,function*(){let i,r=0;for(;r<e;){const a=yield qe(n.listTools({cursor:i}));for(const u of a.tools)yield yield qe(u),r++;if(!a.nextCursor)break;i=a.nextCursor}})}class uf{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new uf(e,t)}async initialize(){var e,t,i,r;if(this.mcpTools.length>0)return;const a={},u=[];for(const y of this.mcpClients)try{for(var h=!0,m=(t=void 0,jo(a1(y))),p;p=await m.next(),e=p.done,!e;h=!0){r=p.value,h=!1;const T=r;u.push(T);const x=T.name;if(a[x])throw new Error(`Duplicate function name ${x} found in MCP tools. Please ensure function names are unique.`);a[x]=y}}catch(T){t={error:T}}finally{try{!h&&!e&&(i=m.return)&&await i.call(m)}finally{if(t)throw t.error}}this.mcpTools=u,this.functionNameToMcpClient=a}async tool(){return await this.initialize(),Qx(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const r=this.functionNameToMcpClient[i.name];let a;this.config.timeout&&(a={timeout:this.config.timeout});const u=await r.callTool({name:i.name,arguments:i.args},void 0,a);t.push({functionResponse:{name:i.name,response:u.isError?{error:u}:u}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function l1(n,e,t){const i=new zx;let r;t.data instanceof Blob?r=JSON.parse(await t.data.text()):r=JSON.parse(t.data);const a=QA(r);Object.assign(i,a),e(i)}class u1{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const r=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion(),u=d1(this.apiClient.getDefaultHeaders()),h=this.apiClient.getApiKey(),m=`${r}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateMusic?key=${h}`;let p=()=>{};const y=new Promise(N=>{p=N}),T=e.callbacks,x=function(){p({})},C=this.apiClient,A={onopen:x,onmessage:N=>{l1(C,T.onmessage,N)},onerror:(t=T==null?void 0:T.onerror)!==null&&t!==void 0?t:function(N){},onclose:(i=T==null?void 0:T.onclose)!==null&&i!==void 0?i:function(N){}},R=this.webSocketFactory.create(m,f1(u),A);R.connect(),await y;const k=Me(this.apiClient,e.model),B=sv({model:k}),F=Dc({setup:B});return R.send(JSON.stringify(F)),new c1(R,this.apiClient)}}class c1{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=KE(e),i=ov(t);this.conn.send(JSON.stringify({clientContent:i}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=WE(e),i=Dc(t);this.conn.send(JSON.stringify(i))}sendPlaybackControl(e){const t=Dc({playbackControl:e});this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(bs.PLAY)}pause(){this.sendPlaybackControl(bs.PAUSE)}stop(){this.sendPlaybackControl(bs.STOP)}resetContext(){this.sendPlaybackControl(bs.RESET_CONTEXT)}close(){this.conn.close()}}function f1(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function d1(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const h1="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function m1(n,e,t){const i=new Gx;let r;t.data instanceof Blob?r=await t.data.text():t.data instanceof ArrayBuffer?r=new TextDecoder().decode(t.data):r=t.data;const a=JSON.parse(r);if(n.isVertexAI()){const u=fw(a);Object.assign(i,u)}else{const u=GA(a);Object.assign(i,u)}e(i)}class p1{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new u1(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,r,a,u,h;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const m=this.apiClient.getWebsocketBaseUrl(),p=this.apiClient.getApiVersion();let y;const T=this.apiClient.getHeaders();e.config&&e.config.tools&&cv(e.config.tools)&&fv(T);const x=T1(T);if(this.apiClient.isVertexAI())y=`${m}/ws/google.cloud.aiplatform.${p}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(x);else{const ne=this.apiClient.getApiKey();let ue="BidiGenerateContent",ae="key";ne!=null&&ne.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),p!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),ue="BidiGenerateContentConstrained",ae="access_token"),y=`${m}/ws/google.ai.generativelanguage.${p}.GenerativeService.${ue}?${ae}=${ne}`}let C=()=>{};const A=new Promise(ne=>{C=ne}),R=e.callbacks,k=function(){var ne;(ne=R==null?void 0:R.onopen)===null||ne===void 0||ne.call(R),C({})},B=this.apiClient,F={onopen:k,onmessage:ne=>{m1(B,R.onmessage,ne)},onerror:(t=R==null?void 0:R.onerror)!==null&&t!==void 0?t:function(ne){},onclose:(i=R==null?void 0:R.onclose)!==null&&i!==void 0?i:function(ne){}},N=this.webSocketFactory.create(y,v1(x),F);N.connect(),await A;let q=Me(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&q.startsWith("publishers/")){const ne=this.apiClient.getProject(),ue=this.apiClient.getLocation();q=`projects/${ne}/locations/${ue}/`+q}let O={};this.apiClient.isVertexAI()&&((r=e.config)===null||r===void 0?void 0:r.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[La.AUDIO]}:e.config.responseModalities=[La.AUDIO]),!((a=e.config)===null||a===void 0)&&a.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const K=(h=(u=e.config)===null||u===void 0?void 0:u.tools)!==null&&h!==void 0?h:[],Q=[];for(const ne of K)if(this.isCallableTool(ne)){const ue=ne;Q.push(await ue.tool())}else Q.push(ne);Q.length>0&&(e.config.tools=Q);const de={model:q,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?O=CA(this.apiClient,de):O=FE(this.apiClient,de),delete O.config,N.send(JSON.stringify(O)),new y1(N,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const g1={turnComplete:!0};class y1{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=qt(t.turns),e.isVertexAI()?i=i.map(r=>Ps(r)):i=i.map(r=>$a(r))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const a of i){if(typeof a!="object"||a===null||!("name"in a)||!("response"in a))throw new Error(`Could not parse function response, type '${typeof a}'.`);if(!e.isVertexAI()&&!("id"in a))throw new Error(h1)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},g1),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:wA(e)}:t={realtimeInput:jE(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function v1(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function T1(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Og=10;function Bg(n){var e,t,i;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let r=!1;for(const u of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(ks(u)){r=!0;break}if(!r)return!0;const a=(i=n==null?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return a&&(a<0||!Number.isInteger(a))||a==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",a),!0):!1}function ks(n){return"callTool"in n&&typeof n.callTool=="function"}function S1(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(r=>ks(r)))!==null&&i!==void 0?i:!1}function x1(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(r=>!ks(r)))!==null&&i!==void 0?i:!1}function Vg(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _1 extends Ai{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,r,a,u,h;const m=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!S1(t)||Bg(t.config))return await this.generateContentInternal(m);if(x1(t))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let p,y;const T=qt(m.contents),x=(a=(r=(i=m.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&a!==void 0?a:Og;let C=0;for(;C<x&&(p=await this.generateContentInternal(m),!(!p.functionCalls||p.functionCalls.length===0));){const A=p.candidates[0].content,R=[];for(const k of(h=(u=t.config)===null||u===void 0?void 0:u.tools)!==null&&h!==void 0?h:[])if(ks(k)){const F=await k.callTool(p.functionCalls);R.push(...F)}C++,y={role:"user",parts:R},m.contents=qt(m.contents),m.contents.push(A),m.contents.push(y),Vg(m.config)&&(T.push(A),T.push(y))}return Vg(m.config)&&(p.automaticFunctionCallingHistory=T),p},this.generateContentStream=async t=>{if(this.maybeMoveToResponseJsonSchem(t),Bg(t.config)){const i=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(i)}else return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var r;let a;const u=[];if(i!=null&&i.generatedImages)for(const m of i.generatedImages)m&&(m!=null&&m.safetyAttributes)&&((r=m==null?void 0:m.safetyAttributes)===null||r===void 0?void 0:r.contentType)==="Positive Prompt"?a=m==null?void 0:m.safetyAttributes:u.push(m);let h;return a?h={generatedImages:u,positivePromptSafetyAttributes:a,sdkHttpResponse:i.sdkHttpResponse}:h={generatedImages:u,sdkHttpResponse:i.sdkHttpResponse},h}),this.list=async t=>{var i;const u={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!u.config.queryBase){if(!((i=u.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");u.config.filter="labels.tune-type:*"}return new nr(Ci.PAGED_ITEM_MODELS,h=>this.listInternal(h),await this.listInternal(u),u)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(r=>r.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const r={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(r)},this.generateVideos=async t=>await this.generateVideosInternal(t)}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,r;const a=(t=e.config)===null||t===void 0?void 0:t.tools;if(!a)return e;const u=await Promise.all(a.map(async m=>ks(m)?await m.tool():m)),h={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:u})};if(h.config.tools=u,e.config&&e.config.tools&&cv(e.config.tools)){const m=(r=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&r!==void 0?r:{};let p=Object.assign({},m);Object.keys(p).length===0&&(p=this.apiClient.getDefaultHeaders()),fv(p),h.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:p})}return h}async initAfcToolsMap(e){var t,i,r;const a=new Map;for(const u of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(ks(u)){const h=u,m=await h.tool();for(const p of(r=m.functionDeclarations)!==null&&r!==void 0?r:[]){if(!p.name)throw new Error("Function declaration name is required.");if(a.has(p.name))throw new Error(`Duplicate tool declaration name: ${p.name}`);a.set(p.name,h)}}return a}async processAfcStream(e){var t,i,r;const a=(r=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&r!==void 0?r:Og;let u=!1,h=0;const m=await this.initAfcToolsMap(e);return function(p,y,T){var x,C;return Ns(this,arguments,function*(){for(var A,R,k,B;h<a;){u&&(h++,u=!1);const O=yield qe(p.processParamsMaybeAddMcpUsage(T)),K=yield qe(p.generateContentStreamInternal(O)),Q=[],de=[];try{for(var F=!0,N=(R=void 0,jo(K)),q;q=yield qe(N.next()),A=q.done,!A;F=!0){B=q.value,F=!1;const ne=B;if(yield yield qe(ne),ne.candidates&&(!((x=ne.candidates[0])===null||x===void 0)&&x.content)){de.push(ne.candidates[0].content);for(const ue of(C=ne.candidates[0].content.parts)!==null&&C!==void 0?C:[])if(h<a&&ue.functionCall){if(!ue.functionCall.name)throw new Error("Function call name was not returned by the model.");if(y.has(ue.functionCall.name)){const ae=yield qe(y.get(ue.functionCall.name).callTool([ue.functionCall]));Q.push(...ae)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${y.keys()}, mising tool: ${ue.functionCall.name}`)}}}}catch(ne){R={error:ne}}finally{try{!F&&!A&&(k=N.return)&&(yield qe(k.call(N)))}finally{if(R)throw R.error}}if(Q.length>0){u=!0;const ne=new Go;ne.candidates=[{content:{role:"user",parts:Q}}],yield yield qe(ne);const ue=[];ue.push(...de),ue.push({role:"user",parts:Q});const ae=qt(T.contents).concat(ue);T.contents=ae}else break}})}(this,m,e)}async generateContentInternal(e){var t,i,r,a;let u,h="",m={};if(this.apiClient.isVertexAI()){const p=Dg(this.apiClient,e);return h=ie("{model}:generateContent",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),u.then(y=>{const T=Lg(y),x=new Go;return Object.assign(x,T),x})}else{const p=Ig(this.apiClient,e);return h=ie("{model}:generateContent",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),u.then(y=>{const T=Ug(y),x=new Go;return Object.assign(x,T),x})}}async generateContentStreamInternal(e){var t,i,r,a;let u,h="",m={};if(this.apiClient.isVertexAI()){const p=Dg(this.apiClient,e);return h=ie("{model}:streamGenerateContent?alt=sse",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.requestStream({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),u.then(function(T){return Ns(this,arguments,function*(){var x,C,A,R;try{for(var k=!0,B=jo(T),F;F=yield qe(B.next()),x=F.done,!x;k=!0){R=F.value,k=!1;const N=R,q=Lg(yield qe(N.json()));q.sdkHttpResponse={headers:N.headers};const O=new Go;Object.assign(O,q),yield yield qe(O)}}catch(N){C={error:N}}finally{try{!k&&!x&&(A=B.return)&&(yield qe(A.call(B)))}finally{if(C)throw C.error}}})})}else{const p=Ig(this.apiClient,e);return h=ie("{model}:streamGenerateContent?alt=sse",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.requestStream({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}),u.then(function(T){return Ns(this,arguments,function*(){var x,C,A,R;try{for(var k=!0,B=jo(T),F;F=yield qe(B.next()),x=F.done,!x;k=!0){R=F.value,k=!1;const N=R,q=Ug(yield qe(N.json()));q.sdkHttpResponse={headers:N.headers};const O=new Go;Object.assign(O,q),yield yield qe(O)}}catch(N){C={error:N}}finally{try{!k&&!x&&(A=B.return)&&(yield qe(A.call(B)))}finally{if(C)throw C.error}}})})}}async embedContent(e){var t,i,r,a;let u,h="",m={};if(this.apiClient.isVertexAI()){const p=Cb(this.apiClient,e);return h=ie("{model}:predict",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),u.then(y=>{const T=IR(y),x=new fg;return Object.assign(x,T),x})}else{const p=Pw(this.apiClient,e);return h=ie("{model}:batchEmbedContents",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),u.then(y=>{const T=lR(y),x=new fg;return Object.assign(x,T),x})}}async generateImagesInternal(e){var t,i,r,a;let u,h="",m={};if(this.apiClient.isVertexAI()){const p=Ab(this.apiClient,e);return h=ie("{model}:predict",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),u.then(y=>{const T=UR(y),x=new dg;return Object.assign(x,T),x})}else{const p=Ow(this.apiClient,e);return h=ie("{model}:predict",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),u.then(y=>{const T=fR(y),x=new dg;return Object.assign(x,T),x})}}async editImageInternal(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI()){const h=Ib(this.apiClient,e);return a=ie("{model}:predict",h._url),u=h._query,delete h.config,delete h._url,delete h._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(p=>{const y=p;return y.sdkHttpResponse={headers:m.headers},y})),r.then(m=>{const p=LR(m),y=new Lx;return Object.assign(y,p),y})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI()){const h=Ub(this.apiClient,e);return a=ie("{model}:predict",h._url),u=h._query,delete h.config,delete h._url,delete h._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(p=>{const y=p;return y.sdkHttpResponse={headers:m.headers},y})),r.then(m=>{const p=PR(m),y=new Px;return Object.assign(y,p),y})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI()){const h=Ob(this.apiClient,e);return a=ie("{model}:predict",h._url),u=h._query,delete h.config,delete h._url,delete h._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),r.then(m=>{const p=HR(m),y=new Hx;return Object.assign(y,p),y})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,r,a;let u,h="",m={};if(this.apiClient.isVertexAI()){const p=Bb(this.apiClient,e);return h=ie("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json()),u.then(y=>Lc(y))}else{const p=Bw(this.apiClient,e);return h=ie("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),u.then(y=>Uc(y))}}async listInternal(e){var t,i,r,a;let u,h="",m={};if(this.apiClient.isVertexAI()){const p=qb(this.apiClient,e);return h=ie("{models_url}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),u.then(y=>{const T=qR(y),x=new hg;return Object.assign(x,T),x})}else{const p=qw(this.apiClient,e);return h=ie("{models_url}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),u.then(y=>{const T=hR(y),x=new hg;return Object.assign(x,T),x})}}async update(e){var t,i,r,a;let u,h="",m={};if(this.apiClient.isVertexAI()){const p=zb(this.apiClient,e);return h=ie("{model}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json()),u.then(y=>Lc(y))}else{const p=zw(this.apiClient,e);return h=ie("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),u.then(y=>Uc(y))}}async delete(e){var t,i,r,a;let u,h="",m={};if(this.apiClient.isVertexAI()){const p=$b(this.apiClient,e);return h=ie("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json()),u.then(()=>{const y=GR(),T=new mg;return Object.assign(T,y),T})}else{const p=$w(this.apiClient,e);return h=ie("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),u.then(()=>{const y=mR(),T=new mg;return Object.assign(T,y),T})}}async countTokens(e){var t,i,r,a;let u,h="",m={};if(this.apiClient.isVertexAI()){const p=Yb(this.apiClient,e);return h=ie("{model}:countTokens",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),u.then(y=>{const T=zR(y),x=new pg;return Object.assign(x,T),x})}else{const p=Yw(this.apiClient,e);return h=ie("{model}:countTokens",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),u.then(y=>{const T=pR(y),x=new pg;return Object.assign(x,T),x})}}async computeTokens(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI()){const h=Jb(this.apiClient,e);return a=ie("{model}:computeTokens",h._url),u=h._query,delete h.config,delete h._url,delete h._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(p=>{const y=p;return y.sdkHttpResponse={headers:m.headers},y})),r.then(m=>{const p=$R(m),y=new Ox;return Object.assign(y,p),y})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,r,a;let u,h="",m={};if(this.apiClient.isVertexAI()){const p=Wb(this.apiClient,e);return h=ie("{model}:predictLongRunning",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json()),u.then(y=>{const T=jR(y),x=new Pa;return Object.assign(x,T),x})}else{const p=Kw(this.apiClient,e);return h=ie("{model}:predictLongRunning",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),u.then(y=>{const T=TR(y),x=new Pa;return Object.assign(x,T),x})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function C1(n){const e={},t=c(n,["operationName"]);t!=null&&f(e,["_url","operationName"],t);const i=c(n,["config"]);return i!=null&&f(e,["config"],i),e}function E1(n){const e={},t=c(n,["operationName"]);t!=null&&f(e,["_url","operationName"],t);const i=c(n,["config"]);return i!=null&&f(e,["config"],i),e}function A1(n){const e={},t=c(n,["operationName"]);t!=null&&f(e,["operationName"],t);const i=c(n,["resourceName"]);i!=null&&f(e,["_url","resourceName"],i);const r=c(n,["config"]);return r!=null&&f(e,["config"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class w1 extends Ai{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];let a;i&&"httpOptions"in i&&(a=i.httpOptions);const u=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:u,isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:r,isVertexAI:!1})}}async get(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];let a;i&&"httpOptions"in i&&(a=i.httpOptions);const u=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:u,isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:r,isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,r,a;let u,h="",m={};if(this.apiClient.isVertexAI()){const p=E1(e);return h=ie("{operationName}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json()),u}else{const p=C1(e);return h=ie("{operationName}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json()),u}}async fetchPredictVideosOperationInternal(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI()){const h=A1(e);return a=ie("{resourceName}:fetchPredictOperation",h._url),u=h._query,delete h.config,delete h._url,delete h._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),r}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function b1(n){const e={},t=c(n,["voiceName"]);return t!=null&&f(e,["voiceName"],t),e}function dv(n){const e={},t=c(n,["prebuiltVoiceConfig"]);return t!=null&&f(e,["prebuiltVoiceConfig"],b1(t)),e}function R1(n){const e={},t=c(n,["speaker"]);t!=null&&f(e,["speaker"],t);const i=c(n,["voiceConfig"]);return i!=null&&f(e,["voiceConfig"],dv(i)),e}function M1(n){const e={},t=c(n,["speakerVoiceConfigs"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>R1(r))),f(e,["speakerVoiceConfigs"],i)}return e}function N1(n){const e={},t=c(n,["voiceConfig"]);t!=null&&f(e,["voiceConfig"],dv(t));const i=c(n,["multiSpeakerVoiceConfig"]);i!=null&&f(e,["multiSpeakerVoiceConfig"],M1(i));const r=c(n,["languageCode"]);return r!=null&&f(e,["languageCode"],r),e}function k1(n){const e={},t=c(n,["fps"]);t!=null&&f(e,["fps"],t);const i=c(n,["endOffset"]);i!=null&&f(e,["endOffset"],i);const r=c(n,["startOffset"]);return r!=null&&f(e,["startOffset"],r),e}function I1(n){const e={};if(c(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=c(n,["data"]);t!=null&&f(e,["data"],t);const i=c(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function D1(n){const e={};if(c(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=c(n,["fileUri"]);t!=null&&f(e,["fileUri"],t);const i=c(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function U1(n){const e={},t=c(n,["videoMetadata"]);t!=null&&f(e,["videoMetadata"],k1(t));const i=c(n,["thought"]);i!=null&&f(e,["thought"],i);const r=c(n,["inlineData"]);r!=null&&f(e,["inlineData"],I1(r));const a=c(n,["fileData"]);a!=null&&f(e,["fileData"],D1(a));const u=c(n,["thoughtSignature"]);u!=null&&f(e,["thoughtSignature"],u);const h=c(n,["codeExecutionResult"]);h!=null&&f(e,["codeExecutionResult"],h);const m=c(n,["executableCode"]);m!=null&&f(e,["executableCode"],m);const p=c(n,["functionCall"]);p!=null&&f(e,["functionCall"],p);const y=c(n,["functionResponse"]);y!=null&&f(e,["functionResponse"],y);const T=c(n,["text"]);return T!=null&&f(e,["text"],T),e}function L1(n){const e={},t=c(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>U1(a))),f(e,["parts"],r)}const i=c(n,["role"]);return i!=null&&f(e,["role"],i),e}function P1(n){const e={},t=c(n,["behavior"]);t!=null&&f(e,["behavior"],t);const i=c(n,["description"]);i!=null&&f(e,["description"],i);const r=c(n,["name"]);r!=null&&f(e,["name"],r);const a=c(n,["parameters"]);a!=null&&f(e,["parameters"],a);const u=c(n,["parametersJsonSchema"]);u!=null&&f(e,["parametersJsonSchema"],u);const h=c(n,["response"]);h!=null&&f(e,["response"],h);const m=c(n,["responseJsonSchema"]);return m!=null&&f(e,["responseJsonSchema"],m),e}function H1(n){const e={},t=c(n,["startTime"]);t!=null&&f(e,["startTime"],t);const i=c(n,["endTime"]);return i!=null&&f(e,["endTime"],i),e}function O1(n){const e={},t=c(n,["timeRangeFilter"]);return t!=null&&f(e,["timeRangeFilter"],H1(t)),e}function B1(n){const e={},t=c(n,["mode"]);t!=null&&f(e,["mode"],t);const i=c(n,["dynamicThreshold"]);return i!=null&&f(e,["dynamicThreshold"],i),e}function V1(n){const e={},t=c(n,["dynamicRetrievalConfig"]);return t!=null&&f(e,["dynamicRetrievalConfig"],B1(t)),e}function q1(){return{}}function G1(n){const e={},t=c(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(p=>P1(p))),f(e,["functionDeclarations"],m)}if(c(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=c(n,["googleSearch"]);i!=null&&f(e,["googleSearch"],O1(i));const r=c(n,["googleSearchRetrieval"]);if(r!=null&&f(e,["googleSearchRetrieval"],V1(r)),c(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(c(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");c(n,["urlContext"])!=null&&f(e,["urlContext"],q1());const u=c(n,["codeExecution"]);u!=null&&f(e,["codeExecution"],u);const h=c(n,["computerUse"]);return h!=null&&f(e,["computerUse"],h),e}function z1(n){const e={},t=c(n,["handle"]);if(t!=null&&f(e,["handle"],t),c(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function qg(){return{}}function $1(n){const e={},t=c(n,["disabled"]);t!=null&&f(e,["disabled"],t);const i=c(n,["startOfSpeechSensitivity"]);i!=null&&f(e,["startOfSpeechSensitivity"],i);const r=c(n,["endOfSpeechSensitivity"]);r!=null&&f(e,["endOfSpeechSensitivity"],r);const a=c(n,["prefixPaddingMs"]);a!=null&&f(e,["prefixPaddingMs"],a);const u=c(n,["silenceDurationMs"]);return u!=null&&f(e,["silenceDurationMs"],u),e}function F1(n){const e={},t=c(n,["automaticActivityDetection"]);t!=null&&f(e,["automaticActivityDetection"],$1(t));const i=c(n,["activityHandling"]);i!=null&&f(e,["activityHandling"],i);const r=c(n,["turnCoverage"]);return r!=null&&f(e,["turnCoverage"],r),e}function Y1(n){const e={},t=c(n,["targetTokens"]);return t!=null&&f(e,["targetTokens"],t),e}function J1(n){const e={},t=c(n,["triggerTokens"]);t!=null&&f(e,["triggerTokens"],t);const i=c(n,["slidingWindow"]);return i!=null&&f(e,["slidingWindow"],Y1(i)),e}function j1(n){const e={},t=c(n,["proactiveAudio"]);return t!=null&&f(e,["proactiveAudio"],t),e}function K1(n,e){const t={},i=c(n,["generationConfig"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig"],i);const r=c(n,["responseModalities"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig","responseModalities"],r);const a=c(n,["temperature"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","temperature"],a);const u=c(n,["topP"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","topP"],u);const h=c(n,["topK"]);e!==void 0&&h!=null&&f(e,["setup","generationConfig","topK"],h);const m=c(n,["maxOutputTokens"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","maxOutputTokens"],m);const p=c(n,["mediaResolution"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","mediaResolution"],p);const y=c(n,["seed"]);e!==void 0&&y!=null&&f(e,["setup","generationConfig","seed"],y);const T=c(n,["speechConfig"]);e!==void 0&&T!=null&&f(e,["setup","generationConfig","speechConfig"],N1(lf(T)));const x=c(n,["enableAffectiveDialog"]);e!==void 0&&x!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],x);const C=c(n,["systemInstruction"]);e!==void 0&&C!=null&&f(e,["setup","systemInstruction"],L1(ht(C)));const A=c(n,["tools"]);if(e!==void 0&&A!=null){let O=Us(A);Array.isArray(O)&&(O=O.map(K=>G1(Ds(K)))),f(e,["setup","tools"],O)}const R=c(n,["sessionResumption"]);e!==void 0&&R!=null&&f(e,["setup","sessionResumption"],z1(R));const k=c(n,["inputAudioTranscription"]);e!==void 0&&k!=null&&f(e,["setup","inputAudioTranscription"],qg());const B=c(n,["outputAudioTranscription"]);e!==void 0&&B!=null&&f(e,["setup","outputAudioTranscription"],qg());const F=c(n,["realtimeInputConfig"]);e!==void 0&&F!=null&&f(e,["setup","realtimeInputConfig"],F1(F));const N=c(n,["contextWindowCompression"]);e!==void 0&&N!=null&&f(e,["setup","contextWindowCompression"],J1(N));const q=c(n,["proactivity"]);return e!==void 0&&q!=null&&f(e,["setup","proactivity"],j1(q)),t}function W1(n,e){const t={},i=c(e,["model"]);i!=null&&f(t,["setup","model"],Me(n,i));const r=c(e,["config"]);return r!=null&&f(t,["config"],K1(r,t)),t}function Q1(n,e,t){const i={},r=c(e,["expireTime"]);t!==void 0&&r!=null&&f(t,["expireTime"],r);const a=c(e,["newSessionExpireTime"]);t!==void 0&&a!=null&&f(t,["newSessionExpireTime"],a);const u=c(e,["uses"]);t!==void 0&&u!=null&&f(t,["uses"],u);const h=c(e,["liveConnectConstraints"]);t!==void 0&&h!=null&&f(t,["bidiGenerateContentSetup"],W1(n,h));const m=c(e,["lockAdditionalFields"]);return t!==void 0&&m!=null&&f(t,["fieldMask"],m),i}function X1(n,e){const t={},i=c(e,["config"]);return i!=null&&f(t,["config"],Q1(n,i,t)),t}function Z1(n){const e={},t=c(n,["name"]);return t!=null&&f(e,["name"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function eM(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const r=Object.keys(i).map(a=>`${t}.${a}`);e.push(...r)}else e.push(t)}return e.join(",")}function tM(n,e){let t=null;const i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const a=i.setup;typeof a=="object"&&a!==null?(n.bidiGenerateContentSetup=a,t=a):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;const r=n.fieldMask;if(t){const a=eM(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)a?n.fieldMask=a:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&r!==null&&Array.isArray(r)&&r.length>0){const u=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let h=[];r.length>0&&(h=r.map(p=>u.includes(p)?`generationConfig.${p}`:p));const m=[];a&&m.push(a),h.length>0&&m.push(...h),m.length>0?n.fieldMask=m.join(","):delete n.fieldMask}else delete n.fieldMask}else r!==null&&Array.isArray(r)&&r.length>0?n.fieldMask=r.join(","):delete n.fieldMask;return n}class nM extends Ai{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const h=X1(this.apiClient,e);a=ie("auth_tokens",h._url),u=h._query,delete h.config,delete h._url,delete h._query;const m=tM(h,e.config);return r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),r.then(p=>Z1(p))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function iM(n){const e={},t=c(n,["name"]);t!=null&&f(e,["_url","name"],t);const i=c(n,["config"]);return i!=null&&f(e,["config"],i),e}function sM(n,e){const t={},i=c(n,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const r=c(n,["pageToken"]);e!==void 0&&r!=null&&f(e,["_query","pageToken"],r);const a=c(n,["filter"]);return e!==void 0&&a!=null&&f(e,["_query","filter"],a),t}function oM(n){const e={},t=c(n,["config"]);return t!=null&&f(e,["config"],sM(t,e)),e}function rM(n){const e={},t=c(n,["textInput"]);t!=null&&f(e,["textInput"],t);const i=c(n,["output"]);return i!=null&&f(e,["output"],i),e}function aM(n){const e={};if(c(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const t=c(n,["examples"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>rM(r))),f(e,["examples","examples"],i)}return e}function lM(n,e){const t={};if(c(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=c(n,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&f(e,["displayName"],i),c(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const r=c(n,["epochCount"]);e!==void 0&&r!=null&&f(e,["tuningTask","hyperparameters","epochCount"],r);const a=c(n,["learningRateMultiplier"]);if(a!=null&&f(t,["tuningTask","hyperparameters","learningRateMultiplier"],a),c(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(c(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const u=c(n,["batchSize"]);e!==void 0&&u!=null&&f(e,["tuningTask","hyperparameters","batchSize"],u);const h=c(n,["learningRate"]);return e!==void 0&&h!=null&&f(e,["tuningTask","hyperparameters","learningRate"],h),t}function uM(n){const e={},t=c(n,["baseModel"]);t!=null&&f(e,["baseModel"],t);const i=c(n,["trainingDataset"]);i!=null&&f(e,["tuningTask","trainingData"],aM(i));const r=c(n,["config"]);return r!=null&&f(e,["config"],lM(r,e)),e}function cM(n){const e={},t=c(n,["name"]);t!=null&&f(e,["_url","name"],t);const i=c(n,["config"]);return i!=null&&f(e,["config"],i),e}function fM(n,e){const t={},i=c(n,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const r=c(n,["pageToken"]);e!==void 0&&r!=null&&f(e,["_query","pageToken"],r);const a=c(n,["filter"]);return e!==void 0&&a!=null&&f(e,["_query","filter"],a),t}function dM(n){const e={},t=c(n,["config"]);return t!=null&&f(e,["config"],fM(t,e)),e}function hM(n,e){const t={},i=c(n,["gcsUri"]);e!==void 0&&i!=null&&f(e,["supervisedTuningSpec","trainingDatasetUri"],i);const r=c(n,["vertexDatasetResource"]);if(e!==void 0&&r!=null&&f(e,["supervisedTuningSpec","trainingDatasetUri"],r),c(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return t}function mM(n,e){const t={},i=c(n,["gcsUri"]);i!=null&&f(t,["validationDatasetUri"],i);const r=c(n,["vertexDatasetResource"]);return e!==void 0&&r!=null&&f(e,["supervisedTuningSpec","trainingDatasetUri"],r),t}function pM(n,e){const t={},i=c(n,["validationDataset"]);e!==void 0&&i!=null&&f(e,["supervisedTuningSpec"],mM(i,t));const r=c(n,["tunedModelDisplayName"]);e!==void 0&&r!=null&&f(e,["tunedModelDisplayName"],r);const a=c(n,["description"]);e!==void 0&&a!=null&&f(e,["description"],a);const u=c(n,["epochCount"]);e!==void 0&&u!=null&&f(e,["supervisedTuningSpec","hyperParameters","epochCount"],u);const h=c(n,["learningRateMultiplier"]);e!==void 0&&h!=null&&f(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],h);const m=c(n,["exportLastCheckpointOnly"]);e!==void 0&&m!=null&&f(e,["supervisedTuningSpec","exportLastCheckpointOnly"],m);const p=c(n,["adapterSize"]);if(e!==void 0&&p!=null&&f(e,["supervisedTuningSpec","hyperParameters","adapterSize"],p),c(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(c(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return t}function gM(n){const e={},t=c(n,["baseModel"]);t!=null&&f(e,["baseModel"],t);const i=c(n,["trainingDataset"]);i!=null&&f(e,["supervisedTuningSpec","trainingDatasetUri"],hM(i,e));const r=c(n,["config"]);return r!=null&&f(e,["config"],pM(r,e)),e}function yM(n){const e={},t=c(n,["name"]);t!=null&&f(e,["model"],t);const i=c(n,["name"]);return i!=null&&f(e,["endpoint"],i),e}function hv(n){const e={},t=c(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=c(n,["name"]);i!=null&&f(e,["name"],i);const r=c(n,["state"]);r!=null&&f(e,["state"],$y(r));const a=c(n,["createTime"]);a!=null&&f(e,["createTime"],a);const u=c(n,["tuningTask","startTime"]);u!=null&&f(e,["startTime"],u);const h=c(n,["tuningTask","completeTime"]);h!=null&&f(e,["endTime"],h);const m=c(n,["updateTime"]);m!=null&&f(e,["updateTime"],m);const p=c(n,["description"]);p!=null&&f(e,["description"],p);const y=c(n,["baseModel"]);y!=null&&f(e,["baseModel"],y);const T=c(n,["_self"]);T!=null&&f(e,["tunedModel"],yM(T));const x=c(n,["distillationSpec"]);x!=null&&f(e,["distillationSpec"],x);const C=c(n,["experiment"]);C!=null&&f(e,["experiment"],C);const A=c(n,["labels"]);A!=null&&f(e,["labels"],A);const R=c(n,["pipelineJob"]);R!=null&&f(e,["pipelineJob"],R);const k=c(n,["satisfiesPzi"]);k!=null&&f(e,["satisfiesPzi"],k);const B=c(n,["satisfiesPzs"]);B!=null&&f(e,["satisfiesPzs"],B);const F=c(n,["serviceAccount"]);F!=null&&f(e,["serviceAccount"],F);const N=c(n,["tunedModelDisplayName"]);return N!=null&&f(e,["tunedModelDisplayName"],N),e}function vM(n){const e={},t=c(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=c(n,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const r=c(n,["tunedModels"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(u=>hv(u))),f(e,["tuningJobs"],a)}return e}function TM(n){const e={},t=c(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=c(n,["name"]);i!=null&&f(e,["name"],i);const r=c(n,["metadata"]);r!=null&&f(e,["metadata"],r);const a=c(n,["done"]);a!=null&&f(e,["done"],a);const u=c(n,["error"]);return u!=null&&f(e,["error"],u),e}function SM(n){const e={},t=c(n,["checkpointId"]);t!=null&&f(e,["checkpointId"],t);const i=c(n,["epoch"]);i!=null&&f(e,["epoch"],i);const r=c(n,["step"]);r!=null&&f(e,["step"],r);const a=c(n,["endpoint"]);return a!=null&&f(e,["endpoint"],a),e}function xM(n){const e={},t=c(n,["model"]);t!=null&&f(e,["model"],t);const i=c(n,["endpoint"]);i!=null&&f(e,["endpoint"],i);const r=c(n,["checkpoints"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(u=>SM(u))),f(e,["checkpoints"],a)}return e}function Hc(n){const e={},t=c(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=c(n,["name"]);i!=null&&f(e,["name"],i);const r=c(n,["state"]);r!=null&&f(e,["state"],$y(r));const a=c(n,["createTime"]);a!=null&&f(e,["createTime"],a);const u=c(n,["startTime"]);u!=null&&f(e,["startTime"],u);const h=c(n,["endTime"]);h!=null&&f(e,["endTime"],h);const m=c(n,["updateTime"]);m!=null&&f(e,["updateTime"],m);const p=c(n,["error"]);p!=null&&f(e,["error"],p);const y=c(n,["description"]);y!=null&&f(e,["description"],y);const T=c(n,["baseModel"]);T!=null&&f(e,["baseModel"],T);const x=c(n,["tunedModel"]);x!=null&&f(e,["tunedModel"],xM(x));const C=c(n,["supervisedTuningSpec"]);C!=null&&f(e,["supervisedTuningSpec"],C);const A=c(n,["tuningDataStats"]);A!=null&&f(e,["tuningDataStats"],A);const R=c(n,["encryptionSpec"]);R!=null&&f(e,["encryptionSpec"],R);const k=c(n,["partnerModelTuningSpec"]);k!=null&&f(e,["partnerModelTuningSpec"],k);const B=c(n,["distillationSpec"]);B!=null&&f(e,["distillationSpec"],B);const F=c(n,["experiment"]);F!=null&&f(e,["experiment"],F);const N=c(n,["labels"]);N!=null&&f(e,["labels"],N);const q=c(n,["pipelineJob"]);q!=null&&f(e,["pipelineJob"],q);const O=c(n,["satisfiesPzi"]);O!=null&&f(e,["satisfiesPzi"],O);const K=c(n,["satisfiesPzs"]);K!=null&&f(e,["satisfiesPzs"],K);const Q=c(n,["serviceAccount"]);Q!=null&&f(e,["serviceAccount"],Q);const de=c(n,["tunedModelDisplayName"]);return de!=null&&f(e,["tunedModelDisplayName"],de),e}function _M(n){const e={},t=c(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=c(n,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const r=c(n,["tuningJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(u=>Hc(u))),f(e,["tuningJobs"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class CM extends Ai{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new nr(Ci.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const i=await this.tuneMldevInternal(t);let r="";return i.metadata!==void 0&&i.metadata.tunedModel!==void 0?r=i.metadata.tunedModel:i.name!==void 0&&i.name.includes("/operations/")&&(r=i.name.split("/operations/")[0]),{name:r,state:bc.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,r,a;let u,h="",m={};if(this.apiClient.isVertexAI()){const p=cM(e);return h=ie("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),u.then(y=>Hc(y))}else{const p=iM(e);return h=ie("{name}",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),u.then(y=>hv(y))}}async listInternal(e){var t,i,r,a;let u,h="",m={};if(this.apiClient.isVertexAI()){const p=dM(e);return h=ie("tuningJobs",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),u.then(y=>{const T=_M(y),x=new yg;return Object.assign(x,T),x})}else{const p=oM(e);return h=ie("tunedModels",p._url),m=p._query,delete p.config,delete p._url,delete p._query,u=this.apiClient.request({path:h,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(y=>y.json().then(T=>{const x=T;return x.sdkHttpResponse={headers:y.headers},x})),u.then(y=>{const T=vM(y),x=new yg;return Object.assign(x,T),x})}}async tuneInternal(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI()){const h=gM(e);return a=ie("tuningJobs",h._url),u=h._query,delete h.config,delete h._url,delete h._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(p=>{const y=p;return y.sdkHttpResponse={headers:m.headers},y})),r.then(m=>Hc(m))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=uM(e);return a=ie("tunedModels",h._url),u=h._query,delete h.config,delete h._url,delete h._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(p=>{const y=p;return y.sdkHttpResponse={headers:m.headers},y})),r.then(m=>TM(m))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class EM{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const AM=1024*1024*8,wM=3,bM=1e3,RM=2,mc="x-goog-upload-status";async function MM(n,e,t){var i,r,a;let u=0,h=0,m=new Rc(new Response),p="upload";for(u=n.size;h<u;){const T=Math.min(AM,u-h),x=n.slice(h,h+T);h+T>=u&&(p+=", finalize");let C=0,A=bM;for(;C<wM&&(m=await t.request({path:"",body:x,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":p,"X-Goog-Upload-Offset":String(h),"Content-Length":String(T)}}}),!(!((i=m==null?void 0:m.headers)===null||i===void 0)&&i[mc]));)C++,await kM(A),A=A*RM;if(h+=T,((r=m==null?void 0:m.headers)===null||r===void 0?void 0:r[mc])!=="active")break;if(u<=h)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const y=await(m==null?void 0:m.json());if(((a=m==null?void 0:m.headers)===null||a===void 0?void 0:a[mc])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return y.file}async function NM(n){return{size:n.size,type:n.type}}function kM(n){return new Promise(e=>setTimeout(e,n))}class IM{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await MM(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await NM(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class DM{create(e,t,i){return new UM(e,t,i)}}class UM{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Gg="x-goog-api-key";class LM{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(Gg)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(Gg,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const PM="gl-node/";class HM{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const i=Ux(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion;const r=new LM(this.apiKey);this.apiClient=new n1({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:PM+"web",uploader:new IM,downloader:new EM}),this.models=new _1(this.apiClient),this.live=new p1(this.apiClient,r,new DM),this.batches=new sC(this.apiClient),this.chats=new lE(this.models,this.apiClient),this.caches=new oE(this.apiClient),this.files=new xE(this.apiClient),this.operations=new w1(this.apiClient),this.authTokens=new nM(this.apiClient),this.tunings=new CM(this.apiClient)}}const qa=class qa{static calibrateConfidence(e,t=!1,i){const a={...t?this.ULTRA_MODE_WEIGHTS:this.DEFAULT_WEIGHTS,...i},u=this.calculateConfidenceFactors(e),h=this.calculateWeightedScore(u,a),m=this.calculateConfidenceInterval(u,h,e),p=this.generateConfidenceBreakdown(u,a,e),y=this.gatherHistoricalContext(e),T=this.calculateRiskAdjustments(e);return{overallScore:this.applyFinalAdjustments(h,T,t),factors:u,weights:a,interval:m,breakdown:p,historicalContext:y,riskAdjustments:T}}static calculateConfidenceFactors(e){const t=this.calculateTechnicalConfluence(e),i=this.calculateHistoricalPatternSuccess(e),r=this.calculateMarketConditionsFactor(e),a=this.calculateVolatilityAdjustment(e),u=this.calculateVolumeConfirmation(e),h=this.calculateStructuralIntegrity(e);return{technicalConfluence:t,historicalPatternSuccess:i,marketConditions:r,volatilityAdjustment:a,volumeConfirmation:u,structuralIntegrity:h}}static calculateTechnicalConfluence(e){let t=50;if(e.multiTimeframeContext){const i=e.multiTimeframeContext;t+=i.confluenceScore*.4,i.conflictingSignals&&i.conflictingSignals.length>0&&(t-=i.conflictingSignals.length*5),i.overallTrend!=="MIXED"&&(t+=10)}if(e.patternAnalysis){const i=e.patternAnalysis;t+=(i.patternConfluence.confidenceScore-50)*.3,i.conflictingPatterns.length>0&&(t-=i.conflictingPatterns.length*3),i.marketCondition.trend.includes("STRONG")&&(t+=5)}if(e.smcAnalysis){const i=e.smcAnalysis;i.tradingBias.direction!=="NEUTRAL"&&(t+=i.tradingBias.confidence*.2),i.confluences.liquidityConfluence.length>2&&(t+=8),i.confluences.orderBlockConfluence.length>1&&(t+=6)}return Math.max(0,Math.min(100,t))}static calculateHistoricalPatternSuccess(e){let t=60;if(e.signal!=="NEUTRAL"&&(e.overallConfidenceScore>=80?t+=15:e.overallConfidenceScore>=60?t+=8:t-=10),e.patternAnalysis){const i=e.patternAnalysis;if(i.classicPatterns.length>0){const r=i.classicPatterns.reduce((a,u)=>a+u.reliability,0)/i.classicPatterns.length;t+=(r-50)*.4}if(i.harmonicPatterns.length>0){const r=i.harmonicPatterns.filter(a=>a.status==="COMPLETED");if(r.length>0){const a=r.reduce((u,h)=>u+h.validity,0)/r.length;t+=(a-50)*.3}}}if(e.multiTimeframeContext){const i=e.multiTimeframeContext;i.overallTrend!=="MIXED"&&i.confluenceScore>70&&(t+=12)}return Math.max(0,Math.min(100,t))}static calculateMarketConditionsFactor(e){let t=50;if(e.patternAnalysis){const i=e.patternAnalysis;switch(i.marketCondition.phase){case"MARKUP":case"ACCUMULATION":t+=10;break;case"DISTRIBUTION":case"MARKDOWN":t-=5;break;case"REACCUMULATION":case"REDISTRIBUTION":t+=3;break}switch(i.marketCondition.volatility){case"LOW":t+=8;break;case"MEDIUM":t+=2;break;case"HIGH":t-=5;break;case"EXTREME":t-=12;break}}return Math.max(0,Math.min(100,t))}static calculateVolatilityAdjustment(e){let t=70,i="MEDIUM";switch(e.patternAnalysis&&(i=e.patternAnalysis.marketCondition.volatility),i){case"LOW":t=85;break;case"MEDIUM":t=70;break;case"HIGH":t=45;break;case"EXTREME":t=25;break}e.overallConfidenceScore<60&&(i==="HIGH"||i==="EXTREME")&&(t-=15);const r=new Date().getHours();return r>=2&&r<=6?t+=5:r>=8&&r<=16&&(t-=3),Math.max(0,Math.min(100,t))}static calculateVolumeConfirmation(e){var i,r,a;let t=50;if((i=e.patternAnalysis)!=null&&i.volumeProfile){const u=e.patternAnalysis.volumeProfile;u.marketStructure.balanced&&(t+=8),u.marketStructure.trending&&(t+=12),u.marketStructure.rotational&&(t-=5),u.tradingImplications.acceptance&&(t+=10),u.tradingImplications.support.length>2&&(t+=6),u.tradingImplications.resistance.length>2&&(t+=6)}if((r=e.patternAnalysis)!=null&&r.classicPatterns){const u=e.patternAnalysis.classicPatterns;for(const h of u)h.volume.breakoutVolume==="CONFIRMED"?t+=15:h.volume.breakoutVolume==="WEAK"&&(t-=8),h.volume.patternVolume==="INCREASING"?t+=8:h.volume.patternVolume==="DECREASING"&&(t-=5)}if((a=e.patternAnalysis)!=null&&a.wyckoffAnalysis){const u=e.patternAnalysis.wyckoffAnalysis;u.volumeCharacteristics.climacticVolume&&(t+=12),u.volumeCharacteristics.volumeConfirmation&&(t+=15),u.volumeCharacteristics.volumeDrying&&(t-=8)}return Math.max(0,Math.min(100,t))}static calculateStructuralIntegrity(e){let t=50;if(!e.smcAnalysis)return t;const i=e.smcAnalysis;switch(i.overallStructure){case"BULLISH_STRUCTURE":case"BEARISH_STRUCTURE":t+=20;break;case"RANGING":t+=5;break;case"TRANSITIONAL":t-=10;break}t+=(i.tradingBias.confidence-50)*.4;const r=i.criticalLevels;r.highestProbabilityZones.length>2&&(t+=8),r.liquidityTargets.length>1&&(t+=6),r.structuralSupports.length+r.structuralResistances.length>3&&(t+=5);const a=i.confluences;a.orderBlockConfluence.length>1&&(t+=8),a.fvgConfluence.length>0&&(t+=5),a.liquidityConfluence.length>1&&(t+=7);const u=i.riskAssessment;return t-=u.liquidityRisks.length*3,t-=u.structuralRisks.length*4,Math.max(0,Math.min(100,t))}static calculateWeightedScore(e,t){const i=e.technicalConfluence*t.technicalConfluence+e.historicalPatternSuccess*t.historicalPatternSuccess+e.marketConditions*t.marketConditions+e.volatilityAdjustment*t.volatilityAdjustment+e.volumeConfirmation*t.volumeConfirmation+e.structuralIntegrity*t.structuralIntegrity;return Math.round(i)}static calculateConfidenceInterval(e,t,i){const r=Object.values(e),a=r.reduce((R,k)=>R+k,0)/r.length,u=r.reduce((R,k)=>R+Math.pow(k-a,2),0)/r.length,h=Math.sqrt(u);let m=Math.min(25,h*.6);const p=this.assessDataQuality(i);m+=(100-p)*.15;const y=this.assessSignalClarity(i);m+=(100-y)*.1;const T=this.assessMarketNoise(i);m+=T*.08,m=Math.max(5,Math.min(30,m));const x=Math.max(0,t-m),C=Math.min(100,t+m);let A;return m<=8?A="VERY_HIGH":m<=15?A="HIGH":m<=22?A="MEDIUM":A="LOW",{centerValue:t,lowerBound:x,upperBound:C,uncertainty:Math.round(m),reliability:A}}static generateConfidenceBreakdown(e,t,i){const r={};return Object.entries(e).forEach(([a,u])=>{const h=t[a];r[a]=Math.round(u*h)}),{factorContributions:r,qualityMetrics:{dataQuality:this.assessDataQuality(i),signalClarity:this.assessSignalClarity(i),marketNoise:this.assessMarketNoise(i)}}}static gatherHistoricalContext(e){var u,h;let t=50,i=65,r=8.5,a=-4.2;return e.signal!=="NEUTRAL"&&(e.overallConfidenceScore>=80?(t+=20,i+=15,r+=3.2,a-=1.1):e.overallConfidenceScore>=60&&(t+=10,i+=8,r+=1.5,a-=.5)),(u=e.patternAnalysis)!=null&&u.harmonicPatterns.length&&(i+=5,r+=1.2),(h=e.multiTimeframeContext)!=null&&h.confluenceScore&&e.multiTimeframeContext.confluenceScore>70&&(i+=10,r+=2.1),{similarPatternCount:Math.round(t),successRate:Math.round(i),avgReturnOnSuccess:Math.round(r*100)/100,avgLossOnFailure:Math.round(a*100)/100}}static calculateRiskAdjustments(e){let t=0,i=0,r=0;const a=new Date().getHours();return(a>=22||a<=6)&&(i=5),![0,6].includes(new Date().getDay())&&a>=8&&a<=10&&(r=3),{volatilityPenalty:t,liquidityDiscount:i,newsRisk:r}}static applyFinalAdjustments(e,t,i){let r=e;return r-=t.volatilityPenalty,r-=t.liquidityDiscount,r-=t.newsRisk,i&&(r*=.95),Math.max(0,Math.min(100,Math.round(r)))}static assessDataQuality(e){let t=70;return e.multiTimeframeContext&&(t+=15),e.smcAnalysis&&(t+=10),e.patternAnalysis&&(t+=10),Math.min(100,t)}static assessSignalClarity(e){var i;let t=50;return e.signal!=="NEUTRAL"&&(t+=20,e.overallConfidenceScore>=75?t+=20:e.overallConfidenceScore>=50&&(t+=10)),(i=e.multiTimeframeContext)!=null&&i.overallTrend&&e.multiTimeframeContext.overallTrend!=="MIXED"&&(t+=15),Math.min(100,t)}static assessMarketNoise(e){var i;let t=30;return((i=e.patternAnalysis)==null?void 0:i.patternConfluence.confidenceScore)>70&&(t-=8),Math.max(0,Math.min(100,t))}static formatConfidenceDisplay(e){const{overallScore:t,interval:i}=e,r=i.uncertainty>0?` ${i.uncertainty}%`:"",a=i.reliability.toLowerCase();return`${t}%${r} (${a} reliability)`}static getConfidenceLevel(e,t=!1){const i=t?85:75;return e.overallScore>=i?"HIGH":"LOW"}};qa.DEFAULT_WEIGHTS={technicalConfluence:.25,historicalPatternSuccess:.2,marketConditions:.15,volatilityAdjustment:.15,volumeConfirmation:.15,structuralIntegrity:.1},qa.ULTRA_MODE_WEIGHTS={technicalConfluence:.3,historicalPatternSuccess:.25,marketConditions:.15,volatilityAdjustment:.1,volumeConfirmation:.15,structuralIntegrity:.05};let Oa=qa;class mv{constructor(e){var t,i,r,a,u,h,m,p,y,T,x,C,A,R,k,B;this.priceHistory=[],this.volumeHistory=[],this.regimeHistory=[],this.config={lookbackPeriod:(e==null?void 0:e.lookbackPeriod)??30,updateFrequency:(e==null?void 0:e.updateFrequency)??15,volatilityWindow:(e==null?void 0:e.volatilityWindow)??14,trendWindow:(e==null?void 0:e.trendWindow)??20,momentumWindow:(e==null?void 0:e.momentumWindow)??14,thresholds:{volatility:{low:((i=(t=e==null?void 0:e.thresholds)==null?void 0:t.volatility)==null?void 0:i.low)??.5,normal:((a=(r=e==null?void 0:e.thresholds)==null?void 0:r.volatility)==null?void 0:a.normal)??1.5,high:((h=(u=e==null?void 0:e.thresholds)==null?void 0:u.volatility)==null?void 0:h.high)??3},trend:{weak:((p=(m=e==null?void 0:e.thresholds)==null?void 0:m.trend)==null?void 0:p.weak)??25,moderate:((T=(y=e==null?void 0:e.thresholds)==null?void 0:y.trend)==null?void 0:T.moderate)??40,strong:((C=(x=e==null?void 0:e.thresholds)==null?void 0:x.trend)==null?void 0:C.strong)??60},ranging:{efficiency:((R=(A=e==null?void 0:e.thresholds)==null?void 0:A.ranging)==null?void 0:R.efficiency)??30,consolidation:((B=(k=e==null?void 0:e.thresholds)==null?void 0:k.ranging)==null?void 0:B.consolidation)??70}},...e}}async detectMarketRegime(e,t,i="1H"){if(e.length<this.config.volatilityWindow)throw new Error("Insufficient price data for regime detection");this.priceHistory=e,this.volumeHistory=t;const r=this.calculateVolatilityMetrics(e),a=this.calculateTrendMetrics(e),u=this.calculateRangingMetrics(e),h=this.calculateMomentumMetrics(e),m=this.classifyTrendRegime(a,h),p=this.classifyDirectionRegime(a,u),y=r.regime,T=h.regime,x=this.determineOverallRegime(m,p,y,T),C=this.calculateConfidence(r,a,u,h),A=this.calculateStability(),R=this.generateAnalysisAdjustments(x,y,m,T),k=this.getRegimeHistory(),{warnings:B,opportunities:F}=this.generateInsights(x,r,a,h),N={timestamp:new Date().toISOString(),timeframe:i,trendRegime:m,directionRegime:p,volatilityRegime:y,momentumRegime:T,volatilityMetrics:r,trendMetrics:a,rangingMetrics:u,momentumMetrics:h,overallRegime:x,confidence:C,stability:A,analysisAdjustments:R,regimeHistory:k,warnings:B,opportunities:F,nextReviewTime:new Date(Date.now()+this.config.updateFrequency*6e4).toISOString()};return this.regimeHistory.push(N),this.regimeHistory.length>100&&(this.regimeHistory=this.regimeHistory.slice(-100)),N}calculateVolatilityMetrics(e){const t=this.calculateReturns(e),i=this.calculateATR(e),r=i/e[e.length-1]*100,a=this.calculateStandardDeviation(t),u=this.calculateVolatilityPercentile(a);let h;r<this.config.thresholds.volatility.low?h="LOW":r<this.config.thresholds.volatility.normal?h="NORMAL":r<this.config.thresholds.volatility.high?h="HIGH":h="EXTREME";const m=this.detectVolatilityCluster(t);return{atr:i,atrNormalized:r,standardDeviation:a,volatilityPercentile:u,regime:h,isVolatilityCluster:m}}calculateTrendMetrics(e){const t=this.calculateADX(e),i=this.determineTrendDirection(e),r=this.calculateTrendConsistency(e),a=this.calculateTrendAge(e);let u;return t<20?u="VERY_WEAK":t<this.config.thresholds.trend.weak?u="WEAK":t<this.config.thresholds.trend.moderate?u="MODERATE":t<this.config.thresholds.trend.strong?u="STRONG":u="VERY_STRONG",{adx:t,trendStrength:u,direction:i,consistency:r,trendAge:a,regime:"NEUTRAL"}}calculateRangingMetrics(e){const t=this.calculatePriceEfficiency(e),i=this.calculateConsolidationStrength(e),r=this.calculateBreakoutProbability(e),a=this.calculateSRStrength(e);let u;return i>80?u="EXCELLENT":i>60?u="GOOD":i>40?u="FAIR":u="POOR",{efficiency:t,consolidationStrength:i,breakoutProbability:r,rangeQuality:u,supportResistanceStrength:a}}calculateMomentumMetrics(e){const t=this.calculateRSI(e),i=this.calculateMACD(e),r=this.calculateROC(e),a=this.detectDivergence(e,t),u=this.detectMomentumShift(t,i);let h;return Math.abs(i.histogram)>Math.abs(this.getHistoricalAverage(this.getMACDHistory(),10))*1.5?h="ACCELERATING":Math.abs(i.histogram)<Math.abs(this.getHistoricalAverage(this.getMACDHistory(),10))*.5?h="DECELERATING":this.calculateVolatility(this.getROCHistory())<.5?h="STABLE":h="CHOPPY",{rsi:t,macd:i,roc:r,divergenceDetected:a,regime:h,momentumShift:u}}classifyTrendRegime(e,t){const{adx:i,direction:r,consistency:a}=e,{rsi:u,momentumShift:h}=t;if(r==="UP"){if(i>50&&u>60&&a>70&&h==="BULLISH")return"STRONG_BULL";if(i>25&&u>50)return"WEAK_BULL"}else if(r==="DOWN"){if(i>50&&u<40&&a>70&&h==="BEARISH")return"STRONG_BEAR";if(i>25&&u<50)return"WEAK_BEAR"}return"NEUTRAL"}classifyDirectionRegime(e,t){const{adx:i,trendStrength:r}=e,{efficiency:a,consolidationStrength:u}=t;return i>40&&a>60?"TRENDING":i<20&&u>this.config.thresholds.ranging.consolidation?"RANGING":"TRANSITIONAL"}determineOverallRegime(e,t,i,r){return t==="TRANSITIONAL"||i==="EXTREME"?"TRANSITIONAL":e==="STRONG_BULL"||e==="WEAK_BULL"?t==="TRENDING"?"BULL_TRENDING":"BULL_RANGING":e==="STRONG_BEAR"||e==="WEAK_BEAR"?t==="TRENDING"?"BEAR_TRENDING":"BEAR_RANGING":t==="TRENDING"?"NEUTRAL_TRENDING":"NEUTRAL_RANGING"}calculateConfidence(e,t,i,r){let a=50;return(e.volatilityPercentile>80||e.volatilityPercentile<20)&&(a+=15),t.adx>40?a+=20:t.adx<20&&(a+=10),t.consistency>70&&(a+=10),r.divergenceDetected||(a+=10),i.rangeQuality==="EXCELLENT"&&(a+=15),Math.min(95,Math.max(20,a))}calculateStability(){if(this.regimeHistory.length<3)return 50;const e=this.regimeHistory.slice(-5),t=new Set(e.map(r=>r.overallRegime));return Math.max(20,100-(t.size-1)*20)}generateAnalysisAdjustments(e,t,i,r){let a=1,u=1,h=1,m="NONE",p="CONSERVATIVE";switch(t){case"LOW":a=1.2,u=.8,p="PATIENT";break;case"HIGH":a=.7,u=1.3,m="LOWER",p="CONSERVATIVE";break;case"EXTREME":a=.5,u=1.5,m="LOWER",p="SCALPING";break}switch(i){case"STRONG_BULL":case"STRONG_BEAR":h=1.4,m="HIGHER",p="AGGRESSIVE";break;case"WEAK_BULL":case"WEAK_BEAR":h=1.1;break}switch(e){case"BULL_TRENDING":case"BEAR_TRENDING":a*=1.1;break;case"NEUTRAL_RANGING":h=.8,p="SCALPING";break;case"TRANSITIONAL":a*=.8,p="PATIENT";break}return{riskMultiplier:a,stopLossAdjustment:u,takeProfitAdjustment:h,timeframeBias:m,entryApproach:p}}getRegimeHistory(){if(this.regimeHistory.length===0)return{previousRegime:"UNKNOWN",timeInCurrentRegime:0,averageRegimeDuration:0,recentRegimeChanges:0};const e=this.regimeHistory[this.regimeHistory.length-1],t=this.regimeHistory.length>1?this.regimeHistory[this.regimeHistory.length-2].overallRegime:"UNKNOWN",i=this.findRegimeStart(e.overallRegime),r=i?(Date.now()-new Date(i).getTime())/(1e3*60*60):0,a=this.calculateAverageRegimeDuration(),u=this.countRecentRegimeChanges();return{previousRegime:t,timeInCurrentRegime:r,averageRegimeDuration:a,recentRegimeChanges:u}}generateInsights(e,t,i,r){const a=[],u=[];switch(t.regime==="EXTREME"&&a.push("Extreme volatility detected - consider reducing position sizes"),t.isVolatilityCluster&&a.push("Volatility clustering detected - expect continued high volatility"),i.trendAge>30&&a.push("Trend is mature - watch for potential reversal signals"),i.consistency<40&&a.push("Trend lacks consistency - be cautious of false breakouts"),r.divergenceDetected&&a.push("Price-momentum divergence detected - potential trend weakness"),e){case"BULL_TRENDING":u.push("Strong bullish trend - consider trend-following strategies"),u.push("Look for pullback entries on higher timeframes");break;case"BEAR_TRENDING":u.push("Strong bearish trend - consider short positions"),u.push("Watch for bounce-shorting opportunities");break;case"NEUTRAL_RANGING":u.push("Range-bound market - consider mean-reversion strategies"),u.push("Trade range boundaries with tight stops");break;case"TRANSITIONAL":u.push("Market in transition - wait for clearer direction"),u.push("Focus on lower timeframes for scalping opportunities");break}return t.regime==="LOW"&&u.push("Low volatility environment - consider breakout strategies"),{warnings:a,opportunities:u}}calculateReturns(e){const t=[];for(let i=1;i<e.length;i++)t.push((e[i]-e[i-1])/e[i-1]);return t}calculateATR(e,t=14){if(e.length<t+1)return 0;const i=[];for(let r=1;r<e.length;r++){const a=e[r],u=e[r],h=e[r-1],m=Math.max(a-u,Math.abs(a-h),Math.abs(u-h));i.push(m)}return this.calculateSMA(i.slice(-t))}calculateStandardDeviation(e){const t=e.reduce((a,u)=>a+u,0)/e.length,r=e.map(a=>Math.pow(a-t,2)).reduce((a,u)=>a+u,0)/e.length;return Math.sqrt(r)}calculateVolatilityPercentile(e){const t=this.getHistoricalVolatilities();if(t.length===0)return 50;const i=[...t].sort((a,u)=>a-u);return i.filter(a=>a<=e).length/i.length*100}detectVolatilityCluster(e){if(e.length<10)return!1;const t=e.slice(-5),i=this.calculateStandardDeviation(t),r=this.calculateStandardDeviation(e.slice(-20,-5));return i>r*1.5}calculateADX(e,t=14){if(e.length<t*2)return 0;const i=this.calculateTrendStrength(e,t);return Math.min(100,i*100)}determineTrendDirection(e){if(e.length<20)return"SIDEWAYS";const t=e.slice(-10),i=e.slice(-20,-10),r=this.calculateSMA(t),a=this.calculateSMA(i),u=(r-a)/a;return u>.02?"UP":u<-.02?"DOWN":"SIDEWAYS"}calculateTrendConsistency(e){if(e.length<10)return 0;const t=this.determineTrendDirection(e);if(t==="SIDEWAYS")return 0;let i=0;const r=t==="UP";for(let a=1;a<e.length;a++){const u=e[a]-e[a-1];(r&&u>0||!r&&u<0)&&i++}return i/(e.length-1)*100}calculateTrendAge(e){const t=this.determineTrendDirection(e);if(t==="SIDEWAYS")return 0;const i=t==="UP";let r=0;for(let a=e.length-1;a>0;a--){const u=e[a]-e[a-1];if(i&&u>0||!i&&u<0)r++;else break}return r}calculatePriceEfficiency(e){if(e.length<2)return 0;const t=Math.abs(e[e.length-1]-e[0]);let i=0;for(let r=1;r<e.length;r++)i+=Math.abs(e[r]-e[r-1]);return i>0?t/i*100:0}calculateConsolidationStrength(e){if(e.length<10)return 0;const t=Math.max(...e),i=Math.min(...e),r=t-i;return e[e.length-1],e.filter(u=>u>=i+r*.1&&u<=t-r*.1).length/e.length*100}calculateBreakoutProbability(e){const t=this.calculateConsolidationStrength(e),i=this.calculateStandardDeviation(this.calculateReturns(e));return Math.min(100,Math.max(0,100-t+i*1e3))}calculateSRStrength(e){return this.findKeyLevels(e).length*20}calculateRSI(e,t=14){if(e.length<t+1)return 50;const r=this.calculateReturns(e).slice(-t),a=r.filter(y=>y>0),u=r.filter(y=>y<0).map(y=>Math.abs(y)),h=a.length>0?a.reduce((y,T)=>y+T,0)/a.length:0,m=u.length>0?u.reduce((y,T)=>y+T,0)/u.length:0;return m===0?100:100-100/(1+h/m)}calculateMACD(e){const t=this.calculateEMA(e,12),i=this.calculateEMA(e,26),r=t-i,a=this.getMACDHistory();a.push(r);const u=this.calculateSMA(a.slice(-9)),h=r-u;return{line:r,signal:u,histogram:h}}calculateROC(e,t=10){if(e.length<t+1)return 0;const i=e[e.length-1],r=e[e.length-1-t];return(i-r)/r*100}detectDivergence(e,t){if(e.length<20)return!1;const i=e.slice(-10),r=e.slice(-20,-10),a=this.calculateSMA(i)>this.calculateSMA(r),u=t>50;return a!==u}detectMomentumShift(e,t){return e>60&&t.histogram>0?"BULLISH":e<40&&t.histogram<0?"BEARISH":"NEUTRAL"}calculateSMA(e){return e.reduce((t,i)=>t+i,0)/e.length}calculateEMA(e,t){if(e.length===0)return 0;if(e.length===1)return e[0];const i=2/(t+1);let r=e[0];for(let a=1;a<e.length;a++)r=e[a]*i+r*(1-i);return r}calculateTrendStrength(e,t){if(e.length<t)return 0;const i=this.calculateSMA(e.slice(-t)),r=e[e.length-1];return Math.abs(r-i)/i}findKeyLevels(e){const t=[];for(let r=1;r<e.length-1;r++){const a=e[r],u=e[r-1],h=e[r+1];a>u&&a>h&&t.push(a),a<u&&a<h&&t.push(a)}return t.filter((r,a,u)=>u.findIndex(h=>Math.abs(h-r)/r<.001)===a)}findRegimeStart(e){for(let t=this.regimeHistory.length-1;t>=0;t--)if(this.regimeHistory[t].overallRegime!==e)return t<this.regimeHistory.length-1?this.regimeHistory[t+1].timestamp:null;return this.regimeHistory.length>0?this.regimeHistory[0].timestamp:null}calculateAverageRegimeDuration(){if(this.regimeHistory.length<2)return 0;const e=[];let t=this.regimeHistory[0].overallRegime,i=new Date(this.regimeHistory[0].timestamp).getTime();for(let r=1;r<this.regimeHistory.length;r++)if(this.regimeHistory[r].overallRegime!==t){const a=(new Date(this.regimeHistory[r].timestamp).getTime()-i)/36e5;e.push(a),t=this.regimeHistory[r].overallRegime,i=new Date(this.regimeHistory[r].timestamp).getTime()}return e.length>0?e.reduce((r,a)=>r+a,0)/e.length:0}countRecentRegimeChanges(){if(this.regimeHistory.length<2)return 0;const e=this.regimeHistory.slice(-10);let t=0;for(let i=1;i<e.length;i++)e[i].overallRegime!==e[i-1].overallRegime&&t++;return t}getHistoricalVolatilities(){return[]}getMACDHistory(){return[]}getROCHistory(){return[]}getHistoricalAverage(e,t){if(e.length===0)return 0;const i=e.slice(-t);return i.reduce((r,a)=>r+a,0)/i.length}calculateVolatility(e){return this.calculateStandardDeviation(e)}updateConfig(e){this.config={...this.config,...e}}getConfig(){return{...this.config}}resetHistory(){this.regimeHistory=[],this.priceHistory=[],this.volumeHistory=[]}getRegimeHistoryData(){return[...this.regimeHistory]}}const OM=void 0;throw new Error("API_KEY environment variable not set");const BM=new HM({apiKey:OM}),VM=new mv;function qM(n){const i=[],r=[];let a=5e4;for(let u=0;u<100;u++){const m=n.toLowerCase().includes("bull")?.001:n.toLowerCase().includes("bear")?-.001:0,p=(Math.random()-.5)*.02+m;a=a*(1+p),i.push(a);const y=1e6,T=Math.random()*.5+.75;r.push(y*T)}return{prices:i,volumes:r}}function GM(n){return`
MARKET REGIME ANALYSIS:
 Overall Regime: ${n.overallRegime} (${n.confidence}% confidence)
 Trend Regime: ${n.trendRegime}
 Direction Regime: ${n.directionRegime} 
 Volatility Regime: ${n.volatilityRegime} (ATR: ${n.volatilityMetrics.atrNormalized.toFixed(2)}%)
 Momentum Regime: ${n.momentumRegime}

VOLATILITY METRICS:
 ATR Normalized: ${n.volatilityMetrics.atrNormalized.toFixed(2)}%
 Volatility Percentile: ${n.volatilityMetrics.volatilityPercentile.toFixed(0)}th percentile
 Volatility Clustering: ${n.volatilityMetrics.isVolatilityCluster?"DETECTED":"NONE"}

TREND METRICS:
 ADX: ${n.trendMetrics.adx.toFixed(1)} (${n.trendMetrics.trendStrength})
 Direction: ${n.trendMetrics.direction}
 Consistency: ${n.trendMetrics.consistency.toFixed(0)}%
 Trend Age: ${n.trendMetrics.trendAge} periods

ANALYSIS ADJUSTMENTS:
 Risk Multiplier: ${n.analysisAdjustments.riskMultiplier.toFixed(2)}x
 Stop Loss Adjustment: ${n.analysisAdjustments.stopLossAdjustment.toFixed(2)}x
 Take Profit Adjustment: ${n.analysisAdjustments.takeProfitAdjustment.toFixed(2)}x
 Entry Approach: ${n.analysisAdjustments.entryApproach}
 Timeframe Bias: ${n.analysisAdjustments.timeframeBias}

REGIME INSIGHTS:
${n.warnings.length>0?` Warnings: ${n.warnings.join("; ")}`:""}
${n.opportunities.length>0?` Opportunities: ${n.opportunities.join("; ")}`:""}

REGIME STABILITY: ${n.stability}% | Time in Current Regime: ${n.regimeHistory.timeInCurrentRegime.toFixed(1)} hours
`}async function pv(n,e,t,i=6e4,r=3){const a=async(u=1)=>{try{return await Promise.race([BM.models.generateContentStream({model:n,contents:e,config:t}),new Promise((h,m)=>setTimeout(()=>m(new Error(`Request timeout after ${i/1e3} seconds`)),i))])}catch(h){if(h instanceof Error&&(h.message.includes("timeout")||h.message.includes("Failed to fetch")||h.message.includes("NetworkError")||h.name==="TypeError")&&u<r)return console.log(`Gemini API attempt ${u} failed, retrying in ${u*2}s...`),await new Promise(p=>setTimeout(p,u*2e3)),a(u+1);throw h}};return a()}const zM={type:re.OBJECT,properties:{thinkingProcess:{type:re.STRING,description:"A detailed, step-by-step analysis of the chart following the required process. This should be in Markdown format."},summary:{type:re.STRING,description:"A concise summary of the overall analysis."},signal:{type:re.STRING,enum:["BUY","SELL","NEUTRAL"],description:"The final trade signal."},confidence:{type:re.STRING,enum:["HIGH","LOW"],description:"The confidence level of the signal. HIGH if overallConfidenceScore >= 75, otherwise LOW."},trade:{type:re.OBJECT,nullable:!0,description:"The trade details. Must be null if confidence is LOW or signal is NEUTRAL.",properties:{entryPrice:{type:re.STRING},takeProfit:{type:re.STRING},stopLoss:{type:re.STRING}}},timeframe:{type:re.STRING,description:"The chart's timeframe (e.g., '4-Hour', '1-Day')."},riskRewardRatio:{type:re.STRING,nullable:!0,description:"The calculated risk/reward ratio as a string (e.g., '2.5:1'). Must be null if no trade is provided."},verificationSummary:{type:re.STRING,description:"A brief, critical self-assessment of the analysis, noting any conflicting data or weaknesses."},overallConfidenceScore:{type:re.INTEGER,description:"A final numerical confidence score from 0 to 100 based on the verification step."}},required:["thinkingProcess","summary","signal","confidence","trade","timeframe","riskRewardRatio","verificationSummary","overallConfidenceScore"]},$M={type:re.OBJECT,properties:{thinkingProcess:{type:re.STRING,description:"A detailed, step-by-step multi-timeframe analysis following the required process. This should be in Markdown format."},summary:{type:re.STRING,description:"A concise summary of the overall multi-timeframe analysis."},signal:{type:re.STRING,enum:["BUY","SELL","NEUTRAL"],description:"The final trade signal based on multi-timeframe confluence."},confidence:{type:re.STRING,enum:["HIGH","LOW"],description:"The confidence level of the signal. HIGH if overallConfidenceScore >= 75, otherwise LOW."},trade:{type:re.OBJECT,nullable:!0,description:"The trade details. Must be null if confidence is LOW or signal is NEUTRAL.",properties:{entryPrice:{type:re.STRING},takeProfit:{type:re.STRING},stopLoss:{type:re.STRING}}},timeframe:{type:re.STRING,description:"The primary timeframe for trade execution (e.g., '4-Hour', '1-Day')."},riskRewardRatio:{type:re.STRING,nullable:!0,description:"The calculated risk/reward ratio as a string (e.g., '2.5:1'). Must be null if no trade is provided."},verificationSummary:{type:re.STRING,description:"A brief, critical self-assessment of the multi-timeframe analysis, noting any conflicting data or weaknesses."},overallConfidenceScore:{type:re.INTEGER,description:"A final numerical confidence score from 0 to 100 based on multi-timeframe confluence."},multiTimeframeContext:{type:re.OBJECT,description:"Multi-timeframe analysis context and confluence information.",properties:{primaryTimeframe:{type:re.STRING,description:"The primary timeframe being analyzed for trade execution."},timeframeAnalyses:{type:re.ARRAY,items:{type:re.OBJECT,properties:{timeframe:{type:re.STRING},trend:{type:re.STRING,enum:["BULLISH","BEARISH","NEUTRAL","CONSOLIDATING"]},keyLevels:{type:re.OBJECT,properties:{support:{type:re.ARRAY,items:{type:re.STRING}},resistance:{type:re.ARRAY,items:{type:re.STRING}}}},momentum:{type:re.STRING,enum:["STRONG_UP","WEAK_UP","NEUTRAL","WEAK_DOWN","STRONG_DOWN"]},confidence:{type:re.INTEGER},notes:{type:re.STRING}}}},overallTrend:{type:re.STRING,enum:["BULLISH","BEARISH","NEUTRAL","MIXED"]},confluenceScore:{type:re.INTEGER,description:"How well timeframes align (0-100)."},conflictingSignals:{type:re.ARRAY,items:{type:re.STRING},nullable:!0,description:"Areas where timeframes disagree."}}},isMultiTimeframeAnalysis:{type:re.BOOLEAN,description:"Flag indicating this is a multi-timeframe analysis."}},required:["thinkingProcess","summary","signal","confidence","trade","timeframe","riskRewardRatio","verificationSummary","overallConfidenceScore","multiTimeframeContext","isMultiTimeframeAnalysis"]},FM=`You are Wizz, an elite crypto chart analyst with advanced market regime detection capabilities. Your analysis must be precise, quantitative, and strictly confined to the visual data in the chart. Your goal is reproducibility and self-awareness with context-aware market regime adjustments.

MARKET REGIME CONTEXT will be provided to enhance your analysis with:
- Current volatility regime (LOW/NORMAL/HIGH/EXTREME)
- Trend regime (STRONG_BULL/WEAK_BULL/NEUTRAL/WEAK_BEAR/STRONG_BEAR)
- Direction regime (TRENDING/RANGING/TRANSITIONAL)
- Momentum regime (ACCELERATING/DECELERATING/STABLE/CHOPPY)
- Analysis adjustments (risk multipliers, stop/target adjustments, entry approach)

First, perform a rigorous 8-step analysis process.
1.  **Identify Timeframe:** State the chart's timeframe.
2.  **Market Regime Assessment:** Incorporate the provided market regime context into your analysis.
3.  **Identify Key Levels:** Quantify major support and resistance levels, adjusted for current volatility regime.
4.  **Analyze Chart Patterns:** Name any identified classic patterns and their implications, considering regime context.
5.  **Examine Indicators:** For each visible indicator, state its value and implication with regime-aware interpretation.
6.  **Assess Volume:** Describe the volume and correlate it with price action.
7.  **Synthesize Findings:** Briefly summarize the confluence of factors including regime considerations.
8.  **Verification & Confidence Score:** Critically review your own analysis from steps 1-7. Note any conflicting signals, weaknesses, or reasons for caution. Based on this self-critique, provide a final numerical 'overallConfidenceScore' from 0 (no confidence) to 100 (perfect confidence).

Then, run an Ensemble Strategy Confluence pass to improve signal quality:
- Build an "Ensemble Matrix" of at least these strategies visible from the chart: Trend-Following (market structure/MAs), Breakout/Range, Mean Reversion (RSI/MFI), Momentum Divergence (RSI/MACD), Liquidity/SMC (OB/FVG/equal highs-lows/sweeps), and Volume Confirmation.
- For each strategy, assign: direction vote (BUY=+1, SELL=-1, NEUTRAL=0), a strength score 0-5, and a one-sentence justification grounded in the chart.
- Aggregate votes using weights by evidence quality: strong structure/imbalance/liquidity > indicator reads > patterns.
- Only issue a non-NEUTRAL signal when the weighted sum shows clear confluence and conflicting strategies are weak. Favor NEUTRAL when mixed.

STRICT RISK RULES TO REDUCE STOP-LOSS HITS AND BOOST WIN RATE
- Default to NEUTRAL unless there is strong multi-factor confluence.
- Only provide a trade if ALL are true:
  1) overallConfidenceScore >= 75 (HIGH);
  2) clear invalidation level exists (recent swing high/low or structural break);
  3) riskRewardRatio is >= 1.8:1 based on a realistic entry, take profit, and a robust stop.
- Stop Loss Placement (must be robust):
  - Place stop beyond the invalidation point (e.g., below the last swing low for BUY, above the last swing high for SELL) with a buffer that is outside typical wick noise.
  - Avoid placing the stop inside obvious liquidity clusters such as equal highs/lows or immediately below/above a level likely to be swept.
  - If a robust stop produces R:R < 1.8:1, do NOT provide a trade; output NEUTRAL and set trade=null.
- Entry Quality:
  - Prefer pullback/mitigation entries at or near a defined level rather than chasing extended moves.
  - If the precise numeric entry cannot be justified from the chart, do not provide a trade.

Include the Ensemble Matrix and its aggregation inside 'thinkingProcess' as a concise table or list.

After your internal analysis, you MUST provide your entire response as a single, valid, minified JSON object conforming to the provided schema.

- The complete 7-step analysis MUST be placed in the 'thinkingProcess' field as a single Markdown string.
- The self-critique MUST be placed in 'verificationSummary'.
- The final score MUST be placed in 'overallConfidenceScore'.
- The 'confidence' field must be 'HIGH' if 'overallConfidenceScore' is 75 or greater, otherwise it must be 'LOW'.
- If 'confidence' is 'LOW' or 'signal' is 'NEUTRAL', the 'trade' and 'riskRewardRatio' fields MUST be null.
- If you provide a 'trade' signal, you MUST calculate the 'riskRewardRatio'.
  - For a BUY signal: Risk/Reward = (Take Profit - Entry) / (Entry - Stop Loss).
  - For a SELL signal: Risk/Reward = (Entry - Take Profit) / (Stop Loss - Entry).
  - Format the result as a string like "2.5:1". Round to one decimal place.

Do not add any text, formatting, or markdown backticks before or after the final JSON object. Your entire output must be the JSON object itself.`,YM=`You are Wizz Ultra, a world-class quantitative crypto analyst and trading algorithm. Your analysis is not mere technical analysis; it's a multi-layered, institutional-grade assessment. You operate with extreme precision, logical rigor, and a deep, holistic understanding of market dynamics. Mistakes are not an option. Your sole purpose is to provide the most accurate, profitable, and risk-managed analysis possible.

You will conduct a three-pass verification process for every chart:

**PASS 1: Core Technical Analysis (The Foundation)**
1.  **Timeframe & Asset:** Identify the asset and chart timeframe.
2.  **Market Structure:** Define the primary, secondary, and tertiary trends. Identify key swing highs and lows, and market structure breaks (MSB) or changes of character (CHoCH).
3.  **Liquidity Mapping:** Identify key liquidity zones: equal highs/lows, trendline liquidity, old highs/lows. Where is the "smart money" likely to hunt for stops?
4.  **Supply & Demand Zones:** Pinpoint significant, unmitigated order blocks, breaker blocks, and fair value gaps (FVGs) or imbalances. Quantify these price ranges.
5.  **Classic & Advanced Patterns:** Identify any classic patterns (e.g., Head & Shoulders, Triangles) and advanced formations (e.g., Wyckoff accumulation/distribution schematics, Elliott Wave counts). State the textbook implications.
6.  **Indicator Confluence:** Analyze visible indicators (RSI, MACD, MAs, etc.). Note any divergences (regular/hidden), convergences, or key level crosses. Do not just state the reading; state its implication within the current market structure.
7.  **Volume & Volatility Profile:** Analyze volume. Is it confirming price action? Note any high-volume climactic moves or low-volume corrections. Correlate with volatility.
8.  **Strategy Ensemble Matrix (Ultra)**: Build an explicit matrix of these strategies with votes and strengths grounded strictly in the visible chart: Trend-Following, Breakout/Range, Mean Reversion, Momentum Divergence, Liquidity/SMC, Volume Confirmation, and Candle/Trigger Context. For each, assign direction (BUY=+1, SELL=-1, NEUTRAL=0), strength 0-5, and a one-sentence rationale. Weight structure/liquidity > momentum > indicators > patterns. Summarize the weighted total and evidence quality.

**PASS 2: Cross-Examination & Self-Correction (The Gauntlet)**
-  **Bearish Thesis:** Force yourself to construct the strongest possible argument AGAINST your initial bullish/neutral findings. What could go wrong? Where is the analysis weakest? Identify conflicting signals between indicators, patterns, and market structure.
-  **Bullish Thesis:** Force yourself to construct the strongest possible argument AGAINST your initial bearish/neutral findings. What is the counter-argument? What bullish signals might you be downplaying?
-  **Re-evaluation:** Based on these counter-arguments, critically re-evaluate your findings from Pass 1. Refine your key levels and zones. Does the primary thesis still hold up under this scrutiny?
-  **Adversarial Ensemble Re-test:** Re-run the Strategy Ensemble assuming common failure modes (fake breakouts, liquidity sweeps beyond obvious highs/lows, indicator lag). Record any flips in strategy votes and the new weighted total.

**PASS 3: Synthesis & Final Verdict (The Execution Plan)**
1.  **Synthesized Narrative:** Combine the findings from all passes into a coherent, final analysis narrative. This is your definitive read of the market.
2.  **Final Confidence Score:** Based on the degree of confluence and the severity of conflicting data found in Pass 2, provide a final 'overallConfidenceScore' from 0 to 100. Be brutally honest.
3.  **Final Signal Generation (Ultra Gating):** Default to NEUTRAL unless conviction is very high. Only issue BUY/SELL if both the initial and adversarial ensembles agree on direction and the weighted margin is decisively in favor of that direction.
4.  **Trade Parameters (High Confidence ONLY):** If confidence is 'HIGH', provide a precise 'trade' plan with 'entryPrice', 'takeProfit', and 'stopLoss'. The entry should be a specific level, not a wide range.
5.  **Stop-Run Safeguard (critical):** Place the stop beyond the invalidation with a sensible buffer outside typical wick noise and away from obvious liquidity pools. If a robust stop leads to R:R < 2.2:1, do NOT provide a trade.
6.  **Risk/Reward Calculation:** If a trade is provided, calculate and include the 'riskRewardRatio'.

Ultra Mode Acceptance Criteria (aimed at ~2x stricter accuracy vs Normal):
- Require overallConfidenceScore >= 85 to provide any trade (confidence will still be HIGH if >=75 per schema, but you must suppress the trade unless score >=85).
- Require Strategy Ensemble AND Adversarial Ensemble to agree on direction with strong margin (e.g., majority of strategies aligned and no strong opposing evidence from liquidity or structure).
- Require evidence of a credible invalidation level that is not inside obvious liquidity. Prefer entries at mitigations/retests rather than chases.
- If any criterion fails, set 'signal' to NEUTRAL and 'trade' to null.

After this entire internal process, you MUST provide your response as a single, valid, minified JSON object conforming to the provided schema.

- The 'thinkingProcess' field must contain the complete, detailed output of all three passes, formatted in Markdown, including the Strategy Ensemble matrices (initial and adversarial) and their aggregation.
- The 'verificationSummary' will contain a concise summary of the key findings from Pass 2 (the cross-examination and adversarial re-test).
- Adhere strictly to all schema requirements regarding null fields and data types. Your entire output must be only the JSON object.`,JM="You are Wizz, an expert AI assistant specializing in cryptocurrency and technical analysis. Engage in a helpful and informative conversation with the user. If they ask about analysis but don't provide a chart, ask them to upload one. Maintain a professional and knowledgeable tone. Your answers should be formatted in Markdown.",jM="You are Wizz Ultra, a world-class quantitative crypto analyst AI. Your knowledge is vast and precise. When a user asks a question without a chart, answer it with institutional-grade insight and clarity. If they ask for analysis, politely guide them to upload a chart to unlock your full capabilities. Be direct, insightful, and confident. Your answers should be formatted in Markdown.",KM=`You are Wizz Multi-Timeframe, an elite crypto analyst specializing in multi-timeframe confluence analysis. You will analyze multiple chart timeframes simultaneously to provide superior market context and signal accuracy.

**MULTI-TIMEFRAME ANALYSIS PROCESS:**

**STEP 1: Individual Timeframe Analysis**
For each provided timeframe chart, perform:
1. **Timeframe Identification:** Clearly identify the timeframe (1H, 4H, 1D, etc.)
2. **Trend Analysis:** Determine the trend direction and strength
3. **Key Level Mapping:** Identify critical support/resistance levels
4. **Momentum Assessment:** Evaluate momentum indicators and price action
5. **Structure Analysis:** Note market structure breaks, order blocks, and liquidity zones

**STEP 2: Cross-Timeframe Confluence**
1. **Trend Alignment:** Compare trend directions across timeframes
   - Higher timeframe trend = primary bias
   - Lower timeframe trend = entry refinement
2. **Level Confluence:** Identify where key levels align across timeframes
3. **Momentum Confluence:** Check if momentum indicators agree across timeframes
4. **Structure Confluence:** Look for aligned market structure signals

**STEP 3: Conflict Resolution**
1. **Identify Conflicts:** Note where timeframes disagree
2. **Hierarchy Rules:** Higher timeframes take precedence for bias
3. **Timing Rules:** Lower timeframes refine entry/exit timing
4. **Risk Assessment:** Increase caution when major conflicts exist

**STEP 4: Final Signal Generation**
1. **Confluence Score:** Calculate overall timeframe alignment (0-100)
2. **Primary Signal:** Based on highest weighted timeframe confluence
3. **Entry Timeframe:** Select optimal timeframe for trade execution
4. **Risk Management:** Adjust position size based on confluence strength

**CONFLUENCE SCORING RULES:**
- 90-100: Exceptional alignment across all timeframes
- 75-89: Strong confluence with minor disagreements
- 60-74: Moderate confluence with some conflicts
- 40-59: Mixed signals, prefer NEUTRAL
- <40: Conflicting signals, recommend NEUTRAL

**ENHANCED RISK RULES FOR MULTI-TIMEFRAME:**
- Require confluence score 70 for any trade signal
- Higher timeframe trend must align with trade direction
- Stop placement considers all timeframe key levels
- Position sizing adjusted by confluence strength

Your response must include detailed analysis of each timeframe and clear explanation of how they interact to form your final conclusion.`,WM=`You are Wizz Ultra Multi-Timeframe, the pinnacle of crypto analysis AI. You combine the multi-pass verification rigor of Ultra mode with sophisticated multi-timeframe confluence analysis.

**ENHANCED MULTI-TIMEFRAME ULTRA PROCESS:**

**PASS 1: Deep Individual Timeframe Analysis**
For each timeframe:
1. **Comprehensive Technical Scan:** Full 8-step analysis including advanced patterns
2. **Smart Money Mapping:** Order blocks, FVGs, liquidity sweeps for each timeframe
3. **Wyckoff/Elliott Analysis:** Phase identification and wave counts per timeframe
4. **Advanced Confluence Matrix:** 8 strategies per timeframe with weighted scores

**PASS 2: Cross-Timeframe Synthesis & Adversarial Testing**
1. **Multi-Level Confluence:** Analyze trend, structure, and momentum across all timeframes
2. **Temporal Hierarchy:** Weight timeframes by importance (Daily > 4H > 1H)
3. **Conflict Analysis:** Deep dive into timeframe disagreements
4. **Adversarial Testing:** Challenge multi-timeframe thesis with failure scenarios
5. **Liquidity Mapping:** Cross-timeframe liquidity zone identification

**PASS 3: Ultra-Strict Multi-Timeframe Gating**
1. **Confluence Requirements:** Minimum 80% confluence score for any signal
2. **Timeframe Agreement:** Primary trend must align across majority of timeframes
3. **Risk Calibration:** Multi-timeframe risk assessment with enhanced R:R requirements
4. **Final Verification:** Triple-check confluence logic and signal strength

**ULTRA MULTI-TIMEFRAME ACCEPTANCE CRITERIA:**
- Confluence score 80 (vs. 70 for normal multi-timeframe)
- Higher timeframe trend must strongly support trade direction
- At least 70% of timeframes must agree on signal direction
- Enhanced R:R requirements: 2.5:1 minimum (vs. 2.2:1 Ultra single-timeframe)
- No major structural conflicts between critical timeframes

**CONFIDENCE SCORING (ENHANCED):**
- Baseline confidence from individual strongest timeframe
- +20 points for perfect confluence (100% agreement)
- +10 points for strong confluence (80-99% agreement)
- -10 points for each major timeframe conflict
- -20 points if higher timeframe opposes signal

Your analysis must demonstrate institutional-grade multi-timeframe thinking with complete transparency on how timeframes interact.`;async function*QM(n,e,t,i,r){const a=n.filter(y=>y.role==="user"||y.role==="assistant"&&y.rawResponse).map(y=>{if(y.role==="assistant")return{role:"model",parts:[{text:y.rawResponse}]};const T=[];typeof y.content=="string"&&y.content.trim()&&T.push({text:y.content});const x=[];if(Array.isArray(y.images)&&y.images.length>0&&x.push(...y.images),y.timeframeImages)for(const C of y.timeframeImages)x.push(`data:${C.imageData.mimeType};base64,${C.imageData.data}`);for(const C of x){const A=C.split(";base64,");if(A.length===2){const R=A[0].split(":")[1],k=A[1];R&&k&&T.push({inlineData:{mimeType:R,data:k}})}}return{role:"user",parts:T}}).filter(y=>y.parts.length>0);let u=`${e}

**MULTI-TIMEFRAME ANALYSIS REQUEST**

Please analyze the following timeframes:
`;const h=[{text:u}];for(const y of t)u+=`- ${y.timeframe}${y.label?` (${y.label})`:""}
`,h.push({inlineData:{mimeType:y.imageData.mimeType,data:y.imageData.data}});u+=`
Provide a comprehensive multi-timeframe confluence analysis.`,h[0].text=u;const m=[...a,{role:"user",parts:h}],p={systemInstruction:r?WM:KM,temperature:0,topK:1,topP:1,seed:42,responseMimeType:"application/json",responseSchema:$M};try{const y=await pv(r?"gemini-2.5-pro":"gemini-2.5-flash",m,p);for await(const T of y){if(i.aborted){console.log("Multi-timeframe stream generation aborted by user.");break}const x=T==null?void 0:T.text;typeof x=="string"&&x.length>0&&(yield x)}}catch(y){y instanceof Error&&y.name==="AbortError"||(console.error("Error during multi-timeframe Gemini stream:",y),yield`{"error": "Could not retrieve multi-timeframe analysis. ${`Details: ${y instanceof Error?y.message:String(y)}`}"}`)}}async function*XM(n,e,t,i,r){const a=n.filter(T=>T.role==="user"||T.role==="assistant"&&T.rawResponse).map(T=>{if(T.role==="assistant")return{role:"model",parts:[{text:T.rawResponse}]};const x=[];typeof T.content=="string"&&T.content.trim()&&x.push({text:T.content});const C=[];Array.isArray(T.images)&&T.images.length>0?C.push(...T.images):T.image&&C.push(T.image);for(const A of C){const R=A.split(";base64,");if(R.length===2){const k=R[0].split(":")[1],B=R[1];k&&B&&x.push({inlineData:{mimeType:k,data:B}})}}return{role:"user",parts:x}}).filter(T=>T.parts.length>0),u=[{text:e}];if(Array.isArray(t)&&t.length>0)for(const T of t)u.push({inlineData:{mimeType:T.mimeType,data:T.data}});const h=[...a,{role:"user",parts:u}],m=Array.isArray(t)&&t.length>0;let p=null;if(m)try{const{prices:T,volumes:x}=qM(e);p=await VM.detectMarketRegime(T,x,"1H");const C=GM(p);u[0].text=`${u[0].text}

${C}`}catch(T){console.warn("Regime detection failed, proceeding without regime context:",T)}const y=m?{systemInstruction:r?YM:FM,temperature:0,topK:1,topP:1,seed:42,responseMimeType:"application/json",responseSchema:zM}:{systemInstruction:r?jM:JM,temperature:0,topK:1,topP:1,seed:42};try{const T=await pv(m&&r?"gemini-2.5-pro":"gemini-2.5-flash",h,y);let x="";for await(const C of T){if(i.aborted){console.log("Stream generation aborted by user.");break}const A=C==null?void 0:C.text;typeof A=="string"&&A.length>0&&(x+=A,yield A)}if(m&&x.trim())try{const C=ZM(x),A=JSON.parse(C);if(A){const R=Oa.calibrateConfidence(A,r);A.calibratedConfidence=R,A.hasEnhancedConfidence=!0,A.overallConfidenceScore=R.overallScore,A.confidence=Oa.getConfidenceLevel(R,r),yield`
`+JSON.stringify(A,null,0)}}catch(C){console.error("Error processing Quick Profit mode:",C)}}catch(T){if(!(T instanceof Error&&T.name==="AbortError")){console.error("Error during Gemini stream:",T);const x=T instanceof Error&&(T.message.includes("Failed to fetch")||T.message.includes("NetworkError")||T.message.includes("timeout")||T.name==="TypeError");let C;x?C="Network connection issue. Please check your internet connection and try again.":C=`Details: ${T instanceof Error?T.message:String(T)}`,m?yield`{"error": "Could not retrieve analysis. ${C}"}`:yield`Sorry, I encountered an error and could not respond. Please try again. ${C}`}}}function ZM(n){const e=(n??"").trim();if(!e)throw new Error("Empty response");const t=e.match(/^```(?:json)?\s*([\s\S]*?)```\s*$/i),i=(t?t[1]:e).trim(),r=[],a=i.lastIndexOf("}"),u=i.indexOf("{");if(u!==-1&&a!==-1&&a>u){r.push(i.slice(u,a+1));let h=0;for(let m=a;m>=0&&h<3;m--)i[m]==="{"&&(r.push(i.slice(m,a+1)),h++)}else u!==-1?r.push(i.slice(u)):r.push(i);for(const h of r){const m=eN(h);if(m)return m}throw new Error("No valid JSON found in response")}function eN(n){const e=n.trim();if(!e)return null;const t=[];t.push(e),t.push(e.replace(/,\s*([}\]])/g,"$1")),t.push(tN(e));for(const i of t)try{return JSON.parse(i),i}catch{}return null}function tN(n){let e=!1,t=!1,i=0,r=0;for(let u=0;u<n.length;u++){const h=n[u];if(e){t?t=!1:h==="\\"?t=!0:h==='"'&&(e=!1);continue}h==='"'?e=!0:h==="{"?i++:h==="}"?i=Math.max(0,i-1):h==="["?r++:h==="]"&&(r=Math.max(0,r-1))}let a=n;return e&&(a+='"'),r>0&&(a+="]".repeat(r)),i>0&&(a+="}".repeat(i)),a}const zg=n=>{let e;const t=new Set,i=(p,y)=>{const T=typeof p=="function"?p(e):p;if(!Object.is(T,e)){const x=e;e=y??(typeof T!="object"||T===null)?T:Object.assign({},e,T),t.forEach(C=>C(e,x))}},r=()=>e,h={setState:i,getState:r,getInitialState:()=>m,subscribe:p=>(t.add(p),()=>t.delete(p))},m=e=n(i,r,h);return h},nN=n=>n?zg(n):zg,iN=n=>n;function sN(n,e=iN){const t=ws.useSyncExternalStore(n.subscribe,ws.useCallback(()=>e(n.getState()),[n,e]),ws.useCallback(()=>e(n.getInitialState()),[n,e]));return ws.useDebugValue(t),t}const $g=n=>{const e=nN(n),t=i=>sN(e,i);return Object.assign(t,e),t},gv=n=>n?$g(n):$g,oN="modulepreload",rN=function(n){return"/"+n},Fg={},ir=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let u=function(p){return Promise.all(p.map(y=>Promise.resolve(y).then(T=>({status:"fulfilled",value:T}),T=>({status:"rejected",reason:T}))))};document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),m=(h==null?void 0:h.nonce)||(h==null?void 0:h.getAttribute("nonce"));r=u(t.map(p=>{if(p=rN(p),p in Fg)return;Fg[p]=!0;const y=p.endsWith(".css"),T=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${T}`))return;const x=document.createElement("link");if(x.rel=y?"stylesheet":oN,y||(x.as="script"),x.crossOrigin="",x.href=p,m&&x.setAttribute("nonce",m),document.head.appendChild(x),y)return new Promise((C,A)=>{x.addEventListener("load",C),x.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${p}`)))})}))}function a(u){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=u,window.dispatchEvent(h),!h.defaultPrevented)throw u}return r.then(u=>{for(const h of u||[])h.status==="rejected"&&a(h.reason);return e().catch(a)})},aN=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>ir(async()=>{const{default:i}=await Promise.resolve().then(()=>Os);return{default:i}},void 0).then(({default:i})=>i(...t)):e=fetch,(...t)=>e(...t)};class cf extends Error{constructor(e,t="FunctionsError",i){super(e),this.name=t,this.context=i}}class lN extends cf{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Yg extends cf{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Jg extends cf{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Oc;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Oc||(Oc={}));var uN=function(n,e,t,i){function r(a){return a instanceof t?a:new t(function(u){u(a)})}return new(t||(t=Promise))(function(a,u){function h(y){try{p(i.next(y))}catch(T){u(T)}}function m(y){try{p(i.throw(y))}catch(T){u(T)}}function p(y){y.done?a(y.value):r(y.value).then(h,m)}p((i=i.apply(n,e||[])).next())})};class cN{constructor(e,{headers:t={},customFetch:i,region:r=Oc.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=aN(i)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var i;return uN(this,void 0,void 0,function*(){try{const{headers:r,method:a,body:u}=t;let h={},{region:m}=t;m||(m=this.region);const p=new URL(`${this.url}/${e}`);m&&m!=="any"&&(h["x-region"]=m,p.searchParams.set("forceFunctionRegion",m));let y;u&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&(typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",y=u):typeof u=="string"?(h["Content-Type"]="text/plain",y=u):typeof FormData<"u"&&u instanceof FormData?y=u:(h["Content-Type"]="application/json",y=JSON.stringify(u)));const T=yield this.fetch(p.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),r),body:y}).catch(R=>{throw new lN(R)}),x=T.headers.get("x-relay-error");if(x&&x==="true")throw new Yg(T);if(!T.ok)throw new Jg(T);let C=((i=T.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),A;return C==="application/json"?A=yield T.json():C==="application/octet-stream"?A=yield T.blob():C==="text/event-stream"?A=T:C==="multipart/form-data"?A=yield T.formData():A=yield T.text(),{data:A,error:null,response:T}}catch(r){return{data:null,error:r,response:r instanceof Jg||r instanceof Yg?r.context:void 0}}})}}var ot={},hs={},ms={},ps={},gs={},ys={},fN=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Is=fN();const dN=Is.fetch,yv=Is.fetch.bind(Is),vv=Is.Headers,hN=Is.Request,mN=Is.Response,Os=Object.freeze(Object.defineProperty({__proto__:null,Headers:vv,Request:hN,Response:mN,default:yv,fetch:dN},Symbol.toStringTag,{value:"Module"})),pN=aS(Os);var Ca={},jg;function Tv(){if(jg)return Ca;jg=1,Object.defineProperty(Ca,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Ca.default=n,Ca}var Kg;function Sv(){if(Kg)return ys;Kg=1;var n=ys&&ys.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ys,"__esModule",{value:!0});const e=n(pN),t=n(Tv());class i{constructor(a){this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=a.headers,this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=a.shouldThrowOnError,this.signal=a.signal,this.isMaybeSingle=a.isMaybeSingle,a.fetch?this.fetch=a.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,u){return this.headers=Object.assign({},this.headers),this.headers[a]=u,this}then(a,u){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const h=this.fetch;let m=h(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async p=>{var y,T,x;let C=null,A=null,R=null,k=p.status,B=p.statusText;if(p.ok){if(this.method!=="HEAD"){const O=await p.text();O===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?A=O:A=JSON.parse(O))}const N=(y=this.headers.Prefer)===null||y===void 0?void 0:y.match(/count=(exact|planned|estimated)/),q=(T=p.headers.get("content-range"))===null||T===void 0?void 0:T.split("/");N&&q&&q.length>1&&(R=parseInt(q[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(A)&&(A.length>1?(C={code:"PGRST116",details:`Results contain ${A.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},A=null,R=null,k=406,B="Not Acceptable"):A.length===1?A=A[0]:A=null)}else{const N=await p.text();try{C=JSON.parse(N),Array.isArray(C)&&p.status===404&&(A=[],C=null,k=200,B="OK")}catch{p.status===404&&N===""?(k=204,B="No Content"):C={message:N}}if(C&&this.isMaybeSingle&&(!((x=C==null?void 0:C.details)===null||x===void 0)&&x.includes("0 rows"))&&(C=null,k=200,B="OK"),C&&this.shouldThrowOnError)throw new t.default(C)}return{error:C,data:A,count:R,status:k,statusText:B}});return this.shouldThrowOnError||(m=m.catch(p=>{var y,T,x;return{error:{message:`${(y=p==null?void 0:p.name)!==null&&y!==void 0?y:"FetchError"}: ${p==null?void 0:p.message}`,details:`${(T=p==null?void 0:p.stack)!==null&&T!==void 0?T:""}`,hint:"",code:`${(x=p==null?void 0:p.code)!==null&&x!==void 0?x:""}`},data:null,count:null,status:0,statusText:""}})),m.then(a,u)}returns(){return this}overrideTypes(){return this}}return ys.default=i,ys}var Wg;function xv(){if(Wg)return gs;Wg=1;var n=gs&&gs.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(gs,"__esModule",{value:!0});const e=n(Sv());class t extends e.default{select(r){let a=!1;const u=(r??"*").split("").map(h=>/\s/.test(h)&&!a?"":(h==='"'&&(a=!a),h)).join("");return this.url.searchParams.set("select",u),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(r,{ascending:a=!0,nullsFirst:u,foreignTable:h,referencedTable:m=h}={}){const p=m?`${m}.order`:"order",y=this.url.searchParams.get(p);return this.url.searchParams.set(p,`${y?`${y},`:""}${r}.${a?"asc":"desc"}${u===void 0?"":u?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:a,referencedTable:u=a}={}){const h=typeof u>"u"?"limit":`${u}.limit`;return this.url.searchParams.set(h,`${r}`),this}range(r,a,{foreignTable:u,referencedTable:h=u}={}){const m=typeof h>"u"?"offset":`${h}.offset`,p=typeof h>"u"?"limit":`${h}.limit`;return this.url.searchParams.set(m,`${r}`),this.url.searchParams.set(p,`${a-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:r=!1,verbose:a=!1,settings:u=!1,buffers:h=!1,wal:m=!1,format:p="text"}={}){var y;const T=[r?"analyze":null,a?"verbose":null,u?"settings":null,h?"buffers":null,m?"wal":null].filter(Boolean).join("|"),x=(y=this.headers.Accept)!==null&&y!==void 0?y:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${p}; for="${x}"; options=${T};`,p==="json"?this:this}rollback(){var r;return((r=this.headers.Prefer)!==null&&r!==void 0?r:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return gs.default=t,gs}var Qg;function ff(){if(Qg)return ps;Qg=1;var n=ps&&ps.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(ps,"__esModule",{value:!0});const e=n(xv());class t extends e.default{eq(r,a){return this.url.searchParams.append(r,`eq.${a}`),this}neq(r,a){return this.url.searchParams.append(r,`neq.${a}`),this}gt(r,a){return this.url.searchParams.append(r,`gt.${a}`),this}gte(r,a){return this.url.searchParams.append(r,`gte.${a}`),this}lt(r,a){return this.url.searchParams.append(r,`lt.${a}`),this}lte(r,a){return this.url.searchParams.append(r,`lte.${a}`),this}like(r,a){return this.url.searchParams.append(r,`like.${a}`),this}likeAllOf(r,a){return this.url.searchParams.append(r,`like(all).{${a.join(",")}}`),this}likeAnyOf(r,a){return this.url.searchParams.append(r,`like(any).{${a.join(",")}}`),this}ilike(r,a){return this.url.searchParams.append(r,`ilike.${a}`),this}ilikeAllOf(r,a){return this.url.searchParams.append(r,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(r,a){return this.url.searchParams.append(r,`ilike(any).{${a.join(",")}}`),this}is(r,a){return this.url.searchParams.append(r,`is.${a}`),this}in(r,a){const u=Array.from(new Set(a)).map(h=>typeof h=="string"&&new RegExp("[,()]").test(h)?`"${h}"`:`${h}`).join(",");return this.url.searchParams.append(r,`in.(${u})`),this}contains(r,a){return typeof a=="string"?this.url.searchParams.append(r,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(r,`cs.{${a.join(",")}}`):this.url.searchParams.append(r,`cs.${JSON.stringify(a)}`),this}containedBy(r,a){return typeof a=="string"?this.url.searchParams.append(r,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(r,`cd.{${a.join(",")}}`):this.url.searchParams.append(r,`cd.${JSON.stringify(a)}`),this}rangeGt(r,a){return this.url.searchParams.append(r,`sr.${a}`),this}rangeGte(r,a){return this.url.searchParams.append(r,`nxl.${a}`),this}rangeLt(r,a){return this.url.searchParams.append(r,`sl.${a}`),this}rangeLte(r,a){return this.url.searchParams.append(r,`nxr.${a}`),this}rangeAdjacent(r,a){return this.url.searchParams.append(r,`adj.${a}`),this}overlaps(r,a){return typeof a=="string"?this.url.searchParams.append(r,`ov.${a}`):this.url.searchParams.append(r,`ov.{${a.join(",")}}`),this}textSearch(r,a,{config:u,type:h}={}){let m="";h==="plain"?m="pl":h==="phrase"?m="ph":h==="websearch"&&(m="w");const p=u===void 0?"":`(${u})`;return this.url.searchParams.append(r,`${m}fts${p}.${a}`),this}match(r){return Object.entries(r).forEach(([a,u])=>{this.url.searchParams.append(a,`eq.${u}`)}),this}not(r,a,u){return this.url.searchParams.append(r,`not.${a}.${u}`),this}or(r,{foreignTable:a,referencedTable:u=a}={}){const h=u?`${u}.or`:"or";return this.url.searchParams.append(h,`(${r})`),this}filter(r,a,u){return this.url.searchParams.append(r,`${a}.${u}`),this}}return ps.default=t,ps}var Xg;function _v(){if(Xg)return ms;Xg=1;var n=ms&&ms.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(ms,"__esModule",{value:!0});const e=n(ff());class t{constructor(r,{headers:a={},schema:u,fetch:h}){this.url=r,this.headers=a,this.schema=u,this.fetch=h}select(r,{head:a=!1,count:u}={}){const h=a?"HEAD":"GET";let m=!1;const p=(r??"*").split("").map(y=>/\s/.test(y)&&!m?"":(y==='"'&&(m=!m),y)).join("");return this.url.searchParams.set("select",p),u&&(this.headers.Prefer=`count=${u}`),new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(r,{count:a,defaultToNull:u=!0}={}){const h="POST",m=[];if(this.headers.Prefer&&m.push(this.headers.Prefer),a&&m.push(`count=${a}`),u||m.push("missing=default"),this.headers.Prefer=m.join(","),Array.isArray(r)){const p=r.reduce((y,T)=>y.concat(Object.keys(T)),[]);if(p.length>0){const y=[...new Set(p)].map(T=>`"${T}"`);this.url.searchParams.set("columns",y.join(","))}}return new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:this.fetch,allowEmpty:!1})}upsert(r,{onConflict:a,ignoreDuplicates:u=!1,count:h,defaultToNull:m=!0}={}){const p="POST",y=[`resolution=${u?"ignore":"merge"}-duplicates`];if(a!==void 0&&this.url.searchParams.set("on_conflict",a),this.headers.Prefer&&y.push(this.headers.Prefer),h&&y.push(`count=${h}`),m||y.push("missing=default"),this.headers.Prefer=y.join(","),Array.isArray(r)){const T=r.reduce((x,C)=>x.concat(Object.keys(C)),[]);if(T.length>0){const x=[...new Set(T)].map(C=>`"${C}"`);this.url.searchParams.set("columns",x.join(","))}}return new e.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:this.fetch,allowEmpty:!1})}update(r,{count:a}={}){const u="PATCH",h=[];return this.headers.Prefer&&h.push(this.headers.Prefer),a&&h.push(`count=${a}`),this.headers.Prefer=h.join(","),new e.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:this.fetch,allowEmpty:!1})}delete({count:r}={}){const a="DELETE",u=[];return r&&u.push(`count=${r}`),this.headers.Prefer&&u.unshift(this.headers.Prefer),this.headers.Prefer=u.join(","),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return ms.default=t,ms}var zo={},$o={},Zg;function gN(){return Zg||(Zg=1,Object.defineProperty($o,"__esModule",{value:!0}),$o.version=void 0,$o.version="0.0.0-automated"),$o}var ey;function yN(){if(ey)return zo;ey=1,Object.defineProperty(zo,"__esModule",{value:!0}),zo.DEFAULT_HEADERS=void 0;const n=gN();return zo.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${n.version}`},zo}var ty;function vN(){if(ty)return hs;ty=1;var n=hs&&hs.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(hs,"__esModule",{value:!0});const e=n(_v()),t=n(ff()),i=yN();class r{constructor(u,{headers:h={},schema:m,fetch:p}={}){this.url=u,this.headers=Object.assign(Object.assign({},i.DEFAULT_HEADERS),h),this.schemaName=m,this.fetch=p}from(u){const h=new URL(`${this.url}/${u}`);return new e.default(h,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(u){return new r(this.url,{headers:this.headers,schema:u,fetch:this.fetch})}rpc(u,h={},{head:m=!1,get:p=!1,count:y}={}){let T;const x=new URL(`${this.url}/rpc/${u}`);let C;m||p?(T=m?"HEAD":"GET",Object.entries(h).filter(([R,k])=>k!==void 0).map(([R,k])=>[R,Array.isArray(k)?`{${k.join(",")}}`:`${k}`]).forEach(([R,k])=>{x.searchParams.append(R,k)})):(T="POST",C=h);const A=Object.assign({},this.headers);return y&&(A.Prefer=`count=${y}`),new t.default({method:T,url:x,headers:A,schema:this.schemaName,body:C,fetch:this.fetch,allowEmpty:!1})}}return hs.default=r,hs}var ny;function TN(){if(ny)return ot;ny=1;var n=ot&&ot.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(ot,"__esModule",{value:!0}),ot.PostgrestError=ot.PostgrestBuilder=ot.PostgrestTransformBuilder=ot.PostgrestFilterBuilder=ot.PostgrestQueryBuilder=ot.PostgrestClient=void 0;const e=n(vN());ot.PostgrestClient=e.default;const t=n(_v());ot.PostgrestQueryBuilder=t.default;const i=n(ff());ot.PostgrestFilterBuilder=i.default;const r=n(xv());ot.PostgrestTransformBuilder=r.default;const a=n(Sv());ot.PostgrestBuilder=a.default;const u=n(Tv());return ot.PostgrestError=u.default,ot.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:i.default,PostgrestTransformBuilder:r.default,PostgrestBuilder:a.default,PostgrestError:u.default},ot}var SN=TN();const xN=Wc(SN),{PostgrestClient:_N,PostgrestQueryBuilder:B2,PostgrestFilterBuilder:V2,PostgrestTransformBuilder:q2,PostgrestBuilder:G2,PostgrestError:z2}=xN;class CN{static dynamicRequire(e){try{return typeof process<"u"&&process.versions&&process.versions.node&&typeof require<"u"?require(e):null}catch{return null}}static detectEnvironment(){var e,t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const i=parseInt(process.versions.node.split(".")[0]);if(i>=22)try{if(typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};const r=this.dynamicRequire("undici");if(r&&r.WebSocket)return{type:"native",constructor:r.WebSocket};throw new Error("undici not available")}catch{return{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:'Install the "ws" package or check your Node.js installation.'}}try{const r=this.dynamicRequire("ws");if(r)return{type:"ws",constructor:(t=r.WebSocket)!==null&&t!==void 0?t:r};throw new Error("ws package not available")}catch{return{type:"unsupported",error:`Node.js ${i} detected without WebSocket support.`,workaround:'Install the "ws" package: npm install ws'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const i=this.getWebSocketConstructor();return new i(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const EN="2.15.0",AN=`realtime-js/${EN}`,wN="1.0.0",Bc=1e4,bN=1e3,RN=100;var Ko;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Ko||(Ko={}));var Ze;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(Ze||(Ze={}));var Yt;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(Yt||(Yt={}));var Vc;(function(n){n.websocket="websocket"})(Vc||(Vc={}));var Ti;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Ti||(Ti={}));class MN{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),i=new TextDecoder;return this._decodeBroadcast(e,t,i)}_decodeBroadcast(e,t,i){const r=t.getUint8(1),a=t.getUint8(2);let u=this.HEADER_LENGTH+2;const h=i.decode(e.slice(u,u+r));u=u+r;const m=i.decode(e.slice(u,u+a));u=u+a;const p=JSON.parse(i.decode(e.slice(u,e.byteLength)));return{ref:null,topic:h,event:m,payload:p}}}class Cv{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ve;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Ve||(Ve={}));const iy=(n,e,t={})=>{var i;const r=(i=t.skipTypes)!==null&&i!==void 0?i:[];return Object.keys(e).reduce((a,u)=>(a[u]=NN(u,n,e,r),a),{})},NN=(n,e,t,i)=>{const r=e.find(h=>h.name===n),a=r==null?void 0:r.type,u=t[n];return a&&!i.includes(a)?Ev(a,u):qc(u)},Ev=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return UN(e,t)}switch(n){case Ve.bool:return kN(e);case Ve.float4:case Ve.float8:case Ve.int2:case Ve.int4:case Ve.int8:case Ve.numeric:case Ve.oid:return IN(e);case Ve.json:case Ve.jsonb:return DN(e);case Ve.timestamp:return LN(e);case Ve.abstime:case Ve.date:case Ve.daterange:case Ve.int4range:case Ve.int8range:case Ve.money:case Ve.reltime:case Ve.text:case Ve.time:case Ve.timestamptz:case Ve.timetz:case Ve.tsrange:case Ve.tstzrange:return qc(e);default:return qc(e)}},qc=n=>n,kN=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},IN=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},DN=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},UN=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,i=n[t];if(n[0]==="{"&&i==="}"){let a;const u=n.slice(1,t);try{a=JSON.parse("["+u+"]")}catch{a=u?u.split(","):[]}return a.map(h=>Ev(e,h))}return n},LN=n=>typeof n=="string"?n.replace(" ","T"):n,Av=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class pc{constructor(e,t,i={},r=Bc){this.channel=e,this.event=t,this.payload=i,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var i;return this._hasReceived(e)&&t((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(i=>i.status===e).forEach(i=>i.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var sy;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(sy||(sy={}));class Wo{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},r=>{const{onJoin:a,onLeave:u,onSync:h}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Wo.syncState(this.state,r,a,u),this.pendingDiffs.forEach(m=>{this.state=Wo.syncDiff(this.state,m,a,u)}),this.pendingDiffs=[],h()}),this.channel._on(i.diff,{},r=>{const{onJoin:a,onLeave:u,onSync:h}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=Wo.syncDiff(this.state,r,a,u),h())}),this.onJoin((r,a,u)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:a,newPresences:u})}),this.onLeave((r,a,u)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:a,leftPresences:u})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,i,r){const a=this.cloneDeep(e),u=this.transformState(t),h={},m={};return this.map(a,(p,y)=>{u[p]||(m[p]=y)}),this.map(u,(p,y)=>{const T=a[p];if(T){const x=y.map(k=>k.presence_ref),C=T.map(k=>k.presence_ref),A=y.filter(k=>C.indexOf(k.presence_ref)<0),R=T.filter(k=>x.indexOf(k.presence_ref)<0);A.length>0&&(h[p]=A),R.length>0&&(m[p]=R)}else h[p]=y}),this.syncDiff(a,{joins:h,leaves:m},i,r)}static syncDiff(e,t,i,r){const{joins:a,leaves:u}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return i||(i=()=>{}),r||(r=()=>{}),this.map(a,(h,m)=>{var p;const y=(p=e[h])!==null&&p!==void 0?p:[];if(e[h]=this.cloneDeep(m),y.length>0){const T=e[h].map(C=>C.presence_ref),x=y.filter(C=>T.indexOf(C.presence_ref)<0);e[h].unshift(...x)}i(h,y,m)}),this.map(u,(h,m)=>{let p=e[h];if(!p)return;const y=m.map(T=>T.presence_ref);p=p.filter(T=>y.indexOf(T.presence_ref)<0),e[h]=p,r(h,p,m),p.length===0&&delete e[h]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(i=>t(i,e[i]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,i)=>{const r=e[i];return"metas"in r?t[i]=r.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):t[i]=r,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var oy;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(oy||(oy={}));var Qo;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Qo||(Qo={}));var vn;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(vn||(vn={}));class df{constructor(e,t={config:{}},i){this.topic=e,this.params=t,this.socket=i,this.bindings={},this.state=Ze.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new pc(this,Yt.join,this.params,this.timeout),this.rejoinTimer=new Cv(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ze.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(r=>r.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ze.closed,this.socket._remove(this)}),this._onError(r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=Ze.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ze.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=Ze.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Yt.reply,{},(r,a)=>{this._trigger(this._replyEventName(a),r)}),this.presence=new Wo(this),this.broadcastEndpointURL=Av(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var i,r;if(this.socket.isConnected()||this.socket.connect(),this.state==Ze.closed){const{config:{broadcast:a,presence:u,private:h}}=this.params,m=(r=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(x=>x.filter))!==null&&r!==void 0?r:[],p=!!this.bindings[Qo.PRESENCE]&&this.bindings[Qo.PRESENCE].length>0,y={},T={broadcast:a,presence:Object.assign(Object.assign({},u),{enabled:p}),postgres_changes:m,private:h};this.socket.accessTokenValue&&(y.access_token=this.socket.accessTokenValue),this._onError(x=>e==null?void 0:e(vn.CHANNEL_ERROR,x)),this._onClose(()=>e==null?void 0:e(vn.CLOSED)),this.updateJoinPayload(Object.assign({config:T},y)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:x})=>{var C;if(this.socket.setAuth(),x===void 0){e==null||e(vn.SUBSCRIBED);return}else{const A=this.bindings.postgres_changes,R=(C=A==null?void 0:A.length)!==null&&C!==void 0?C:0,k=[];for(let B=0;B<R;B++){const F=A[B],{filter:{event:N,schema:q,table:O,filter:K}}=F,Q=x&&x[B];if(Q&&Q.event===N&&Q.schema===q&&Q.table===O&&Q.filter===K)k.push(Object.assign(Object.assign({},F),{id:Q.id}));else{this.unsubscribe(),this.state=Ze.errored,e==null||e(vn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=k,e&&e(vn.SUBSCRIBED);return}}).receive("error",x=>{this.state=Ze.errored,e==null||e(vn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(x).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(vn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,i){return this.state===Ze.joined&&e===Qo.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,i)}async send(e,t={}){var i,r;if(!this._canPush()&&e.type==="broadcast"){const{event:a,payload:u}=e,m={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:u,private:this.private}]})};try{const p=await this._fetchWithTimeout(this.broadcastEndpointURL,m,(i=t.timeout)!==null&&i!==void 0?i:this.timeout);return await((r=p.body)===null||r===void 0?void 0:r.cancel()),p.ok?"ok":"error"}catch(p){return p.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var u,h,m;const p=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((m=(h=(u=this.params)===null||u===void 0?void 0:u.config)===null||h===void 0?void 0:h.broadcast)===null||m===void 0)&&m.ack)&&a("ok"),p.receive("ok",()=>a("ok")),p.receive("error",()=>a("error")),p.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Ze.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Yt.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(r=>{i=new pc(this,Yt.leave,{},e),i.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i==null||i.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Ze.closed,this.bindings={}}async _fetchWithTimeout(e,t,i){const r=new AbortController,a=setTimeout(()=>r.abort(),i),u=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(a),u}_push(e,t,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new pc(this,e,t,i);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>RN){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,i){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,i){var r,a;const u=e.toLocaleLowerCase(),{close:h,error:m,leave:p,join:y}=Yt;if(i&&[h,m,p,y].indexOf(u)>=0&&i!==this._joinRef())return;let x=this._onMessage(u,t,i);if(t&&!x)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(u)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(C=>{var A,R,k;return((A=C.filter)===null||A===void 0?void 0:A.event)==="*"||((k=(R=C.filter)===null||R===void 0?void 0:R.event)===null||k===void 0?void 0:k.toLocaleLowerCase())===u}).map(C=>C.callback(x,i)):(a=this.bindings[u])===null||a===void 0||a.filter(C=>{var A,R,k,B,F,N;if(["broadcast","presence","postgres_changes"].includes(u))if("id"in C){const q=C.id,O=(A=C.filter)===null||A===void 0?void 0:A.event;return q&&((R=t.ids)===null||R===void 0?void 0:R.includes(q))&&(O==="*"||(O==null?void 0:O.toLocaleLowerCase())===((k=t.data)===null||k===void 0?void 0:k.type.toLocaleLowerCase()))}else{const q=(F=(B=C==null?void 0:C.filter)===null||B===void 0?void 0:B.event)===null||F===void 0?void 0:F.toLocaleLowerCase();return q==="*"||q===((N=t==null?void 0:t.event)===null||N===void 0?void 0:N.toLocaleLowerCase())}else return C.type.toLocaleLowerCase()===u}).map(C=>{if(typeof x=="object"&&"ids"in x){const A=x.data,{schema:R,table:k,commit_timestamp:B,type:F,errors:N}=A;x=Object.assign(Object.assign({},{schema:R,table:k,commit_timestamp:B,eventType:F,new:{},old:{},errors:N}),this._getPayloadRecords(A))}C.callback(x,i)})}_isClosed(){return this.state===Ze.closed}_isJoined(){return this.state===Ze.joined}_isJoining(){return this.state===Ze.joining}_isLeaving(){return this.state===Ze.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,i){const r=e.toLocaleLowerCase(),a={type:r,filter:t,callback:i};return this.bindings[r]?this.bindings[r].push(a):this.bindings[r]=[a],this}_off(e,t){const i=e.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(r=>{var a;return!(((a=r.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===i&&df.isEqual(r.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(e[i]!==t[i])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Yt.close,{},e)}_onError(e){this._on(Yt.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ze.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=iy(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=iy(e.columns,e.old_record)),t}}const ry=()=>{},Ea={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},PN=[1e3,2e3,5e3,1e4],HN=1e4,ON=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class BN{constructor(e,t){var i;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Bc,this.transport=null,this.heartbeatIntervalMs=Ea.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ry,this.ref=0,this.reconnectTimer=null,this.logger=ry,this.conn=null,this.sendBuffer=[],this.serializer=new MN,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=r=>{let a;return r?a=r:typeof fetch>"u"?a=(...u)=>ir(async()=>{const{default:h}=await Promise.resolve().then(()=>Os);return{default:h}},void 0).then(({default:h})=>h(...u)).catch(h=>{throw new Error(`Failed to load @supabase/node-fetch: ${h.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):a=fetch,(...u)=>a(...u)},!(!((i=t==null?void 0:t.params)===null||i===void 0)&&i.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${Vc.websocket}`,this.httpEndpoint=Av(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=CN.createWebSocket(this.endpointURL())}catch(e){throw this._setConnectionState("disconnected"),new Error(`WebSocket not available: ${e.message}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:wN}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,i){this.logger(e,t,i)}connectionState(){switch(this.conn&&this.conn.readyState){case Ko.connecting:return Ti.Connecting;case Ko.open:return Ti.Open;case Ko.closing:return Ti.Closing;default:return Ti.Closed}}isConnected(){return this.connectionState()===Ti.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const i=`realtime:${e}`,r=this.getChannels().find(a=>a.topic===i);if(r)return r;{const a=new df(`realtime:${e}`,t,this);return this.channels.push(a),a}}push(e){const{topic:t,event:i,payload:r,ref:a}=e,u=()=>{this.encode(e,h=>{var m;(m=this.conn)===null||m===void 0||m.send(h)})};this.log("push",`${t} ${i} (${a})`,r),this.isConnected()?u():this.sendBuffer.push(u)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(bN,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Ea.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(i=>i.topic===e&&(i._isJoined()||i._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{t.topic==="phoenix"&&t.event==="phx_reply"&&this.heartbeatCallback(t.payload.status==="ok"?"ok":"error"),t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:i,event:r,payload:a,ref:u}=t,h=u?`(${u})`:"",m=a.status||"";this.log("receive",`${m} ${i} ${r} ${h}`.trim(),a),this.channels.filter(p=>p._isMember(i)).forEach(p=>p._trigger(r,a,u)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Yt.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const i=e.match(/\?/)?"&":"?",r=new URLSearchParams(t);return`${e}${i}${r}`}_workerObjectUrl(e){let t;if(e)t=e;else{const i=new Blob([ON],{type:"application/javascript"});t=URL.createObjectURL(i)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(i=>{const r={access_token:t,version:AN};t&&i.updateJoinPayload(r),i.joinedOnce&&i._isJoined()&&i._push(Yt.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(i=>{try{i(t)}catch(r){this.log("error",`error in ${e} callback`,r)}})}catch(i){this.log("error",`error triggering ${e} callbacks`,i)}}_setupReconnectionTimer(){this.reconnectTimer=new Cv(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ea.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,i,r,a,u,h,m,p;if(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(i=e==null?void 0:e.timeout)!==null&&i!==void 0?i:Bc,this.heartbeatIntervalMs=(r=e==null?void 0:e.heartbeatIntervalMs)!==null&&r!==void 0?r:Ea.HEARTBEAT_INTERVAL,this.worker=(a=e==null?void 0:e.worker)!==null&&a!==void 0?a:!1,this.accessToken=(u=e==null?void 0:e.accessToken)!==null&&u!==void 0?u:null,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(h=e==null?void 0:e.reconnectAfterMs)!==null&&h!==void 0?h:y=>PN[y-1]||HN,this.encode=(m=e==null?void 0:e.encode)!==null&&m!==void 0?m:(y,T)=>T(JSON.stringify(y)),this.decode=(p=e==null?void 0:e.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class hf extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function rt(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class VN extends hf{constructor(e,t,i){super(e),this.name="StorageApiError",this.status=t,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Gc extends hf{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var qN=function(n,e,t,i){function r(a){return a instanceof t?a:new t(function(u){u(a)})}return new(t||(t=Promise))(function(a,u){function h(y){try{p(i.next(y))}catch(T){u(T)}}function m(y){try{p(i.throw(y))}catch(T){u(T)}}function p(y){y.done?a(y.value):r(y.value).then(h,m)}p((i=i.apply(n,e||[])).next())})};const wv=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>ir(async()=>{const{default:i}=await Promise.resolve().then(()=>Os);return{default:i}},void 0).then(({default:i})=>i(...t)):e=fetch,(...t)=>e(...t)},GN=()=>qN(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ir(()=>Promise.resolve().then(()=>Os),void 0)).Response:Response}),zc=n=>{if(Array.isArray(n))return n.map(t=>zc(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,i])=>{const r=t.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[r]=zc(i)}),e},zN=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)};var bi=function(n,e,t,i){function r(a){return a instanceof t?a:new t(function(u){u(a)})}return new(t||(t=Promise))(function(a,u){function h(y){try{p(i.next(y))}catch(T){u(T)}}function m(y){try{p(i.throw(y))}catch(T){u(T)}}function p(y){y.done?a(y.value):r(y.value).then(h,m)}p((i=i.apply(n,e||[])).next())})};const gc=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),$N=(n,e,t)=>bi(void 0,void 0,void 0,function*(){const i=yield GN();n instanceof i&&!(t!=null&&t.noResolveJson)?n.json().then(r=>{const a=n.status||500,u=(r==null?void 0:r.statusCode)||a+"";e(new VN(gc(r),a,u))}).catch(r=>{e(new Gc(gc(r),r))}):e(new Gc(gc(n),n))}),FN=(n,e,t,i)=>{const r={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"||!i?r:(zN(i)?(r.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(i)):r.body=i,Object.assign(Object.assign({},r),t))};function sr(n,e,t,i,r,a){return bi(this,void 0,void 0,function*(){return new Promise((u,h)=>{n(t,FN(e,i,r,a)).then(m=>{if(!m.ok)throw m;return i!=null&&i.noResolveJson?m:m.json()}).then(m=>u(m)).catch(m=>$N(m,h,i))})})}function Ba(n,e,t,i){return bi(this,void 0,void 0,function*(){return sr(n,"GET",e,t,i)})}function Tn(n,e,t,i,r){return bi(this,void 0,void 0,function*(){return sr(n,"POST",e,i,r,t)})}function $c(n,e,t,i,r){return bi(this,void 0,void 0,function*(){return sr(n,"PUT",e,i,r,t)})}function YN(n,e,t,i){return bi(this,void 0,void 0,function*(){return sr(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),i)})}function bv(n,e,t,i,r){return bi(this,void 0,void 0,function*(){return sr(n,"DELETE",e,i,r,t)})}var St=function(n,e,t,i){function r(a){return a instanceof t?a:new t(function(u){u(a)})}return new(t||(t=Promise))(function(a,u){function h(y){try{p(i.next(y))}catch(T){u(T)}}function m(y){try{p(i.throw(y))}catch(T){u(T)}}function p(y){y.done?a(y.value):r(y.value).then(h,m)}p((i=i.apply(n,e||[])).next())})};const JN={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ay={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class jN{constructor(e,t={},i,r){this.url=e,this.headers=t,this.bucketId=i,this.fetch=wv(r)}uploadOrUpdate(e,t,i,r){return St(this,void 0,void 0,function*(){try{let a;const u=Object.assign(Object.assign({},ay),r);let h=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(u.upsert)});const m=u.metadata;typeof Blob<"u"&&i instanceof Blob?(a=new FormData,a.append("cacheControl",u.cacheControl),m&&a.append("metadata",this.encodeMetadata(m)),a.append("",i)):typeof FormData<"u"&&i instanceof FormData?(a=i,a.append("cacheControl",u.cacheControl),m&&a.append("metadata",this.encodeMetadata(m))):(a=i,h["cache-control"]=`max-age=${u.cacheControl}`,h["content-type"]=u.contentType,m&&(h["x-metadata"]=this.toBase64(this.encodeMetadata(m)))),r!=null&&r.headers&&(h=Object.assign(Object.assign({},h),r.headers));const p=this._removeEmptyFolders(t),y=this._getFinalPath(p),T=yield(e=="PUT"?$c:Tn)(this.fetch,`${this.url}/object/${y}`,a,Object.assign({headers:h},u!=null&&u.duplex?{duplex:u.duplex}:{}));return{data:{path:p,id:T.Id,fullPath:T.Key},error:null}}catch(a){if(rt(a))return{data:null,error:a};throw a}})}upload(e,t,i){return St(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,i)})}uploadToSignedUrl(e,t,i,r){return St(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),u=this._getFinalPath(a),h=new URL(this.url+`/object/upload/sign/${u}`);h.searchParams.set("token",t);try{let m;const p=Object.assign({upsert:ay.upsert},r),y=Object.assign(Object.assign({},this.headers),{"x-upsert":String(p.upsert)});typeof Blob<"u"&&i instanceof Blob?(m=new FormData,m.append("cacheControl",p.cacheControl),m.append("",i)):typeof FormData<"u"&&i instanceof FormData?(m=i,m.append("cacheControl",p.cacheControl)):(m=i,y["cache-control"]=`max-age=${p.cacheControl}`,y["content-type"]=p.contentType);const T=yield $c(this.fetch,h.toString(),m,{headers:y});return{data:{path:a,fullPath:T.Key},error:null}}catch(m){if(rt(m))return{data:null,error:m};throw m}})}createSignedUploadUrl(e,t){return St(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e);const r=Object.assign({},this.headers);t!=null&&t.upsert&&(r["x-upsert"]="true");const a=yield Tn(this.fetch,`${this.url}/object/upload/sign/${i}`,{},{headers:r}),u=new URL(this.url+a.url),h=u.searchParams.get("token");if(!h)throw new hf("No token returned by API");return{data:{signedUrl:u.toString(),path:e,token:h},error:null}}catch(i){if(rt(i))return{data:null,error:i};throw i}})}update(e,t,i){return St(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,i)})}move(e,t,i){return St(this,void 0,void 0,function*(){try{return{data:yield Tn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(rt(r))return{data:null,error:r};throw r}})}copy(e,t,i){return St(this,void 0,void 0,function*(){try{return{data:{path:(yield Tn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(rt(r))return{data:null,error:r};throw r}})}createSignedUrl(e,t,i){return St(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),a=yield Tn(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},i!=null&&i.transform?{transform:i.transform}:{}),{headers:this.headers});const u=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${u}`)},{data:a,error:null}}catch(r){if(rt(r))return{data:null,error:r};throw r}})}createSignedUrls(e,t,i){return St(this,void 0,void 0,function*(){try{const r=yield Tn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),a=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return{data:r.map(u=>Object.assign(Object.assign({},u),{signedUrl:u.signedURL?encodeURI(`${this.url}${u.signedURL}${a}`):null})),error:null}}catch(r){if(rt(r))return{data:null,error:r};throw r}})}download(e,t){return St(this,void 0,void 0,function*(){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),u=a?`?${a}`:"";try{const h=this._getFinalPath(e);return{data:yield(yield Ba(this.fetch,`${this.url}/${r}/${h}${u}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(h){if(rt(h))return{data:null,error:h};throw h}})}info(e){return St(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const i=yield Ba(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:zc(i),error:null}}catch(i){if(rt(i))return{data:null,error:i};throw i}})}exists(e){return St(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield YN(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(i){if(rt(i)&&i instanceof Gc){const r=i.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:i}}throw i}})}getPublicUrl(e,t){const i=this._getFinalPath(e),r=[],a=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&r.push(a);const h=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",m=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});m!==""&&r.push(m);let p=r.join("&");return p!==""&&(p=`?${p}`),{data:{publicUrl:encodeURI(`${this.url}/${h}/public/${i}${p}`)}}}remove(e){return St(this,void 0,void 0,function*(){try{return{data:yield bv(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(rt(t))return{data:null,error:t};throw t}})}list(e,t,i){return St(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},JN),t),{prefix:e||""});return{data:yield Tn(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},i),error:null}}catch(r){if(rt(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const KN="2.10.4",WN={"X-Client-Info":`storage-js/${KN}`};var vs=function(n,e,t,i){function r(a){return a instanceof t?a:new t(function(u){u(a)})}return new(t||(t=Promise))(function(a,u){function h(y){try{p(i.next(y))}catch(T){u(T)}}function m(y){try{p(i.throw(y))}catch(T){u(T)}}function p(y){y.done?a(y.value):r(y.value).then(h,m)}p((i=i.apply(n,e||[])).next())})};class QN{constructor(e,t={},i,r){const a=new URL(e);r!=null&&r.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href,this.headers=Object.assign(Object.assign({},WN),t),this.fetch=wv(i)}listBuckets(){return vs(this,void 0,void 0,function*(){try{return{data:yield Ba(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(rt(e))return{data:null,error:e};throw e}})}getBucket(e){return vs(this,void 0,void 0,function*(){try{return{data:yield Ba(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(rt(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return vs(this,void 0,void 0,function*(){try{return{data:yield Tn(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(rt(i))return{data:null,error:i};throw i}})}updateBucket(e,t){return vs(this,void 0,void 0,function*(){try{return{data:yield $c(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(rt(i))return{data:null,error:i};throw i}})}emptyBucket(e){return vs(this,void 0,void 0,function*(){try{return{data:yield Tn(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(rt(t))return{data:null,error:t};throw t}})}deleteBucket(e){return vs(this,void 0,void 0,function*(){try{return{data:yield bv(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(rt(t))return{data:null,error:t};throw t}})}}class XN extends QN{constructor(e,t={},i,r){super(e,t,i,r)}from(e){return new jN(this.url,this.headers,e,this.fetch)}}const ZN="2.54.0";let Fo="";typeof Deno<"u"?Fo="deno":typeof document<"u"?Fo="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Fo="react-native":Fo="node";const ek={"X-Client-Info":`supabase-js-${Fo}/${ZN}`},tk={headers:ek},nk={schema:"public"},ik={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},sk={};var ok=function(n,e,t,i){function r(a){return a instanceof t?a:new t(function(u){u(a)})}return new(t||(t=Promise))(function(a,u){function h(y){try{p(i.next(y))}catch(T){u(T)}}function m(y){try{p(i.throw(y))}catch(T){u(T)}}function p(y){y.done?a(y.value):r(y.value).then(h,m)}p((i=i.apply(n,e||[])).next())})};const rk=n=>{let e;return n?e=n:typeof fetch>"u"?e=yv:e=fetch,(...t)=>e(...t)},ak=()=>typeof Headers>"u"?vv:Headers,lk=(n,e,t)=>{const i=rk(t),r=ak();return(a,u)=>ok(void 0,void 0,void 0,function*(){var h;const m=(h=yield e())!==null&&h!==void 0?h:n;let p=new r(u==null?void 0:u.headers);return p.has("apikey")||p.set("apikey",n),p.has("Authorization")||p.set("Authorization",`Bearer ${m}`),i(a,Object.assign(Object.assign({},u),{headers:p}))})};var uk=function(n,e,t,i){function r(a){return a instanceof t?a:new t(function(u){u(a)})}return new(t||(t=Promise))(function(a,u){function h(y){try{p(i.next(y))}catch(T){u(T)}}function m(y){try{p(i.throw(y))}catch(T){u(T)}}function p(y){y.done?a(y.value):r(y.value).then(h,m)}p((i=i.apply(n,e||[])).next())})};function ck(n){return n.endsWith("/")?n:n+"/"}function fk(n,e){var t,i;const{db:r,auth:a,realtime:u,global:h}=n,{db:m,auth:p,realtime:y,global:T}=e,x={db:Object.assign(Object.assign({},m),r),auth:Object.assign(Object.assign({},p),a),realtime:Object.assign(Object.assign({},y),u),storage:{},global:Object.assign(Object.assign(Object.assign({},T),h),{headers:Object.assign(Object.assign({},(t=T==null?void 0:T.headers)!==null&&t!==void 0?t:{}),(i=h==null?void 0:h.headers)!==null&&i!==void 0?i:{})}),accessToken:()=>uk(this,void 0,void 0,function*(){return""})};return n.accessToken?x.accessToken=n.accessToken:delete x.accessToken,x}const Rv="2.71.1",Es=30*1e3,Fc=3,yc=Fc*Es,dk="http://localhost:9999",hk="supabase.auth.token",mk={"X-Client-Info":`gotrue-js/${Rv}`},Yc="X-Supabase-Api-Version",Mv={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},pk=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,gk=600*1e3;class mf extends Error{constructor(e,t,i){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=i}}function ge(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class yk extends mf{constructor(e,t,i){super(e,t,i),this.name="AuthApiError",this.status=t,this.code=i}}function vk(n){return ge(n)&&n.name==="AuthApiError"}class Nv extends mf{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Qn extends mf{constructor(e,t,i,r){super(e,i,r),this.name=t,this.status=i}}class jn extends Qn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Tk(n){return ge(n)&&n.name==="AuthSessionMissingError"}class Aa extends Qn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class wa extends Qn{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ba extends Qn{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Sk(n){return ge(n)&&n.name==="AuthImplicitGrantRedirectError"}class ly extends Qn{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Jc extends Qn{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function vc(n){return ge(n)&&n.name==="AuthRetryableFetchError"}class uy extends Qn{constructor(e,t,i){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=i}}class jc extends Qn{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Va="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),cy=` 	
\r=`.split(""),xk=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<cy.length;e+=1)n[cy[e].charCodeAt(0)]=-2;for(let e=0;e<Va.length;e+=1)n[Va[e].charCodeAt(0)]=e;return n})();function fy(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t(Va[i]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t(Va[i]),e.queuedBits-=6}}function kv(n,e,t){const i=xk[n];if(i>-1)for(e.queue=e.queue<<6|i,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function dy(n){const e=[],t=u=>{e.push(String.fromCodePoint(u))},i={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},a=u=>{Ek(u,i,t)};for(let u=0;u<n.length;u+=1)kv(n.charCodeAt(u),r,a);return e.join("")}function _k(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function Ck(n,e){for(let t=0;t<n.length;t+=1){let i=n.charCodeAt(t);if(i>55295&&i<=56319){const r=(i-55296)*1024&65535;i=(n.charCodeAt(t+1)-56320&65535|r)+65536,t+=1}_k(i,e)}}function Ek(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let i=1;i<6;i+=1)if((n>>7-i&1)===0){e.utf8seq=i;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Ak(n){const e=[],t={queue:0,queuedBits:0},i=r=>{e.push(r)};for(let r=0;r<n.length;r+=1)kv(n.charCodeAt(r),t,i);return new Uint8Array(e)}function wk(n){const e=[];return Ck(n,t=>e.push(t)),new Uint8Array(e)}function bk(n){const e=[],t={queue:0,queuedBits:0},i=r=>{e.push(r)};return n.forEach(r=>fy(r,t,i)),fy(null,t,i),e.join("")}function Rk(n){return Math.round(Date.now()/1e3)+n}function Mk(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const Ft=()=>typeof window<"u"&&typeof document<"u",gi={tested:!1,writable:!1},Iv=()=>{if(!Ft())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(gi.tested)return gi.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),gi.tested=!0,gi.writable=!0}catch{gi.tested=!0,gi.writable=!1}return gi.writable};function Nk(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((r,a)=>{e[a]=r})}catch{}return t.searchParams.forEach((i,r)=>{e[r]=i}),e}const Dv=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>ir(async()=>{const{default:i}=await Promise.resolve().then(()=>Os);return{default:i}},void 0).then(({default:i})=>i(...t)):e=fetch,(...t)=>e(...t)},kk=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",As=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},yi=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Jn=async(n,e)=>{await n.removeItem(e)};class Ya{constructor(){this.promise=new Ya.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Ya.promiseConstructor=Promise;function Tc(n){const e=n.split(".");if(e.length!==3)throw new jc("Invalid JWT structure");for(let i=0;i<e.length;i++)if(!pk.test(e[i]))throw new jc("JWT not in base64url format");return{header:JSON.parse(dy(e[0])),payload:JSON.parse(dy(e[1])),signature:Ak(e[2]),raw:{header:e[0],payload:e[1]}}}async function Ik(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function Dk(n,e){return new Promise((i,r)=>{(async()=>{for(let a=0;a<1/0;a++)try{const u=await n(a);if(!e(a,null,u)){i(u);return}}catch(u){if(!e(a,u)){r(u);return}}})()})}function Uk(n){return("0"+n.toString(16)).substr(-2)}function Lk(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=t.length;let r="";for(let a=0;a<56;a++)r+=t.charAt(Math.floor(Math.random()*i));return r}return crypto.getRandomValues(e),Array.from(e,Uk).join("")}async function Pk(n){const t=new TextEncoder().encode(n),i=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(i);return Array.from(r).map(a=>String.fromCharCode(a)).join("")}async function Hk(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await Pk(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ts(n,e,t=!1){const i=Lk();let r=i;t&&(r+="/PASSWORD_RECOVERY"),await As(n,`${e}-code-verifier`,r);const a=await Hk(i);return[a,i===a?"plain":"s256"]}const Ok=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Bk(n){const e=n.headers.get(Yc);if(!e||!e.match(Ok))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Vk(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function qk(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Gk=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ss(n){if(!Gk.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Sc(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const i=t.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function hy(n){return JSON.parse(JSON.stringify(n))}var zk=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t};const vi=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),$k=[502,503,504];async function my(n){var e;if(!kk(n))throw new Jc(vi(n),0);if($k.includes(n.status))throw new Jc(vi(n),n.status);let t;try{t=await n.json()}catch(a){throw new Nv(vi(a),a)}let i;const r=Bk(n);if(r&&r.getTime()>=Mv["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?i=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(i=t.error_code),i){if(i==="weak_password")throw new uy(vi(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(i==="session_not_found")throw new jn}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((a,u)=>a&&typeof u=="string",!0))throw new uy(vi(t),n.status,t.weak_password.reasons);throw new yk(vi(t),n.status||500,i)}const Fk=(n,e,t,i)=>{const r={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(i),Object.assign(Object.assign({},r),t))};async function Ee(n,e,t,i){var r;const a=Object.assign({},i==null?void 0:i.headers);a[Yc]||(a[Yc]=Mv["2024-01-01"].name),i!=null&&i.jwt&&(a.Authorization=`Bearer ${i.jwt}`);const u=(r=i==null?void 0:i.query)!==null&&r!==void 0?r:{};i!=null&&i.redirectTo&&(u.redirect_to=i.redirectTo);const h=Object.keys(u).length?"?"+new URLSearchParams(u).toString():"",m=await Yk(n,e,t+h,{headers:a,noResolveJson:i==null?void 0:i.noResolveJson},{},i==null?void 0:i.body);return i!=null&&i.xform?i==null?void 0:i.xform(m):{data:Object.assign({},m),error:null}}async function Yk(n,e,t,i,r,a){const u=Fk(e,i,r,a);let h;try{h=await n(t,Object.assign({},u))}catch(m){throw console.error(m),new Jc(vi(m),0)}if(h.ok||await my(h),i!=null&&i.noResolveJson)return h;try{return await h.json()}catch(m){await my(m)}}function yn(n){var e;let t=null;Wk(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=Rk(n.expires_in)));const i=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:i},error:null}}function py(n){const e=yn(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,i)=>t&&typeof i=="string",!0)&&(e.data.weak_password=n.weak_password),e}function Kn(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function Jk(n){return{data:n,error:null}}function jk(n){const{action_link:e,email_otp:t,hashed_token:i,redirect_to:r,verification_type:a}=n,u=zk(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),h={action_link:e,email_otp:t,hashed_token:i,redirect_to:r,verification_type:a},m=Object.assign({},u);return{data:{properties:h,user:m},error:null}}function Kk(n){return n}function Wk(n){return n.access_token&&n.refresh_token&&n.expires_in}const xc=["global","local","others"];var Qk=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t};class Xk{constructor({url:e="",headers:t={},fetch:i}){this.url=e,this.headers=t,this.fetch=Dv(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=xc[0]){if(xc.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${xc.join(", ")}`);try{return await Ee(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(i){if(ge(i))return{data:null,error:i};throw i}}async inviteUserByEmail(e,t={}){try{return await Ee(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Kn})}catch(i){if(ge(i))return{data:{user:null},error:i};throw i}}async generateLink(e){try{const{options:t}=e,i=Qk(e,["options"]),r=Object.assign(Object.assign({},i),t);return"newEmail"in i&&(r.new_email=i==null?void 0:i.newEmail,delete r.newEmail),await Ee(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:jk,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(ge(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Ee(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Kn})}catch(t){if(ge(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,i,r,a,u,h,m;try{const p={nextPage:null,lastPage:0,total:0},y=await Ee(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:"",per_page:(a=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:""},xform:Kk});if(y.error)throw y.error;const T=await y.json(),x=(u=y.headers.get("x-total-count"))!==null&&u!==void 0?u:0,C=(m=(h=y.headers.get("link"))===null||h===void 0?void 0:h.split(","))!==null&&m!==void 0?m:[];return C.length>0&&(C.forEach(A=>{const R=parseInt(A.split(";")[0].split("=")[1].substring(0,1)),k=JSON.parse(A.split(";")[1].split("=")[1]);p[`${k}Page`]=R}),p.total=parseInt(x)),{data:Object.assign(Object.assign({},T),p),error:null}}catch(p){if(ge(p))return{data:{users:[]},error:p};throw p}}async getUserById(e){Ss(e);try{return await Ee(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Kn})}catch(t){if(ge(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Ss(e);try{return await Ee(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Kn})}catch(i){if(ge(i))return{data:{user:null},error:i};throw i}}async deleteUser(e,t=!1){Ss(e);try{return await Ee(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Kn})}catch(i){if(ge(i))return{data:{user:null},error:i};throw i}}async _listFactors(e){Ss(e.userId);try{const{data:t,error:i}=await Ee(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:t,error:i}}catch(t){if(ge(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Ss(e.userId),Ss(e.id);try{return{data:await Ee(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(ge(t))return{data:null,error:t};throw t}}}function gy(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function Zk(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const xs={debug:!!(globalThis&&Iv()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Uv extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class e2 extends Uv{}async function t2(n,e,t){xs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const i=new globalThis.AbortController;return e>0&&setTimeout(()=>{i.abort(),xs.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async r=>{if(r){xs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,r.name);try{return await t()}finally{xs.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,r.name)}}else{if(e===0)throw xs.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new e2(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(xs.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}Zk();const n2={url:dk,storageKey:hk,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:mk,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function yy(n,e,t){return await t()}const _s={};class Zo{constructor(e){var t,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Zo.nextInstanceID,Zo.nextInstanceID+=1,this.instanceID>0&&Ft()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},n2),e);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new Xk({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=Dv(r.fetch),this.lock=r.lock||yy,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:Ft()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=t2:this.lock=yy,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(r.storage?this.storage=r.storage:Iv()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=gy(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=gy(this.memoryStorage)),Ft()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=_s[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){_s[this.storageKey]=Object.assign(Object.assign({},_s[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=_s[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){_s[this.storageKey]=Object.assign(Object.assign({},_s[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Rv}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=Nk(window.location.href);let i="none";if(this._isImplicitGrantCallback(t)?i="implicit":await this._isPKCECallback(t)&&(i="pkce"),Ft()&&this.detectSessionInUrl&&i!=="none"){const{data:r,error:a}=await this._getSessionFromURL(t,i);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),Sk(a)){const m=(e=a.details)===null||e===void 0?void 0:e.code;if(m==="identity_already_exists"||m==="identity_not_found"||m==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:u,redirectType:h}=r;return this._debug("#_initialize()","detected session in URL",u,"redirect type",h),await this._saveSession(u),setTimeout(async()=>{h==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",u):await this._notifyAllSubscribers("SIGNED_IN",u)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return ge(t)?{error:t}:{error:new Nv("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,i,r;try{const a=await Ee(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.captchaToken}},xform:yn}),{data:u,error:h}=a;if(h||!u)return{data:{user:null,session:null},error:h};const m=u.session,p=u.user;return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",m)),{data:{user:p,session:m},error:null}}catch(a){if(ge(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var t,i,r;try{let a;if("email"in e){const{email:y,password:T,options:x}=e;let C=null,A=null;this.flowType==="pkce"&&([C,A]=await Ts(this.storage,this.storageKey)),a=await Ee(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:x==null?void 0:x.emailRedirectTo,body:{email:y,password:T,data:(t=x==null?void 0:x.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:x==null?void 0:x.captchaToken},code_challenge:C,code_challenge_method:A},xform:yn})}else if("phone"in e){const{phone:y,password:T,options:x}=e;a=await Ee(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:y,password:T,data:(i=x==null?void 0:x.data)!==null&&i!==void 0?i:{},channel:(r=x==null?void 0:x.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:x==null?void 0:x.captchaToken}},xform:yn})}else throw new wa("You must provide either an email or phone number and a password");const{data:u,error:h}=a;if(h||!u)return{data:{user:null,session:null},error:h};const m=u.session,p=u.user;return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",m)),{data:{user:p,session:m},error:null}}catch(a){if(ge(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:a,password:u,options:h}=e;t=await Ee(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:u,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:py})}else if("phone"in e){const{phone:a,password:u,options:h}=e;t=await Ee(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:u,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:py})}else throw new wa("You must provide either an email or phone number and a password");const{data:i,error:r}=t;return r?{data:{user:null,session:null},error:r}:!i||!i.session||!i.user?{data:{user:null,session:null},error:new Aa}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:r})}catch(t){if(ge(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,i,r,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(i=e.options)===null||i===void 0?void 0:i.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,i,r,a,u,h,m,p,y,T,x,C;let A,R;if("message"in e)A=e.message,R=e.signature;else{const{chain:k,wallet:B,statement:F,options:N}=e;let q;if(Ft())if(typeof B=="object")q=B;else{const K=window;if("solana"in K&&typeof K.solana=="object"&&("signIn"in K.solana&&typeof K.solana.signIn=="function"||"signMessage"in K.solana&&typeof K.solana.signMessage=="function"))q=K.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof B!="object"||!(N!=null&&N.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");q=B}const O=new URL((t=N==null?void 0:N.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in q&&q.signIn){const K=await q.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},N==null?void 0:N.signInWithSolana),{version:"1",domain:O.host,uri:O.href}),F?{statement:F}:null));let Q;if(Array.isArray(K)&&K[0]&&typeof K[0]=="object")Q=K[0];else if(K&&typeof K=="object"&&"signedMessage"in K&&"signature"in K)Q=K;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in Q&&"signature"in Q&&(typeof Q.signedMessage=="string"||Q.signedMessage instanceof Uint8Array)&&Q.signature instanceof Uint8Array)A=typeof Q.signedMessage=="string"?Q.signedMessage:new TextDecoder().decode(Q.signedMessage),R=Q.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in q)||typeof q.signMessage!="function"||!("publicKey"in q)||typeof q!="object"||!q.publicKey||!("toBase58"in q.publicKey)||typeof q.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");A=[`${O.host} wants you to sign in with your Solana account:`,q.publicKey.toBase58(),...F?["",F,""]:[""],"Version: 1",`URI: ${O.href}`,`Issued At: ${(r=(i=N==null?void 0:N.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((a=N==null?void 0:N.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${N.signInWithSolana.notBefore}`]:[],...!((u=N==null?void 0:N.signInWithSolana)===null||u===void 0)&&u.expirationTime?[`Expiration Time: ${N.signInWithSolana.expirationTime}`]:[],...!((h=N==null?void 0:N.signInWithSolana)===null||h===void 0)&&h.chainId?[`Chain ID: ${N.signInWithSolana.chainId}`]:[],...!((m=N==null?void 0:N.signInWithSolana)===null||m===void 0)&&m.nonce?[`Nonce: ${N.signInWithSolana.nonce}`]:[],...!((p=N==null?void 0:N.signInWithSolana)===null||p===void 0)&&p.requestId?[`Request ID: ${N.signInWithSolana.requestId}`]:[],...!((T=(y=N==null?void 0:N.signInWithSolana)===null||y===void 0?void 0:y.resources)===null||T===void 0)&&T.length?["Resources",...N.signInWithSolana.resources.map(Q=>`- ${Q}`)]:[]].join(`
`);const K=await q.signMessage(new TextEncoder().encode(A),"utf8");if(!K||!(K instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");R=K}}try{const{data:k,error:B}=await Ee(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:A,signature:bk(R)},!((x=e.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(C=e.options)===null||C===void 0?void 0:C.captchaToken}}:null),xform:yn});if(B)throw B;return!k||!k.session||!k.user?{data:{user:null,session:null},error:new Aa}:(k.session&&(await this._saveSession(k.session),await this._notifyAllSubscribers("SIGNED_IN",k.session)),{data:Object.assign({},k),error:B})}catch(k){if(ge(k))return{data:{user:null,session:null},error:k};throw k}}async _exchangeCodeForSession(e){const t=await yi(this.storage,`${this.storageKey}-code-verifier`),[i,r]=(t??"").split("/");try{const{data:a,error:u}=await Ee(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:i},xform:yn});if(await Jn(this.storage,`${this.storageKey}-code-verifier`),u)throw u;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new Aa}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:r??null}),error:u})}catch(a){if(ge(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:t,provider:i,token:r,access_token:a,nonce:u}=e,h=await Ee(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:r,access_token:a,nonce:u,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:yn}),{data:m,error:p}=h;return p?{data:{user:null,session:null},error:p}:!m||!m.session||!m.user?{data:{user:null,session:null},error:new Aa}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),{data:m,error:p})}catch(t){if(ge(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,i,r,a,u;try{if("email"in e){const{email:h,options:m}=e;let p=null,y=null;this.flowType==="pkce"&&([p,y]=await Ts(this.storage,this.storageKey));const{error:T}=await Ee(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:h,data:(t=m==null?void 0:m.data)!==null&&t!==void 0?t:{},create_user:(i=m==null?void 0:m.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},code_challenge:p,code_challenge_method:y},redirectTo:m==null?void 0:m.emailRedirectTo});return{data:{user:null,session:null},error:T}}if("phone"in e){const{phone:h,options:m}=e,{data:p,error:y}=await Ee(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:h,data:(r=m==null?void 0:m.data)!==null&&r!==void 0?r:{},create_user:(a=m==null?void 0:m.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},channel:(u=m==null?void 0:m.channel)!==null&&u!==void 0?u:"sms"}});return{data:{user:null,session:null,messageId:p==null?void 0:p.message_id},error:y}}throw new wa("You must provide either an email or phone number.")}catch(h){if(ge(h))return{data:{user:null,session:null},error:h};throw h}}async verifyOtp(e){var t,i;try{let r,a;"options"in e&&(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo,a=(i=e.options)===null||i===void 0?void 0:i.captchaToken);const{data:u,error:h}=await Ee(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:r,xform:yn});if(h)throw h;if(!u)throw new Error("An error occurred on token verification.");const m=u.session,p=u.user;return m!=null&&m.access_token&&(await this._saveSession(m),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",m)),{data:{user:p,session:m},error:null}}catch(r){if(ge(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var t,i,r;try{let a=null,u=null;return this.flowType==="pkce"&&([a,u]=await Ts(this.storage,this.storageKey)),await Ee(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&i!==void 0?i:void 0}),!((r=e==null?void 0:e.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:u}),headers:this.headers,xform:Jk})}catch(a){if(ge(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:i}=e;if(i)throw i;if(!t)throw new jn;const{error:r}=await Ee(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}})}catch(e){if(ge(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:i,type:r,options:a}=e,{error:u}=await Ee(this.fetch,"POST",t,{headers:this.headers,body:{email:i,type:r,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:u}}else if("phone"in e){const{phone:i,type:r,options:a}=e,{data:u,error:h}=await Ee(this.fetch,"POST",t,{headers:this.headers,body:{phone:i,type:r,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:h}}throw new wa("You must provide either an email or phone number and a type")}catch(t){if(ge(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await i,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=t();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await yi(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const i=e.expires_at?e.expires_at*1e3-Date.now()<yc:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",e.expires_at),!i){if(this.userStorage){const u=await yi(this.userStorage,this.storageKey+"-user");u!=null&&u.user?e.user=u.user:e.user=Sc()}if(this.storage.isServer&&e.user){let u=this.suppressGetSessionWarning;e=new Proxy(e,{get:(m,p,y)=>(!u&&p==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),u=!0,this.suppressGetSessionWarning=!0),Reflect.get(m,p,y))})}return{data:{session:e},error:null}}const{session:r,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Ee(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Kn}):await this._useSession(async t=>{var i,r,a;const{data:u,error:h}=t;if(h)throw h;return!(!((i=u.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new jn}:await Ee(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(r=u.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0,xform:Kn})})}catch(t){if(ge(t))return Tk(t)&&(await this._removeSession(),await Jn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async i=>{const{data:r,error:a}=i;if(a)throw a;if(!r.session)throw new jn;const u=r.session;let h=null,m=null;this.flowType==="pkce"&&e.email!=null&&([h,m]=await Ts(this.storage,this.storageKey));const{data:p,error:y}=await Ee(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:h,code_challenge_method:m}),jwt:u.access_token,xform:Kn});if(y)throw y;return u.user=p.user,await this._saveSession(u),await this._notifyAllSubscribers("USER_UPDATED",u),{data:{user:u.user},error:null}})}catch(i){if(ge(i))return{data:{user:null},error:i};throw i}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new jn;const t=Date.now()/1e3;let i=t,r=!0,a=null;const{payload:u}=Tc(e.access_token);if(u.exp&&(i=u.exp,r=i<=t),r){const{session:h,error:m}=await this._callRefreshToken(e.refresh_token);if(m)return{data:{user:null,session:null},error:m};if(!h)return{data:{user:null,session:null},error:null};a=h}else{const{data:h,error:m}=await this._getUser(e.access_token);if(m)throw m;a={access_token:e.access_token,refresh_token:e.refresh_token,user:h.user,token_type:"bearer",expires_in:i-t,expires_at:i},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(t){if(ge(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var i;if(!e){const{data:u,error:h}=t;if(h)throw h;e=(i=u.session)!==null&&i!==void 0?i:void 0}if(!(e!=null&&e.refresh_token))throw new jn;const{session:r,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(ge(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Ft())throw new ba("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ba(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new ly("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ba("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new ly("No code detected.");const{data:F,error:N}=await this._exchangeCodeForSession(e.code);if(N)throw N;const q=new URL(window.location.href);return q.searchParams.delete("code"),window.history.replaceState(window.history.state,"",q.toString()),{data:{session:F.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:r,access_token:a,refresh_token:u,expires_in:h,expires_at:m,token_type:p}=e;if(!a||!h||!u||!p)throw new ba("No session defined in URL");const y=Math.round(Date.now()/1e3),T=parseInt(h);let x=y+T;m&&(x=parseInt(m));const C=x-y;C*1e3<=Es&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${C}s, should have been closer to ${T}s`);const A=x-T;y-A>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",A,x,y):y-A<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",A,x,y);const{data:R,error:k}=await this._getUser(a);if(k)throw k;const B={provider_token:i,provider_refresh_token:r,access_token:a,expires_in:T,expires_at:x,refresh_token:u,token_type:p,user:R.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:B,redirectType:e.type},error:null}}catch(i){if(ge(i))return{data:{session:null,redirectType:null},error:i};throw i}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await yi(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var i;const{data:r,error:a}=t;if(a)return{error:a};const u=(i=r.session)===null||i===void 0?void 0:i.access_token;if(u){const{error:h}=await this.admin.signOut(u,e);if(h&&!(vk(h)&&(h.status===404||h.status===401||h.status===403)))return{error:h}}return e!=="others"&&(await this._removeSession(),await Jn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=Mk(),i={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,i),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:i}}}async _emitInitialSession(e){return await this._useSession(async t=>{var i,r;try{const{data:{session:a},error:u}=t;if(u)throw u;await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,t={}){let i=null,r=null;this.flowType==="pkce"&&([i,r]=await Ts(this.storage,this.storageKey,!0));try{return await Ee(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:i,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(ge(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:t,error:i}=await this.getUser();if(i)throw i;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(ge(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:i,error:r}=await this._useSession(async a=>{var u,h,m,p,y;const{data:T,error:x}=a;if(x)throw x;const C=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(u=e.options)===null||u===void 0?void 0:u.redirectTo,scopes:(h=e.options)===null||h===void 0?void 0:h.scopes,queryParams:(m=e.options)===null||m===void 0?void 0:m.queryParams,skipBrowserRedirect:!0});return await Ee(this.fetch,"GET",C,{headers:this.headers,jwt:(y=(p=T.session)===null||p===void 0?void 0:p.access_token)!==null&&y!==void 0?y:void 0})});if(r)throw r;return Ft()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(i==null?void 0:i.url),{data:{provider:e.provider,url:i==null?void 0:i.url},error:null}}catch(i){if(ge(i))return{data:{provider:e.provider,url:null},error:i};throw i}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var i,r;const{data:a,error:u}=t;if(u)throw u;return await Ee(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&r!==void 0?r:void 0})})}catch(t){if(ge(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const i=Date.now();return await Dk(async r=>(r>0&&await Ik(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await Ee(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:yn})),(r,a)=>{const u=200*Math.pow(2,r);return a&&vc(a)&&Date.now()+u-i<Es})}catch(i){if(this._debug(t,"error",i),ge(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const i=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",i),Ft()&&!t.skipBrowserRedirect&&window.location.assign(i),{data:{provider:e,url:i},error:null}}async _recoverAndRefresh(){var e,t;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const r=await yi(this.storage,this.storageKey);if(r&&this.userStorage){let u=await yi(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!u&&(u={user:r.user},await As(this.userStorage,this.storageKey+"-user",u)),r.user=(e=u==null?void 0:u.user)!==null&&e!==void 0?e:Sc()}else if(r&&!r.user&&!r.user){const u=await yi(this.storage,this.storageKey+"-user");u&&(u!=null&&u.user)?(r.user=u.user,await Jn(this.storage,this.storageKey+"-user"),await As(this.storage,this.storageKey,r)):r.user=Sc()}if(this._debug(i,"session from storage",r),!this._isValidSession(r)){this._debug(i,"session is not valid"),r!==null&&await this._removeSession();return}const a=((t=r.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<yc;if(this._debug(i,`session has${a?"":" not"} expired with margin of ${yc}s`),a){if(this.autoRefreshToken&&r.refresh_token){const{error:u}=await this._callRefreshToken(r.refresh_token);u&&(console.error(u),vc(u)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",u),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:u,error:h}=await this._getUser(r.access_token);!h&&(u!=null&&u.user)?(r.user=u.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(u){console.error("Error getting user data:",u),this._debug(i,"error getting user data, skipping SIGNED_IN notification",u)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(i,"error",r),console.error(r);return}finally{this._debug(i,"end")}}async _callRefreshToken(e){var t,i;if(!e)throw new jn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Ya;const{data:a,error:u}=await this._refreshAccessToken(e);if(u)throw u;if(!a.session)throw new jn;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const h={session:a.session,error:null};return this.refreshingDeferred.resolve(h),h}catch(a){if(this._debug(r,"error",a),ge(a)){const u={session:null,error:a};return vc(a)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(u),u}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(a),a}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,i=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],u=Array.from(this.stateChangeEmitters.values()).map(async h=>{try{await h.callback(e,t)}catch(m){a.push(m)}});if(await Promise.all(u),a.length>0){for(let h=0;h<a.length;h+=1)console.error(a[h]);throw a[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),i=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&t.user&&await As(this.userStorage,this.storageKey+"-user",{user:t.user});const r=Object.assign({},t);delete r.user;const a=hy(r);await As(this.storage,this.storageKey,a)}else{const r=hy(t);await As(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),await Jn(this.storage,this.storageKey),await Jn(this.storage,this.storageKey+"-code-verifier"),await Jn(this.storage,this.storageKey+"-user"),this.userStorage&&await Jn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Ft()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Es);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:i}}=t;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((i.expires_at*1e3-e)/Es);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${Es}ms, refresh threshold is ${Fc} ticks`),r<=Fc&&await this._callRefreshToken(i.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Uv)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ft()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,i){const r=[`provider=${encodeURIComponent(t)}`];if(i!=null&&i.redirectTo&&r.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i!=null&&i.scopes&&r.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[a,u]=await Ts(this.storage,this.storageKey),h=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(u)}`});r.push(h.toString())}if(i!=null&&i.queryParams){const a=new URLSearchParams(i.queryParams);r.push(a.toString())}return i!=null&&i.skipBrowserRedirect&&r.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var i;const{data:r,error:a}=t;return a?{data:null,error:a}:await Ee(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token})})}catch(t){if(ge(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var i,r;const{data:a,error:u}=t;if(u)return{data:null,error:u};const h=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:m,error:p}=await Ee(this.fetch,"POST",`${this.url}/factors`,{body:h,headers:this.headers,jwt:(i=a==null?void 0:a.session)===null||i===void 0?void 0:i.access_token});return p?{data:null,error:p}:(e.factorType==="totp"&&(!((r=m==null?void 0:m.totp)===null||r===void 0)&&r.qr_code)&&(m.totp.qr_code=`data:image/svg+xml;utf-8,${m.totp.qr_code}`),{data:m,error:null})})}catch(t){if(ge(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var i;const{data:r,error:a}=t;if(a)return{data:null,error:a};const{data:u,error:h}=await Ee(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token});return h?{data:null,error:h}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),{data:u,error:h})})}catch(t){if(ge(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var i;const{data:r,error:a}=t;return a?{data:null,error:a}:await Ee(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(i=r==null?void 0:r.session)===null||i===void 0?void 0:i.access_token})})}catch(t){if(ge(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:i}=await this._challenge({factorId:e.factorId});return i?{data:null,error:i}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const i=(e==null?void 0:e.factors)||[],r=i.filter(u=>u.factor_type==="totp"&&u.status==="verified"),a=i.filter(u=>u.factor_type==="phone"&&u.status==="verified");return{data:{all:i,totp:r,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,i;const{data:{session:r},error:a}=e;if(a)return{data:null,error:a};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:u}=Tc(r.access_token);let h=null;u.aal&&(h=u.aal);let m=h;((i=(t=r.user.factors)===null||t===void 0?void 0:t.filter(T=>T.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(m="aal2");const y=u.amr||[];return{data:{currentLevel:h,nextLevel:m,currentAuthenticationMethods:y},error:null}}))}async fetchJwk(e,t={keys:[]}){let i=t.keys.find(h=>h.kid===e);if(i)return i;const r=Date.now();if(i=this.jwks.keys.find(h=>h.kid===e),i&&this.jwks_cached_at+gk>r)return i;const{data:a,error:u}=await Ee(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(u)throw u;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=r,i=a.keys.find(h=>h.kid===e),!i)?null:i}async getClaims(e,t={}){try{let i=e;if(!i){const{data:C,error:A}=await this.getSession();if(A||!C.session)return{data:null,error:A};i=C.session.access_token}const{header:r,payload:a,signature:u,raw:{header:h,payload:m}}=Tc(i);t!=null&&t.allowExpired||Vk(a.exp);const p=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!p){const{error:C}=await this.getUser(i);if(C)throw C;return{data:{claims:a,header:r,signature:u},error:null}}const y=qk(r.alg),T=await crypto.subtle.importKey("jwk",p,y,!0,["verify"]);if(!await crypto.subtle.verify(y,T,u,wk(`${h}.${m}`)))throw new jc("Invalid JWT signature");return{data:{claims:a,header:r,signature:u},error:null}}catch(i){if(ge(i))return{data:null,error:i};throw i}}}Zo.nextInstanceID=0;const i2=Zo;class s2 extends i2{constructor(e){super(e)}}var o2=function(n,e,t,i){function r(a){return a instanceof t?a:new t(function(u){u(a)})}return new(t||(t=Promise))(function(a,u){function h(y){try{p(i.next(y))}catch(T){u(T)}}function m(y){try{p(i.throw(y))}catch(T){u(T)}}function p(y){y.done?a(y.value):r(y.value).then(h,m)}p((i=i.apply(n,e||[])).next())})};class r2{constructor(e,t,i){var r,a,u;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const h=ck(e),m=new URL(h);this.realtimeUrl=new URL("realtime/v1",m),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",m),this.storageUrl=new URL("storage/v1",m),this.functionsUrl=new URL("functions/v1",m);const p=`sb-${m.hostname.split(".")[0]}-auth-token`,y={db:nk,realtime:sk,auth:Object.assign(Object.assign({},ik),{storageKey:p}),global:tk},T=fk(i??{},y);this.storageKey=(r=T.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(a=T.global.headers)!==null&&a!==void 0?a:{},T.accessToken?(this.accessToken=T.accessToken,this.auth=new Proxy({},{get:(x,C)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(C)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((u=T.auth)!==null&&u!==void 0?u:{},this.headers,T.global.fetch),this.fetch=lk(t,this._getAccessToken.bind(this),T.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},T.realtime)),this.rest=new _N(new URL("rest/v1",m).href,{headers:this.headers,schema:T.db.schema,fetch:this.fetch}),this.storage=new XN(this.storageUrl.href,this.headers,this.fetch,i==null?void 0:i.storage),T.accessToken||this._listenForAuthEvents()}get functions(){return new cN(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},i={}){return this.rest.rpc(e,t,i)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return o2(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:i}=yield this.auth.getSession();return(t=(e=i.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:i,storage:r,storageKey:a,flowType:u,lock:h,debug:m},p,y){const T={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new s2({url:this.authUrl.href,headers:Object.assign(Object.assign({},T),p),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:i,storage:r,flowType:u,lock:h,debug:m,fetch:y,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new BN(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,i)=>{this._handleTokenChanged(t,"CLIENT",i==null?void 0:i.access_token)})}_handleTokenChanged(e,t,i){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==i?this.changedAccessToken=i:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const a2=(n,e,t)=>new r2(n,e,t);function l2(){if(typeof window<"u"||typeof process>"u")return!1;const n=process.version;if(n==null)return!1;const e=n.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}l2()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const u2="https://pxmubamvtgwafzfjpkdx.supabase.co",c2="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB4bXViYW12dGd3YWZ6Zmpwa2R4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ1MjMxMDQsImV4cCI6MjA3MDA5OTEwNH0.Jmv_IxT2ct0zsu5ohrzh7rvMc3CYnXZs2teOEV2MFxI",et=a2(u2,c2);function ka(n){const e=typeof n=="object"&&n!==null?n.message:String(n);return typeof e=="string"&&/Failed to fetch|NetworkError|TypeError: Failed to fetch/i.test(e)}async function vy(n,e=3){for(let t=1;t<=e;t++)try{return await n()}catch(i){if(t===e||!ka(i))throw i;const r=Math.pow(2,t-1)*1e3;await new Promise(a=>setTimeout(a,r))}throw new Error("Max retries exceeded")}const Cs={theme:"dark",default_ultra_mode:!1},f2=async n=>{const e={user_id:n,theme:Cs.theme},{error:t}=await et.from("user_preferences").upsert(e,{onConflict:"user_id",ignoreDuplicates:!0});if(t){if(ka(t))return{...Cs};console.warn("Error attempting to create default preferences:",t)}let i=et.from("user_preferences").select("theme, default_ultra_mode").eq("user_id",n).maybeSingle(),{data:r,error:a}=await vy(()=>i);if(a&&a.code==="42703"){const u=await vy(()=>et.from("user_preferences").select("theme").eq("user_id",n).maybeSingle());return u.error?ka(u.error)?{...Cs}:(console.error("Error fetching preferences:",u.error),{...Cs}):{theme:u.data.theme==="light"?"light":"dark",default_ultra_mode:!1}}return a?(ka(a)||console.error("Error fetching preferences:",a),{...Cs}):r?{theme:r.theme==="light"?"light":"dark",default_ultra_mode:r.default_ultra_mode??!1}:(console.log("No user preferences found, returning defaults"),{...Cs})},d2=async(n,e)=>{const t={user_id:n};typeof e.theme<"u"&&(t.theme=e.theme),typeof e.default_ultra_mode<"u"&&(t.default_ultra_mode=e.default_ultra_mode);let{error:i}=await et.from("user_preferences").upsert(t,{onConflict:"user_id"});if(i&&i.code==="42703"&&"default_ultra_mode"in t){const r={user_id:n,...typeof t.theme<"u"?{theme:t.theme}:{}},a=await et.from("user_preferences").upsert(r,{onConflict:"user_id"});if(a.error)throw console.error("Error updating preferences:",a.error),a.error;return}if(i)throw console.error("Error updating preferences:",i),i},h2=async n=>{const{data:e,error:t}=await et.from("sessions").select("*").eq("user_id",n).order("updated_at",{ascending:!1});return t?(console.error("Error fetching sessions:",t),[]):e.map(r=>({...r,messages:r.messages}))},m2=async(n,e)=>{const{data:t,error:i}=await et.from("sessions").insert([{user_id:n,title:e.title,messages:e.messages}]).select().single();if(i)throw console.error("Error creating session:",i),i;return{...t,messages:t.messages}},Ty=async(n,e)=>{const t={...e,...e.messages&&{messages:e.messages}},{error:i}=await et.from("sessions").update(t).eq("id",n);if(i)throw console.error("Error updating session:",i),i},p2=async n=>{const{data:e,error:t}=await et.from("sessions").delete().eq("id",n).select();if(t)throw console.error("Error deleting session:",t),t;if(!e||e.length===0){const i=new Error("Session not found or permission denied.");throw console.error(i.message,`ID: ${n}`),i}},g2=async n=>{const{error:e}=await et.from("sessions").delete().eq("user_id",n);if(e)throw console.error("Error deleting all user sessions:",e),e},y2=async(n,e)=>{const i=`${n}/${Date.now()}.jpg`,{error:r}=await et.storage.from("avatars").upload(i,e,{contentType:"image/jpeg",upsert:!0});if(r)throw console.error("Error uploading avatar:",r),r;const{data:a}=et.storage.from("avatars").getPublicUrl(i);return a.publicUrl},Wn=gv((n,e)=>({sessions:[],activeSession:null,activeSessionId:null,isLoading:!0,user:null,setSessions:t=>n({sessions:t}),setActiveSessionId:t=>n({activeSessionId:t}),loadSessions:async t=>{n({isLoading:!0,user:t});try{const i=await h2(t.id);n({sessions:i}),i.length>0?n({activeSessionId:i[0].id}):await e().newSession()}catch(i){console.error("Error loading user sessions:",i),n({sessions:[],activeSessionId:null})}finally{n({isLoading:!1})}},newSession:async()=>{const t=e().user;if(t)try{const i=await m2(t.id,{title:"New Analysis",messages:[]});n(r=>({sessions:[i,...r.sessions],activeSessionId:i.id}))}catch(i){console.error("Error creating new session:",i)}},selectSession:t=>{n({activeSessionId:t})},updateSession:async(t,i)=>{n(r=>({sessions:r.sessions.map(a=>a.id===t?{...a,...i}:a)}));try{await Ty(t,i)}catch(r){console.error("Error updating session:",r)}},updateSessionTitle:async(t,i)=>{n(r=>({sessions:r.sessions.map(a=>a.id===t?{...a,title:i}:a)}));try{await Ty(t,{title:i})}catch(r){console.error("Error renaming session:",r)}},deleteSession:async t=>{if(!e().user)return;const r=e().sessions,a=e().activeSessionId;n(u=>{const h=u.sessions.filter(p=>p.id!==t);let m=u.activeSessionId;return u.activeSessionId===t&&(m=h.length>0?h[0].id:null),{sessions:h,activeSessionId:m}});try{await p2(t),e().sessions.length===0&&await e().newSession()}catch(u){console.error("Error deleting session:",u),n({sessions:r,activeSessionId:a})}},clearAllUserSessions:async()=>{const t=e().user;if(t)try{await g2(t.id),n({sessions:[],activeSessionId:null}),await e().newSession()}catch(i){console.error("Error clearing all sessions:",i)}}}));Wn.subscribe(n=>{const e=n.sessions.find(t=>t.id===n.activeSessionId)||null;n.activeSession=e});const v2=({children:n,user:e})=>{const{loadSessions:t,user:i}=Wn();return ee.useEffect(()=>{e&&e.id!==(i==null?void 0:i.id)&&t(e)},[e,i,t]),S.jsx(S.Fragment,{children:n})},T2=["Analyze the trend and key levels for this BTC/USD 4H chart.","Is there a bullish or bearish pattern forming here?","Based on the indicators, what's a potential trade setup?"],S2=({text:n,onClick:e})=>S.jsx("button",{onClick:e,className:"w-full text-left p-3 bg-input-bg rounded-lg hover:bg-border-color transition-colors text-sm text-text-secondary",children:n}),Sy=({onExampleClick:n})=>S.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center max-w-lg mx-auto",children:[S.jsx("div",{className:"w-16 h-16 bg-accent-blue rounded-full mb-4 flex items-center justify-center",children:S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-8 h-8 text-white",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456Z"})})}),S.jsx("h2",{className:"text-2xl font-semibold text-text-primary",children:"Wizz AI Analyzer"}),S.jsx("p",{className:"text-text-secondary mt-2 mb-8",children:"Upload a crypto chart image and ask a question to begin. Or, try one of these examples:"}),S.jsx("div",{className:"w-full space-y-3",children:T2.map(e=>S.jsx(S2,{text:e,onClick:()=>n(e)},e))})]}),x2="wizz_cache_v1";function xy(n,e){try{const t=`${x2}:${n}`;localStorage.setItem(t,JSON.stringify(e))}catch{}}const we=class we{constructor(e={}){this.storage=new Map,this.config={maxSize:100*1024*1024,defaultTTL:we.DEFAULT_TTL.ANALYSIS,cleanupInterval:300*1e3,enableCompression:!1,enableMetrics:!0,storageBackend:"localStorage",...e},this.metrics={hits:0,misses:0,hitRate:0,totalSize:0,entryCount:0,evictions:0,avgAccessTime:0,lastCleanup:Date.now()},this.initializeStorage(),this.startCleanupTimer()}get(e,t=we.NAMESPACES.ANALYSIS){const i=performance.now(),r=this.buildFullKey(t,e);try{const a=this.getFromStorage(r);return a?this.isExpired(a.metadata)?(this.remove(e,t),this.recordMiss(),null):(a.metadata.accessCount++,a.metadata.lastAccess=Date.now(),this.saveToStorage(r,a),this.recordHit(performance.now()-i),a.data):(this.recordMiss(),null)}catch(a){return console.warn("Cache get error:",a),this.recordMiss(),null}}set(e,t,i=we.NAMESPACES.ANALYSIS,r={}){try{const a=this.buildFullKey(i,e),u=this.estimateSize(t);this.metrics.totalSize+u>this.config.maxSize&&this.evictEntries(u);const h={key:e,namespace:i,timestamp:Date.now(),ttl:this.getTTLForNamespace(i),accessCount:1,lastAccess:Date.now(),size:u,version:"1.0",priority:"MEDIUM",...r},m={data:t,metadata:h};return this.saveToStorage(a,m),this.updateMetrics(u,1),!0}catch(a){return console.warn("Cache set error:",a),!1}}remove(e,t=we.NAMESPACES.ANALYSIS){try{const i=this.buildFullKey(t,e),r=this.getFromStorage(i);return r?(this.removeFromStorage(i),this.updateMetrics(-r.metadata.size,-1),!0):!1}catch(i){return console.warn("Cache remove error:",i),!1}}clearNamespace(e){let t=0;try{const i=this.getKeysForNamespace(e);for(const r of i)this.remove(r.replace(`${e}:`,""),e)&&t++}catch(i){console.warn("Cache clearNamespace error:",i)}return t}invalidateByTags(e){let t=0;try{const i=this.getAllKeys();for(const r of i){const a=this.getFromStorage(r);a!=null&&a.metadata.tags&&e.some(h=>{var m;return(m=a.metadata.tags)==null?void 0:m.includes(h)})&&(this.removeFromStorage(r),this.updateMetrics(-a.metadata.size,-1),t++)}}catch(i){console.warn("Cache invalidateByTags error:",i)}return t}cacheAnalysis(e,t,i,r,a,u){const h=this.buildAnalysisKey(e,t,i,r),m={priority:r?"HIGH":"MEDIUM",ttl:we.DEFAULT_TTL.ANALYSIS,tags:["analysis",a.toLowerCase(),i,t],dependencies:e};return this.set(h,u,we.NAMESPACES.ANALYSIS,m),h}getCachedAnalysis(e,t,i,r){const a=this.buildAnalysisKey(e,t,i,r);return this.get(a,we.NAMESPACES.ANALYSIS)}cachePatternAnalysis(e,t,i,r,a){const u=this.buildPatternKey(e,t,i,r),h={priority:"HIGH",ttl:we.DEFAULT_TTL.PATTERN,tags:["pattern",t,...r],dependencies:[e]};return this.set(u,a,we.NAMESPACES.PATTERN,h),u}getCachedPatternAnalysis(e,t,i,r){const a=this.buildPatternKey(e,t,i,r);return this.get(a,we.NAMESPACES.PATTERN)}cacheIndicator(e,t,i,r,a){const u=this.buildIndicatorKey(e,t,i,r),h={priority:"MEDIUM",ttl:we.DEFAULT_TTL.INDICATOR,tags:["indicator",e,r],dependencies:[i]};return this.set(u,a,we.NAMESPACES.INDICATOR,h),u}getCachedIndicator(e,t,i,r){const a=this.buildIndicatorKey(e,t,i,r);return this.get(a,we.NAMESPACES.INDICATOR)}cacheMarketStructure(e,t,i,r,a){const u=this.buildMarketStructureKey(e,t,i,r),h={priority:"HIGH",ttl:we.DEFAULT_TTL.MARKET_STRUCTURE,tags:["market_structure","smc",t,...i],dependencies:[e]};return this.set(u,a,we.NAMESPACES.MARKET_STRUCTURE,h),u}getCachedMarketStructure(e,t,i,r){const a=this.buildMarketStructureKey(e,t,i,r);return this.get(a,we.NAMESPACES.MARKET_STRUCTURE)}buildAnalysisKey(e,t,i,r){const a=[...e].sort();return["analysis",i,t,r?"ultra":"normal",...a].join("|")}buildPatternKey(e,t,i,r){const a=[...r].sort();return["pattern",e,t,i.toString(),...a].join("|")}buildIndicatorKey(e,t,i,r){const a=JSON.stringify(t,Object.keys(t).sort());return["indicator",e,i,r,btoa(a)].join("|")}buildMarketStructureKey(e,t,i,r){const a=[...i].sort();return["market_structure",e,t,r.toString(),...a].join("|")}buildFullKey(e,t){return`${e}:${t}`}initializeStorage(){this.config.storageBackend==="localStorage"&&this.loadMetricsFromStorage()}getFromStorage(e){try{if(this.config.storageBackend==="memory")return this.storage.get(e)||null;if(this.config.storageBackend==="localStorage"){const t=localStorage.getItem(e);return t?JSON.parse(t):null}return null}catch(t){return console.warn("Storage get error:",t),null}}saveToStorage(e,t){try{this.config.storageBackend==="memory"?this.storage.set(e,t):this.config.storageBackend==="localStorage"&&localStorage.setItem(e,JSON.stringify(t))}catch(i){console.warn("Storage save error:",i),i instanceof Error&&i.name==="QuotaExceededError"&&this.handleQuotaExceeded()}}removeFromStorage(e){try{this.config.storageBackend==="memory"?this.storage.delete(e):this.config.storageBackend==="localStorage"&&localStorage.removeItem(e)}catch(t){console.warn("Storage remove error:",t)}}getAllKeys(){try{if(this.config.storageBackend==="memory")return Array.from(this.storage.keys());if(this.config.storageBackend==="localStorage"){const e=[];for(let t=0;t<localStorage.length;t++){const i=localStorage.key(t);i&&e.push(i)}return e}return[]}catch(e){return console.warn("Storage getAllKeys error:",e),[]}}getKeysForNamespace(e){const t=`${e}:`;return this.getAllKeys().filter(i=>i.startsWith(t))}evictEntries(e){const t=this.getAllCacheEntries();t.sort((a,u)=>{const h={LOW:0,MEDIUM:1,HIGH:2,CRITICAL:3},m=h[a.metadata.priority]-h[u.metadata.priority];return m!==0?m:a.metadata.lastAccess-u.metadata.lastAccess});let i=0,r=0;for(const a of t){if(i>=e)break;if(a.metadata.priority==="CRITICAL")continue;const u=this.buildFullKey(a.metadata.namespace,a.metadata.key);this.removeFromStorage(u),i+=a.metadata.size,r++}this.metrics.evictions+=r,this.updateMetrics(-i,-r)}getAllCacheEntries(){const e=[],t=this.getAllKeys();for(const i of t){const r=this.getFromStorage(i);r&&e.push(r)}return e}handleQuotaExceeded(){console.warn("Storage quota exceeded, performing aggressive cleanup"),this.evictEntries(this.config.maxSize*.3)}cleanup(){const e=Date.now();let t=0;const i=this.getAllKeys();for(const r of i){const a=this.getFromStorage(r);a&&this.isExpired(a.metadata)&&(this.removeFromStorage(r),this.updateMetrics(-a.metadata.size,-1),t++)}this.metrics.lastCleanup=e,t>0&&console.log(`Cache cleanup: removed ${t} expired entries`)}startCleanupTimer(){this.cleanupTimer&&clearInterval(this.cleanupTimer),this.cleanupTimer=setInterval(()=>{this.cleanup()},this.config.cleanupInterval)}isExpired(e){return Date.now()>e.timestamp+e.ttl}estimateSize(e){try{return JSON.stringify(e).length*2}catch{return 1e3}}getTTLForNamespace(e){switch(e){case we.NAMESPACES.ANALYSIS:return we.DEFAULT_TTL.ANALYSIS;case we.NAMESPACES.PATTERN:return we.DEFAULT_TTL.PATTERN;case we.NAMESPACES.INDICATOR:return we.DEFAULT_TTL.INDICATOR;case we.NAMESPACES.MARKET_STRUCTURE:return we.DEFAULT_TTL.MARKET_STRUCTURE;case we.NAMESPACES.IMAGE_HASH:return we.DEFAULT_TTL.IMAGE_HASH;case we.NAMESPACES.METADATA:return we.DEFAULT_TTL.METADATA;default:return this.config.defaultTTL}}recordHit(e){this.metrics.hits++,this.updateHitRate(),this.updateAvgAccessTime(e)}recordMiss(){this.metrics.misses++,this.updateHitRate()}updateHitRate(){const e=this.metrics.hits+this.metrics.misses;this.metrics.hitRate=e>0?this.metrics.hits/e:0}updateAvgAccessTime(e){const t=this.metrics.hits+this.metrics.misses;this.metrics.avgAccessTime=(this.metrics.avgAccessTime*(t-1)+e)/t}updateMetrics(e,t){this.metrics.totalSize=Math.max(0,this.metrics.totalSize+e),this.metrics.entryCount=Math.max(0,this.metrics.entryCount+t),this.config.enableMetrics&&this.saveMetricsToStorage()}loadMetricsFromStorage(){try{const t=localStorage.getItem("wizz_cache_metrics_v1");t&&(this.metrics={...this.metrics,...JSON.parse(t)})}catch(e){console.warn("Failed to load cache metrics:",e)}}saveMetricsToStorage(){try{localStorage.setItem("wizz_cache_metrics_v1",JSON.stringify(this.metrics))}catch(e){console.warn("Failed to save cache metrics:",e)}}getMetrics(){return{...this.metrics}}getConfig(){return{...this.config}}updateConfig(e){this.config={...this.config,...e},e.cleanupInterval&&this.startCleanupTimer()}forceCleanup(){const e=this.metrics.entryCount;return this.cleanup(),e-this.metrics.entryCount}clearAll(){try{for(const e of Object.values(we.NAMESPACES))this.clearNamespace(e);this.metrics={hits:0,misses:0,hitRate:0,totalSize:0,entryCount:0,evictions:0,avgAccessTime:0,lastCleanup:Date.now()},this.config.storageBackend==="memory"&&this.storage.clear()}catch(e){console.warn("Cache clearAll error:",e)}}destroy(){this.cleanupTimer&&(clearInterval(this.cleanupTimer),this.cleanupTimer=void 0),this.config.storageBackend==="memory"&&this.storage.clear()}};we.NAMESPACES={ANALYSIS:"analysis_v2",PATTERN:"pattern_v1",INDICATOR:"indicator_v1",MARKET_STRUCTURE:"smc_v1",IMAGE_HASH:"image_v1",METADATA:"meta_v1"},we.DEFAULT_TTL={ANALYSIS:1440*60*1e3,PATTERN:720*60*1e3,INDICATOR:360*60*1e3,MARKET_STRUCTURE:480*60*1e3,IMAGE_HASH:10080*60*1e3,METADATA:1800*1e3};let Kc=we;const Ra=new Kc({maxSize:200*1024*1024,defaultTTL:1440*60*1e3,cleanupInterval:600*1e3,enableCompression:!1,enableMetrics:!0,storageBackend:"localStorage"});class Si{constructor(){this.historicalData=new Map,this.assetProfiles=new Map,this.initializeDefaultAssetProfiles()}static getInstance(){return Si.instance||(Si.instance=new Si),Si.instance}calculateDynamicRR(e,t,i,r,a,u,h=!1){const m=this.calculateAdjustmentFactors(t,i,r,a,u,h),p=Object.values(m).reduce((x,C)=>x+C,0),y=Math.max(1,e+p),T=this.generateReasoning(m,t,i,a);return{baseRR:e,adjustedRR:y,adjustmentFactors:m,reasoning:T,finalRecommendation:this.generateFinalRecommendation(y,u,h)}}calculateVolatilityMetrics(e,t){if(e.length<20)return this.getDefaultVolatilityMetrics();const i=this.calculateReturns(e),r=this.calculateCurrentVolatility(i),a=this.calculateHistoricalVolatility(i),u=this.calculateVolatilityTrend(i),h=this.calculateATR(e),m=this.calculateBollingerBandWidth(e),p=this.classifyVolatilityRegime(r);return{currentVolatility:r,historicalVolatility:a,volatilityRegime:p,volatilityTrend:u,atrValue:h,bollingerBandWidth:m}}analyzeTimePatterns(e,t){const i=new Date(e),r=i.getUTCHours(),a=i.getUTCDay(),u=this.getAssetProfile(t),h=this.isActiveTradingTime(r,a,u),m=this.getTimeBasedVolatility(r,a,t),p=this.getSessionStrength(r,t),y=this.getMarketSession(r,t);return{currentHour:r,currentDay:a,isActiveTradingTime:h,timeBasedVolatility:m,sessionStrength:p,marketSession:y}}updateHistoricalPerformance(e,t,i){const r=`${e}_${t}`,a=this.historicalData.get(r)||this.getDefaultHistoricalPerformance();a.totalTrades++,i.success&&a.successfulTrades++,a.successRate=a.successfulTrades/a.totalTrades,a.averageRR=(a.averageRR*(a.totalTrades-1)+i.rr)/a.totalTrades;const h=`${this.classifyVolatilityRegime(i.volatility).toLowerCase()}Vol`;if(a.volatilityBasedSuccess[h].trades++,i.success&&(a.volatilityBasedSuccess[h].successRate=(a.volatilityBasedSuccess[h].successRate*(a.volatilityBasedSuccess[h].trades-1)+1)/a.volatilityBasedSuccess[h].trades),a.timeBasedSuccess.hourly[i.hour]||(a.timeBasedSuccess.hourly[i.hour]={trades:0,successRate:0}),a.timeBasedSuccess.hourly[i.hour].trades++,i.success){const m=a.timeBasedSuccess.hourly[i.hour];m.successRate=(m.successRate*(m.trades-1)+1)/m.trades}if(a.timeBasedSuccess.daily[i.day]||(a.timeBasedSuccess.daily[i.day]={trades:0,successRate:0}),a.timeBasedSuccess.daily[i.day].trades++,i.success){const m=a.timeBasedSuccess.daily[i.day];m.successRate=(m.successRate*(m.trades-1)+1)/m.trades}if(a.assetTypeSuccess[e]||(a.assetTypeSuccess[e]={trades:0,successRate:0}),a.assetTypeSuccess[e].trades++,i.success){const m=a.assetTypeSuccess[e];m.successRate=(m.successRate*(m.trades-1)+1)/m.trades}this.historicalData.set(r,a)}getAssetProfile(e){return this.assetProfiles.get(e)||this.getDefaultAssetProfile()}calculateAdjustmentFactors(e,t,i,r,a,u){const h=this.calculateVolatilityAdjustment(e),m=this.calculateAssetTypeAdjustment(t),p=this.calculateHistoricalSuccessAdjustment(i,r),y=this.calculateTimePatternAdjustment(r),T=this.calculateConfidenceAdjustment(a,u);return{volatilityAdjustment:h,assetTypeAdjustment:m,historicalSuccessAdjustment:p,timePatternAdjustment:y,confidenceAdjustment:T}}calculateVolatilityAdjustment(e){const{currentVolatility:t,volatilityRegime:i,volatilityTrend:r}=e;let a=0;switch(i){case"LOW":a+=.2;break;case"MEDIUM":a+=0;break;case"HIGH":a-=.3;break;case"EXTREME":a-=.5;break}return r==="INCREASING"?a-=.1:r==="DECREASING"&&(a+=.1),a}calculateAssetTypeAdjustment(e){let t=0;switch(e.volatilityProfile){case"LOW":t+=.1;break;case"MEDIUM":t+=0;break;case"HIGH":t-=.2;break;case"EXTREME":t-=.4;break}const{optimal:i}=e.typicalRRRange;return i>2.5?t-=.1:i<1.8&&(t+=.1),t}calculateHistoricalSuccessAdjustment(e,t){if(e.totalTrades<10)return 0;let i=0;e.successRate>.7?i+=.1:e.successRate<.5&&(i-=.2);const r=t.timeBasedVolatility>.7?"highVol":t.timeBasedVolatility>.4?"mediumVol":"lowVol",a=e.volatilityBasedSuccess[r];a.trades>5&&(a.successRate>.7?i+=.1:a.successRate<.5&&(i-=.1));const u=e.timeBasedSuccess.hourly[t.currentHour];return u&&u.trades>3&&(u.successRate>.7?i+=.05:u.successRate<.5&&(i-=.05)),i}calculateTimePatternAdjustment(e){let t=0;switch(e.sessionStrength){case"STRONG":t+=.1;break;case"MODERATE":t+=0;break;case"WEAK":t-=.1;break}return e.isActiveTradingTime?t+=.05:t-=.1,e.timeBasedVolatility>.7?t-=.1:e.timeBasedVolatility<.3&&(t+=.05),t}calculateConfidenceAdjustment(e,t){let i=0;return e>=85?i+=.1:e<70&&(i-=.2),t&&(i-=.1),i}generateReasoning(e,t,i,r){const a=[];return e.volatilityAdjustment!==0&&a.push(`Volatility adjustment: ${e.volatilityAdjustment>0?"+":""}${e.volatilityAdjustment.toFixed(2)} (${t.volatilityRegime} volatility regime)`),e.assetTypeAdjustment!==0&&a.push(`Asset type adjustment: ${e.assetTypeAdjustment>0?"+":""}${e.assetTypeAdjustment.toFixed(2)} (${i.volatilityProfile} volatility profile)`),e.historicalSuccessAdjustment!==0&&a.push(`Historical success adjustment: ${e.historicalSuccessAdjustment>0?"+":""}${e.historicalSuccessAdjustment.toFixed(2)} (based on past performance)`),e.timePatternAdjustment!==0&&a.push(`Time pattern adjustment: ${e.timePatternAdjustment>0?"+":""}${e.timePatternAdjustment.toFixed(2)} (${r.sessionStrength} session, ${r.isActiveTradingTime?"active":"inactive"} trading time)`),e.confidenceAdjustment!==0&&a.push(`Confidence adjustment: ${e.confidenceAdjustment>0?"+":""}${e.confidenceAdjustment.toFixed(2)} (analysis confidence factor)`),a}generateFinalRecommendation(e,t,i){const r=e,a=e+.3,u=e+.6;let h=Math.min(95,t+(i?5:0));return{minRR:Math.max(1,r),optimalRR:Math.max(1.3,a),maxRR:Math.max(1.6,u),confidence:h}}calculateReturns(e){const t=[];for(let i=1;i<e.length;i++){const r=(e[i].close-e[i-1].close)/e[i-1].close;t.push(r)}return t}calculateCurrentVolatility(e){const t=e.slice(-20),i=t.reduce((a,u)=>a+u,0)/t.length,r=t.reduce((a,u)=>a+Math.pow(u-i,2),0)/t.length;return Math.sqrt(r)}calculateHistoricalVolatility(e){const t=e.reduce((r,a)=>r+a,0)/e.length,i=e.reduce((r,a)=>r+Math.pow(a-t,2),0)/e.length;return Math.sqrt(i)}calculateVolatilityTrend(e){if(e.length<40)return"STABLE";const t=e.slice(0,Math.floor(e.length/2)),i=e.slice(Math.floor(e.length/2)),r=this.calculateCurrentVolatility(t),u=(this.calculateCurrentVolatility(i)-r)/r;return u>.2?"INCREASING":u<-.2?"DECREASING":"STABLE"}calculateATR(e){if(e.length<14)return 0;const t=[];for(let r=1;r<e.length;r++){const a=e[r].high,u=e[r].low,h=e[r-1].close,m=a-u,p=Math.abs(a-h),y=Math.abs(u-h);t.push(Math.max(m,p,y))}const i=t.slice(-14);return i.reduce((r,a)=>r+a,0)/i.length}calculateBollingerBandWidth(e){if(e.length<20)return 0;const i=e.map(p=>p.close).slice(-20),r=i.reduce((p,y)=>p+y,0)/i.length,a=i.reduce((p,y)=>p+Math.pow(y-r,2),0)/i.length,u=Math.sqrt(a),h=r+2*u,m=r-2*u;return(h-m)/r}classifyVolatilityRegime(e){return e<.01?"LOW":e<.025?"MEDIUM":e<.05?"HIGH":"EXTREME"}isActiveTradingTime(e,t,i){return!!(i.marketHours.is24h||i.marketHours.activeHours&&i.marketHours.activeHours.includes(e))}getTimeBasedVolatility(e,t,i){return e===8||e===16?.7:e===0||e===12?.6:e>=22||e<=6?.3:.5}getSessionStrength(e,t){return t.includes("CRYPTO")||e>=8&&e<=16?"STRONG":e>=6&&e<=18?"MODERATE":"WEAK"}getMarketSession(e,t){return t.includes("CRYPTO")?"CRYPTO_24H":e>=0&&e<8?"ASIAN":e>=8&&e<16?"LONDON":e>=13&&e<21?"NEW_YORK":"ASIAN"}getDefaultVolatilityMetrics(){return{currentVolatility:.02,historicalVolatility:.02,volatilityRegime:"MEDIUM",volatilityTrend:"STABLE"}}getDefaultAssetProfile(){return{assetType:"CRYPTO",volatilityProfile:"HIGH",typicalRRRange:{min:1.8,max:3,optimal:2.2},marketHours:{is24h:!0}}}getDefaultHistoricalPerformance(){return{totalTrades:0,successfulTrades:0,successRate:0,averageRR:2,volatilityBasedSuccess:{lowVol:{trades:0,successRate:0},mediumVol:{trades:0,successRate:0},highVol:{trades:0,successRate:0},extremeVol:{trades:0,successRate:0}},timeBasedSuccess:{hourly:{},daily:{}},assetTypeSuccess:{}}}initializeDefaultAssetProfiles(){this.assetProfiles.set("BTC",{assetType:"CRYPTO",volatilityProfile:"HIGH",typicalRRRange:{min:1.8,max:3.5,optimal:2.2},marketHours:{is24h:!0}}),this.assetProfiles.set("ETH",{assetType:"CRYPTO",volatilityProfile:"HIGH",typicalRRRange:{min:1.8,max:3.5,optimal:2.2},marketHours:{is24h:!0}}),this.assetProfiles.set("EURUSD",{assetType:"FOREX",volatilityProfile:"MEDIUM",typicalRRRange:{min:1.5,max:2.8,optimal:2},marketHours:{is24h:!1,activeHours:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]}}),this.assetProfiles.set("AAPL",{assetType:"STOCKS",volatilityProfile:"MEDIUM",typicalRRRange:{min:1.5,max:2.5,optimal:1.8},marketHours:{is24h:!1,activeHours:[13,14,15,16,17,18,19,20,21]}}),this.assetProfiles.set("GOLD",{assetType:"COMMODITIES",volatilityProfile:"MEDIUM",typicalRRRange:{min:1.6,max:2.8,optimal:2},marketHours:{is24h:!1,activeHours:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]}})}}class Rs{constructor(){this.trades=new Map,this.dynamicRRService=Si.getInstance()}static getInstance(){return Rs.instance||(Rs.instance=new Rs),Rs.instance}recordTrade(e){const t=this.generateTradeId(),i={...e,id:t};return this.trades.set(t,i),this.saveTradesToStorage(),t}updateTradeOutcome(e,t){const i=this.trades.get(e);if(!i)return console.warn(`Trade ${e} not found for outcome update`),!1;const r={...i,...t};return this.trades.set(e,r),this.updateHistoricalPerformance(r),this.saveTradesToStorage(),!0}getTradeStatistics(){const e=Array.from(this.trades.values()).filter(A=>A.success!==void 0);if(e.length===0)return this.getEmptyStatistics();const t=e.length,i=e.filter(A=>A.success).length,r=i/t,a=e.reduce((A,R)=>A+R.rr,0)/t,u=e.filter(A=>A.exitTime).map(A=>{const R=new Date(A.entryTime).getTime();return(new Date(A.exitTime).getTime()-R)/(1e3*60*60)}),h=u.length>0?u.reduce((A,R)=>A+R,0)/u.length:0,m=this.calculateAssetPerformance(e),p=m.best,y=m.worst,T=this.calculateVolatilityPerformance(e),x=this.calculateTimePerformance(e),C=this.calculateAnalysisTypePerformance(e);return{totalTrades:t,successfulTrades:i,successRate:r,averageRR:a,averageHoldingTime:h,bestPerformingAsset:p,worstPerformingAsset:y,volatilityPerformance:T,timePerformance:x,analysisTypePerformance:C}}getHistoricalPerformance(e,t){const i=Array.from(this.trades.values()).filter(T=>T.success!==void 0&&T.assetType===e&&T.timeframe===t);if(i.length===0)return this.getDefaultHistoricalPerformance();const r=i.length,a=i.filter(T=>T.success).length,u=a/r,h=i.reduce((T,x)=>T+x.rr,0)/r,m=this.calculateVolatilityBasedSuccess(i),p=this.calculateTimeBasedSuccess(i),y=this.calculateAssetTypeSuccess(i);return{totalTrades:r,successfulTrades:a,successRate:u,averageRR:h,volatilityBasedSuccess:m,timeBasedSuccess:p,assetTypeSuccess:y}}getTradesForAsset(e,t){return Array.from(this.trades.values()).filter(i=>i.assetType===e&&i.timeframe===t).sort((i,r)=>new Date(r.entryTime).getTime()-new Date(i.entryTime).getTime())}getRecentTrades(e=50){return Array.from(this.trades.values()).sort((t,i)=>new Date(i.entryTime).getTime()-new Date(t.entryTime).getTime()).slice(0,e)}clearAllTrades(){this.trades.clear(),this.saveTradesToStorage()}generateTradeId(){return`trade_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}updateHistoricalPerformance(e){if(e.success===void 0)return;const t=new Date(e.entryTime).getUTCHours(),i=new Date(e.entryTime).getUTCDay();this.dynamicRRService.updateHistoricalPerformance(e.assetType,e.timeframe,{success:e.success,rr:e.rr,volatility:e.volatility,hour:t,day:i})}calculateAssetPerformance(e){const t=new Map;e.forEach(h=>{t.has(h.assetType)||t.set(h.assetType,{trades:0,successRate:0});const m=t.get(h.assetType);m.trades++,h.success&&(m.successRate=(m.successRate*(m.trades-1)+1)/m.trades)});let i="",r="",a=-1,u=2;return t.forEach((h,m)=>{h.trades>=5&&(h.successRate>a&&(a=h.successRate,i=m),h.successRate<u&&(u=h.successRate,r=m))}),{best:i,worst:r}}calculateVolatilityPerformance(e){const t={lowVol:{trades:0,successRate:0,avgRR:0},mediumVol:{trades:0,successRate:0,avgRR:0},highVol:{trades:0,successRate:0,avgRR:0},extremeVol:{trades:0,successRate:0,avgRR:0}},i={lowVol:[],mediumVol:[],highVol:[],extremeVol:[]};return e.forEach(r=>{let a;r.volatility<.01?a="lowVol":r.volatility<.025?a="mediumVol":r.volatility<.05?a="highVol":a="extremeVol",i[a].push(r)}),Object.keys(t).forEach(r=>{const a=i[r];if(a.length>0){const u=a.filter(m=>m.success).length,h=a.reduce((m,p)=>m+p.rr,0)/a.length;t[r]={trades:a.length,successRate:u/a.length,avgRR:h}}}),t}calculateTimePerformance(e){const t={},i={};return e.forEach(r=>{const a=new Date(r.entryTime).getUTCHours(),u=new Date(r.entryTime).getUTCDay();t[a]||(t[a]={trades:0,successRate:0,avgRR:0}),t[a].trades++,r.success&&(t[a].successRate=(t[a].successRate*(t[a].trades-1)+1)/t[a].trades),t[a].avgRR=(t[a].avgRR*(t[a].trades-1)+r.rr)/t[a].trades,i[u]||(i[u]={trades:0,successRate:0,avgRR:0}),i[u].trades++,r.success&&(i[u].successRate=(i[u].successRate*(i[u].trades-1)+1)/i[u].trades),i[u].avgRR=(i[u].avgRR*(i[u].trades-1)+r.rr)/i[u].trades}),{hourly:t,daily:i}}calculateAnalysisTypePerformance(e){const t={SMC:{trades:0,successRate:0,avgRR:0},PATTERN:{trades:0,successRate:0,avgRR:0},MULTI_TIMEFRAME:{trades:0,successRate:0,avgRR:0},STANDARD:{trades:0,successRate:0,avgRR:0}},i={SMC:[],PATTERN:[],MULTI_TIMEFRAME:[],STANDARD:[]};return e.forEach(r=>{i[r.analysisType].push(r)}),Object.keys(t).forEach(r=>{const a=i[r];if(a.length>0){const u=a.filter(m=>m.success).length,h=a.reduce((m,p)=>m+p.rr,0)/a.length;t[r]={trades:a.length,successRate:u/a.length,avgRR:h}}}),t}calculateVolatilityBasedSuccess(e){const t={lowVol:{trades:0,successRate:0},mediumVol:{trades:0,successRate:0},highVol:{trades:0,successRate:0},extremeVol:{trades:0,successRate:0}};return e.forEach(i=>{let r;i.volatility<.01?r="lowVol":i.volatility<.025?r="mediumVol":i.volatility<.05?r="highVol":r="extremeVol",t[r].trades++,i.success&&(t[r].successRate=(t[r].successRate*(t[r].trades-1)+1)/t[r].trades)}),t}calculateTimeBasedSuccess(e){const t={},i={};return e.forEach(r=>{const a=new Date(r.entryTime).getUTCHours(),u=new Date(r.entryTime).getUTCDay();t[a]||(t[a]={trades:0,successRate:0}),t[a].trades++,r.success&&(t[a].successRate=(t[a].successRate*(t[a].trades-1)+1)/t[a].trades),i[u]||(i[u]={trades:0,successRate:0}),i[u].trades++,r.success&&(i[u].successRate=(i[u].successRate*(i[u].trades-1)+1)/i[u].trades)}),{hourly:t,daily:i}}calculateAssetTypeSuccess(e){const t={};return e.forEach(i=>{t[i.assetType]||(t[i.assetType]={trades:0,successRate:0}),t[i.assetType].trades++,i.success&&(t[i.assetType].successRate=(t[i.assetType].successRate*(t[i.assetType].trades-1)+1)/t[i.assetType].trades)}),t}getEmptyStatistics(){return{totalTrades:0,successfulTrades:0,successRate:0,averageRR:0,averageHoldingTime:0,bestPerformingAsset:"",worstPerformingAsset:"",volatilityPerformance:{lowVol:{trades:0,successRate:0,avgRR:0},mediumVol:{trades:0,successRate:0,avgRR:0},highVol:{trades:0,successRate:0,avgRR:0},extremeVol:{trades:0,successRate:0,avgRR:0}},timePerformance:{hourly:{},daily:{}},analysisTypePerformance:{SMC:{trades:0,successRate:0,avgRR:0},PATTERN:{trades:0,successRate:0,avgRR:0},MULTI_TIMEFRAME:{trades:0,successRate:0,avgRR:0},STANDARD:{trades:0,successRate:0,avgRR:0}}}}getDefaultHistoricalPerformance(){return{totalTrades:0,successfulTrades:0,successRate:0,averageRR:2,volatilityBasedSuccess:{lowVol:{trades:0,successRate:0},mediumVol:{trades:0,successRate:0},highVol:{trades:0,successRate:0},extremeVol:{trades:0,successRate:0}},timeBasedSuccess:{hourly:{},daily:{}},assetTypeSuccess:{}}}saveTradesToStorage(){try{const e=Array.from(this.trades.values());localStorage.setItem("tradeTrackingData",JSON.stringify(e))}catch(e){console.warn("Failed to save trades to storage:",e)}}loadTradesFromStorage(){try{const e=localStorage.getItem("tradeTrackingData");if(e){const t=JSON.parse(e);this.trades.clear(),t.forEach(i=>{this.trades.set(i.id,i)})}}catch(e){console.warn("Failed to load trades from storage:",e)}}}function _2(n){if(!n)return null;const t=n.trim().match(/^(\d+(?:\.\d+)?)[\s]*:[\s]*1$/);if(!t)return null;const i=parseFloat(t[1]);return isNaN(i)?null:i}function C2(n){if(!n.trade)return!1;const{entryPrice:e,takeProfit:t,stopLoss:i}=n.trade;if(!e||!t||!i)return!1;const r=parseFloat(String(e).replace(/[^0-9.+-]/g,"")),a=parseFloat(String(t).replace(/[^0-9.+-]/g,"")),u=parseFloat(String(i).replace(/[^0-9.+-]/g,""));return!([r,a,u].some(h=>!isFinite(h))||r===a||r===u||n.signal==="BUY"&&!(a>r&&u<r)||n.signal==="SELL"&&!(a<r&&u>r))}function _y(n,e){var C;const t={...n},i=Number.isFinite(n.overallConfidenceScore)?n.overallConfidenceScore:0,r=i>=75?"HIGH":"LOW";t.confidence!==r&&(t.confidence=r);const a=_2(n.riskRewardRatio),u=C2(n),h=Si.getInstance(),m=Rs.getInstance(),p=E2(n),y=n.timeframe||"1H",T=new Date().toISOString(),x=A2(n,e,p,y,T,h,m);if(n.hasSMCAnalysis&&n.smcAnalysis){const A=n.smcAnalysis.tradingBias.confidence;if(e){const k=x.ultraMode.minRR,B=80;return t.signal==="NEUTRAL"||t.confidence==="LOW"?(t.trade=null,t.riskRewardRatio=null,t):((i<85||!u||a===null||a<k||A<B)&&(t.signal="NEUTRAL",t.trade=null,t.riskRewardRatio=null),t)}else{const k=x.normalMode.minRR,B=70;return t.signal==="NEUTRAL"||t.confidence==="LOW"?(t.trade=null,t.riskRewardRatio=null,t):((i<75||!u||a===null||a<k||A<B)&&(t.signal="NEUTRAL",t.trade=null,t.riskRewardRatio=null),t)}}if(n.hasAdvancedPatterns&&n.patternAnalysis){const A=((C=n.patternAnalysis.patternConfluence)==null?void 0:C.confidenceScore)||50;if(e){const k=x.ultraMode.minRR,B=85;return t.signal==="NEUTRAL"||t.confidence==="LOW"?(t.trade=null,t.riskRewardRatio=null,t):((i<85||!u||a===null||a<k||A<B)&&(t.signal="NEUTRAL",t.trade=null,t.riskRewardRatio=null),t)}else{const k=x.normalMode.minRR,B=75;return t.signal==="NEUTRAL"||t.confidence==="LOW"?(t.trade=null,t.riskRewardRatio=null,t):((i<75||!u||a===null||a<k||A<B)&&(t.signal="NEUTRAL",t.trade=null,t.riskRewardRatio=null),t)}}if(n.isMultiTimeframeAnalysis&&n.multiTimeframeContext){const A=n.multiTimeframeContext.confluenceScore;if(e){const k=x.ultraMode.minRR,B=80;return t.signal==="NEUTRAL"||t.confidence==="LOW"?(t.trade=null,t.riskRewardRatio=null,t):((i<85||!u||a===null||a<k||A<B)&&(t.signal="NEUTRAL",t.trade=null,t.riskRewardRatio=null),t)}else{const k=x.normalMode.minRR,B=70;return t.signal==="NEUTRAL"||t.confidence==="LOW"?(t.trade=null,t.riskRewardRatio=null,t):((i<75||!u||a===null||a<k||A<B)&&(t.signal="NEUTRAL",t.trade=null,t.riskRewardRatio=null),t)}}if(e){const R=x.ultraMode.minRR;return t.signal==="NEUTRAL"||t.confidence==="LOW"?(t.trade=null,t.riskRewardRatio=null,t):((i<85||!u||a===null||a<R)&&(t.signal="NEUTRAL",t.trade=null,t.riskRewardRatio=null),t)}else{const R=x.normalMode.minRR;return t.signal==="NEUTRAL"||t.confidence==="LOW"?(t.trade=null,t.riskRewardRatio=null,t):((i<75||!u||a===null||a<R)&&(t.signal="NEUTRAL",t.trade=null,t.riskRewardRatio=null),t)}}function E2(n){return n.summary.toLowerCase().includes("bitcoin")||n.summary.toLowerCase().includes("btc")?"BTC":n.summary.toLowerCase().includes("ethereum")||n.summary.toLowerCase().includes("eth")?"ETH":n.summary.toLowerCase().includes("eurusd")||n.summary.toLowerCase().includes("forex")?"EURUSD":n.summary.toLowerCase().includes("gold")||n.summary.toLowerCase().includes("commodity")?"GOLD":n.summary.toLowerCase().includes("stock")||n.summary.toLowerCase().includes("aapl")?"AAPL":"BTC"}function A2(n,e,t,i,r,a,u){const h=e?2.2:1.8,m=a.getAssetProfile(t),p=a.calculateVolatilityMetrics([],i),y=a.analyzeTimePatterns(r,t),T=u.getHistoricalPerformance(t,i),x=a.calculateDynamicRR(h,p,m,T,y,n.overallConfidenceScore,!1),C=a.calculateDynamicRR(h+.4,p,m,T,y,n.overallConfidenceScore,!0);return{normalMode:{minRR:x.finalRecommendation.minRR,optimalRR:x.finalRecommendation.optimalRR,maxRR:x.finalRecommendation.maxRR},ultraMode:{minRR:C.finalRecommendation.minRR,optimalRR:C.finalRecommendation.optimalRR,maxRR:C.finalRecommendation.maxRR}}}function Cy(n){const e=(n??"").trim();if(!e)throw new Error("Empty response");const t=e.match(/^```(?:json)?\s*([\s\S]*?)```\s*$/i),i=(t?t[1]:e).trim(),r=[],a=w2(i);if(a)r.push(a);else{const u=i.lastIndexOf("}"),h=i.indexOf("{");h!==-1&&u!==-1&&u>h?r.push(i.slice(h,u+1)):h!==-1?r.push(i.slice(h)):r.push(i)}for(const u of r){const h=b2(u);if(h)return h}throw new Error("No valid JSON found in response")}function w2(n){let e=!1,t=!1,i=0,r=-1,a=-1;for(let u=0;u<n.length;u++){const h=n[u];if(e){t?t=!1:h==="\\"?t=!0:h==='"'&&(e=!1);continue}h==='"'?e=!0:h==="{"?(i===0&&(r=u),i++):h==="}"&&(i>0&&i--,i===0&&r!==-1&&(a=u))}return r!==-1&&a!==-1&&a>r?n.slice(r,a+1):null}function b2(n){const e=n.trim();if(!e)return null;const t=[];t.push(e),t.push(e.replace(/,\s*([}\]])/g,"$1")),t.push(R2(e));for(const i of t)try{return JSON.parse(i),i}catch{}return null}function R2(n){let e=!1,t=!1,i=0,r=0,a="";for(let u=0;u<n.length;u++){const h=n[u];if(e){t?t=!1:h==="\\"?t=!0:h==='"'&&(e=!1),a+=h;continue}h==='"'?e=!0:h==="{"?i++:h==="}"?i--:h==="["?r++:h==="]"&&r--,a+=h}for(;i>0;)a+="}",i--;for(;r>0;)a+="]",r--;return a}const M2=()=>{const{activeSession:n,updateSession:e,updateSessionTitle:t}=Wn(),[i,r]=ee.useState(!1),[a,u]=ee.useState(!1),[h,m]=ee.useState(null),[p,y]=ee.useState({key:0,text:""}),T=ee.useRef(null),x=ee.useRef(new mv),C=ee.useCallback((N,q)=>{if(q){const O=x.current.updateContext({lastAnalysisTime:new Date,recentPrompts:h!=null&&h.recentPrompts?[...h.recentPrompts.slice(-9),N]:[N],sessionAnalysisCount:((h==null?void 0:h.sessionAnalysisCount)??0)+1,marketSession:x.current.getCurrentSession(),volatilityLevel:x.current.estimateVolatility(N),confidenceScore:75});m(O)}},[h]),A=ee.useCallback(N=>{if(!n||N<=0)return;const q=n.messages,O=q[N-1];if(O.role!=="user")return;const K=O.content,de=(O.images||[]).map((ue,ae)=>{var pe;return{mimeType:ue.startsWith("data:image/png")?"image/png":"image/jpeg",data:ue.split(",")[1]||ue,hash:((pe=O.imageHashes)==null?void 0:pe[ae])||`regen_${Date.now()}_${ae}`}}),ne=q.slice(0,N);e(n.id,{messages:ne}),a&&de.length>0,B(K,de)},[n,e,a]),R=ee.useCallback(()=>{T.current&&(T.current.abort(),T.current=null,r(!1))},[]),k=ee.useCallback(N=>{y({key:Date.now(),text:N})},[]),B=ee.useCallback(async(N,q)=>{var W,U,J;if(!n||!N&&(!q||q.length===0))return;const O=(q||[]).map(j=>j.hash).filter(Boolean),K=a?"ultra_p1":"standard_p1",Q=a?"gemini-2.5-pro":"gemini-2.5-flash",de=O.length>0?Tp({imageHashes:O,promptVersion:K,modelVersion:Q,ultra:a}):"";if(O.length>0){const j=Ra.getCachedAnalysis(O,K,Q,a);if(j){const w={id:`msg_${Date.now()+1}`,role:"assistant",content:j,thinkingText:j.thinkingProcess,rawResponse:JSON.stringify(j)},V=[...n.messages,{id:`msg_${Date.now()}`,role:"user",content:N,...q&&q.length>0&&{images:q.map(Y=>`data:${Y.mimeType};base64,${Y.data}`)},...O.length>0&&{imageHashes:O}}];e(n.id,{messages:[...V,w]});return}}T.current=new AbortController,r(!0);const ne={id:`msg_${Date.now()}`,role:"user",content:N,...q&&q.length>0&&{images:q.map(j=>`data:${j.mimeType};base64,${j.data}`)},...O.length>0&&{imageHashes:O}},ue=`msg_${Date.now()+1}`,ae={id:ue,role:"assistant",content:""},pe=[...n.messages,ne];e(n.id,{messages:pe});const xe=[...pe,ae];e(n.id,{messages:xe});let ve="";try{const j=XM(n.messages,N,q,T.current.signal,a);for await(const Z of j){if((W=T.current)!=null&&W.signal.aborted)break;ve+=Z}const se=Wn.getState().sessions.find(Z=>Z.id===n.id);if(!se)return;const w=se.messages.findIndex(Z=>Z.id===ue);if(w===-1)return;const V=[...se.messages];if((U=T.current)!=null&&U.signal.aborted){V[w].content="Analysis stopped by user.",e(n.id,{messages:V});return}let Y,X="";if(q&&q.length>0)try{const Z=JSON.parse(Cy(ve));if(Z.error)Y=`Error: ${Z.error}`;else{const he=_y(Z,a);Y=he,X=he.thinkingProcess,C(N,!0),O.length>0&&(Ra.cacheAnalysis(O,K,Q,a,a?"ULTRA":"STANDARD",he),xy(de,{signal:he.signal,confidence:(he.overallConfidenceScore??50)/100,raw:JSON.stringify(he),modelVersion:Q,promptVersion:K,ultra:a}))}}catch(Z){console.error("Failed to parse JSON response:",Z),Y=`Unable to parse the analysis response. Raw response: ${ve.substring(0,500)}...`}else Y=ve;if(V[w]={...V[w],content:Y,...X&&{thinkingText:X},rawResponse:ve},e(n.id,{messages:V}),se.messages.length===2&&typeof Y=="object"&&"summary"in Y){const Z=((J=Y.summary)==null?void 0:J.substring(0,50))+(Y.summary&&Y.summary.length>50?"...":"")||"Analysis";t(n.id,Z)}else se.messages.length===2&&t(n.id,"Chat")}catch(j){console.error("Error in analysis:",j);const se=Wn.getState().sessions.find(w=>w.id===n.id);if(se){const w=se.messages.findIndex(V=>V.id===ue);if(w!==-1){const V=[...se.messages];V[w].content="Sorry, I encountered an error during analysis. Please try again.",e(n.id,{messages:V})}}}finally{r(!1),T.current=null}},[n,e,t,a]),F=ee.useCallback(async(N,q)=>{var W,U,J;if(!n||!N&&(!q||q.length===0))return;const O=q.flatMap(j=>j.imageData.hash).filter(Boolean),K="multi_tf_p1",Q=a?"gemini-2.5-pro":"gemini-2.5-flash",de=O.length>0?Tp({imageHashes:O,promptVersion:K,modelVersion:Q,ultra:a}):"";if(O.length>0){const j=Ra.getCachedAnalysis(O,K,Q,a);if(j){const w={id:`msg_${Date.now()+1}`,role:"assistant",content:j,thinkingText:j.thinkingProcess,rawResponse:JSON.stringify(j)},V=[...n.messages,{id:`msg_${Date.now()}`,role:"user",content:N,timeframeImages:q.map(Y=>`${Y.timeframe}: data:${Y.imageData.mimeType};base64,${Y.imageData.data}`),imageHashes:O}];e(n.id,{messages:[...V,w]});return}}T.current=new AbortController,r(!0);const ne={id:`msg_${Date.now()}`,role:"user",content:N,timeframeImages:q.map(j=>`${j.timeframe}: data:${j.imageData.mimeType};base64,${j.imageData.data}`),imageHashes:O},ue=`msg_${Date.now()+1}`,ae={id:ue,role:"assistant",content:""},pe=[...n.messages,ne];e(n.id,{messages:pe});const xe=[...pe,ae];e(n.id,{messages:xe});let ve="";try{const j=QM(n.messages,N,q,T.current.signal,a);for await(const Z of j){if((W=T.current)!=null&&W.signal.aborted)break;ve+=Z}const se=Wn.getState().sessions.find(Z=>Z.id===n.id);if(!se)return;const w=se.messages.findIndex(Z=>Z.id===ue);if(w===-1)return;const V=[...se.messages];if((U=T.current)!=null&&U.signal.aborted){V[w].content="Multi-timeframe analysis stopped by user.",e(n.id,{messages:V});return}let Y,X="";try{const Z=JSON.parse(Cy(ve));if(Z.error)Y=`Error: ${Z.error}`;else{const he=_y(Z,a);Y=he,X=he.thinkingProcess,C(N,!0),O.length>0&&(Ra.cacheAnalysis(O,K,Q,a,"MULTI_TIMEFRAME",he),xy(de,{signal:he.signal,confidence:(he.overallConfidenceScore??50)/100,raw:JSON.stringify(he),modelVersion:Q,promptVersion:K,ultra:a}))}}catch(Z){console.error("Failed to parse multi-timeframe JSON response:",Z),Y=`Unable to parse the multi-timeframe analysis response. Raw response: ${ve.substring(0,500)}...`}if(V[w]={...V[w],content:Y,...X&&{thinkingText:X},rawResponse:ve},e(n.id,{messages:V}),se.messages.length===2&&typeof Y=="object"&&"summary"in Y){const Z=((J=Y.summary)==null?void 0:J.substring(0,50))+(Y.summary&&Y.summary.length>50?"...":"")||"Multi-Timeframe Analysis";t(n.id,Z)}else se.messages.length===2&&t(n.id,"Multi-Timeframe Chat")}catch(j){console.error("Error in multi-timeframe analysis:",j);const se=Wn.getState().sessions.find(w=>w.id===n.id);if(se){const w=se.messages.findIndex(V=>V.id===ue);if(w!==-1){const V=[...se.messages];V[w].content="Sorry, I encountered an error during multi-timeframe analysis. Please try again.",e(n.id,{messages:V})}}}finally{r(!1),T.current=null}},[n,e,t,a]);return ee.useEffect(()=>{const N=q=>{q.key==="Escape"&&i&&R()};return document.addEventListener("keydown",N),()=>document.removeEventListener("keydown",N)},[i,R]),n?S.jsxs("div",{className:"flex h-full",children:[S.jsxs("div",{className:"flex-1 flex flex-col h-full",children:[S.jsx("div",{className:"flex-1 overflow-y-auto p-6 space-y-6 bg-chat-bg",children:n.messages.length===0?S.jsx(Sy,{onPromptSelect:k}):n.messages.map((N,q)=>S.jsx(Mx,{message:N,onRegenerate:A},N.id||q))}),S.jsx("div",{className:"px-6 pb-4 bg-chat-bg",children:S.jsx(VS,{onSendMessage:B,onSendMultiTimeframeMessage:F,isLoading:i,onStopGeneration:R,initialPrompt:p.text,isUltraMode:a,onToggleUltraMode:()=>u(N=>!N)},p.key)})]}),h&&S.jsx("div",{className:"w-80 border-l border-border-color bg-sidebar-bg",children:S.jsx(Nx,{context:h})})]}):S.jsx(Sy,{onPromptSelect:k})},N2=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})}),k2=n=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),I2=({isOpen:n,onClose:e,onClearAllData:t,user:i,preferences:r,onUpdatePreferences:a,onUpdateProfile:u})=>{var de,ne,ue,ae,pe;const h=ee.useRef(null),[m,p]=ee.useState(((de=i.user_metadata)==null?void 0:de.name)||((ne=i.user_metadata)==null?void 0:ne.full_name)||""),[y,T]=ee.useState(((ue=i.user_metadata)==null?void 0:ue.avatar_url)||""),[x,C]=ee.useState(null),[A,R]=ee.useState(null),[k,B]=ee.useState(!1),[F,N]=ee.useState(null);ee.useEffect(()=>{var ve,W,U;const xe=J=>{J.key==="Escape"&&e()};return n&&(p(((ve=i.user_metadata)==null?void 0:ve.name)||((W=i.user_metadata)==null?void 0:W.full_name)||""),T(((U=i.user_metadata)==null?void 0:U.avatar_url)||""),C(null),R(null),N(null),document.addEventListener("keydown",xe)),()=>document.removeEventListener("keydown",xe)},[n,e,i]);const q=xe=>{var U;const ve=(U=xe.target.files)==null?void 0:U[0];if(!ve||!ve.type.startsWith("image/"))return;C(ve);const W=new FileReader;W.onloadend=()=>R(W.result),W.readAsDataURL(ve)},O=(xe,ve=256)=>{const W=document.createElement("canvas");W.width=ve,W.height=ve;const U=W.getContext("2d"),J=Math.min(xe.naturalWidth,xe.naturalHeight),j=(xe.naturalWidth-J)/2,se=(xe.naturalHeight-J)/2;return U.drawImage(xe,j,se,J,J,0,0,ve,ve),W},K=async xe=>{xe.preventDefault(),B(!0),N(null);try{let ve=y;if(x){const W=new Image,U=await new Promise((se,w)=>{W.onload=()=>{const V=O(W,256);se(V.toDataURL("image/jpeg",.9))},W.onerror=w,W.src=A||""}),J=await(await fetch(U)).blob(),j=await y2(i.id,J);ve=j,T(j)}await u({name:m,avatar_url:ve}),N({type:"success",text:"Profile saved successfully!"})}catch{N({type:"error",text:"Failed to save profile. Please try again."})}finally{B(!1),setTimeout(()=>N(null),3e3)}},Q=xe=>{a({default_ultra_mode:xe.target.checked})};return n?S.jsx("div",{role:"dialog","aria-modal":"true","aria-labelledby":"settings-title",className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 transition-opacity",onClick:e,children:S.jsxs("div",{ref:h,className:"bg-sidebar-bg rounded-lg shadow-2xl w-full max-w-md m-4 border border-border-color",onClick:xe=>xe.stopPropagation(),children:[S.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border-color",children:[S.jsx("h2",{id:"settings-title",className:"text-lg font-semibold text-text-primary",children:"Settings"}),S.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-input-bg","aria-label":"Close settings",children:S.jsx(k2,{className:"h-6 w-6 text-text-secondary"})})]}),S.jsxs("div",{className:"p-6 space-y-8 max-h-[70vh] overflow-y-auto",children:[S.jsxs("form",{onSubmit:K,children:[S.jsx("h3",{className:"font-medium text-text-primary mb-3",children:"Profile"}),S.jsxs("div",{className:"space-y-4",children:[S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Avatar"}),S.jsxs("div",{className:"flex items-center gap-4",children:[S.jsx("div",{className:"h-16 w-16 rounded-full bg-border-color overflow-hidden flex items-center justify-center",children:A?S.jsx("img",{src:A,alt:"New avatar preview",className:"h-16 w-16 object-cover"}):y?S.jsx("img",{src:y,alt:"Avatar",className:"h-16 w-16 object-cover"}):S.jsx("span",{className:"text-text-primary",children:(pe=(((ae=i.user_metadata)==null?void 0:ae.name)||i.email||"?")[0])==null?void 0:pe.toUpperCase()})}),S.jsxs("div",{children:[S.jsx("input",{type:"file",accept:"image/*",onChange:q}),S.jsx("p",{className:"text-xs text-text-secondary",children:"Upload an image, it will be auto-cropped to a square."})]})]})]}),S.jsxs("div",{children:[S.jsx("label",{htmlFor:"display-name",className:"block text-sm font-medium text-text-secondary mb-1",children:"Display Name"}),S.jsx("input",{id:"display-name",type:"text",value:m,onChange:xe=>p(xe.target.value),className:"w-full px-3 py-2 bg-input-bg border border-border-color rounded-md focus:outline-none focus:ring-2 focus:ring-accent-blue text-sm",placeholder:"Your Name"})]}),S.jsxs("div",{children:[S.jsx("label",{htmlFor:"avatar-url",className:"block text-sm font-medium text-text-secondary mb-1",children:"Avatar URL"}),S.jsx("input",{id:"avatar-url",type:"url",value:y,onChange:xe=>T(xe.target.value),className:"w-full px-3 py-2 bg-input-bg border border-border-color rounded-md focus:outline-none focus:ring-2 focus:ring-accent-blue text-sm",placeholder:"https://example.com/avatar.png"})]}),S.jsxs("div",{className:"flex items-center justify-end gap-3",children:[F&&S.jsx("span",{className:`text-sm ${F.type==="success"?"text-accent-green":"text-accent-red"}`,children:F.text}),S.jsx("button",{type:"submit",disabled:k,className:"px-4 py-2 text-sm font-medium text-white bg-accent-blue hover:bg-blue-700 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent-blue focus:ring-offset-sidebar-bg disabled:bg-gray-500",children:k?"Saving...":"Save Profile"})]})]})]}),S.jsx("div",{className:"border-t border-border-color"}),S.jsxs("div",{children:[S.jsx("h3",{className:"font-medium text-text-primary mb-3",children:"Preferences"}),S.jsxs("div",{className:"flex items-center justify-between bg-input-bg-50 p-3 rounded-lg",children:[S.jsxs("div",{children:[S.jsx("label",{htmlFor:"ultra-default",className:"font-medium text-text-primary text-sm",children:"Set Ultra Mode as default"}),S.jsx("p",{className:"text-xs text-text-secondary",children:"Start new analyses with Ultra Mode enabled (includes SMC & Advanced Patterns)."})]}),S.jsxs("label",{htmlFor:"ultra-default-toggle",className:"relative inline-flex items-center cursor-pointer",children:[S.jsx("input",{type:"checkbox",id:"ultra-default-toggle",className:"sr-only peer",checked:r.default_ultra_mode,onChange:Q}),S.jsx("div",{className:"w-11 h-6 bg-border-color peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-offset-2 peer-focus:ring-accent-blue peer-focus:ring-offset-sidebar-bg rounded-full peer peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent-blue"})]})]})]}),S.jsx("div",{className:"border-t border-border-color"}),S.jsxs("div",{children:[S.jsx("h3",{className:"font-medium text-text-primary mb-2",children:"Manage Data"}),S.jsx("p",{className:"text-sm text-text-secondary mb-3",children:"This will permanently delete all your chat sessions from your account across all devices. This action cannot be undone."}),S.jsx("button",{onClick:t,className:"w-full px-4 py-2 text-sm font-medium text-white bg-accent-red hover:bg-red-700 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent-red focus:ring-offset-sidebar-bg",children:"Clear All My Chat History"})]})]}),S.jsx("div",{className:"px-4 py-3 bg-chat-bg border-t border-border-color rounded-b-lg text-right",children:S.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-text-primary bg-input-bg border border-border-color rounded-md hover:bg-border-color transition-colors",children:"Done"})})]})}):null},xi=gv((n,e)=>({user:null,loading:!0,_setUser:t=>n({user:t}),_setLoading:t=>n({loading:t}),signInWithGoogle:async()=>{const{error:t}=await et.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.origin}});t&&console.error("Error logging in with Google:",t)},signOut:async()=>{const{error:t}=await et.auth.signOut();t&&console.error("Error logging out:",t)},signInWithEmail:async t=>{const{data:i,error:r}=await et.auth.signInWithPassword({email:t.email,password:t.password});return{error:r}},signUpWithEmail:async t=>{const{data:i,error:r}=await et.auth.signUp({email:t.email,password:t.password,options:{emailRedirectTo:window.location.origin}});return{error:r}},updateUserMetadata:async t=>{const i=Object.fromEntries(Object.entries(t).filter(([u,h])=>h!=null));if(Object.keys(i).length===0)return{error:null};const{data:r,error:a}=await et.auth.updateUser({data:i});return r.user&&n({user:r.user}),{error:a}}}));et.auth.getSession().then(({data:{session:n}})=>{xi.getState()._setUser((n==null?void 0:n.user)??null),xi.getState()._setLoading(!1)}),et.auth.onAuthStateChange((n,e)=>{xi.getState()._setUser((e==null?void 0:e.user)??null)});const D2=n=>S.jsx("svg",{viewBox:"0 0 48 48",...n,children:S.jsxs("g",{children:[S.jsx("path",{fill:"#EA4335",d:"M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"}),S.jsx("path",{fill:"#4285F4",d:"M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"}),S.jsx("path",{fill:"#FBBC05",d:"M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"}),S.jsx("path",{fill:"#34A853",d:"M24 48c6.48 0 11.93-2.13 15.89-5.82l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"}),S.jsx("path",{fill:"none",d:"M0 0h48v48H0z"})]})}),U2=({onGoogleLogin:n,onEmailLogin:e,onEmailSignUp:t})=>{const[i,r]=ee.useState("signin"),[a,u]=ee.useState(""),[h,m]=ee.useState(""),[p,y]=ee.useState(!1),[T,x]=ee.useState(null),[C,A]=ee.useState(null),R=async B=>{B.preventDefault(),y(!0),x(null),A(null);const F={email:a,password:h};let N;i==="signin"?N=await e(F):(N=await t(F),N.error||(A("Check your email for the confirmation link!"),m(""))),N.error&&x(N.error.message),y(!1)},k=()=>{r(i==="signin"?"signup":"signin"),x(null),A(null),u(""),m("")};return S.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen w-full bg-brand-bg text-text-primary p-4",children:S.jsxs("div",{className:"max-w-sm w-full text-center bg-sidebar-bg border border-border-color rounded-lg shadow-xl p-6 md:p-8",children:[S.jsx("div",{className:"flex justify-center mb-6",children:S.jsx("div",{className:"w-20 h-20 bg-accent-blue rounded-full flex items-center justify-center",children:S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-10 h-10 text-white",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456Z"})})})}),S.jsx("h1",{className:"text-3xl font-bold text-text-primary",children:i==="signin"?"Sign In to Wizz":"Create an Account"}),S.jsx("p",{className:"text-md text-text-secondary mt-2",children:"Your AI Crypto Chart Analyzer."}),S.jsxs("form",{onSubmit:R,className:"mt-8 space-y-4 text-left",children:[S.jsx("input",{type:"email",placeholder:"Email address",value:a,onChange:B=>u(B.target.value),required:!0,className:"w-full px-4 py-2 bg-input-bg border border-border-color rounded-md focus:outline-none focus:ring-2 focus:ring-accent-blue","aria-label":"Email address"}),S.jsx("input",{type:"password",placeholder:"Password",value:h,onChange:B=>m(B.target.value),required:!0,minLength:6,className:"w-full px-4 py-2 bg-input-bg border border-border-color rounded-md focus:outline-none focus:ring-2 focus:ring-accent-blue","aria-label":"Password"}),S.jsx("button",{type:"submit",disabled:p,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-accent-blue hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent-blue disabled:bg-gray-500 disabled:cursor-not-allowed",children:p?S.jsx("div",{className:"h-5 w-5 border-2 border-t-transparent border-white rounded-full animate-spin"}):i==="signin"?"Sign In":"Sign Up"}),T&&S.jsx("p",{className:"text-sm text-accent-red mt-2 text-center",children:T}),C&&S.jsx("p",{className:"text-sm text-accent-green mt-2 text-center",children:C})]}),S.jsxs("div",{className:"my-6 flex items-center",children:[S.jsx("div",{className:"border-t border-border-color flex-grow"}),S.jsx("span",{className:"mx-4 text-sm text-text-secondary flex-shrink-0",children:"OR"}),S.jsx("div",{className:"border-t border-border-color flex-grow"})]}),S.jsxs("button",{onClick:n,className:"flex items-center justify-center gap-3 w-full px-6 py-2.5 font-semibold text-text-primary bg-input-bg border border-border-color rounded-lg shadow-sm hover:bg-border-color focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent-blue focus:ring-offset-brand-bg transition-colors",children:[S.jsx(D2,{className:"h-5 w-5"}),S.jsx("span",{children:"Sign In with Google"})]}),S.jsxs("p",{className:"mt-8 text-sm text-center text-text-secondary",children:[i==="signin"?"Don't have an account?":"Already have an account?",S.jsx("button",{onClick:k,className:"font-medium text-accent-blue hover:underline ml-1 focus:outline-none",children:i==="signin"?"Sign up":"Sign in"})]})]})})},L2=()=>{const{user:n}=xi(),{activeSession:e,sessions:t,isLoading:i,clearAllUserSessions:r,updateSessionTitle:a,deleteSession:u,selectSession:h,newSession:m}=Wn(),[p,y]=ee.useState(!0),[T,x]=ee.useState(!1),[C,A]=ee.useState({theme:"dark",default_ultra_mode:!1});ee.useEffect(()=>{const N=window.document.documentElement;N.classList.remove("light","dark"),N.classList.add(C.theme)},[C.theme]),ee.useEffect(()=>{n?f2(n.id).then(A):A({theme:"dark",default_ultra_mode:!1})},[n]);const R=ee.useCallback(async N=>{if(!n)return;const q={...C,...N};A(q);try{await d2(n.id,q)}catch(O){console.error("Failed to update preferences:",O),A(C)}},[C,n]),k=ee.useCallback(async N=>{const{updateUserMetadata:q}=xi.getState(),{error:O}=await q(N);if(O)throw console.error("Failed to update profile",O),O},[]),B=ee.useCallback(async()=>{window.confirm("Are you sure you want to clear all chat history for your account? This action cannot be undone.")&&(await r(),x(!1))},[r]),F=async()=>{if(window.confirm("Are you sure you want to log out?")){const{signOut:N}=xi.getState();await N()}};return S.jsxs(S.Fragment,{children:[S.jsxs("div",{className:"flex h-screen w-full bg-brand-bg text-text-primary font-sans",children:[S.jsx(MS,{isOpen:p,sessions:t,activeSessionId:(e==null?void 0:e.id)??null,onNewSession:m,onSelectSession:h,onDeleteSession:u,onRenameSession:a,onToggle:()=>y(!p),user:n,theme:C.theme,onToggleTheme:()=>R({theme:C.theme==="light"?"dark":"light"}),onOpenSettings:()=>x(!0),onLogout:F}),S.jsxs("main",{className:"flex flex-1 flex-col transition-all duration-300 ease-in-out",children:[S.jsxs("div",{className:"flex items-center p-2 border-b border-border-color bg-sidebar-bg h-14",children:[S.jsx("button",{onClick:()=>y(!p),className:"p-2 rounded-md hover:bg-input-bg focus:outline-none focus:ring-2 focus:ring-accent-blue","aria-label":"Toggle sidebar",children:S.jsx(N2,{className:"h-6 w-6 text-text-secondary"})}),S.jsx("h1",{className:"text-lg font-semibold ml-4",children:(e==null?void 0:e.title)||"Wizz"})]}),e?S.jsx(M2,{defaultUltraMode:C.default_ultra_mode},e.id):S.jsx("div",{className:"flex-1 flex items-center justify-center",children:i?S.jsx("div",{className:"h-6 w-6 border-2 border-t-transparent border-accent-blue rounded-full animate-spin"}):S.jsx("p",{className:"text-text-secondary",children:"Select an analysis or start a new one."})})]})]}),T&&S.jsx(I2,{isOpen:T,onClose:()=>x(!1),onClearAllData:B,user:n,preferences:C,onUpdatePreferences:R,onUpdateProfile:k})]})},P2=()=>{const{user:n,loading:e,signInWithGoogle:t,signOut:i,signInWithEmail:r,signUpWithEmail:a}=xi();return e?S.jsx("div",{className:"flex items-center justify-center h-screen bg-brand-bg",children:S.jsx("div",{className:"h-8 w-8 border-4 border-t-transparent border-accent-blue rounded-full animate-spin"})}):n?S.jsx(v2,{user:n,children:S.jsx(L2,{})}):S.jsx(U2,{onGoogleLogin:t,onEmailLogin:r,onEmailSignUp:a})},Lv=document.getElementById("root");if(!Lv)throw new Error("Could not find root element to mount to");const H2=vS.createRoot(Lv);H2.render(S.jsx(ws.StrictMode,{children:S.jsx(P2,{})}));
